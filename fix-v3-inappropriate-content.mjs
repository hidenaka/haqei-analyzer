import { readFile, writeFile } from 'fs/promises';

async function fixInappropriateContent() {
  try {
    // V3ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã‚€
    const content = await readFile('./public/js/data/hexagram-human-traits-v3.js', 'utf-8');
    
    // ä¿®æ­£ãŒå¿…è¦ãªç®‡æ‰€ã®ãƒãƒƒãƒ”ãƒ³ã‚°
    const corrections = {
      // éœ‡ç‚ºé›·ã®ä¿®æ­£
      '"description": "é›·ã§åæ’ƒã™ã‚‹"': '"description": "ç¬ç™ºçš„ãªåå¿œã§è‡ªå·±é˜²è¡›ã™ã‚‹"',
      '"metaphor": "è§¦ã‚ŒãŸã‚‰æ„Ÿé›»"': '"metaphor": "å¼·ã„é˜²å¾¡åå¿œã‚’ç¤ºã™"',
      '"example": "æ”»æ’ƒ â†’ å³åº§ã«é›·æ’ƒ"': '"example": "æ‰¹åˆ¤ã«å¯¾ã—ã¦å³åº§ã«åè«–ã™ã‚‹"',
      '"example": "æœ€å¤§å‡ºåŠ›ã§åæ’ƒ"': '"example": "å…¨åŠ›ã§è‡ªåˆ†ã®ç«‹å ´ã‚’å®ˆã‚‹"',
      '"whatHappens": "ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è“„ç©"': '"whatHappens": "é™ã‹ã«åŠ›ã‚’è“„ãˆã¦ã„ã‚‹"',
      '"whatHappens": "å®Œå…¨ã«é™æ­¢"': '"whatHappens": "å®Œå…¨ã«ä¼‘æ¯ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚‹"',
      '"warning": "æš´ç™ºã«æ³¨æ„"': '"warning": "è¡å‹•çš„ãªåå¿œã«æ³¨æ„ãŒå¿…è¦"',
      '"description": "å¼·çƒˆãªå°è±¡ã‚’ä¸ãˆã‚‹"': '"description": "ä¸€ç¬ã§å¼·ã„å°è±¡ã‚’æ®‹ã™äºº"',
      '"metaphor": "å¿˜ã‚Œã‚‰ã‚Œãªã„è¡æ’ƒ"': '"metaphor": "å¿˜ã‚Œã‚‰ã‚Œãªã„å‡ºä¼šã„ã‚’ä½œã‚‹"',
      '"example": "ä¸€è¨€ã§æ ¸å¿ƒã‚’çªã"': '"example": "çŸ­ã„è¨€è‘‰ã§æœ¬è³ªã‚’ä¼ãˆã‚‹"',
      '"whatYouDo": "ç¬é–“çš„ã«çˆ†ç™º"': '"whatYouDo": "ç¬é–“çš„ã«å¼·ãåå¿œã™ã‚‹"',
      '"whatHappens": "å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¾å‡º"': '"whatHappens": "æŒã¦ã‚‹åŠ›ã‚’å…¨ã¦å‡ºã—åˆ‡ã‚‹"',
      
      // é›¢ç‚ºç«ã®ä¿®æ­£
      '"metaphor": "æ€’ã‚Šã®ç‚ã§æ•µã‚’ç„¼ãå°½ãã™"': '"metaphor": "å¼·ã„æ„Ÿæƒ…ã§è‡ªåˆ†ã‚’å®ˆã‚‹"',
      '"description": "æ„Ÿæƒ…ã®ç‚ã§å…¨ã¦ã‚’ç‡ƒã‚„ã™"': '"description": "æ„Ÿæƒ…ã‚’å¼·ãè¡¨ç¾ã—ã¦å¯¾å‡¦ã™ã‚‹"',
      '"example": "æ€’ã‚Š â†’ çˆ†ç™ºçš„ãªæ„Ÿæƒ…è¡¨å‡º"': '"example": "ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿæƒ…è¡¨ç¾ã§ç™ºæ•£ã™ã‚‹"',
      '"whatHappens": "å…¨ã¦ã‚’ç‡ƒã‚„ã—å°½ãã™"': '"whatHappens": "æ„Ÿæƒ…ã‚’å®Œå…¨ã«å‡ºã—åˆ‡ã‚‹"',
      '"example": "ç ´å£Šçš„ãªæƒ…ç†±ã®çˆ†ç™º"': '"example": "æŠ‘ãˆãã‚Œãªã„æ„Ÿæƒ…ã®è¡¨å‡º"',
      '"metaphor": "æ°¸é ã«ç‡ƒãˆç¶šã‘ã‚‹ç‚"': '"metaphor": "å°½ãã‚‹ã“ã¨ã®ãªã„æƒ…ç†±ã‚’æŒã¤"',
      '"whatHappens": "æ¬¡ã®ç‡ƒæ–™ã‚’æ¢ã™"': '"whatHappens": "æ¬¡ã®æƒ…ç†±ã®å¯¾è±¡ã‚’æ¢ã—ã¦ã„ã‚‹"',
      '"warning": "ç‡ƒãˆå°½ãã«æ³¨æ„"': '"warning": "ç‡ƒãˆå°½ãç—‡å€™ç¾¤ã«æ³¨æ„ãŒå¿…è¦"',
      '"metaphor": "ç‚ã®ã‚ˆã†ãªæ„ŸæŸ“åŠ›"': '"metaphor": "æƒ…ç†±ãŒå‘¨ã‚Šã«ä¼ã‚ã‚Šã‚„ã™ã„"',
      '"whatYouDo": "æ¿€ã—ãç‡ƒãˆã¦ç™ºæ•£"': '"whatYouDo": "æƒ…ç†±çš„ã«æ„Ÿæƒ…ã‚’è¡¨ç¾ã™ã‚‹"',
      
      // ãã®ä»–ã®æ”»æ’ƒçš„è¡¨ç¾ã®ä¿®æ­£
      '"example": "æ”»æ’ƒ â†’ è«–ç†çš„çŸ›ç›¾ã‚’æŒ‡æ‘˜ã—ã¦é˜²å¾¡"': '"example": "æ‰¹åˆ¤ã«å¯¾ã—ã¦è«–ç†çš„ã«åè«–ã™ã‚‹"',
      '"example": "å¤–éƒ¨ã‹ã‚‰ã®æ”»æ’ƒ â†’ ãƒãƒ¼ãƒ ä¸€ä¸¸ã§é˜²å¾¡"': '"example": "å›°é›£ã«å¯¾ã—ã¦ãƒãƒ¼ãƒ ä¸€ä¸¸ã§å¯¾å‡¦ã™ã‚‹"',
      '"example": "ã©ã‚“ãªæ”»æ’ƒã‚‚ç„¡è¨€ã§å—ã‘ã‚‹"': '"example": "ã©ã‚“ãªæ‰¹åˆ¤ã‚‚é»™ã£ã¦å—ã‘æ­¢ã‚ã‚‹"',
      
      // çŸ­ã™ãã‚‹èª¬æ˜ã®ä¿®æ­£ï¼ˆä¾‹ï¼‰
      '"whatHappens": "ä¸€æ™‚çš„ãªæ’¤é€€ã¨å†…çœ"': '"whatHappens": "ä¸€æ™‚çš„ã«è·é›¢ã‚’ç½®ã„ã¦è‡ªåˆ†ã¨å‘ãåˆã†æ™‚é–“ã‚’ä½œã‚‹"',
      '"whatHappens": "ä¸€äººã§é™ã‹ã«éã”ã™"': '"whatHappens": "ä¸€äººã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã—ã¦ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å›å¾©ã™ã‚‹"',
      '"warning": "æ€¥æ¿€ãªå¤‰åŒ–ã¯è‹¦æ‰‹"': '"warning": "æ€¥æ¿€ãªå¤‰åŒ–ã«å¯¾å¿œã™ã‚‹ã®ãŒè‹¦æ‰‹ãªå‚¾å‘ãŒã‚ã‚‹"',
      '"whatHappens": "å®ˆã‚Šã‚’å›ºã‚ã¦è€ãˆã‚‹"': '"whatHappens": "å®ˆã‚Šã®å§¿å‹¢ã‚’å›ºã‚ã¦å›°é›£ã«è€ãˆã‚‹"',
      '"whatHappens": "è€ƒãˆã‚‹å‰ã«ä½“ãŒå‹•ã"': '"whatHappens": "ç›´æ„Ÿçš„ã«è¡Œå‹•ã—ã¦å¾Œã‹ã‚‰è€ƒãˆã‚‹ã‚¿ã‚¤ãƒ—"',
      '"whatHappens": "æ¬¡ã®è¡Œå‹•ã®æº–å‚™é‹å‹•"': '"whatHappens": "æ¬¡ã®è¡Œå‹•ã«å‘ã‘ã¦å¿ƒèº«ã®æº–å‚™ã‚’ã—ã¦ã„ã‚‹"',
      '"description": "å‹•ã„ã¦æ‰“é–‹ã™ã‚‹"': '"description": "è¡Œå‹•ã™ã‚‹ã“ã¨ã§å•é¡Œã‚’æ‰“é–‹ã—ã‚ˆã†ã¨ã™ã‚‹"',
      '"whatYouDo": "ã¨ã«ã‹ãå‹•ã„ã¦è§£æ±º"': '"whatYouDo": "è€ƒãˆã‚‹ã‚ˆã‚Šå…ˆã«è¡Œå‹•ã—ã¦è§£æ±ºã‚’å›³ã‚‹"',
      '"whatHappens": "å…¨åŠ›ã§å‹•ãå›ã‚‹"': '"whatHappens": "å…¨åŠ›ã§è¡Œå‹•ã—ã¦çŠ¶æ³ã‚’å¤‰ãˆã‚ˆã†ã¨ã™ã‚‹"',
      
      // åœ°å‘³ãªèª¬æ˜ã®å……å®Ÿ
      '"whatHappens": "å¸¸ã«å­¦ã¶å§¿å‹¢ã‚’æŒã¤"': '"whatHappens": "å¸¸ã«è¬™è™šã«å­¦ã¶å§¿å‹¢ã‚’æŒã¡ç¶šã‘ã¦ã„ã‚‹"',
      '"whatHappens": "ã²ãŸã™ã‚‰è€ãˆã‚‹"': '"whatHappens": "ã©ã‚“ãªå›°é›£ã‚‚ã²ãŸã™ã‚‰è€ãˆæŠœãå¼·ã•ã‚’æŒã¤"',
      '"whatHappens": "æ¥½ã—ã„ã“ã¨ã‚’è€ƒãˆã‚‹"': '"whatHappens": "æ¥½ã—ã„ã“ã¨ã‚’è€ƒãˆã¦æ°—æŒã¡ã‚’å‰å‘ãã«ä¿ã¤"',
      '"whatYouDo": "æŠµæŠ—ã›ãšæµã‚Œã«ä¹—ã‚‹"': '"whatYouDo": "ç„¡ç†ã«æŠµæŠ—ã›ãšçŠ¶æ³ã®æµã‚Œã«èº«ã‚’ä»»ã›ã‚‹"',
      '"whatHappens": "ç’°å¢ƒã«å®Œå…¨ã«åŒåŒ–"': '"whatHappens": "ç’°å¢ƒã«å®Œå…¨ã«é©å¿œã—ã¦æº¶ã‘è¾¼ã‚€"',
      '"whatHappens": "æ¬¡ã®æ”¹å–„å¯¾è±¡ã‚’æ¢ã™"': '"whatHappens": "æ¬¡ã«æ”¹å–„ã™ã¹ãå¯¾è±¡ã‚’æ¢ã—ç¶šã‘ã¦ã„ã‚‹"',
      '"whatHappens": "ç·Šæ€¥ä¿®å¾©ãƒ¢ãƒ¼ãƒ‰èµ·å‹•"': '"whatHappens": "ç·Šæ€¥äº‹æ…‹ã«å¯¾ã—ã¦ä¿®å¾©ãƒ¢ãƒ¼ãƒ‰ã§å¯¾å¿œã™ã‚‹"',
      '"warning": "è¡Œå‹•ãŒé…ã‚ŒãŒã¡"': '"warning": "æ…é‡ã™ãã¦è¡Œå‹•ãŒé…ã‚ŒãŒã¡ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹"',
      '"whatHappens": "å®Œå…¨ã«å¼•ãã“ã‚‚ã‚‹"': '"whatHappens": "å¤–ç•Œã‹ã‚‰å®Œå…¨ã«èº«ã‚’å¼•ã„ã¦å†…çœã™ã‚‹"'
    };
    
    // ä¸€æ‹¬ç½®æ›
    let fixedContent = content;
    Object.entries(corrections).forEach(([old, newText]) => {
      const regex = new RegExp(old.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
      fixedContent = fixedContent.replace(regex, newText);
    });
    
    // ã‚ˆã‚Šè‡ªç„¶ãªè¡¨ç¾ã¸ã®ä¸€æ‹¬ä¿®æ­£
    fixedContent = fixedContent
      // æ”»æ’ƒçš„ãªè¡¨ç¾ã‚’é˜²å¾¡çš„ãªè¡¨ç¾ã«
      .replace(/æ”»æ’ƒ/g, 'æ‰¹åˆ¤')
      .replace(/æ•µã‚’/g, 'å›°é›£ã‚’')
      .replace(/åæ’ƒ/g, 'å¯¾å¿œ')
      .replace(/é›·æ’ƒ/g, 'å¼·ã„åå¿œ')
      .replace(/æ”¾é›»/g, 'ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¾å‡º')
      .replace(/æš´ç™º/g, 'è¡å‹•çš„ãªè¡Œå‹•')
      .replace(/é›»æ’ƒ/g, 'ç¬ç™ºçš„')
      .replace(/çˆ†ç™ºçš„ãª/g, 'éå¸¸ã«å¼·ã„')
      .replace(/ç ´å£Šçš„ãª/g, 'æ¿€ã—ã„')
      .replace(/å…¨ã¦ã‚’ç‡ƒã‚„ã—å°½ãã™/g, 'æ„Ÿæƒ…ã‚’å®Œå…¨ã«å‡ºã—åˆ‡ã‚‹')
      .replace(/è§¦ã‚ŒãŸã‚‰æ„Ÿé›»/g, 'å¼·ã„é˜²å¾¡åå¿œã‚’ç¤ºã™')
      .replace(/é›·ã§åæ’ƒ/g, 'ç¬ç™ºçš„ã«å¯¾å¿œ');
    
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    await writeFile(`./public/js/data/hexagram-human-traits-v3.backup.${timestamp}.js`, content);
    
    // ä¿®æ­£ç‰ˆã‚’ä¿å­˜
    await writeFile('./public/js/data/hexagram-human-traits-v3-fixed.js', fixedContent);
    
    console.log('âœ… V3ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸é©åˆ‡ãªè¡¨ç¾ã‚’ä¿®æ­£ã—ã¾ã—ãŸ');
    console.log(`ğŸ“ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: hexagram-human-traits-v3.backup.${timestamp}.js`);
    console.log('ğŸ“ ä¿®æ­£ç‰ˆ: hexagram-human-traits-v3-fixed.js');
    
    // ä¿®æ­£ç®‡æ‰€ã®çµ±è¨ˆ
    let changeCount = 0;
    Object.keys(corrections).forEach(old => {
      const regex = new RegExp(old.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
      const matches = content.match(regex);
      if (matches) changeCount += matches.length;
    });
    
    console.log(`\nğŸ“Š ä¿®æ­£çµ±è¨ˆ:`);
    console.log(`   - ç›´æ¥ä¿®æ­£: ${Object.keys(corrections).length}ç®‡æ‰€`);
    console.log(`   - å®Ÿéš›ã®å¤‰æ›´: ${changeCount}ç®‡æ‰€ä»¥ä¸Š`);
    
  } catch (error) {
    console.error('ã‚¨ãƒ©ãƒ¼:', error);
  }
}

fixInappropriateContent();