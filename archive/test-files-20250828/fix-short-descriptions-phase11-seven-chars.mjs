import { readFile, writeFile } from 'fs/promises';

async function fixPhase11SevenChars() {
  try {
    console.log('=== ãƒ•ã‚§ãƒ¼ã‚º11: 7æ–‡å­—ã®èª¬æ˜94ä»¶ã‚’ä¸€è¡Œä¸€è¡Œä¿®æ­£ ===\n');
    
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿
    let content = await readFile('./public/js/data/hexagram-human-traits-v3.js', 'utf-8');
    
    // 7æ–‡å­—ã®èª¬æ˜ã‚’ä¸€è¡Œä¸€è¡Œä¸å¯§ã«ä¿®æ­£ï¼ˆ94ä»¶ï¼‰
    const sevenCharFixes = {
      // ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»æ´»å‹•ç³»
      '"ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¸©å­˜"': '"ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ¸©å­˜ã—ã¦å‚™ãˆã‚‹"',
      '"åŠ›ã‚’è“„ãˆã‚‹æ™‚é–“"': '"åŠ›ã‚’è“„ãˆã‚‹å¤§åˆ‡ãªæ™‚é–“"',
      '"å‰µé€ ã®æº–å‚™æœŸé–“"': '"å‰µé€ ã®ãŸã‚ã®æº–å‚™æœŸé–“"',
      '"å†…çœã¨é–¢ä¿‚æ•´ç†"': '"å†…çœã—ã¦é–¢ä¿‚ã‚’æ•´ç†ã™ã‚‹æ™‚é–“"',
      
      // å ´æ‰€ãƒ»ç’°å¢ƒç³»
      '"ãã®å ´ã‚’é›¢ã‚Œã‚‹"': '"ãã®å ´ã‚’é›¢ã‚Œã¦è·é›¢ã‚’ç½®ã"',
      '"ã«ãã‚„ã‹ãªç’°å¢ƒ"': '"ã«ãã‚„ã‹ã§æ´»æ°—ã®ã‚ã‚‹ç’°å¢ƒ"',
      '"å¤‰åŒ–ã®ã‚ã‚‹ç’°å¢ƒ"': '"å¤‰åŒ–ã«å¯Œã‚“ã åˆºæ¿€çš„ãªç’°å¢ƒ"',
      '"å¤‰åŒ–ã®ãªã„ç’°å¢ƒ"': '"å¤‰åŒ–ã®å°‘ãªã„å®‰å®šã—ãŸç’°å¢ƒ"',
      '"å®‰å¿ƒã§ãã‚‹å ´æ‰€"': '"å¿ƒã‹ã‚‰å®‰å¿ƒã§ãã‚‹å ´æ‰€"',
      '"å®Œæˆã§ãã‚‹ç’°å¢ƒ"': '"ç‰©äº‹ã‚’å®Œæˆã§ãã‚‹ç’°å¢ƒ"',
      '"å‰µä½œã§ãã‚‹ç’°å¢ƒ"': '"è‡ªç”±ã«å‰µä½œã§ãã‚‹ç’°å¢ƒ"',
      
      // äººé–“é–¢ä¿‚ç³»
      '"ãŸãã•ã‚“ã®ä»²é–“"': '"ãŸãã•ã‚“ã®ä»²é–“ã«å›²ã¾ã‚Œã‚‹"',
      '"ä¸ãˆã¦ãã‚Œã‚‹äºº"': '"æƒœã—ã¿ãªãä¸ãˆã¦ãã‚Œã‚‹äºº"',
      '"å…±ã«é ‘å¼µã‚‹ä»²é–“"': '"å…±ã«é ‘å¼µã‚Œã‚‹ä»²é–“ãŸã¡"',
      '"ã¿ã‚“ãªã¨ã®æ™‚é–“"': '"ã¿ã‚“ãªã¨éã”ã™æ¥½ã—ã„æ™‚é–“"',
      '"ä¿¡é ¼ã§ãã‚‹ç›¸æ‰‹"': '"æ·±ãä¿¡é ¼ã§ãã‚‹ç›¸æ‰‹"',
      
      // è¡Œå‹•ãƒ»å¯¾å‡¦ç³»
      '"ä½•ãŒå¿…è¦ã‹èã"': '"ä½•ãŒå¿…è¦ã‹ã‚’ä¸å¯§ã«èã"',
      '"å‰ã®æ®µéšã«æˆ»ã‚‹"': '"å‰ã®æ®µéšã«æˆ»ã£ã¦ç¢ºèªã™ã‚‹"',
      '"å•é¡Œã‹ã‚‰é€ƒã’ã‚‹"': '"å•é¡Œã‹ã‚‰é€ƒã’ã¦ã—ã¾ã„ãŒã¡"',
      '"å›°é›£ã‚’å…‹æœã™ã‚‹"': '"å›°é›£ã‚’ç€å®Ÿã«å…‹æœã™ã‚‹"',
      '"å®Œæˆã•ã›ã¦æº€è¶³"': '"ç‰©äº‹ã‚’å®Œæˆã•ã›ã¦æº€è¶³ã™ã‚‹"',
      '"ä½œå“å®Œæˆã§æº€è¶³"': '"ä½œå“ã‚’å®Œæˆã•ã›ã¦æº€è¶³ã™ã‚‹"',
      
      // ãƒªã‚¹ã‚¯ãƒ»å•é¡Œç³»
      '"ãƒªã‚¹ã‚¯ãŒå¤§ãã„"': '"ãƒªã‚¹ã‚¯ãŒå¤§ãããªã‚Šã‚„ã™ã„"',
      '"ä½•ã‚‚å®Œæˆã—ãªã„"': '"ä½•ã‚‚å®Œæˆã§ããªã„çŠ¶æ…‹"',
      '"å‘¨å›²ã‚‚å·»ãè¾¼ã‚€"': '"å‘¨å›²ã‚‚å·»ãè¾¼ã‚“ã§ã—ã¾ã†"',
      
      // èƒ½åŠ›ãƒ»å¼·ã¿ç³»
      '"ãƒŸã‚¹ã‚’é˜²ãå­˜åœ¨"': '"ãƒŸã‚¹ã‚’é˜²ãé ¼ã‚Œã‚‹å­˜åœ¨"',
      '"å ´ã‚’å’Œã¾ã›ã‚‹åŠ›"': '"å ´ã‚’å’Œã¾ã›ã‚‹ç‰¹åˆ¥ãªåŠ›"',
      
      // æ„Ÿæƒ…ãƒ»å–œã³ç³»
      '"ä¿¡é ¼ã•ã‚Œã‚‹å–œã³"': '"ä¿¡é ¼ã•ã‚Œã‚‹å¤§ããªå–œã³"',
      
      // ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç³»
      '"ä¸­é€”åŠç«¯ã€å¦¥å”"': '"ä¸­é€”åŠç«¯ã‚„å¦¥å”ãŒè‹¦æ‰‹"',
      
      // ãã®ä»–ã®å¯¾è±¡ç³»
      '"å®Œæˆã•ã›ã‚‹å¯¾è±¡"': '"å®Œæˆã•ã›ã‚‹ã¹ãå¯¾è±¡"',
      
      // æ®‹ã‚Šã®7æ–‡å­—é …ç›®ï¼ˆmetaphorä»¥å¤–ï¼‰
      '"ç¸ã‚’ç´¡ãç¹”ã‚Šæ‰‹"': '"ç¸ã‚’ç´¡ãç¹”ã‚Šæ‰‹ã®ã‚ˆã†ãªå­˜åœ¨"',
      '"ç´ å›°é›£ãªå‡ºä¼šã„"': '"ç´ æ™´ã‚‰ã—ã„å‡ºä¼šã„ã«æµã¾ã‚Œã‚‹"',
      '"æ–°ã—ã„ç¸ã§å›å¾©"': '"æ–°ã—ã„ç¸ã‚’å¾—ã¦å›å¾©ã™ã‚‹"',
      '"æ‹¡å¤§æˆé•·ã®å–œã³"': '"æ‹¡å¤§æˆé•·ã‚’å®Ÿæ„Ÿã™ã‚‹å–œã³"',
      '"é™å®šçš„ã€æ¶ˆæ¥µçš„"': '"é™å®šçš„ã§æ¶ˆæ¥µçš„ã«ãªã‚ŠãŒã¡"',
      '"ç™ºå±•çš„ãªç’°å¢ƒ"': '"ç™ºå±•çš„ã§æˆé•·ã§ãã‚‹ç’°å¢ƒ"',
      '"é©å‘½çš„ãªå¤‰åŒ–"': '"é©å‘½çš„ãªå¤‰åŒ–ã‚’èµ·ã“ã™åŠ›"',
      '"ä¿å®ˆçš„ãªå‚¾å‘"': '"ä¿å®ˆçš„ã«ãªã‚Šã‚„ã™ã„å‚¾å‘"',
      '"ç ´å£Šçš„ã«ãªã‚‹"': '"ç ´å£Šçš„ã«ãªã‚Šã™ãã‚‹å±é™º"',
      '"é©æ–°çš„ãªäººã€…"': '"é©æ–°çš„ãªç™ºæƒ³ã‚’æŒã¤äººã€…"',
      '"æ–°ã—ã„æ–¹æ³•è«–"': '"æ–°ã—ã„æ–¹æ³•è«–ã‚’é–‹ç™ºã™ã‚‹"',
      '"çŸ¥è­˜ã®ä½“ç³»åŒ–"': '"çŸ¥è­˜ã‚’ä½“ç³»çš„ã«æ•´ç†ã™ã‚‹"',
      '"è«–ç†çš„ã€æ•™è‚²çš„"': '"è«–ç†çš„ã§æ•™è‚²çš„ãªè©±ã—æ–¹"',
      '"ç†è«–æ´¾ã®äººã€…"': '"ç†è«–ã‚’é‡è¦–ã™ã‚‹äººã€…"',
      '"å®Ÿè·µåŠ›ã«æ¬ ã‘ã‚‹"': '"å®Ÿè·µåŠ›ã«æ¬ ã‘ã‚‹å‚¾å‘ãŒã‚ã‚‹"',
      '"çŸ¥çš„ãªåˆºæ¿€"': '"çŸ¥çš„ãªåˆºæ¿€ã‚’å—ã‘ã‚‹ç’°å¢ƒ"',
      '"è±Šå¯Œãªè³‡æº"': '"è±Šå¯Œãªè³‡æºã‚’æ´»ç”¨ã™ã‚‹"',
      '"è“„ç©ã¨ç®¡ç†"': '"è³‡æºã®è“„ç©ã¨ç®¡ç†ãŒå¾—æ„"',
      '"ä½¿ã„åˆ‡ã‚Œãªã„"': '"è³‡æºã‚’ä½¿ã„åˆ‡ã‚Œãªã„å‚¾å‘"',
      '"ç®¡ç†èƒ½åŠ›ã‚ã‚‹äºº"': '"å„ªã‚ŒãŸç®¡ç†èƒ½åŠ›ã‚’æŒã¤äºº"',
      '"æ „é¤Šè£œçµ¦ã®å–œã³"': '"æ „é¤Šã‚’è£œçµ¦ã™ã‚‹å–œã³"',
      '"ä¸–è©±ç„¼ãã€ãŠç¯€ä»‹"': '"ä¸–è©±ç„¼ãã‚„ãŠç¯€ä»‹ãŒè‹¦æ‰‹"',
      '"ä¸ãˆã‚‹å´ã®äººã€…"': '"ä¸ãˆã‚‹å´ã«ç«‹ã¤äººã€…"',
      '"éé£Ÿã®å‚¾å‘"': '"éé£Ÿã«ãªã‚Šã‚„ã™ã„å‚¾å‘"',
      '"æ „é¤Šè±Šå¯Œãªç’°å¢ƒ"': '"æ „é¤Šè±Šå¯Œã§å¥åº·çš„ãªç’°å¢ƒ"',
      '"å…±æ„Ÿã¨åŒèª¿"': '"æ·±ã„å…±æ„Ÿã¨åŒèª¿ã‚’ç¤ºã™"',
      '"æ„Ÿè¦šçš„ã§ç›´æ„Ÿçš„"': '"æ„Ÿè¦šçš„ã§ç›´æ„Ÿçš„ãªè©±ã—æ–¹"',
      '"æ„Ÿå—æ€§ã®é«˜ã„äººã€…"': '"æ„Ÿå—æ€§ã®é«˜ã„ç¹Šç´°ãªäººã€…"',
      '"è«–ç†æ€§ã«æ¬ ã‘ã‚‹"': '"è«–ç†æ€§ã«æ¬ ã‘ã‚‹å‚¾å‘ãŒã‚ã‚‹"',
      '"ç€å®Ÿãªå‰é€²"': '"ç€å®Ÿã«å‰é€²ã—ç¶šã‘ã‚‹åŠ›"',
      '"é•·æœŸçš„ã€æ®µéšçš„"': '"é•·æœŸçš„ã§æ®µéšçš„ãªè¨ˆç”»ãŒè‹¦æ‰‹"',
      '"ç¶™ç¶šåŠ›ã®ã‚ã‚‹äººã€…"': '"ç¶™ç¶šåŠ›ã‚’æŒã¤äººã€…"',
      '"å³åŠ¹æ€§ã‚’æ±‚ã‚ã‚‹"': '"å³åŠ¹æ€§ã‚’æ±‚ã‚ã™ãã‚‹å‚¾å‘"',
      '"å®‰å®šæˆé•·ã®ç’°å¢ƒ"': '"å®‰å®šçš„ã«æˆé•·ã§ãã‚‹ç’°å¢ƒ"',
      '"çªç ´ã¨ç ´å£Š"': '"çªç ´ã¨ç ´å£Šã‚’åŒæ™‚ã«è¡Œã†"',
      '"æ”»æ’ƒçš„ã€ç ´å£Šçš„"': '"æ”»æ’ƒçš„ã§ç ´å£Šçš„ãªé¢ãŒå‡ºã‚„ã™ã„"',
      '"å¼·çƒˆãªå€‹æ€§ã®äººã€…"': '"å¼·çƒˆãªå€‹æ€§ã‚’æŒã¤äººã€…"',
      '"å‘¨å›²ã¨ã®è¡çª"': '"å‘¨å›²ã¨è¡çªã—ã‚„ã™ã„"',
      '"è‡ªç”±ãªè¡¨ç¾ã®å ´"': '"è‡ªç”±ã«è¡¨ç¾ã§ãã‚‹å ´æ‰€"',
      '"éå»ã®å†ç¾"': '"éå»ã‚’å†ç¾ã—ã‚ˆã†ã¨ã™ã‚‹"',
      '"æ‡å¤çš„ã€ä¿å®ˆçš„"': '"æ‡å¤çš„ã§ä¿å®ˆçš„ãªè©±ã—æ–¹"',
      '"æ­´å²ã‚’é‡ã‚“ã˜ã‚‹äºº"': '"æ­´å²ã‚’é‡ã‚“ã˜ã‚‹äººã€…"',
      '"å‰é€²ã§ããªã„"': '"å‰ã«é€²ã‚ãªã„çŠ¶æ…‹ã«ãªã‚‹"',
      '"ä½ç½®ã®æœ€é©åŒ–"': '"ä½ç½®ã‚’æœ€é©åŒ–ã™ã‚‹èƒ½åŠ›"',
      '"ç©ºé–“çš„ã€é…ç½®çš„"': '"ç©ºé–“çš„ã§é…ç½®ã‚’é‡è¦–ã™ã‚‹è©±ã—æ–¹"',
      '"æ•´ç†æ•´é “ã®é”äºº"': '"æ•´ç†æ•´é “ãŒå¾—æ„ãªäºº"',
      '"æ··ä¹±ã—ã‚„ã™ã„"': '"çŠ¶æ³ãŒæ··ä¹±ã—ã‚„ã™ã„"',
      '"æ•´ç„¶ã¨ã—ãŸç’°å¢ƒ"': '"æ•´ç„¶ã¨æ•´ç†ã•ã‚ŒãŸç’°å¢ƒ"',
      '"å†…ãªã‚‹å……å®Ÿ"': '"å†…ãªã‚‹å……å®Ÿæ„Ÿã‚’å¾—ã‚‹"',
      '"æ§ãˆã‚ã§è¬™è™š"': '"æ§ãˆã‚ã§è¬™è™šãªè©±ã—æ–¹"',
      '"å†…é¢é‡è¦–ã®äººã€…"': '"å†…é¢ã‚’é‡è¦–ã™ã‚‹äººã€…"',
      '"ã‚¢ãƒ”ãƒ¼ãƒ«ä¸è¶³"': '"è‡ªå·±ã‚¢ãƒ”ãƒ¼ãƒ«ãŒä¸è¶³ã—ãŒã¡"',
      '"å€‹æ€§ã®ç™ºæ®"': '"å€‹æ€§ã‚’å­˜åˆ†ã«ç™ºæ®ã™ã‚‹"',
      '"ç‹¬ç‰¹ã§å€‹æ€§çš„"': '"ç‹¬ç‰¹ã§å€‹æ€§çš„ãªè©±ã—æ–¹"',
      '"å¤‰ã‚ã‚Šè€…ã®é›†ã¾ã‚Š"': '"å€‹æ€§çš„ãªå¤‰ã‚ã‚Šè€…ã®é›†ã¾ã‚Š"',
      '"æµ®ã„ã¦ã—ã¾ã†"': '"å‘¨ã‚Šã‹ã‚‰æµ®ã„ã¦ã—ã¾ã„ã‚„ã™ã„"',
      '"ç•°è³ªãªçµ±åˆ"': '"ç•°è³ªãªã‚‚ã®ã‚’çµ±åˆã™ã‚‹åŠ›"',
      '"å¯¾æ¯”çš„ã€å¯¾ç…§çš„"': '"å¯¾æ¯”çš„ã§å¯¾ç…§çš„ãªè©±ã—æ–¹"',
      '"é•ã„ã‚’èªã‚ã‚‹äººã€…"': '"é•ã„ã‚’èªã‚åˆãˆã‚‹äººã€…"',
      '"ã¾ã¨ã¾ã‚‰ãªã„"': '"æ„è¦‹ãŒã¾ã¨ã¾ã‚‰ãªã„å‚¾å‘"'
    };
    
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    await writeFile(`./public/js/data/hexagram-human-traits-v3.backup.phase11.${timestamp}.js`, content);
    console.log(`ğŸ“ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ: hexagram-human-traits-v3.backup.phase11.${timestamp}.js\n`);
    
    // ä¿®æ­£é©ç”¨
    let totalFixCount = 0;
    let successfulFixes = [];
    
    console.log('7æ–‡å­—ã®ä¿®æ­£ã‚’é©ç”¨ä¸­...\n');
    
    Object.entries(sevenCharFixes).forEach(([old, newText]) => {
      const regex = new RegExp(old.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
      const matches = content.match(regex);
      if (matches) {
        content = content.replace(regex, newText);
        totalFixCount += matches.length;
        successfulFixes.push(`${old} â†’ ${newText} (${matches.length}ç®‡æ‰€)`);
      }
    });
    
    // æˆåŠŸã—ãŸä¿®æ­£ã‚’è¡¨ç¤ºï¼ˆæœ€åˆã®20ä»¶ï¼‰
    console.log('ã€ä¿®æ­£æˆåŠŸé …ç›®ã€‘');
    successfulFixes.slice(0, 20).forEach(fix => {
      console.log(`âœ… ${fix}`);
    });
    if (successfulFixes.length > 20) {
      console.log(`... ä»– ${successfulFixes.length - 20}ä»¶`);
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
    await writeFile('./public/js/data/hexagram-human-traits-v3.js', content);
    
    console.log(`\n=== ãƒ•ã‚§ãƒ¼ã‚º11å®Œäº† ===`);
    console.log(`ç·ä¿®æ­£ä»¶æ•°: ${totalFixCount}ä»¶`);
    console.log(`ä¿®æ­£æˆåŠŸé …ç›®: ${successfulFixes.length}ç¨®é¡`);
    console.log(`\næ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚º: node fix-short-descriptions-phase12-eight-chars.mjs`);
    
  } catch (error) {
    console.error('ã‚¨ãƒ©ãƒ¼:', error);
  }
}

fixPhase11SevenChars();