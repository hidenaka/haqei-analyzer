<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç¾åœ¨ã®5çˆ»é¸æŠç‡æ¸¬å®š</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .success { color: #4ec9b0; }
        .warning { color: #dcdcaa; }
        .error { color: #f48771; }
        pre {
            background: #252526;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #3e3e42;
        }
    </style>
</head>
<body>
    <h1>ğŸ“Š ç¾åœ¨ã®5çˆ»é¸æŠç‡æ¸¬å®šï¼ˆC-3ï¼‰</h1>
    <div id="status">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</div>
    <div id="results"></div>

    <script type="module">
        import { TextTo384LinesBridge } from './public/js/ai/TextTo384LinesBridge.js';
        
        async function measureCurrent5Yao() {
            const statusEl = document.getElementById('status');
            const resultsEl = document.getElementById('results');
            
            try {
                statusEl.innerHTML = 'åˆæœŸåŒ–ä¸­...';
                const bridge = new TextTo384LinesBridge();
                await bridge.initialize();
                
                // ãƒ†ã‚¹ãƒˆã‚µãƒ³ãƒ—ãƒ«ï¼ˆ5çˆ»ãŒé¸ã°ã‚Œã‚„ã™ãã†ãªã‚‚ã®ï¼‰
                const samples = [
                    "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã™ã‚‹",
                    "æ±ºæ–­ã‚’ä¸‹ã™æ™‚ãŒæ¥ãŸ",
                    "æœ€é«˜ã®æˆæœã‚’ç›®æŒ‡ã™",
                    "æˆç†Ÿã—ãŸåˆ¤æ–­åŠ›",
                    "çµ±ç‡åŠ›ã‚’ç¤ºã™",
                    "æŒ‡å°è€…ã¨ã—ã¦è¡Œå‹•",
                    "æœ€çµ‚æ±ºå®šã‚’è¡Œã†",
                    "æ¨©å¨ã‚ã‚‹ç«‹å ´",
                    "é ‚ç‚¹ã«ç«‹ã¤",
                    "å®Œç’§ã‚’è¿½æ±‚ã™ã‚‹"
                ];
                
                // 100å›ãƒ†ã‚¹ãƒˆï¼ˆå„ã‚µãƒ³ãƒ—ãƒ«10å›ï¼‰
                const positionCount = [0, 0, 0, 0, 0, 0, 0];
                let total = 0;
                
                for (const text of samples) {
                    for (let i = 0; i < 10; i++) {
                        const result = await bridge.analyzeText(`${text}${i}`);
                        const position = result.line_position;
                        
                        if (position <= 6) {
                            positionCount[position - 1]++;
                        } else {
                            positionCount[6]++; // ç”¨ä¹ãƒ»ç”¨å…­
                        }
                        total++;
                    }
                }
                
                // çµæœè¡¨ç¤º
                let html = '<h2>æ¸¬å®šçµæœï¼ˆ100ã‚µãƒ³ãƒ—ãƒ«ï¼‰</h2>';
                html += '<pre>';
                
                positionCount.slice(0, 6).forEach((count, idx) => {
                    const percentage = (count / total * 100).toFixed(1);
                    const bar = 'â–ˆ'.repeat(Math.round(percentage / 2));
                    const colorClass = idx === 4 ? (percentage >= 10 ? 'success' : 'error') : '';
                    html += `${idx + 1}çˆ»: ${count}å€‹ (${percentage}%) <span class="${colorClass}">${bar}</span>\n`;
                });
                
                const line5Percentage = (positionCount[4] / total * 100).toFixed(1);
                html += '\n';
                html += `<span class="${line5Percentage >= 10 ? 'success' : 'error'}">`;
                html += `5çˆ»é¸æŠç‡: ${line5Percentage}%`;
                html += line5Percentage >= 10 ? ' âœ… ç›®æ¨™é”æˆ' : ' âŒ è¦æ”¹å–„';
                html += '</span>';
                
                html += '</pre>';
                
                resultsEl.innerHTML = html;
                statusEl.innerHTML = '<span class="success">æ¸¬å®šå®Œäº†</span>';
                
            } catch (error) {
                statusEl.innerHTML = `<span class="error">ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                console.error(error);
            }
        }
        
        measureCurrent5Yao();
    </script>
</body>
</html>