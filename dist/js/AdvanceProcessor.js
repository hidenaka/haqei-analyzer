export class AdvanceProcessor{constructor(){this.philosophy={definition:"同一卦内での成熟・発展段階の進行",interpretation:"現在の状況が質的に変化せず、段階的に深化する過程",limitation:"第6爻に達した場合、それ以上の進爻は不可"},this.stageNames={1:"萌芽期",2:"基礎形成期",3:"実行開始期",4:"展開期",5:"成熟期",6:"完成期"},this.ichingStageNames={1:"潜龍（始まりの兆し）",2:"見龍（表面化の始まり）",3:"君子（実行の段階）",4:"躍龍（飛躍への準備）",5:"飛龍（最高の位置）",6:"亢龍（極みと転換）"}}canAdvance(e){return e>=1&&e<6}generateAdvanceChain(e,t,a){const i=[];let n=t;for(let s=0;s<a;s++){if(!this.canAdvance(n)){console.log(`Line ${n} is the top line. Advance stops.`);break}const t=n+1;i.push({type:"advance",from:{hex:e,line:n,stage:this.getStageName(n)},to:{hex:e,line:t,stage:this.getStageName(t)},description:this.generateAdvanceDescription(e,n,t),philosophy:"段階的成熟",keywords:[this.getStageName(n),this.getStageName(t),"発展","成熟"]}),n=t}return i}getStageName(e,t=!1){return t?this.ichingStageNames[e]||`第${e}爻`:this.stageNames[e]||`第${e}段階`}generateAdvanceDescription(e,t,a){const i=this.getStageName(t),n=this.getStageName(a),s=this.getStageName(t,!0),g=this.getStageName(a,!0),o=this.getLineData(e,t),r=this.getLineData(e,a);return o&&r?`${o.stage}から${r.stage}へと発展。${o.keyword}の段階を経て、${r.keyword}へと成熟します。`:`${i}から${n}へと発展。${s}の段階から${g}へと成熟していきます。`}getLineData(e,t){if("undefined"!=typeof window&&window.H384_DATA){const a=window.H384_DATA.find(a=>a["卦番号"]===e&&a["爻位"]===t);if(a)return{stage:this.getStageName(t),keyword:a["キーワード"]||`第${t}爻`,description:a["現代解釈の要約"]||"変化の段階"}}return{stage:this.getStageName(t),keyword:this.getDefaultKeyword(t),description:this.getDefaultDescription(t)}}getDefaultKeyword(e){return{1:"始動",2:"蓄積",3:"行動",4:"展開",5:"統合",6:"完成"}[e]||"変化"}getDefaultDescription(e){return{1:"物事の始まりの段階。潜在的な可能性が芽生える",2:"基礎を固める段階。内的な力を蓄える",3:"外に向かって行動を起こす段階。初めての試み",4:"本格的な展開の段階。外部との相互作用",5:"成熟と統合の段階。最高の位置での調和",6:"完成と新たな転換の段階。極みからの変化"}[e]||"変化と発展の段階"}evaluateAdvancePotential(e,t){const a=this.canAdvance(t),i=a?6-t:0;return{possible:a,currentStage:this.getStageName(t),remainingSteps:i,nextStage:a?this.getStageName(t+1):null,recommendation:this.getAdvanceRecommendation(t)}}getAdvanceRecommendation(e){return 6===e?"既に完成期にあります。新たな始まりを考える時期です。":5===e?"成熟期にあります。完成に向けて最後の調整を行いましょう。":e>=3?"実行・展開期にあります。着実に前進を続けましょう。":"基礎段階にあります。しっかりと土台を築きましょう。"}}