class EvidencePanel{constructor(){this.panelElement=null,this.isVisible=!1,this.currentEvidence=null,this.initializePanel(),console.log("ğŸ“‹ EvidencePanel initialized - æ ¹æ‹ è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ èµ·å‹•")}initializePanel(){const e=document.getElementById("evidence-panel");e&&e.remove(),this.panelElement=document.createElement("div"),this.panelElement.id="evidence-panel",this.panelElement.className="evidence-panel",this.panelElement.innerHTML=this.getPanelHTML(),this.applyStyles(),document.body.appendChild(this.panelElement),this.setupEventListeners(),this.hide()}getPanelHTML(){return'\n            <div class="evidence-panel-header">\n                <h3>ğŸ” æ ¹æ‹ ãƒ»é€æ˜æ€§æƒ…å ±</h3>\n                <button class="evidence-close-btn" title="ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹">Ã—</button>\n            </div>\n            <div class="evidence-panel-content">\n                <div class="evidence-section">\n                    <h4>ğŸ“– æ˜“çµŒçš„æ ¹æ‹ </h4>\n                    <div id="hexagram-info">\n                        <div class="evidence-item">\n                            <span class="evidence-label">æœ¬å¦:</span>\n                            <span id="main-hexagram">æœªè¨­å®š</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">å¤‰çˆ»:</span>\n                            <span id="changing-lines">æœªè¨­å®š</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">ä¹‹å¦:</span>\n                            <span id="derived-hexagram">æœªè¨­å®š</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">å‡ºå…¸:</span>\n                            <span id="source-citation">æœªè¨­å®š</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="evidence-section">\n                    <h4>âš ï¸ ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯æ³¨è¨˜</h4>\n                    <div id="heuristic-note">\n                        <div class="evidence-warning">\n                            <strong>é€²çˆ»ã«ã¤ã„ã¦:</strong><br>\n                            ã€Œé€²çˆ»ã€ã¯æ˜“çµŒã®æ­£å…¸ã«ãªã„å½“ã‚·ã‚¹ãƒ†ãƒ ç‹¬è‡ªã®ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯æ‰‹æ³•ã§ã™ã€‚\n                            çˆ»ä½ã®æ®µéšçš„é€²è¡Œã«ã‚ˆã‚‹è§£é‡ˆã‚’æä¾›ã—ã¦ã„ã¾ã™ãŒã€å¤å…¸çš„æ˜“çµŒã¨ã¯ç•°ãªã‚‹\n                            ç¾ä»£çš„è§£é‡ˆã§ã‚ã‚‹ã“ã¨ã‚’ã”ç†è§£ãã ã•ã„ã€‚\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="evidence-section">\n                    <h4>ğŸ”„ å‡¦ç†ãƒ¬ãƒ™ãƒ«æƒ…å ±</h4>\n                    <div id="processing-info">\n                        <div class="evidence-item">\n                            <span class="evidence-label">Fallbackãƒ¬ãƒ™ãƒ«:</span>\n                            <span id="fallback-level" class="fallback-full">Full</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">ä¿¡é ¼åº¦:</span>\n                            <span id="confidence-level">é«˜</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="evidence-section">\n                    <h4>ğŸ¯ HaQeiå“²å­¦æ•´åˆæ€§</h4>\n                    <div id="haqei-alignment">\n                        <div class="evidence-item">\n                            <span class="evidence-label">ä¸»ä½“æ€§:</span>\n                            <span id="agency-note">ã‚ãªãŸã®é¸æŠãƒ»åˆ¤æ–­ã‚’æ”¯æ´</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">éæ±ºå®šè«–:</span>\n                            <span id="non-deterministic-note">æœ€çµ‚åˆ¤æ–­ã¯å¸¸ã«ã‚ãªãŸãŒè¡Œã„ã¾ã™</span>\n                        </div>\n                        <div class="evidence-item">\n                            <span class="evidence-label">çŸ›ç›¾å—å®¹:</span>\n                            <span id="contradiction-note">è¤‡æ•°ã®é“ãŒåŒæ™‚ã«æœ‰åŠ¹ã§ã™</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '}applyStyles(){const e=document.createElement("style");e.textContent="\n            .evidence-panel {\n                position: fixed;\n                top: 20px;\n                right: 20px;\n                width: 400px;\n                max-height: 80vh;\n                background: #1e293b;\n                border: 1px solid #334155;\n                border-radius: 8px;\n                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);\n                z-index: 1000;\n                font-family: 'Inter', 'Noto Sans JP', sans-serif;\n                color: #ffffff;\n                overflow-y: auto;\n                opacity: 0;\n                transform: translateX(100%);\n                transition: all 0.3s ease;\n            }\n            \n            .evidence-panel.visible {\n                opacity: 1;\n                transform: translateX(0);\n            }\n            \n            .evidence-panel-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 16px 20px;\n                background: #2563eb;\n                border-radius: 8px 8px 0 0;\n                border-bottom: 1px solid #3b82f6;\n            }\n            \n            .evidence-panel-header h3 {\n                margin: 0;\n                font-size: 16px;\n                font-weight: 600;\n            }\n            \n            .evidence-close-btn {\n                background: none;\n                border: none;\n                color: #ffffff;\n                font-size: 18px;\n                cursor: pointer;\n                padding: 4px 8px;\n                border-radius: 4px;\n                transition: background 0.2s;\n            }\n            \n            .evidence-close-btn:hover {\n                background: rgba(255, 255, 255, 0.1);\n            }\n            \n            .evidence-panel-content {\n                padding: 20px;\n            }\n            \n            .evidence-section {\n                margin-bottom: 24px;\n            }\n            \n            .evidence-section:last-child {\n                margin-bottom: 0;\n            }\n            \n            .evidence-section h4 {\n                margin: 0 0 12px 0;\n                font-size: 14px;\n                font-weight: 600;\n                color: #60a5fa;\n                border-bottom: 1px solid #374151;\n                padding-bottom: 6px;\n            }\n            \n            .evidence-item {\n                display: flex;\n                margin-bottom: 8px;\n                align-items: flex-start;\n            }\n            \n            .evidence-label {\n                font-weight: 500;\n                color: #94a3b8;\n                min-width: 80px;\n                margin-right: 8px;\n                font-size: 13px;\n            }\n            \n            .evidence-item span:not(.evidence-label) {\n                color: #e2e8f0;\n                font-size: 13px;\n                line-height: 1.4;\n            }\n            \n            .evidence-warning {\n                background: #451a03;\n                border: 1px solid #92400e;\n                border-radius: 4px;\n                padding: 12px;\n                font-size: 12px;\n                line-height: 1.4;\n                color: #fed7aa;\n            }\n            \n            .fallback-full { color: #10b981; }\n            .fallback-partial { color: #f59e0b; }\n            .fallback-minimal { color: #ef4444; }\n            .fallback-emergency { color: #dc2626; font-weight: bold; }\n            \n            /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */\n            @media (max-width: 640px) {\n                .evidence-panel {\n                    width: 90vw;\n                    right: 5vw;\n                    max-height: 70vh;\n                }\n            }\n        ",document.head.appendChild(e)}setupEventListeners(){this.panelElement.querySelector(".evidence-close-btn").addEventListener("click",()=>this.hide()),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isVisible&&this.hide()})}displayHexagramInfo(e){const n=this.panelElement.querySelector("#main-hexagram"),i=this.panelElement.querySelector("#changing-lines"),t=this.panelElement.querySelector("#derived-hexagram"),a=this.panelElement.querySelector("#source-citation");n.textContent=e.mainHexagram||"æœªè¨­å®š",i.textContent=e.changingLines||"æœªè¨­å®š",t.textContent=e.derivedHexagram||"æœªè¨­å®š",a.textContent=e.citation||"ã‚·ã‚¹ãƒ†ãƒ ç”Ÿæˆ",console.log("ğŸ“– å¦æƒ…å ±è¡¨ç¤ºæ›´æ–°:",e)}displayChangingLines(e){const n=this.panelElement.querySelector("#changing-lines");e&&e.length>0?n.textContent=e.join("ã€")+"çˆ»":n.textContent="ãªã—"}displayHeuristicNote(e){if(e){const n=this.panelElement.querySelector("#heuristic-note .evidence-warning");let i=e;(e.includes("é€²çˆ»")||e.includes("advance")||e.includes("é€²ã‚€"))&&(i=`<strong>âš ï¸ é€²çˆ»ã«ã¤ã„ã¦:</strong><br>\n                é€²çˆ»ã¯å¤å…¸æ˜“çµŒã«ãªã„å½“ã‚·ã‚¹ãƒ†ãƒ ç‹¬è‡ªã®åˆ†ææ‰‹æ³•ã§ã™ã€‚<br>\n                å¾“æ¥ã®å¤‰çˆ»ï¼ˆé™°é™½åè»¢ï¼‰ã¨ã¯ç•°ãªã‚Šã€ç¾åœ¨ã®çˆ»ä½ã‹ã‚‰æ¬¡ã®æ®µéšã¸é€²ã‚€å‹•çš„è§£é‡ˆã‚’æä¾›ã—ã¾ã™ã€‚<br><br>\n                <strong>æ‰‹æ³•ã®æ ¹æ‹ :</strong> HaQeiå“²å­¦ã®ã€Œéæ±ºå®šè«–çš„é¸æŠè‚¢æç¤ºã€ã«åŸºã¥ã<br>\n                <strong>é™ç•Œ:</strong> å¤å…¸çš„æ˜“çµŒè§£é‡ˆã¨ã¯ç•°ãªã‚‹ç¾ä»£çš„é©å¿œ<br>\n                <strong>ä»£æ›¿è§£é‡ˆ:</strong> ä¼çµ±çš„ãªå¤‰çˆ»è§£é‡ˆã‚‚å‚è€ƒã«ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨<br><br>\n                <strong>åˆ†æå†…å®¹:</strong><br>${e}`),n.innerHTML=i}}displayFallbackLevel(e){const n=this.panelElement.querySelector("#fallback-level"),i=this.panelElement.querySelector("#confidence-level");switch(n.className="",e){case"full":n.className="fallback-full",n.textContent="Fullï¼ˆå®Œå…¨ãƒ‡ãƒ¼ã‚¿ï¼‰",i.textContent="é«˜";break;case"partial":n.className="fallback-partial",n.textContent="Partialï¼ˆéƒ¨åˆ†ãƒ‡ãƒ¼ã‚¿ï¼‰",i.textContent="ä¸­";break;case"minimal":n.className="fallback-minimal",n.textContent="Minimalï¼ˆæœ€å°ãƒ‡ãƒ¼ã‚¿ï¼‰",i.textContent="ä½";break;case"emergency":n.className="fallback-emergency",n.textContent="Emergencyï¼ˆç·Šæ€¥ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",i.textContent="è¦æ³¨æ„";break;default:n.textContent=e||"æœªè¨­å®š",i.textContent="ä¸æ˜"}console.log("ğŸ”„ Fallbackãƒ¬ãƒ™ãƒ«è¡¨ç¤ºæ›´æ–°:",e)}show(){this.panelElement.classList.add("visible"),this.isVisible=!0,console.log("ğŸ‘ï¸ æ ¹æ‹ ãƒ‘ãƒãƒ«è¡¨ç¤º")}hide(){this.panelElement.classList.remove("visible"),this.isVisible=!1,console.log("ğŸ‘ï¸ æ ¹æ‹ ãƒ‘ãƒãƒ«éè¡¨ç¤º")}toggle(){this.isVisible?this.hide():this.show()}updateEvidence(e){this.currentEvidence=e,e.hexagram&&this.displayHexagramInfo(e.hexagram),e.changingLines&&this.displayChangingLines(e.changingLines),e.fallbackLevel&&this.displayFallbackLevel(e.fallbackLevel),e.heuristicNote&&this.displayHeuristicNote(e.heuristicNote),console.log("ğŸ“‹ æ ¹æ‹ æƒ…å ±ä¸€æ‹¬æ›´æ–°å®Œäº†")}getSystemInfo(){return{version:"1.0.0",isVisible:this.isVisible,hasEvidence:!!this.currentEvidence,panelId:this.panelElement.id}}}"undefined"!=typeof window&&(window.EvidencePanel=EvidencePanel,console.log("ğŸ“‹ EvidencePanel registered to window object")),"undefined"!=typeof module&&module.exports&&(module.exports=EvidencePanel),console.log("ğŸ“‹ EvidencePanel.js loaded successfully - 7æ—¥é–“ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ—ãƒªãƒ³ãƒˆç”¨æ ¹æ‹ è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ ");