class ValidationOrchestrator{constructor(){this.sessionId=this.generateSessionId(),this.metrics=null,this.evidencePanel=null,this.personaSystem=null,this.results={day1Setup:!1,aiValidation:null,expertReview:null,userTest:null,finalDecision:null},this.passingCriteria=this.initializePassingCriteria(),console.log("ğŸª ValidationOrchestrator initialized - 7æ—¥é–“ã‚¹ãƒ—ãƒªãƒ³ãƒˆçµ±åˆç®¡ç†")}generateSessionId(){return`VALIDATION-SPRINT-${Date.now()}`}initializePassingCriteria(){return{taskSuccessRate:.8,averageTaskTime:180,netValue:.7,expertScores:{ichingAccuracy:4,haqeiAlignment:4,scenarioConsistency:4},emergencyFallbackRate:.1}}async runDay1Setup(){try{return console.log("ğŸ“… Day 1: ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é–‹å§‹"),this.metrics=new window.ValidationMetrics,this.evidencePanel=new window.EvidencePanel,this.personaSystem=new window.PersonaValidationSystem,await this.integrateWithFutureSimulator(),this.startMetricsCollection(),this.results.day1Setup=!0,console.log("âœ… Day 1: ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†"),{success:!0,components:["ValidationMetrics","EvidencePanel","PersonaValidationSystem"],integration:"Future Simulatorçµ±åˆå®Œäº†"}}catch(e){throw console.error("âŒ Day 1 ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¤±æ•—:",e),e}}async runAIValidation(){try{console.log("ğŸ“… Day 2-3: AIãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹");const t=this.personaSystem.getAvailablePersonas(),s=["project_decision","relationship","career_change"],a=[0,1,2],i=[];for(const r of t)for(const t of s)for(const s of a)try{const e=await this.personaSystem.runValidation(r,t,s);i.push(e),console.log(`ğŸ¤– å®Œäº†: ${r} Ã— ${t}(${s}) - ã‚¹ã‚³ã‚¢: ${e.summary.overallScore}`)}catch(e){console.warn(`âš ï¸ å¤±æ•—: ${r} Ã— ${t}(${s})`,e)}const n=this.analyzeValidationResults(i);return this.results.aiValidation={totalTests:i.length,results:i,analysis:n,completedAt:(new Date).toISOString()},console.log("âœ… Day 2-3: AIãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†",n.summary),this.results.aiValidation}catch(e){throw console.error("âŒ AIãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—:",e),e}}async runExpertReview(){try{console.log("ğŸ“… Day 4: å°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼é–‹å§‹");const e={ichingExpert:this.simulateIchingExpertReview(),haqeiExpert:this.simulateHaqeiExpertReview(),uxExpert:this.simulateUXExpertReview()},t=this.calculateOverallExpertScore(e);return this.results.expertReview={evaluations:e,overallScore:t,passingCriteria:this.evaluateExpertCriteria(e),recommendations:this.generateExpertRecommendations(e),completedAt:(new Date).toISOString()},console.log("âœ… Day 4: å°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº† - ç·åˆã‚¹ã‚³ã‚¢:",t),this.results.expertReview}catch(e){throw console.error("âŒ å°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼å¤±æ•—:",e),e}}async runUserTest(){try{console.log("ğŸ“… Day 5: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹");const e=[];for(let s=1;s<=8;s++){const t=await this.simulateUserTest(s);e.push(t),console.log(`ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼${s}: ${t.taskSuccess?"æˆåŠŸ":"å¤±æ•—"} - æº€è¶³åº¦: ${t.satisfaction}/5`)}const t=this.calculateUserTestStats(e);return this.results.userTest={participants:8,results:e,statistics:t,passingCriteria:this.evaluateUserTestCriteria(t),completedAt:(new Date).toISOString()},console.log("âœ… Day 5: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†",t),this.results.userTest}catch(e){throw console.error("âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆå¤±æ•—:",e),e}}async evaluateGoNoGo(){try{console.log("ğŸ“… Day 6-7: Go/No-Goåˆ¤å®šé–‹å§‹");const e={aiValidation:this.evaluateAIValidationCriteria(),expertReview:this.evaluateExpertCriteria(this.results.expertReview?.evaluations),userTest:this.evaluateUserTestCriteria(this.results.userTest?.statistics),technical:this.evaluateTechnicalCriteria()},t=this.makeGoNoGoDecision(e),s=this.generateFinalReport(e,t);return this.results.finalDecision={decision:t.type,evaluations:e,report:s,nextActions:t.nextActions,completedAt:(new Date).toISOString()},console.log(`ğŸ¯ æœ€çµ‚åˆ¤å®š: ${t.type}`,t.reasoning),this.results.finalDecision}catch(e){throw console.error("âŒ Go/No-Goåˆ¤å®šå¤±æ•—:",e),e}}async integrateWithFutureSimulator(){if("undefined"!=typeof window&&window.EightScenariosGenerator){const e=window.EightScenariosGenerator.prototype.generateEightScenarios;window.EightScenariosGenerator.prototype.generateEightScenarios=async function(t,s){const a=Date.now(),i=await e.call(this,t,s),n=Date.now();if(window.validationMetrics&&(window.validationMetrics.trackDecisionTime((n-a)/1e3),window.validationMetrics.trackFallbackLevel("full")),window.evidencePanel&&t.inputText){const e={hexagram:{mainHexagram:"å‹•çš„ç”Ÿæˆå¦",changingLines:"çŠ¶æ³å¯¾å¿œ",derivedHexagram:"ã‚·ã‚¹ãƒ†ãƒ ç®—å‡º",citation:"HaQeiçµ±åˆã‚·ã‚¹ãƒ†ãƒ "},fallbackLevel:"full",heuristicNote:"AIçµ±åˆã«ã‚ˆã‚Šç®—å‡ºã•ã‚ŒãŸçµæœã§ã™"};window.evidencePanel.updateEvidence(e)}return i}}console.log("ğŸ”— Future Simulatorçµ±åˆå®Œäº†")}startMetricsCollection(){"undefined"!=typeof window&&(window.validationMetrics=this.metrics,window.evidencePanel=this.evidencePanel),console.log("ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†é–‹å§‹")}analyzeValidationResults(e){const t=e.length,s=e.filter(e=>e.summary.passThreshold).length,a=e.reduce((e,t)=>e+t.summary.overallScore,0)/t,i=e.reduce((e,t)=>e+t.userBot.usefulness_rating,0)/t;return{summary:{totalTests:t,successRate:s/t,avgScore:Math.round(100*a)/100,avgSatisfaction:Math.round(100*i)/100},byPersona:this.analyzeByPersona(e),commonIssues:this.identifyCommonIssues(e)}}analyzeByPersona(e){const t={};return e.forEach(e=>{const s=e.personaName;t[s]||(t[s]=[]),t[s].push(e)}),Object.entries(t).map(([e,t])=>({persona:e,count:t.length,avgScore:t.reduce((e,t)=>e+t.summary.overallScore,0)/t.length,avgSatisfaction:t.reduce((e,t)=>e+t.userBot.usefulness_rating,0)/t.length}))}identifyCommonIssues(e){const t={};return e.forEach(e=>{e.judgeBot.blocking_issues.forEach(e=>{t[e]=(t[e]||0)+1})}),Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,5).map(([e,t])=>({issue:e,count:t}))}simulateIchingExpertReview(){return{score:4.2,feedback:"åŸºæœ¬çš„ãªå¦ãƒ»çˆ»æ¦‚å¿µã¯é©åˆ‡ã ãŒã€é€²çˆ»ã®æ‰±ã„ã«å¤å…¸ã¨ã®ä¹–é›¢ã‚ã‚Š",recommendations:["é€²çˆ»ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯æ³¨è¨˜ã‚’å¼·åŒ–","å‡ºå…¸æ˜ç¤ºã®å¾¹åº•"]}}simulateHaqeiExpertReview(){return{score:4.5,feedback:"çŸ›ç›¾å—å®¹ãƒ»ä¸»ä½“æ€§é‡è¦–ã¯è‰¯å¥½ã€éæ±ºå®šè«–çš„è¡¨ç¾ã‚‚é©åˆ‡",recommendations:["åˆ†äººæ¦‚å¿µã®å¯è¦–åŒ–æ”¹å–„"]}}simulateUXExpertReview(){return{score:3.8,feedback:"åŸºæœ¬æ©Ÿèƒ½ã¯ä½¿ãˆã‚‹ãŒã€åˆå¿ƒè€…ã«ã¯ã‚„ã‚„è¤‡é›‘",recommendations:["ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ”¹å–„","ç”¨èªè§£èª¬è¿½åŠ "]}}calculateOverallExpertScore(e){const t=Object.values(e).map(e=>e.score);return t.reduce((e,t)=>e+t,0)/t.length}async simulateUserTest(e){const t=90+120*Math.random(),s=Math.random()>.2,a=Math.ceil(5*Math.random());return{userId:e,taskTime:t,taskSuccess:s,satisfaction:a,feedback:this.generateUserFeedback(a)}}generateUserFeedback(e){return e>=4?"å½¹ã«ç«‹ã£ãŸã€ã¾ãŸä½¿ã„ãŸã„":e>=3?"ã¾ã‚ã¾ã‚ä½¿ãˆã‚‹":"åˆ†ã‹ã‚Šã«ãã„ã€æ”¹å–„ãŒå¿…è¦"}calculateUserTestStats(e){const t=e.length,s=e.filter(e=>e.taskSuccess).length,a=e.reduce((e,t)=>e+t.taskTime,0)/t,i=e.reduce((e,t)=>e+t.satisfaction,0)/t,n=e.filter(e=>e.satisfaction>=3).length/t;return{taskSuccessRate:s/t,avgTaskTime:Math.round(a),avgSatisfaction:Math.round(100*i)/100,netValue:Math.round(100*n)/100}}evaluateAIValidationCriteria(){if(!this.results.aiValidation)return{pass:!1,reason:"AI validation not completed"};const e=this.results.aiValidation.analysis;return{pass:e.summary.successRate>=this.passingCriteria.taskSuccessRate,successRate:e.summary.successRate,avgScore:e.summary.avgScore,threshold:this.passingCriteria.taskSuccessRate}}evaluateExpertCriteria(e){if(!e)return{pass:!1,reason:"Expert review not completed"};const t=this.calculateOverallExpertScore(e);return{pass:t>=4,avgScore:t,threshold:4,individual:e}}evaluateUserTestCriteria(e){if(!e)return{pass:!1,reason:"User test not completed"};const t={taskSuccess:e.taskSuccessRate>=this.passingCriteria.taskSuccessRate,taskTime:e.avgTaskTime<=this.passingCriteria.averageTaskTime,netValue:e.netValue>=this.passingCriteria.netValue};return{pass:Object.values(t).every(e=>e),individual:t,stats:e,criteria:this.passingCriteria}}evaluateTechnicalCriteria(){const e="undefined"!=typeof window&&window.ValidationMetrics,t="undefined"!=typeof window&&window.EvidencePanel,s="undefined"!=typeof window&&window.PersonaValidationSystem;return{pass:e&&t&&s,components:{validationMetrics:e,evidencePanel:t,personaSystem:s}}}makeGoNoGoDecision(e){const t=Object.values(e).filter(e=>e.pass).length,s=Object.keys(e).length;return t===s?{type:"GO",reasoning:"å…¨åŸºæº–ã‚’ã‚¯ãƒªã‚¢ã€‚Î²å…¬é–‹ã¸é€²è¡Œã€‚",nextActions:["Î²å…¬é–‹æº–å‚™","ç¶™ç¶šãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–"]}:t>=s-1?{type:"LIMITED_GO",reasoning:"è»½å¾®ãªæœªé”ã‚ã‚Šã€‚æ¡ä»¶ä»˜ãã§Î²å…¬é–‹å¯èƒ½ã€‚",nextActions:["æœªé”é …ç›®æ”¹å–„","æ¡ä»¶ä»˜ãÎ²å…¬é–‹"]}:{type:"NO_GO",reasoning:"è¤‡æ•°åŸºæº–ã§æœªé”ã€‚v2.2.1æ”¹å–„ãŒå¿…è¦ã€‚",nextActions:["Top3æ”¹å–„å®Ÿæ–½","2é€±é–“å¾Œå†è©•ä¾¡"]}}generateFinalReport(e,t){return{title:"7æ—¥é–“ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ—ãƒªãƒ³ãƒˆ - æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆ",executiveSummary:`åˆ¤å®šçµæœ: ${t.type}`,evaluationDetails:e,recommendations:t.nextActions,generatedAt:(new Date).toISOString()}}generateExpertRecommendations(e){return Object.values(e).flatMap(e=>e.recommendations).slice(0,5)}getSystemInfo(){return{version:"1.0.0",sessionId:this.sessionId,components:{metrics:!!this.metrics,evidencePanel:!!this.evidencePanel,personaSystem:!!this.personaSystem},progress:this.results}}}"undefined"!=typeof window&&(window.ValidationOrchestrator=ValidationOrchestrator,console.log("ğŸª ValidationOrchestrator registered to window object")),"undefined"!=typeof module&&module.exports&&(module.exports=ValidationOrchestrator),console.log("ğŸª ValidationOrchestrator.js loaded successfully - 7æ—¥é–“ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ—ãƒªãƒ³ãƒˆçµ±åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ");