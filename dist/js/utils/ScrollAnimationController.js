class ScrollAnimationController{constructor(){this.sections=[],this.animatedElements=new Set,this.countUpCallbacks=new Map,this.observerOptions={threshold:.1,rootMargin:"0px 0px -10% 0px"},"IntersectionObserver"in window?this.observer=new IntersectionObserver(this.handleIntersection.bind(this),this.observerOptions):(console.warn("Intersection Observer not supported, falling back to scroll event"),this.setupScrollFallback()),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches}observeSection(e){e&&(this.sections.push(e),this.observer&&this.observer.observe(e),this.prefersReducedMotion||(e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease-out, transform 0.6s ease-out"))}handleIntersection(e){e.forEach(e=>{e.isIntersecting&&!this.animatedElements.has(e.target)&&(this.triggerSectionAnimation(e.target),this.animatedElements.add(e.target))})}triggerSectionAnimation(e){if(this.prefersReducedMotion)return void e.classList.add("is-visible");e.style.opacity="1",e.style.transform="translateY(0)",e.classList.add("is-visible");switch(this.getSectionType(e)){case"boot-screen":this.animateBootScreen(e);break;case"core-engine":this.animateCoreEngine(e);break;case"gui-section":this.animateGUISection(e);break;case"safemode-section":this.animateSafeModeSection(e);break;case"integration-section":this.animateIntegrationSection(e)}this.animateCounters(e)}getSectionType(e){return e.classList.contains("boot-screen")?"boot-screen":e.classList.contains("core-engine-section")?"core-engine":e.classList.contains("gui-section")?"gui-section":e.classList.contains("safemode-section")?"safemode-section":e.classList.contains("integration-section")?"integration-section":"unknown"}animateBootScreen(e){const t=e.querySelector(".hexagram-svg");if(t){t.querySelectorAll(".yang-line, .yin-line").forEach((e,t)=>{setTimeout(()=>{e.style.animation="drawLine 1s ease-out forwards"},200*t)})}const n=e.querySelector(".boot-title");n&&setTimeout(()=>{n.style.animation="fadeInUp 1s ease-out forwards"},500)}animateCoreEngine(e){const t=e.querySelector("#profile-radar-chart");t&&window.Chart&&setTimeout(()=>{const e=Chart.getChart(t);e&&e.update("active")},300);const n=e.querySelector(".engine-description");n&&setTimeout(()=>{n.style.animation="fadeInRight 0.8s ease-out forwards"},600)}animateGUISection(e){this.animateDynamicsConnector(e)}animateSafeModeSection(e){this.animateDynamicsConnector(e,"tension")}animateIntegrationSection(e){e.querySelectorAll(".summary-card").forEach((e,t)=>{setTimeout(()=>{e.style.animation="fadeInUp 0.6s ease-out forwards"},200*t)})}animateDynamicsConnector(e,t="harmony"){const n=e.querySelector(".dynamics-connector"),i=e.querySelectorAll(".os-icon");n&&setTimeout(()=>{n.style.animation="tension"===t?"tensionPulse 2s ease-in-out infinite":"harmonyFlow 3s ease-in-out infinite"},400),i.forEach((e,t)=>{setTimeout(()=>{e.style.animation="bounceIn 0.6s ease-out forwards"},300*t)})}animateCounters(e){e.querySelectorAll("[data-count-to]").forEach(e=>{const t=parseInt(e.getAttribute("data-count-to")),n=parseInt(e.getAttribute("data-duration")||"2000");this.animateCounter(e,0,t,n)})}animateCounter(e,t,n,i){const s=performance.now(),updateCounter=o=>{const a=o-s,r=Math.min(a/i,1),c=1-Math.pow(1-r,4),l=Math.round(t+(n-t)*c);e.textContent=l+(e.getAttribute("data-suffix")||""),r<1&&requestAnimationFrame(updateCounter)};requestAnimationFrame(updateCounter)}setupScrollFallback(){let e=!1;const checkVisibility=()=>{this.sections.forEach(e=>{if(!this.animatedElements.has(e)){const t=e.getBoundingClientRect();t.top<.8*window.innerHeight&&t.bottom>0&&(this.triggerSectionAnimation(e),this.animatedElements.add(e))}}),e=!1};window.addEventListener("scroll",()=>{e||(requestAnimationFrame(checkVisibility),e=!0)},{passive:!0}),checkVisibility()}registerCustomAnimation(e,t){this.countUpCallbacks.set(e,t)}destroy(){this.observer&&this.observer.disconnect(),this.sections=[],this.animatedElements.clear(),this.countUpCallbacks.clear()}}"undefined"!=typeof window&&(window.ScrollAnimationController=ScrollAnimationController);