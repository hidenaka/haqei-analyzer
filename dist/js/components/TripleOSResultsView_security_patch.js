window.SecurityValidator&&window.SecureDOM||console.error("Security utilities not loaded. Please include SecurityValidator.js and SecureDOM.js"),function(){TripleOSResultsView.prototype.render;TripleOSResultsView.prototype.render=async function(){try{const e=await this.extractTripleOSData(this.analysisResult);if(!(e&&e.engineOS&&e.interfaceOS&&e.safeModeOS))return void SecureDOM.setHTML(this.container,'\n                    <div class="error-container" role="alert">\n                        <div class="error-icon">⚠️</div>\n                        <h2 class="error-title">トリプルOS分析データが不完全です</h2>\n                        <p class="error-message">エンジンOS、インターフェースOS、セーフモードOSのデータを読み込めませんでした。</p>\n                        <p class="error-advice">ページをリロードするか、分析を再実行してください。</p>\n                    </div>\n                ',{ALLOWED_TAGS:["div","h2","p"],ALLOWED_ATTR:["class","role"]});const t=this.generateMainHTML(e);SecureDOM.setHTML(this.container,t,{ALLOWED_TAGS:["div","h1","h2","h3","h4","p","span","ul","li","button","section","header","article","canvas"],ALLOWED_ATTR:["class","id","data-tab","data-value","data-os-type","aria-label","aria-selected","role","tabindex"]}),this.attachEventListeners(),await this.initializeVisualizations()}catch(e){console.error("❌ [TripleOSResultsView] Render error:",e),SecureDOM.setText(this.container,"エラーが発生しました。ページをリロードしてください。")}};TripleOSResultsView.prototype.updateSectionContent;TripleOSResultsView.prototype.updateSectionContent=function(e,t,s){try{if(t)SecureDOM.setHTML(e,t,{ALLOWED_TAGS:["div","h3","h4","p","span","ul","li","strong","em","small"],ALLOWED_ATTR:["class","style"]});else{const t=s||'<div class="error-note"><small>❌ データの読み込みに失敗しました</small></div>';SecureDOM.setHTML(e,t,{ALLOWED_TAGS:["div","small"],ALLOWED_ATTR:["class"]})}}catch(r){console.error("❌ Section update error:",r),SecureDOM.setText(e,"❌ 表示エラーが発生しました")}};TripleOSResultsView.prototype.showNotImplementedMessage;TripleOSResultsView.prototype.showNotImplementedMessage=function(e){SecureDOM.setText(e,"🚧 まだ実装していません - 今後実装予定です")};["_renderEngineOSAnalysis","_renderInterfaceOSAnalysis","_renderSafeModeOSAnalysis","_renderCompatibilityAnalysis","_renderAdvancedAnalysis"].forEach(e=>{const t=TripleOSResultsView.prototype[e];t&&(TripleOSResultsView.prototype[e]=function(...e){const s=t.apply(this,e);return"string"==typeof s?DOMPurify?DOMPurify.sanitize(s,{ALLOWED_TAGS:["div","h3","h4","p","span","ul","li","strong","em","small","table","tr","td","th"],ALLOWED_ATTR:["class","style","data-value","data-type"]}):SecurityValidator.escapeHtml(s):s})}),console.log("✅ TripleOSResultsView security patch applied successfully")}();