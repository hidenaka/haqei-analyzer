class InsightPanel extends BaseComponent{constructor(n,e={}){super(n,e),this.analysisResult=null,this.insights=null,this.currentView="overview"}get defaultOptions(){return{...super.defaultOptions,onBack:null,onGenerateReport:null}}setData(n,e){this.analysisResult=n,this.insights=e,this.render()}render(){this.analysisResult?(this.container.innerHTML=`\n      <div class="insight-panel-container">\n        <div class="insight-header">\n          <h2 class="insight-title">🔍 深い洞察パネル</h2>\n          <div class="insight-navigation">\n            <button class="nav-btn ${"overview"===this.currentView?"active":""}" data-view="overview">概要</button>\n            <button class="nav-btn ${"dimensions"===this.currentView?"active":""}" data-view="dimensions">8次元分析</button>\n            <button class="nav-btn ${"hexagram"===this.currentView?"active":""}" data-view="hexagram">64卦詳細</button>\n            <button class="nav-btn ${"recommendations"===this.currentView?"active":""}" data-view="recommendations">推奨事項</button>\n          </div>\n        </div>\n\n        <div class="insight-content">\n          ${this.renderCurrentView()}\n        </div>\n\n        <div class="insight-actions">\n          <button id="back-btn" class="btn btn-secondary">← 戻る</button>\n          <button id="generate-report-btn" class="btn btn-primary">📊 レポート生成</button>\n        </div>\n      </div>\n    `,this.bindEvents()):this.container.innerHTML='\n        <div class="insight-panel-container">\n          <div class="error">分析結果が見つかりません。</div>\n        </div>\n      '}renderCurrentView(){switch(this.currentView){case"overview":default:return this.renderOverview();case"dimensions":return this.renderDimensionsAnalysis();case"hexagram":return this.renderHexagramDetails();case"recommendations":return this.renderRecommendations()}}renderOverview(){const n=this.analysisResult.primaryOS;return`\n      <div class="overview-section">\n        <div class="primary-hexagram">\n          <div class="hexagram-card">\n            <div class="hexagram-name">${n.hexagramInfo.name}</div>\n            <div class="hexagram-reading">${n.hexagramInfo.reading||""}</div>\n            <div class="match-score">${n.matchPercentage.toFixed(1)}% マッチ</div>\n            <div class="hexagram-description">\n              ${n.hexagramInfo.description||"詳細な説明を生成中..."}\n            </div>\n          </div>\n        </div>\n\n        <div class="key-insights">\n          <h3>🎯 主要な洞察</h3>\n          <div class="insights-grid">\n            ${this.renderKeyInsights()}\n          </div>\n        </div>\n\n        <div class="dimension-overview">\n          <h3>📊 8次元バランス概要</h3>\n          <div class="dimension-radar">\n            ${this.renderDimensionRadar()}\n          </div>\n        </div>\n      </div>\n    `}renderDimensionsAnalysis(){const n=this.analysisResult.eightDimensionVector;return`\n      <div class="dimensions-section">\n        <h3>📈 8次元詳細分析</h3>\n        <div class="dimensions-detailed">\n          ${this.renderDetailedDimensions(n)}\n        </div>\n        \n        <div class="dimension-insights">\n          <h4>💡 次元別洞察</h4>\n          ${this.renderDimensionInsights(n)}\n        </div>\n      </div>\n    `}renderHexagramDetails(){const n=this.analysisResult.primaryOS;return`\n      <div class="hexagram-section">\n        <div class="hexagram-details">\n          <h3>🔮 ${n.hexagramInfo.name} 詳細</h3>\n          \n          <div class="hexagram-attributes">\n            <div class="attribute-item">\n              <strong>読み:</strong> ${n.hexagramInfo.reading||"N/A"}\n            </div>\n            <div class="attribute-item">\n              <strong>象徴:</strong> ${n.hexagramInfo.symbol||"N/A"}\n            </div>\n            <div class="attribute-item">\n              <strong>意味:</strong> ${n.hexagramInfo.meaning||"N/A"}\n            </div>\n          </div>\n\n          <div class="hexagram-interpretation">\n            <h4>🎭 あなたの人格パターン</h4>\n            <p>${this.generateHexagramInterpretation(n)}</p>\n          </div>\n\n          <div class="hexagram-vector">\n            <h4>🧮 この64卦の8次元ベクトル</h4>\n            <div class="vector-display">\n              ${this.renderHexagramVector(n.hexagramId)}\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderRecommendations(){return`\n      <div class="recommendations-section">\n        <h3>💡 あなたへの推奨事項</h3>\n        \n        <div class="recommendations-categories">\n          <div class="recommendation-category">\n            <h4>🎯 キャリア・仕事</h4>\n            <ul>\n              ${this.generateCareerRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>🌱 成長・発展</h4>\n            <ul>\n              ${this.generateGrowthRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>🤝 人間関係</h4>\n            <ul>\n              ${this.generateRelationshipRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>⚠️ 注意点</h4>\n            <ul>\n              ${this.generateCautionRecommendations()}\n            </ul>\n          </div>\n        </div>\n      </div>\n    `}renderKeyInsights(){if(!this.insights)return'<div class="insight-item">洞察を生成中...</div>';return[{title:"主要な強み",content:this.insights.strengths||"分析中..."},{title:"成長の可能性",content:this.insights.potential||"分析中..."},{title:"特徴的な行動パターン",content:this.insights.patterns||"分析中..."}].map(n=>`\n      <div class="insight-item">\n        <h4>${n.title}</h4>\n        <p>${n.content}</p>\n      </div>\n    `).join("")}renderDimensionRadar(){return'\n      <div class="radar-placeholder">\n        <p>🎯 8次元バランス可視化</p>\n        <p>※ 実際のレーダーチャートを表示するにはChart.jsなどのライブラリが必要です</p>\n      </div>\n    '}renderDetailedDimensions(n){return[{key:"乾_創造性",name:"創造性",icon:"🌟",description:"新しいアイデアを生み出す力"},{key:"震_行動性",name:"行動性",icon:"⚡",description:"積極的に行動する力"},{key:"坎_探求性",name:"探求性",icon:"🔍",description:"深く探求する力"},{key:"艮_安定性",name:"安定性",icon:"🗻",description:"安定を保つ力"},{key:"坤_受容性",name:"受容性",icon:"🌍",description:"受け入れる力"},{key:"巽_適応性",name:"適応性",icon:"🌊",description:"変化に適応する力"},{key:"離_表現性",name:"表現性",icon:"🔥",description:"自己表現する力"},{key:"兌_調和性",name:"調和性",icon:"☯️",description:"調和を作る力"}].map(e=>{const i=n[e.key]||0,s=this.getDimensionLevel(i);return`\n        <div class="dimension-detail">\n          <div class="dimension-header">\n            <span class="dimension-icon">${e.icon}</span>\n            <span class="dimension-name">${e.name}</span>\n            <span class="dimension-level ${s.class}">${s.text}</span>\n          </div>\n          <div class="dimension-description">${e.description}</div>\n          <div class="dimension-score-detail">スコア: ${i.toFixed(2)}</div>\n        </div>\n      `}).join("")}renderDimensionInsights(n){const e=["乾_創造性","震_行動性","坎_探求性","艮_安定性","坤_受容性","巽_適応性","離_表現性","兌_調和性"].map(e=>({name:e,score:n[e]||0}));e.sort((n,e)=>e.score-n.score);const i=e[0],s=e[e.length-1];return`\n      <div class="dimension-analysis">\n        <div class="strength-dimension">\n          <h5>🌟 最も強い次元: ${i.name}</h5>\n          <p>あなたの${i.name}は特に高く、これがあなたの主要な強みです。</p>\n        </div>\n        \n        <div class="growth-dimension">\n          <h5>🌱 成長の余地: ${s.name}</h5>\n          <p>この次元を意識的に伸ばすことで、よりバランスの取れた人格となるでしょう。</p>\n        </div>\n      </div>\n    `}getDimensionLevel(n){return n>=2?{text:"非常に高い",class:"very-high"}:n>=1?{text:"高い",class:"high"}:n>=0?{text:"標準",class:"normal"}:n>=-1?{text:"低い",class:"low"}:{text:"非常に低い",class:"very-low"}}generateHexagramInterpretation(n){return`あなたの人格は「${n.hexagramInfo.name}」として特徴づけられます。この卦は${n.hexagramInfo.meaning||"独特の意味を持ち"}、あなたの行動パターンや価値観に深く反映されています。適合度${n.matchPercentage.toFixed(1)}%という高いマッチング率は、この分析の精度を示しています。`}generateCareerRecommendations(){return["<li>創造性を活かせる分野での活躍が期待できます</li>","<li>チームワークを重視する環境が適しています</li>","<li>継続的な学習と成長の機会がある職場を選びましょう</li>"].join("")}generateGrowthRecommendations(){return["<li>定期的な自己反省と目標設定を行いましょう</li>","<li>新しいスキルの習得に積極的に取り組みましょう</li>","<li>多様な経験を積むことで視野を広げましょう</li>"].join("")}generateRelationshipRecommendations(){return["<li>オープンなコミュニケーションを心がけましょう</li>","<li>相手の価値観を尊重する姿勢が重要です</li>","<li>協力的な関係性を築くことを意識しましょう</li>"].join("")}generateCautionRecommendations(){return["<li>完璧主義になりすぎないよう注意しましょう</li>","<li>他人の意見にも耳を傾ける柔軟性を保ちましょう</li>","<li>ストレス管理と適切な休息を忘れずに</li>"].join("")}renderHexagramVector(n){return`\n      <div class="hexagram-vector-display">\n        <p>64卦ID: ${n}</p>\n        <p>※ この64卦の標準的な8次元ベクトルを表示</p>\n      </div>\n    `}bindEvents(){this.container.querySelectorAll(".nav-btn").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.view;this.currentView=e,this.render()})});const n=this.container.querySelector("#back-btn"),e=this.container.querySelector("#generate-report-btn");n&&n.addEventListener("click",()=>{this.options.onBack&&this.options.onBack()}),e&&e.addEventListener("click",()=>{this.options.onGenerateReport&&this.options.onGenerateReport(this.analysisResult,this.insights)})}}