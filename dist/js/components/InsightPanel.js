class InsightPanel extends BaseComponent{constructor(n,e={}){super(n,e),this.analysisResult=null,this.insights=null,this.currentView="overview"}get defaultOptions(){return{...super.defaultOptions,onBack:null,onGenerateReport:null}}setData(n,e){this.analysisResult=n,this.insights=e,this.render()}render(){this.analysisResult?(this.container.innerHTML=`\n      <div class="insight-panel-container">\n        <div class="insight-header">\n          <h2 class="insight-title">ğŸ” æ·±ã„æ´å¯Ÿãƒ‘ãƒãƒ«</h2>\n          <div class="insight-navigation">\n            <button class="nav-btn ${"overview"===this.currentView?"active":""}" data-view="overview">æ¦‚è¦</button>\n            <button class="nav-btn ${"dimensions"===this.currentView?"active":""}" data-view="dimensions">8æ¬¡å…ƒåˆ†æ</button>\n            <button class="nav-btn ${"hexagram"===this.currentView?"active":""}" data-view="hexagram">64å¦è©³ç´°</button>\n            <button class="nav-btn ${"recommendations"===this.currentView?"active":""}" data-view="recommendations">æ¨å¥¨äº‹é …</button>\n          </div>\n        </div>\n\n        <div class="insight-content">\n          ${this.renderCurrentView()}\n        </div>\n\n        <div class="insight-actions">\n          <button id="back-btn" class="btn btn-secondary">â† æˆ»ã‚‹</button>\n          <button id="generate-report-btn" class="btn btn-primary">ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</button>\n        </div>\n      </div>\n    `,this.bindEvents()):this.container.innerHTML='\n        <div class="insight-panel-container">\n          <div class="error">åˆ†æçµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</div>\n        </div>\n      '}renderCurrentView(){switch(this.currentView){case"overview":default:return this.renderOverview();case"dimensions":return this.renderDimensionsAnalysis();case"hexagram":return this.renderHexagramDetails();case"recommendations":return this.renderRecommendations()}}renderOverview(){const n=this.analysisResult.primaryOS;return`\n      <div class="overview-section">\n        <div class="primary-hexagram">\n          <div class="hexagram-card">\n            <div class="hexagram-name">${n.hexagramInfo.name}</div>\n            <div class="hexagram-reading">${n.hexagramInfo.reading||""}</div>\n            <div class="match-score">${n.matchPercentage.toFixed(1)}% ãƒãƒƒãƒ</div>\n            <div class="hexagram-description">\n              ${n.hexagramInfo.description||"è©³ç´°ãªèª¬æ˜ã‚’ç”Ÿæˆä¸­..."}\n            </div>\n          </div>\n        </div>\n\n        <div class="key-insights">\n          <h3>ğŸ¯ ä¸»è¦ãªæ´å¯Ÿ</h3>\n          <div class="insights-grid">\n            ${this.renderKeyInsights()}\n          </div>\n        </div>\n\n        <div class="dimension-overview">\n          <h3>ğŸ“Š 8æ¬¡å…ƒãƒãƒ©ãƒ³ã‚¹æ¦‚è¦</h3>\n          <div class="dimension-radar">\n            ${this.renderDimensionRadar()}\n          </div>\n        </div>\n      </div>\n    `}renderDimensionsAnalysis(){const n=this.analysisResult.eightDimensionVector;return`\n      <div class="dimensions-section">\n        <h3>ğŸ“ˆ 8æ¬¡å…ƒè©³ç´°åˆ†æ</h3>\n        <div class="dimensions-detailed">\n          ${this.renderDetailedDimensions(n)}\n        </div>\n        \n        <div class="dimension-insights">\n          <h4>ğŸ’¡ æ¬¡å…ƒåˆ¥æ´å¯Ÿ</h4>\n          ${this.renderDimensionInsights(n)}\n        </div>\n      </div>\n    `}renderHexagramDetails(){const n=this.analysisResult.primaryOS;return`\n      <div class="hexagram-section">\n        <div class="hexagram-details">\n          <h3>ğŸ”® ${n.hexagramInfo.name} è©³ç´°</h3>\n          \n          <div class="hexagram-attributes">\n            <div class="attribute-item">\n              <strong>èª­ã¿:</strong> ${n.hexagramInfo.reading||"N/A"}\n            </div>\n            <div class="attribute-item">\n              <strong>è±¡å¾´:</strong> ${n.hexagramInfo.symbol||"N/A"}\n            </div>\n            <div class="attribute-item">\n              <strong>æ„å‘³:</strong> ${n.hexagramInfo.meaning||"N/A"}\n            </div>\n          </div>\n\n          <div class="hexagram-interpretation">\n            <h4>ğŸ­ ã‚ãªãŸã®äººæ ¼ãƒ‘ã‚¿ãƒ¼ãƒ³</h4>\n            <p>${this.generateHexagramInterpretation(n)}</p>\n          </div>\n\n          <div class="hexagram-vector">\n            <h4>ğŸ§® ã“ã®64å¦ã®8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«</h4>\n            <div class="vector-display">\n              ${this.renderHexagramVector(n.hexagramId)}\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderRecommendations(){return`\n      <div class="recommendations-section">\n        <h3>ğŸ’¡ ã‚ãªãŸã¸ã®æ¨å¥¨äº‹é …</h3>\n        \n        <div class="recommendations-categories">\n          <div class="recommendation-category">\n            <h4>ğŸ¯ ã‚­ãƒ£ãƒªã‚¢ãƒ»ä»•äº‹</h4>\n            <ul>\n              ${this.generateCareerRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>ğŸŒ± æˆé•·ãƒ»ç™ºå±•</h4>\n            <ul>\n              ${this.generateGrowthRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>ğŸ¤ äººé–“é–¢ä¿‚</h4>\n            <ul>\n              ${this.generateRelationshipRecommendations()}\n            </ul>\n          </div>\n\n          <div class="recommendation-category">\n            <h4>âš ï¸ æ³¨æ„ç‚¹</h4>\n            <ul>\n              ${this.generateCautionRecommendations()}\n            </ul>\n          </div>\n        </div>\n      </div>\n    `}renderKeyInsights(){if(!this.insights)return'<div class="insight-item">æ´å¯Ÿã‚’ç”Ÿæˆä¸­...</div>';return[{title:"ä¸»è¦ãªå¼·ã¿",content:this.insights.strengths||"åˆ†æä¸­..."},{title:"æˆé•·ã®å¯èƒ½æ€§",content:this.insights.potential||"åˆ†æä¸­..."},{title:"ç‰¹å¾´çš„ãªè¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³",content:this.insights.patterns||"åˆ†æä¸­..."}].map(n=>`\n      <div class="insight-item">\n        <h4>${n.title}</h4>\n        <p>${n.content}</p>\n      </div>\n    `).join("")}renderDimensionRadar(){return'\n      <div class="radar-placeholder">\n        <p>ğŸ¯ 8æ¬¡å…ƒãƒãƒ©ãƒ³ã‚¹å¯è¦–åŒ–</p>\n        <p>â€» å®Ÿéš›ã®ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯Chart.jsãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™</p>\n      </div>\n    '}renderDetailedDimensions(n){return[{key:"ä¹¾_å‰µé€ æ€§",name:"å‰µé€ æ€§",icon:"ğŸŒŸ",description:"æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç”Ÿã¿å‡ºã™åŠ›"},{key:"éœ‡_è¡Œå‹•æ€§",name:"è¡Œå‹•æ€§",icon:"âš¡",description:"ç©æ¥µçš„ã«è¡Œå‹•ã™ã‚‹åŠ›"},{key:"å_æ¢æ±‚æ€§",name:"æ¢æ±‚æ€§",icon:"ğŸ”",description:"æ·±ãæ¢æ±‚ã™ã‚‹åŠ›"},{key:"è‰®_å®‰å®šæ€§",name:"å®‰å®šæ€§",icon:"ğŸ—»",description:"å®‰å®šã‚’ä¿ã¤åŠ›"},{key:"å¤_å—å®¹æ€§",name:"å—å®¹æ€§",icon:"ğŸŒ",description:"å—ã‘å…¥ã‚Œã‚‹åŠ›"},{key:"å·½_é©å¿œæ€§",name:"é©å¿œæ€§",icon:"ğŸŒŠ",description:"å¤‰åŒ–ã«é©å¿œã™ã‚‹åŠ›"},{key:"é›¢_è¡¨ç¾æ€§",name:"è¡¨ç¾æ€§",icon:"ğŸ”¥",description:"è‡ªå·±è¡¨ç¾ã™ã‚‹åŠ›"},{key:"å…Œ_èª¿å’Œæ€§",name:"èª¿å’Œæ€§",icon:"â˜¯ï¸",description:"èª¿å’Œã‚’ä½œã‚‹åŠ›"}].map(e=>{const i=n[e.key]||0,s=this.getDimensionLevel(i);return`\n        <div class="dimension-detail">\n          <div class="dimension-header">\n            <span class="dimension-icon">${e.icon}</span>\n            <span class="dimension-name">${e.name}</span>\n            <span class="dimension-level ${s.class}">${s.text}</span>\n          </div>\n          <div class="dimension-description">${e.description}</div>\n          <div class="dimension-score-detail">ã‚¹ã‚³ã‚¢: ${i.toFixed(2)}</div>\n        </div>\n      `}).join("")}renderDimensionInsights(n){const e=["ä¹¾_å‰µé€ æ€§","éœ‡_è¡Œå‹•æ€§","å_æ¢æ±‚æ€§","è‰®_å®‰å®šæ€§","å¤_å—å®¹æ€§","å·½_é©å¿œæ€§","é›¢_è¡¨ç¾æ€§","å…Œ_èª¿å’Œæ€§"].map(e=>({name:e,score:n[e]||0}));e.sort((n,e)=>e.score-n.score);const i=e[0],s=e[e.length-1];return`\n      <div class="dimension-analysis">\n        <div class="strength-dimension">\n          <h5>ğŸŒŸ æœ€ã‚‚å¼·ã„æ¬¡å…ƒ: ${i.name}</h5>\n          <p>ã‚ãªãŸã®${i.name}ã¯ç‰¹ã«é«˜ãã€ã“ã‚ŒãŒã‚ãªãŸã®ä¸»è¦ãªå¼·ã¿ã§ã™ã€‚</p>\n        </div>\n        \n        <div class="growth-dimension">\n          <h5>ğŸŒ± æˆé•·ã®ä½™åœ°: ${s.name}</h5>\n          <p>ã“ã®æ¬¡å…ƒã‚’æ„è­˜çš„ã«ä¼¸ã°ã™ã“ã¨ã§ã€ã‚ˆã‚Šãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸäººæ ¼ã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚</p>\n        </div>\n      </div>\n    `}getDimensionLevel(n){return n>=2?{text:"éå¸¸ã«é«˜ã„",class:"very-high"}:n>=1?{text:"é«˜ã„",class:"high"}:n>=0?{text:"æ¨™æº–",class:"normal"}:n>=-1?{text:"ä½ã„",class:"low"}:{text:"éå¸¸ã«ä½ã„",class:"very-low"}}generateHexagramInterpretation(n){return`ã‚ãªãŸã®äººæ ¼ã¯ã€Œ${n.hexagramInfo.name}ã€ã¨ã—ã¦ç‰¹å¾´ã¥ã‘ã‚‰ã‚Œã¾ã™ã€‚ã“ã®å¦ã¯${n.hexagramInfo.meaning||"ç‹¬ç‰¹ã®æ„å‘³ã‚’æŒã¡"}ã€ã‚ãªãŸã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ä¾¡å€¤è¦³ã«æ·±ãåæ˜ ã•ã‚Œã¦ã„ã¾ã™ã€‚é©åˆåº¦${n.matchPercentage.toFixed(1)}%ã¨ã„ã†é«˜ã„ãƒãƒƒãƒãƒ³ã‚°ç‡ã¯ã€ã“ã®åˆ†æã®ç²¾åº¦ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`}generateCareerRecommendations(){return["<li>å‰µé€ æ€§ã‚’æ´»ã‹ã›ã‚‹åˆ†é‡ã§ã®æ´»èºãŒæœŸå¾…ã§ãã¾ã™</li>","<li>ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é‡è¦–ã™ã‚‹ç’°å¢ƒãŒé©ã—ã¦ã„ã¾ã™</li>","<li>ç¶™ç¶šçš„ãªå­¦ç¿’ã¨æˆé•·ã®æ©Ÿä¼šãŒã‚ã‚‹è·å ´ã‚’é¸ã³ã¾ã—ã‚‡ã†</li>"].join("")}generateGrowthRecommendations(){return["<li>å®šæœŸçš„ãªè‡ªå·±åçœã¨ç›®æ¨™è¨­å®šã‚’è¡Œã„ã¾ã—ã‚‡ã†</li>","<li>æ–°ã—ã„ã‚¹ã‚­ãƒ«ã®ç¿’å¾—ã«ç©æ¥µçš„ã«å–ã‚Šçµ„ã¿ã¾ã—ã‚‡ã†</li>","<li>å¤šæ§˜ãªçµŒé¨“ã‚’ç©ã‚€ã“ã¨ã§è¦–é‡ã‚’åºƒã’ã¾ã—ã‚‡ã†</li>"].join("")}generateRelationshipRecommendations(){return["<li>ã‚ªãƒ¼ãƒ—ãƒ³ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†</li>","<li>ç›¸æ‰‹ã®ä¾¡å€¤è¦³ã‚’å°Šé‡ã™ã‚‹å§¿å‹¢ãŒé‡è¦ã§ã™</li>","<li>å”åŠ›çš„ãªé–¢ä¿‚æ€§ã‚’ç¯‰ãã“ã¨ã‚’æ„è­˜ã—ã¾ã—ã‚‡ã†</li>"].join("")}generateCautionRecommendations(){return["<li>å®Œç’§ä¸»ç¾©ã«ãªã‚Šã™ããªã„ã‚ˆã†æ³¨æ„ã—ã¾ã—ã‚‡ã†</li>","<li>ä»–äººã®æ„è¦‹ã«ã‚‚è€³ã‚’å‚¾ã‘ã‚‹æŸ”è»Ÿæ€§ã‚’ä¿ã¡ã¾ã—ã‚‡ã†</li>","<li>ã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†ã¨é©åˆ‡ãªä¼‘æ¯ã‚’å¿˜ã‚Œãšã«</li>"].join("")}renderHexagramVector(n){return`\n      <div class="hexagram-vector-display">\n        <p>64å¦ID: ${n}</p>\n        <p>â€» ã“ã®64å¦ã®æ¨™æº–çš„ãª8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‚’è¡¨ç¤º</p>\n      </div>\n    `}bindEvents(){this.container.querySelectorAll(".nav-btn").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.view;this.currentView=e,this.render()})});const n=this.container.querySelector("#back-btn"),e=this.container.querySelector("#generate-report-btn");n&&n.addEventListener("click",()=>{this.options.onBack&&this.options.onBack()}),e&&e.addEventListener("click",()=>{this.options.onGenerateReport&&this.options.onGenerateReport(this.analysisResult,this.insights)})}}