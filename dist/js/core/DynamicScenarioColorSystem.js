class DynamicScenarioColorSystem{constructor(){this.version="1.0.0",this.initialized=!1,this.scenarioTrigramMapping={proactive:"qian",adaptive:"kun",transformative:"zhen",decisive:"li",strengthening:"gen",harmonizing:"dui",integrative:"xun",innovative:"kan"},this.trigramColors={qian:{primary:"#FFD700",light:"#FFF8DC",dark:"#B8860B",icon:"☰",name:"乾"},dui:{primary:"#87CEEB",light:"#F0F8FF",dark:"#4682B4",icon:"☱",name:"兌"},li:{primary:"#FF4500",light:"#FFE4E1",dark:"#DC143C",icon:"☲",name:"離"},zhen:{primary:"#8A2BE2",light:"#E6E6FA",dark:"#4B0082",icon:"☳",name:"震"},xun:{primary:"#32CD32",light:"#F0FFF0",dark:"#228B22",icon:"☴",name:"巽"},kan:{primary:"#1E90FF",light:"#F0F8FF",dark:"#0000CD",icon:"☵",name:"坎"},gen:{primary:"#708090",light:"#F8F8FF",dark:"#2F4F4F",icon:"☶",name:"艮"},kun:{primary:"#8B4513",light:"#F5F5DC",dark:"#A0522D",icon:"☷",name:"坤"}},this.initialize()}initialize(){console.log("🎨 DynamicScenarioColorSystem v1.0.0 初期化中..."),this.initialized=!0,console.log("✅ 8シナリオ→八卦マッピング完了")}getScenarioVisualization(r,i=null){try{const e=r.metadata?.approach||r.approach;let a=this.scenarioTrigramMapping[e];i&&this.shouldAdjustByHexagram(i)&&(a=this.adjustTrigramByHexagram(a,i)),a&&"undefined"!==a||(a="乾");const n=this.trigramColors[a];return n?{color:n.primary,lightColor:n.light,darkColor:n.dark,icon:n.icon,traditional:n.icon||"☯",modern:this.getModernEmoji(e)||"🎯",trigramName:n.name,trigramKey:a,gradient:`linear-gradient(135deg, ${n.primary}, ${n.dark})`,cssClass:`trigram-${a}`,modernEmoji:this.getModernEmoji(e),confidenceLevel:r.metadata?.confidence||.8}:this.getDefaultVisualization()}catch(e){return console.error("❌ getScenarioVisualization error:",e),this.getDefaultVisualization()}}shouldAdjustByHexagram(r){return r&&(r.trigrams||r.upperTrigram||r.lowerTrigram||r["上卦"]||r["下卦"]||r["卦名"]||r.hexagramNumber)}adjustTrigramByHexagram(r,i){try{const e=this.getH384HexagramData(i);if(e){if(e.upperTrigram&&e.lowerTrigram){const i=this.mapTrigramNameToKey(e.upperTrigram),a=this.mapTrigramNameToKey(e.lowerTrigram);return i||a||r}if(e.hexagramName){const r=this.extractTrigramFromHexagramName(e.hexagramName);if(r)return r}}if(i.trigrams&&i.trigrams.length>0){return this.mapTrigramNameToKey(i.trigrams[0])||r}return r}catch(e){return console.warn("⚠️ adjustTrigramByHexagram error:",e),r}}getH384HexagramData(r){try{if("undefined"!=typeof window&&window.H384_DATA&&Array.isArray(window.H384_DATA)){let i=null;if(r.hexagramNumber&&(i=window.H384_DATA.find(i=>i["卦番号"]===r.hexagramNumber||i["通し番号"]===r.hexagramNumber)),!i&&r.hexagramName&&(i=window.H384_DATA.find(i=>i["卦名"]&&i["卦名"].includes(r.hexagramName))),i||"string"!=typeof r||(i=window.H384_DATA.find(i=>i["卦名"]&&i["卦名"].includes(r))),i)return{hexagramName:i["卦名"],hexagramNumber:i["卦番号"]||i["通し番号"],upperTrigram:i["上卦"],lowerTrigram:i["下卦"],keywords:i["キーワード"],modernInterpretation:i["現代解釈"],guidance:i["指針"],originalEntry:i}}return null}catch(i){return console.warn("⚠️ getH384HexagramData error:",i),null}}extractTrigramFromHexagramName(r){const i={"乾":"qian","天":"qian","坤":"kun","地":"kun","震":"zhen","雷":"zhen","巽":"xun","風":"xun","坎":"kan","水":"kan","離":"li","火":"li","艮":"gen","山":"gen","兌":"dui","沢":"dui","澤":"dui"};for(const[e,a]of Object.entries(i))if(r.includes(e))return a;return null}mapTrigramNameToKey(r){return{"乾":"qian","天":"qian","兌":"dui","沢":"dui","離":"li","火":"li","震":"zhen","雷":"zhen","巽":"xun","風":"xun","坎":"kan","水":"kan","艮":"gen","山":"gen","坤":"kun","地":"kun"}[r]||null}getModernEmoji(r){return{proactive:"🚀",adaptive:"🌊",transformative:"🦋",decisive:"⚡",strengthening:"🛡️",harmonizing:"☯️",integrative:"🔗",innovative:"💎"}[r]||"🎯"}getDefaultVisualization(){return{color:"#757575",lightColor:"#f5f5f5",darkColor:"#424242",icon:"🎯",traditional:"☯",modern:"🎯",trigramName:"一般",trigramKey:"default",gradient:"linear-gradient(135deg, #757575, #424242)",cssClass:"trigram-default",modernEmoji:"🎯",confidenceLevel:.5}}getAllScenariosVisualization(r,i=null){return r.map((r,e)=>({...r,visualization:this.getScenarioVisualization(r,i),displayOrder:e+1}))}applyScenariosColorsToDom(r){const i=document.documentElement;r.forEach((r,e)=>{const a=r.visualization;a&&(i.style.setProperty(`--scenario-${e+1}-color`,a.color),i.style.setProperty(`--scenario-${e+1}-light`,a.lightColor),i.style.setProperty(`--scenario-${e+1}-dark`,a.darkColor),i.style.setProperty(`--scenario-${e+1}-gradient`,a.gradient))}),console.log("🎨 シナリオ色をCSS変数に適用完了")}getSystemInfo(){return{version:this.version,initialized:this.initialized,mappingCount:Object.keys(this.scenarioTrigramMapping).length,colorCount:Object.keys(this.trigramColors).length,availableApproaches:Object.keys(this.scenarioTrigramMapping)}}}"undefined"!=typeof window&&(window.DynamicScenarioColorSystem=DynamicScenarioColorSystem,window.haqeiColorSystem||(window.haqeiColorSystem=new DynamicScenarioColorSystem,console.log("🎨 HAQEI動的色システム初期化完了"))),"undefined"!=typeof module&&module.exports&&(module.exports=DynamicScenarioColorSystem);