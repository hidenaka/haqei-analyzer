console.log("📚 DictionaryManager Loading with HaQei Philosophy..."),window.DictionaryManager={initialized:!1,engineOS:null,interfaceOS:null,safeMode:null,dictionaries:{haqei_philosophy:null,iching_terms:null,semantic_relations:null,emotional_lexicon:null,wisdom_patterns:null},async init(){console.log("🚀 DictionaryManager initializing...");try{this.setupTripleOSArchitecture(),await this.loadHaQeiDictionaries(),await this.buildSemanticNetworks(),this.validateDictionaryIntegrity(),this.initialized=!0,console.log("✅ DictionaryManager initialized with HaQei philosophy")}catch(i){console.error("❌ DictionaryManager initialization failed:",i),this.activateSafeMode()}},setupTripleOSArchitecture(){console.log("🔧 Setting up Triple OS Architecture for Dictionary..."),this.engineOS={name:"Dictionary Engine OS",version:"1.0.0",philosophy:"haqei-dictionary",async lookupTerm(i,e={}){try{const e={term:i,definitions:[],semantic_relations:[],haqei_associations:[],usage_examples:[],emotional_connotations:[],wisdom_connections:[]};return e.definitions=this.findDefinitions(i),e.semantic_relations=this.findSemanticRelations(i),e.haqei_associations=this.findHaQeiAssociations(i),e.usage_examples=this.findUsageExamples(i),e.emotional_connotations=this.analyzeEmotionalConnotations(i),e.wisdom_connections=this.findWisdomConnections(i),{query:i,results:e,confidence:this.calculateLookupConfidence(e),philosophy:"haqei-enhanced"}}catch(n){return console.warn("⚠️ Dictionary lookup error:",n),this.createFallbackLookup(i)}},findDefinitions(i){const e=[];if(this.dictionaries.haqei_philosophy&&this.dictionaries.haqei_philosophy.has(i)){const n=this.dictionaries.haqei_philosophy.get(i);e.push({source:"haqei_philosophy",definition:n.definition,principles:n.principles,applications:n.applications})}if(this.dictionaries.iching_terms&&this.dictionaries.iching_terms.has(i)){const n=this.dictionaries.iching_terms.get(i);e.push({source:"iching_terms",definition:n.definition,hexagram:n.hexagram,trigram:n.trigram,classical_meaning:n.classical_meaning})}return 0===e.length&&e.push(this.generateBasicDefinition(i)),e},findSemanticRelations(i){const e=[];if(this.dictionaries.semantic_relations){const n=this.dictionaries.semantic_relations.get(i);n&&(e.push(...n.synonyms.map(i=>({type:"synonym",term:i,strength:.9}))),e.push(...n.antonyms.map(i=>({type:"antonym",term:i,strength:.8}))),e.push(...n.hypernyms.map(i=>({type:"hypernym",term:i,strength:.7}))),e.push(...n.hyponyms.map(i=>({type:"hyponym",term:i,strength:.7}))),e.push(...n.meronyms.map(i=>({type:"meronym",term:i,strength:.6}))),e.push(...n.holonyms.map(i=>({type:"holonym",term:i,strength:.6}))))}return e.sort((i,e)=>e.strength-i.strength)},findHaQeiAssociations(i){const e=[];["調和","平和","バランス","協調","統合"].some(e=>i.includes(e)||e.includes(i))&&e.push({principle:"harmony",connection:"direct",description:"調和の原理に直接関連する概念です",practical_application:"協力と統合を促進する文脈で使用されます"});["慈悲","愛","思いやり","共感","理解","支援"].some(e=>i.includes(e)||e.includes(i))&&e.push({principle:"compassion",connection:"direct",description:"慈悲の原理に直接関連する概念です",practical_application:"他者への理解と支援の文脈で使用されます"});["智慧","知恵","学習","成長","洞察","理解"].some(e=>i.includes(e)||e.includes(i))&&e.push({principle:"wisdom",connection:"direct",description:"智慧の原理に直接関連する概念です",practical_application:"学習と成長の文脈で使用されます"});return["真実","誠実","正直","自然","純粋"].some(e=>i.includes(e)||e.includes(i))&&e.push({principle:"authenticity",connection:"direct",description:"真実の原理に直接関連する概念です",practical_application:"誠実な表現と行動の文脈で使用されます"}),e},findUsageExamples(i){const e=[],n={"調和":["人々の調和を促進することが重要です","この解決策は全体の調和を保ちます","内面の調和が外面に反映されます"],"慈悲":["慈悲深い心で他者に接します","この行動は慈悲の精神から生まれました","慈悲は智慧と共に歩みます"],"智慧":["経験から智慧を得ることができます","この智慧を日常生活に活かします","智慧は実践によって深まります"],"真実":["真実を語ることの大切さを学びました","この真実は心の奥深くから湧き上がります","真実は時として厳しいものです"]};return n[i]&&e.push(...n[i].map(i=>({text:i,context:"haqei_philosophy",usage_type:"philosophical"}))),e},analyzeEmotionalConnotations(i){const e=[];if(this.dictionaries.emotional_lexicon){const n=this.dictionaries.emotional_lexicon.get(i);n&&e.push({valence:n.valence,arousal:n.arousal,dominance:n.dominance,primary_emotions:n.primary_emotions,secondary_emotions:n.secondary_emotions})}return e},findWisdomConnections(i){const e=[];if(this.dictionaries.wisdom_patterns){const n=this.dictionaries.wisdom_patterns.get(i);n&&e.push(...n.map(i=>({pattern_type:i.type,wisdom_tradition:i.tradition,teaching:i.teaching,application:i.application,relevance_score:i.relevance})))}return e.sort((i,e)=>e.relevance_score-i.relevance_score)},generateBasicDefinition:i=>({source:"generated",definition:`「${i}」に関連する概念`,note:"HaQei辞書に定義が見つからないため、基本的な説明を提供しています",suggestion:"より詳細な定義については、HaQei哲学の文脈での使用例を参照してください"}),calculateLookupConfidence(i){let e=0;return i.definitions.length>0&&(e+=.3),i.semantic_relations.length>0&&(e+=.2),i.haqei_associations.length>0&&(e+=.2),i.usage_examples.length>0&&(e+=.15),i.emotional_connotations.length>0&&(e+=.1),i.wisdom_connections.length>0&&(e+=.05),Math.min(e,1)},createFallbackLookup(i){return{query:i,results:{term:i,definitions:[this.generateBasicDefinition(i)],semantic_relations:[],haqei_associations:[],usage_examples:[],emotional_connotations:[],wisdom_connections:[]},confidence:.2,philosophy:"haqei-fallback"}}},this.interfaceOS={name:"Dictionary Interface OS",formatLookupResult(i){return{query:i.query,summary:{confidence:Math.round(100*i.confidence)+"%",definitions_found:i.results.definitions.length,relations_found:i.results.semantic_relations.length,haqei_relevance:i.results.haqei_associations.length>0?"high":"low"},definitions:this.formatDefinitions(i.results.definitions),relations:this.formatRelations(i.results.semantic_relations),haqei_insights:this.formatHaQeiInsights(i.results.haqei_associations),usage_guide:this.formatUsageGuide(i.results.usage_examples),emotional_profile:this.formatEmotionalProfile(i.results.emotional_connotations),wisdom_teachings:this.formatWisdomTeachings(i.results.wisdom_connections)}},formatDefinitions(i){return i.map(i=>({source:this.formatSourceName(i.source),definition:i.definition,additional_info:this.extractAdditionalInfo(i)}))},formatSourceName:i=>({haqei_philosophy:"📚 HaQei哲学辞書",iching_terms:"☯️ 易経用語辞書",emotional_lexicon:"💭 感情語彙辞書",generated:"🔍 自動生成"}[i]||`📖 ${i}`),extractAdditionalInfo(i){const e={};return i.principles&&(e.principles=i.principles),i.applications&&(e.applications=i.applications),i.hexagram&&(e.hexagram=i.hexagram),i.trigram&&(e.trigram=i.trigram),e},formatRelations(i){return i.slice(0,10).map(i=>({type:this.formatRelationType(i.type),term:i.term,strength:Math.round(100*i.strength)+"%"}))},formatRelationType:i=>({synonym:"🔄 同義語",antonym:"↔️ 対義語",hypernym:"⬆️ 上位語",hyponym:"⬇️ 下位語",meronym:"🧩 部分語",holonym:"🏢 全体語"}[i]||`🔗 ${i}`),formatHaQeiInsights(i){return i.map(i=>({principle:this.formatPrincipleName(i.principle),connection:i.connection,description:i.description,application:i.practical_application}))},formatPrincipleName:i=>({harmony:"🤝 調和",compassion:"💖 慈悲",wisdom:"🧠 智慧",authenticity:"✨ 真実"}[i]||`🔷 ${i}`),formatUsageGuide:i=>({total_examples:i.length,sample_usage:i.slice(0,3).map(i=>({text:i.text,context:i.context,type:i.usage_type}))}),formatEmotionalProfile(i){if(0===i.length)return null;const e=i[0];return{valence:e.valence,arousal:e.arousal,dominance:e.dominance,primary_emotions:e.primary_emotions||[],secondary_emotions:e.secondary_emotions||[]}},formatWisdomTeachings:i=>i.slice(0,3).map(i=>({tradition:i.wisdom_tradition,teaching:i.teaching,application:i.application,relevance:Math.round(100*i.relevance_score)+"%"}))},this.safeMode={name:"Dictionary Safe Mode OS",active:!1,activate(){return console.log("🛡️ DictionaryManager Safe Mode activated"),this.active=!0,{basic_lookup:!0,advanced_features:!1,philosophy:"haqei-safe"}},performSafeLookup:i=>({query:i,results:{term:i,definitions:[{source:"safe_mode",definition:`「${i}」の基本的な概念`,note:"Safe Mode実行中 - 詳細な辞書機能は利用できません"}],semantic_relations:[],haqei_associations:[],usage_examples:[],emotional_connotations:[],wisdom_connections:[]},confidence:.1,philosophy:"haqei-safe"})},console.log("✅ Triple OS Architecture setup complete")},async loadHaQeiDictionaries(){console.log("📖 Loading HaQei dictionaries..."),this.dictionaries.haqei_philosophy=new Map([["調和",{definition:"異なる要素が統合され、バランスの取れた状態",principles:["unity","balance","cooperation"],applications:["conflict_resolution","team_building","personal_growth"]}],["慈悲",{definition:"他者への無条件の愛と思いやり",principles:["compassion","empathy","kindness"],applications:["healing","support","understanding"]}],["智慧",{definition:"深い理解と賢明な判断力",principles:["insight","discernment","understanding"],applications:["decision_making","learning","guidance"]}],["真実",{definition:"偽りのない純粋で自然な状態",principles:["honesty","authenticity","purity"],applications:["communication","self_expression","integrity"]}]]),this.dictionaries.iching_terms=new Map([["乾",{definition:"天・創造的な力・父性原理",hexagram:1,trigram:"乾",classical_meaning:"強健・創造・指導"}],["坤",{definition:"地・受容的な力・母性原理",hexagram:2,trigram:"坤",classical_meaning:"柔順・受容・育成"}],["泰",{definition:"天地交通・平和・調和",hexagram:11,trigram:"坤/乾",classical_meaning:"通泰・繁栄・協力"}]]),this.dictionaries.semantic_relations=new Map([["調和",{synonyms:["平和","バランス","統合","協調"],antonyms:["対立","混乱","不和","分裂"],hypernyms:["状態","関係","概念"],hyponyms:["内的調和","外的調和","社会的調和"],meronyms:["相互理解","協力","バランス"],holonyms:["平和","幸福","成功"]}],["愛",{synonyms:["慈悲","思いやり","愛情","慈愛"],antonyms:["憎しみ","無関心","冷淡"],hypernyms:["感情","心情","精神状態"],hyponyms:["家族愛","友愛","自愛","博愛"],meronyms:["思いやり","共感","理解"],holonyms:["幸福","調和","平和"]}]]),this.dictionaries.emotional_lexicon=new Map([["調和",{valence:"positive",arousal:"medium",dominance:"high",primary_emotions:["peace","satisfaction"],secondary_emotions:["balance","unity"]}],["慈悲",{valence:"positive",arousal:"medium",dominance:"medium",primary_emotions:["love","compassion"],secondary_emotions:["kindness","empathy"]}]]),this.dictionaries.wisdom_patterns=new Map([["調和",[{type:"balance_principle",tradition:"eastern_philosophy",teaching:"中庸の道を歩む",application:"極端を避け、バランスを保つ",relevance:.9},{type:"integration_wisdom",tradition:"haqei_philosophy",teaching:"対立を統合に変える",application:"異なる視点を調和させる",relevance:.95}]],["智慧",[{type:"learning_principle",tradition:"universal_wisdom",teaching:"経験から学ぶ",application:"失敗を成長の機会とする",relevance:.85}]]]),console.log("✅ HaQei dictionaries loaded")},async buildSemanticNetworks(){console.log("🕸️ Building semantic networks..."),this.semanticNetwork={principle_relations:new Map([["調和",["慈悲","智慧","真実"]],["慈悲",["調和","智慧","真実"]],["智慧",["調和","慈悲","真実"]],["真実",["調和","慈悲","智慧"]]]),iching_relations:new Map([["調和",["泰","謙","既済"]],["創造",["乾","震","離"]],["受容",["坤","巽","坎"]]])},console.log("✅ Semantic networks built")},validateDictionaryIntegrity(){console.log("🔍 Validating dictionary integrity...");const i={haqei_philosophy:this.dictionaries.haqei_philosophy?.size||0,iching_terms:this.dictionaries.iching_terms?.size||0,semantic_relations:this.dictionaries.semantic_relations?.size||0,emotional_lexicon:this.dictionaries.emotional_lexicon?.size||0,wisdom_patterns:this.dictionaries.wisdom_patterns?.size||0};this.validationResults=i,console.log("✅ Dictionary integrity validated:",i)},activateSafeMode(){console.log("🛡️ Activating Safe Mode..."),this.safeMode.activate(),this.initialized=!0},async lookupTerm(i,e={}){this.initialized||await this.init();try{if(this.safeMode.active)return this.safeMode.performSafeLookup(i);const n=await this.engineOS.lookupTerm(i,e);return this.interfaceOS.formatLookupResult(n)}catch(n){return console.error("❌ Term lookup failed:",n),this.safeMode.activate(),this.safeMode.performSafeLookup(i)}},async lookupMultipleTerms(i,e={}){const n=[];for(const t of i){const i=await this.lookupTerm(t,e);n.push(i)}return{query_terms:i,results:n,total_found:n.filter(i=>"10%"!==i.summary.confidence).length}},async findSemanticRelations(i,e="all"){if(this.initialized||await this.init(),this.dictionaries.semantic_relations.has(i)){const n=this.dictionaries.semantic_relations.get(i);return"all"===e?n:n[e]||[]}return[]},async findHaQeiRelations(i){this.initialized||await this.init();const e=[];if(this.semanticNetwork?.principle_relations?.has(i)){const n=this.semanticNetwork.principle_relations.get(i);e.push(...n.map(i=>({type:"haqei_principle",term:i})))}return e},getStatus(){return{initialized:this.initialized,safe_mode_active:this.safeMode?.active||!1,dictionaries_loaded:Object.keys(this.dictionaries).length,total_entries:Object.values(this.dictionaries).reduce((i,e)=>i+(e?.size||0),0),validation_results:this.validationResults||{},philosophy:"haqei",architecture:"triple-os"}},getCapabilities(){const i=["basic_lookup"];return this.dictionaries.haqei_philosophy&&i.push("haqei_philosophy_lookup"),this.dictionaries.iching_terms&&i.push("iching_terms_lookup"),this.dictionaries.semantic_relations&&i.push("semantic_relations_search"),this.semanticNetwork&&i.push("semantic_network_analysis"),this.safeMode?.active||i.push("advanced_lookup","emotional_analysis","wisdom_connections"),i}},document.addEventListener("DOMContentLoaded",()=>{window.DictionaryManager.init()}),console.log("✅ DictionaryManager loaded with HaQei Philosophy");