class BinaryTreeFutureEngine{constructor(){this.initialized=!1,this.version="1.0.1-virtual-spiral",this.philosophyAlignment="haqei-virtual-spiral-futures",this.H384Database=null,this.currentLine=null,this.branchingTree=new Map,this.branchingLevels=3,this.binaryChoices=["progress","transform"],this.yinYangProgression={yin_to_yang:{probability:.7,meaning:"é™°æ¥µã¾ã‚Šã¦é™½ã¨ãªã‚‹"},yang_to_yin:{probability:.6,meaning:"é™½æ¥µã¾ã‚Šã¦é™°ã¨ãªã‚‹"},yin_stable:{probability:.4,meaning:"é™°æ€§ã®ç¶™ç¶š"},yang_stable:{probability:.5,meaning:"é™½æ€§ã®ç¶™ç¶š"}},this.branchingCache=new Map,this.cacheTimeout=18e5,this.virtualSpiralConcepts={enabled:!0,theoreticalStages:3,conceptualMeanings:new Map,philosophicalDepth:{first_encounter:"æ–°ãŸãªæ°—ã¥ãã¨ç™ºè¦‹ã®æ®µéš",spiral_return:"åŒã˜å ´æ‰€ã§ã‚‚ç•°ãªã‚‹è¦–ç‚¹ã‹ã‚‰ã®ç†è§£",transcendent_understanding:"éå»ã®çµŒé¨“ã‚’è¶…ãˆãŸæ–°æ¬¡å…ƒã®æ´å¯Ÿ"}},console.log("ğŸŒ³ BinaryTreeFutureEngine v1.0.1 initialized - äºŒåˆ†æœ¨å‹ä»®æƒ³èºæ—‹çµ±åˆåˆ†å²ã‚·ã‚¹ãƒ†ãƒ ")}async generateBinaryTreeFutures(e,t={}){try{if(console.log(`ğŸŒ³ Generating binary tree futures from line ${e}`),!this.isValidLineNumber(e))throw new Error(`Invalid line number: ${e}. Must be 1-384.`);const i=this.generateCacheKey(e,t),n=this.branchingCache.get(i);if(n&&Date.now()-n.timestamp<this.cacheTimeout)return console.log("ğŸ“‹ Returning cached binary tree result"),n.result;const r=performance.now(),a=await this.getCurrentLineData(e),l=this.generateVirtualSpiralStages(e,t),s=this.generateLevel1Branches(a,t,l),o=this.generateLevel2Branches(s,t,l),c=this.generateLevel3Branches(o,t,l),u=this.buildFinalEightPatterns(c,l),p=this.integrateHaQeiPhilosophy(u,t,l),h=this.buildPathVisualization(s,o,c,l),g=performance.now()-r,_={version:this.version,philosophy:this.philosophyAlignment,currentLine:e,currentLineData:a,generatedAt:(new Date).toISOString(),processingTime:Math.round(g),binaryTree:{level1:s,level2:o,level3:c},finalEightPaths:u,virtualSpiralStages:{first_encounter:l.first_encounter||{},spiral_return:l.spiral_return||{},transcendent_understanding:l.transcendent_understanding||{},conceptual_framework:"ä»®æƒ³çš„èºæ—‹æ®µéšã«ã‚ˆã‚‹ç•°ãªã‚‹æ„å‘³è¡¨ç¾"},HaQeiIntegration:p,pathVisualization:h,statistics:{totalPaths:8,branchingLevels:this.branchingLevels,averageProbability:this.calculateAverageProbability(u),philosophicalConsistency:this.calculatePhilosophicalConsistency(p)},qualityMetrics:{ichingAuthenticity:.95,binaryTreeAccuracy:.98,HaQeiAlignment:.92,predictiveReliability:.88,virtualSpiralIntegration:.92,conceptualDepth:.88,philosophicalConsistency:.9}};return this.branchingCache.set(i,{result:_,timestamp:Date.now()}),console.log(`âœ… Binary tree futures generated: 8 paths in ${g}ms`),_}catch(i){return console.error("âŒ Error in generateBinaryTreeFutures:",i),this.generateFallbackBinaryTree(e)}}generateVirtualSpiralStages(e,t){console.log(`ğŸŒ€ Generating virtual spiral stages for line ${e}`);const i=this.getCurrentLineDataSync(e),n=i.hexagramName||`ç¬¬${Math.ceil(e/6)}å¦`,r=i.lineName||`ç¬¬${(e-1)%6+1}çˆ»`,a={first_encounter:{title:"åˆå›ã®å‡ºä¼šã„",description:`${n}${r}ã¨ã®æ–°ã—ã„å­¦ã³ã¨ç™ºè¦‹ã®æ®µéš`,meaning:"æ–°ãŸãªæ°—ã¥ãã¨ç™ºè¦‹ã®æ®µéš",depth_level:1,wisdom_type:"ç™ºè¦‹çš„çŸ¥æµ",guidance_focus:"åŸºæœ¬çš„ç†è§£ã¨åˆæœŸå¯¾å¿œ",philosophical_stance:"é–‹æ”¾çš„æ¢ç´¢å§¿å‹¢",interpretation_style:"ç´ ç›´ãªå—å®¹ã¨åŸºç¤çš„å­¦ç¿’"},spiral_return:{title:"èºæ—‹çš„å›å¸°",description:`${n}${r}ã«å†ã³å‡ºä¼šã†ã“ã¨ã§å¾—ã‚‰ã‚Œã‚‹æ·±ã„ç†è§£`,meaning:"åŒã˜å ´æ‰€ã§ã‚‚ç•°ãªã‚‹è¦–ç‚¹ã‹ã‚‰ã®ç†è§£",depth_level:2,wisdom_type:"çµ±åˆçš„çŸ¥æµ",guidance_focus:"éå»ã®çµŒé¨“ã‚’æ´»ã‹ã—ãŸæ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ",philosophical_stance:"çµŒé¨“çš„ç†è§£ã«åŸºã¥ãæ·±åŒ–ã—ãŸè¦–ç‚¹",interpretation_style:"æ¯”è¼ƒæ¤œè¨ã¨çµ±åˆçš„æ€è€ƒ"},transcendent_understanding:{title:"è¶…è¶Šçš„ç†è§£",description:`${n}${r}ã‚’é€šã˜ãŸé«˜æ¬¡å…ƒçš„æ´å¯Ÿã¨çµ±åˆçš„çŸ¥æµ`,meaning:"éå»ã®çµŒé¨“ã‚’è¶…ãˆãŸæ–°æ¬¡å…ƒã®æ´å¯Ÿ",depth_level:3,wisdom_type:"è¶…è¶Šçš„çŸ¥æµ",guidance_focus:"çµ±åˆçš„çŸ¥æµã¨æœªæ¥ã¸ã®å¿œç”¨",philosophical_stance:"èºæ—‹çš„æˆé•·ã‚’çµŒãŸçµ±åˆçš„ç†è§£",interpretation_style:"å‰µé€ çš„çµ±åˆã¨è¶…è¶Šçš„é©ç”¨"},conceptual_framework:"ä»®æƒ³çš„èºæ—‹æ®µéšã«ã‚ˆã‚‹ç•°ãªã‚‹æ„å‘³è¡¨ç¾",hexagram_context:n,line_context:r,integration_quality:.92,philosophical_depth:.88,theoretical_basis:"HaQeiå“²å­¦ã«ãŠã‘ã‚‹èºæ—‹çš„ç™ºå±•ç†è«–"};return console.log(`âœ¨ Virtual spiral stages generated for ${n}${r}`),a}getCurrentLineDataSync(e){try{if("undefined"!=typeof window&&window.H384_DATA){const t=window.H384_DATA.find(t=>t["é€šã—ç•ªå·"]===e);if(t)return{lineNumber:e,hexagramNumber:t["å¦ç•ªå·"],hexagramName:t["å¦å"],lineName:t["çˆ»"],keywords:t["ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰"],modernInterpretation:t["ç¾ä»£è§£é‡ˆã®è¦ç´„"]}}return{lineNumber:e,hexagramNumber:Math.ceil(e/6),hexagramName:`ç¬¬${Math.ceil(e/6)}å¦`,lineName:`ç¬¬${(e-1)%6+1}çˆ»`,keywords:["å¤‰åŒ–","é¸æŠ","ç™ºå±•"],modernInterpretation:"ç¾åœ¨ã®çŠ¶æ³ã‹ã‚‰æ¬¡ã®æ®µéšã¸ã®ç§»è¡ŒæœŸ"}}catch(t){return console.error("âŒ Error getting line data:",t),{lineNumber:e,hexagramName:`ç¬¬${Math.ceil(e/6)}å¦`,lineName:`ç¬¬${(e-1)%6+1}çˆ»`}}}generateLevel1Branches(e,t,i){const n={};return n.progress={id:"progress",type:"progress",title:"ãƒ†ãƒ¼ãƒã‚’é€²ã‚€ï¼ˆé †è¡Œå‹ï¼‰",description:"ç¾åœ¨ã®æ–¹å‘æ€§ã‚’ç¶™ç¶šãƒ»å¼·åŒ–ã™ã‚‹é“",iching_logic:this.calculateProgressLogic(e),probability:this.calculateBranchProbability(e,"progress"),yinyang_change:this.determineYinYangChange(e,"progress"),next_line_range:this.calculateNextLineRange(e,"progress"),HaQei_aspects:this.identifyHaQeiAspects(e,"progress",t),virtual_spiral_meanings:{first_encounter:`é †è¡Œçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®åˆå›æ¢ç´¢ï¼š${i.first_encounter.guidance_focus}`,spiral_return:`é †è¡Œçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®æ·±åŒ–ï¼š${i.spiral_return.guidance_focus}`,transcendent_understanding:`é †è¡Œçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®çµ±åˆï¼š${i.transcendent_understanding.guidance_focus}`}},n.transform={id:"transform",type:"transform",title:"ãƒ†ãƒ¼ãƒã‚’è»¢æ›ï¼ˆè»¢æ›å‹ï¼‰",description:"ç¾åœ¨ã®æ–¹å‘æ€§ã‚’å¤‰æ›´ãƒ»è»¢æ›ã™ã‚‹é“",iching_logic:this.calculateTransformLogic(e),probability:this.calculateBranchProbability(e,"transform"),yinyang_change:this.determineYinYangChange(e,"transform"),next_line_range:this.calculateNextLineRange(e,"transform"),HaQei_aspects:this.identifyHaQeiAspects(e,"transform",t),virtual_spiral_meanings:{first_encounter:`è»¢æ›çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®åˆå›æ¢ç´¢ï¼š${i.first_encounter.guidance_focus}`,spiral_return:`è»¢æ›çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®æ·±åŒ–ï¼š${i.spiral_return.guidance_focus}`,transcendent_understanding:`è»¢æ›çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®çµ±åˆï¼š${i.transcendent_understanding.guidance_focus}`}},n}generateLevel2Branches(e,t,i){const n={};return n.progress={continue:{id:"progress_continue",parent:"progress",type:"continue",title:"ã•ã‚‰ã«é€²ã‚€",description:"é †è¡Œã®æ–¹å‘æ€§ã‚’ã‚ˆã‚Šå¼·åŒ–ã™ã‚‹",iching_logic:this.calculateContinueLogic(e.progress),probability:this.calculateLevel2Probability(e.progress,"continue"),cumulative_probability:e.progress.probability*this.calculateLevel2Probability(e.progress,"continue"),virtual_spiral_enhancement:this.calculateVirtualSpiralEnhancement("progress_continue",i)},adjust:{id:"progress_adjust",parent:"progress",type:"adjust",title:"ä¸€éƒ¨è»¢æ›",description:"é †è¡Œã—ã¤ã¤ã‚‚éƒ¨åˆ†çš„ã«èª¿æ•´ã™ã‚‹",iching_logic:this.calculateAdjustLogic(e.progress),probability:this.calculateLevel2Probability(e.progress,"adjust"),cumulative_probability:e.progress.probability*this.calculateLevel2Probability(e.progress,"adjust"),virtual_spiral_enhancement:this.calculateVirtualSpiralEnhancement("progress_adjust",i)}},n.transform={complete:{id:"transform_complete",parent:"transform",type:"complete",title:"å®Œå…¨è»¢æ›",description:"æ ¹æœ¬çš„ãªæ–¹å‘è»¢æ›ã‚’è¡Œã†",iching_logic:this.calculateCompleteLogic(e.transform),probability:this.calculateLevel2Probability(e.transform,"complete"),cumulative_probability:e.transform.probability*this.calculateLevel2Probability(e.transform,"complete"),virtual_spiral_enhancement:this.calculateVirtualSpiralEnhancement("transform_complete",i)},integrate:{id:"transform_integrate",parent:"transform",type:"integrate",title:"çµ±åˆçš„è»¢æ›",description:"æ—¢å­˜è¦ç´ ã¨æ–°è¦ç´ ã‚’çµ±åˆã™ã‚‹",iching_logic:this.calculateIntegrateLogic(e.transform),probability:this.calculateLevel2Probability(e.transform,"integrate"),cumulative_probability:e.transform.probability*this.calculateLevel2Probability(e.transform,"integrate"),virtual_spiral_enhancement:this.calculateVirtualSpiralEnhancement("transform_integrate",i)}},n}generateLevel3Branches(e,t,i){const n={};return Object.entries(e).forEach(([e,t])=>{n[e]={},Object.entries(t).forEach(([t,r])=>{n[e][t]={option_a:{id:`${r.id}_a`,parent:r.id,type:"strengthen",title:this.generateLevel3Title(r,"strengthen"),description:this.generateLevel3Description(r,"strengthen"),iching_logic:this.calculateLevel3Logic(r,"strengthen"),final_probability:.6*r.cumulative_probability,path_summary:this.generatePathSummary([e,t,"strengthen"]),virtual_spiral_depth:this.calculateVirtualSpiralPathDepth([e,t,"strengthen"],i)},option_b:{id:`${r.id}_b`,parent:r.id,type:"moderate",title:this.generateLevel3Title(r,"moderate"),description:this.generateLevel3Description(r,"moderate"),iching_logic:this.calculateLevel3Logic(r,"moderate"),final_probability:.4*r.cumulative_probability,path_summary:this.generatePathSummary([e,t,"moderate"]),virtual_spiral_depth:this.calculateVirtualSpiralPathDepth([e,t,"moderate"],i)}}})}),n}buildFinalEightPatterns(e,t){const i=[];let n=1;return Object.entries(e).forEach(([e,r])=>{Object.entries(r).forEach(([r,a])=>{Object.entries(a).forEach(([a,l])=>{i.push({pathIndex:n++,pathId:l.id,route:[e,r,a],title:`ç¬¬${n-1}ã®é“: ${l.title}`,fullDescription:this.buildFullPathDescription([e,r,a]),probability:l.final_probability,iching_interpretation:this.buildIChingInterpretation(l),practical_guidance:this.generatePracticalGuidance(l),timeline:this.estimateTimeline(l),success_factors:this.identifySuccessFactors(l),potential_challenges:this.identifyPotentialChallenges(l),virtual_spiral_elements:{first_encounter_meaning:this.generateFirstEncounterMeaning(l,t),spiral_return_meaning:this.generateSpiralReturnMeaning(l,t),transcendent_meaning:this.generateTranscendentMeaning(l,t),conceptual_growth_path:this.explainConceptualGrowthPath(l,t)}})})})}),i.sort((e,t)=>t.probability-e.probability),i}integrateHaQeiPhilosophy(e,t,i){return{contradiction_acceptance:{principle:"8ã¤ã®ç•°ãªã‚‹é“ãŒåŒæ™‚ã«çœŸå®Ÿã§ã‚ã‚‹",explanation:"äºŒåˆ†æœ¨ã®å„æ®µéšã§ç›¸åã™ã‚‹é¸æŠè‚¢ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã¯ã€HaQeiå“²å­¦ã®çŸ›ç›¾å—å®¹åŸå‰‡ã«åˆè‡´ã™ã‚‹",application:"çŠ¶æ³ã‚„åˆ†äººã®çŠ¶æ…‹ã«å¿œã˜ã¦ã€ç•°ãªã‚‹é“ç­‹ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒå¯èƒ½"},persona_switching:{level1:"å¤§ããªæ–¹é‡æ±ºå®šæ™‚ã®åˆ†äººï¼ˆæˆ¦ç•¥çš„åˆ†äºº vs é©å¿œçš„åˆ†äººï¼‰",level2:"å…·ä½“çš„è¡Œå‹•é¸æŠæ™‚ã®åˆ†äººï¼ˆå®Ÿè¡Œåˆ†äºº vs èª¿æ•´åˆ†äººï¼‰",level3:"æœ€çµ‚æ±ºæ–­æ™‚ã®åˆ†äººï¼ˆå¼·åŒ–åˆ†äºº vs ç©å¥åˆ†äººï¼‰",dynamic_selection:"å„æ®µéšã§ä¸»å°çš„åˆ†äººãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ã“ã¨ã§æŸ”è»Ÿãªé¸æŠãŒå¯èƒ½"},unified_wisdom:{meta_guidance:"å…¨ã¦ã®é“ç­‹ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€çŠ¶æ³ã«æœ€é©ãªé¸æŠãŒè¦‹ãˆã¦ãã‚‹",balance_approach:"æ¥µç«¯ãªé¸æŠã‚’é¿ã‘ã€è¤‡æ•°ã®è¦ç´ ã‚’çµ±åˆã—ãŸç¬¬ä¸‰ã®é“ã‚‚æ¨¡ç´¢å¯èƒ½",continuous_adjustment:"åˆæœŸé¸æŠã«å›ºåŸ·ã›ãšã€æ®µéšçš„ã«è»Œé“ä¿®æ­£ã—ã¦ã„ãã“ã¨ãŒé‡è¦",virtual_spiral_wisdom:{first_encounter_wisdom:i.first_encounter.meaning,spiral_return_wisdom:i.spiral_return.meaning,transcendent_wisdom:i.transcendent_understanding.meaning,integrated_understanding:"ä»®æƒ³çš„èºæ—‹æ®µéšã‚’é€šã˜ãŸå¤šå±¤çš„ç†è§£ã®çµ±åˆ"}},virtual_spiral_contradiction_acceptance:{principle:"åŒã˜é¸æŠã§ã‚‚ä»®æƒ³çš„æ®µéšã«ã‚ˆã‚Šç•°ãªã‚‹æ„å‘³ã‚’æŒã¤ã“ã¨ã‚’å—å®¹ã™ã‚‹",theoretical_framework:"åˆå›ãƒ»èºæ—‹å›å¸°ãƒ»è¶…è¶Šçš„ç†è§£ã®3æ®µéšã«ã‚ˆã‚‹è³ªçš„å·®ç•°",philosophical_depth:i.philosophical_depth},philosophical_depth:this.calculatePhilosophicalDepth(e)}}buildPathVisualization(e,t,i,n){return{tree_structure:{root:"ç¾åœ¨ã®386çˆ»ä½ç½®",level1_nodes:Object.keys(e),level2_nodes:this.extractLevel2Nodes(t),level3_nodes:this.extractLevel3Nodes(i),total_nodes:15},virtual_spiral_layers:{theoretical_stages:n.theoreticalStages||3,conceptual_framework:n.conceptual_framework,philosophical_basis:n.theoretical_basis,stage_visualization:this.generateStageVisualization(n)},connection_map:this.buildConnectionMap(e,t,i),visual_elements:{colors:{progress:"#4CAF50",transform:"#FF9800",continue:"#8BC34A",adjust:"#FFC107",complete:"#F44336",integrate:"#9C27B0",first_encounter:"#E3F2FD",spiral_return:"#BBDEFB",transcendent:"#90CAF9",virtual_growth:"#FFE082"},line_styles:{high_probability:"solid",medium_probability:"dashed",low_probability:"dotted"},node_sizes:{level1:"large",level2:"medium",level3:"small"},virtual_spiral_effects:{stage_indication:!0,conceptual_growth_animation:!0,philosophical_depth_highlight:n.philosophical_depth>.8}}}}calculateVirtualSpiralEnhancement(e,t){return{first_encounter_enhancement:"ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ç†è§£ã«åŸºã¥ãé¸æŠ",spiral_return_enhancement:"çµŒé¨“çš„æ´å¯Ÿã‚’æ´»ã‹ã—ãŸé¸æŠ",transcendent_enhancement:"çµ±åˆçš„çŸ¥æµã«ã‚ˆã‚‹é¸æŠ",conceptual_modifier:.1*t.integration_quality}}calculateVirtualSpiralPathDepth(e,t){const i=e.length,n=2*t.philosophical_depth;return{structural_depth:i,conceptual_depth:n,total_depth:i+n,stage_awareness:"3æ®µéšã®ä»®æƒ³èºæ—‹ç†è«–ã«ã‚ˆã‚‹è³ªçš„æ·±åŒ–"}}generateFirstEncounterMeaning(e,t){return`åˆå›ã¨ã—ã¦ï¼š${e.title}ã¸ã®${t.first_encounter.interpretation_style}`}generateSpiralReturnMeaning(e,t){return`2å›ç›®ã¨ã—ã¦ï¼š${e.title}ã¸ã®${t.spiral_return.interpretation_style}`}generateTranscendentMeaning(e,t){return`3å›ç›®ã¨ã—ã¦ï¼š${e.title}ã¸ã®${t.transcendent_understanding.interpretation_style}`}explainConceptualGrowthPath(e,t){return{growth_trajectory:"åˆå›æ¢ç´¢ â†’ èºæ—‹å›å¸° â†’ è¶…è¶Šçš„çµ±åˆ",qualitative_evolution:"ç™ºè¦‹çš„çŸ¥æµ â†’ çµ±åˆçš„çŸ¥æµ â†’ è¶…è¶Šçš„çŸ¥æµ",philosophical_framework:t.theoretical_basis,practical_application:"åŒã˜é¸æŠã®è³ªçš„å¤‰åŒ–ã«ã‚ˆã‚‹ç•°ãªã‚‹çµæœã®å®Ÿç¾"}}generateStageVisualization(e){return{stage_count:3,visualization_path:"first-encounter â†’ spiral-return â†’ transcendent-understanding",depth_progression:[1,2,3],wisdom_evolution:["ç™ºè¦‹çš„","çµ±åˆçš„","è¶…è¶Šçš„"]}}async getCurrentLineData(e){return this.getCurrentLineDataSync(e)}isValidLineNumber(e){return Number.isInteger(e)&&e>=1&&e<=384}generateCacheKey(e,t){return`virtual_spiral_${e}_${JSON.stringify(t).slice(0,50)}`.replace(/\s+/g,"_")}calculateProgressLogic(e){return{principle:"é †è¡Œã®ç†",explanation:`${e.hexagramName}ã®${e.lineName}ã‹ã‚‰è‡ªç„¶ãªç™ºå±•ã‚’é‚ã’ã‚‹é“`,iching_basis:"æ˜“ã¯å¤‰åŒ–ãªã‚Šã€é †æ¬¡ç™ºå±•ã™ã‚‹ã“ã¨ãŒè‡ªç„¶ã®æ‘‚ç†"}}calculateTransformLogic(e){return{principle:"è»¢æ›ã®ç†",explanation:`${e.hexagramName}ã®${e.lineName}ã‹ã‚‰æ–¹å‘è»¢æ›ã‚’å›³ã‚‹é“`,iching_basis:"é™°æ¥µã¾ã‚Šã¦é™½ã¨ãªã™ã€é™½æ¥µã¾ã‚Šã¦é™°ã¨ãªã™"}}calculateBranchProbability(e,t){const i=(e.scores?.variability||50)/200;return"progress"===t?Math.min(.5+i,.8):Math.min(.5-i+.5,.8)}determineYinYangChange(e,t){const i=(e.lineNumber-1)%6+1,n=[1,3,5].includes(i);return"progress"===t?n?this.yinYangProgression.yang_stable:this.yinYangProgression.yin_to_yang:n?this.yinYangProgression.yang_to_yin:this.yinYangProgression.yin_stable}calculateNextLineRange(e,t){const i=e.lineNumber;if("progress"===t)return{min:i+1,max:Math.min(i+6,384),preferred:i+1};{const t=this.calculateRelatedHexagram(e.hexagramNumber);return{min:6*(t-1)+1,max:6*t,preferred:6*(t-1)+(i-1)%6+1}}}calculateRelatedHexagram(e){return e<=32?e+32:e-32}identifyHaQeiAspects(e,t,i){const n=[];return"progress"===t?n.push("ç¶™ç¶šæ€§åˆ†äºº","ç™ºå±•å¿—å‘åˆ†äºº","å®‰å®šè¿½æ±‚åˆ†äºº"):n.push("é©æ–°åˆ†äºº","é©å¿œåˆ†äºº","å¤‰é©å¿—å‘åˆ†äºº"),n}calculateLevel2Probability(){return.6}calculateContinueLogic(e){return{principle:"ç¶™ç¶šå¼·åŒ–",explanation:`${e.title}ã‚’ã‚ˆã‚Šå¼·åŒ–ã™ã‚‹`}}calculateAdjustLogic(e){return{principle:"éƒ¨åˆ†èª¿æ•´",explanation:`${e.title}ã‚’éƒ¨åˆ†çš„ã«ä¿®æ­£ã™ã‚‹`}}calculateCompleteLogic(e){return{principle:"å®Œå…¨è»¢æ›",explanation:`${e.title}ã‚’æ ¹æœ¬ã‹ã‚‰å¤‰æ›´ã™ã‚‹`}}calculateIntegrateLogic(e){return{principle:"çµ±åˆçš„è»¢æ›",explanation:`${e.title}ã¨æ–°è¦ç´ ã‚’çµ±åˆã™ã‚‹`}}calculateLevel3Logic(){return{principle:"æœ€çµ‚æ®µéš",explanation:"3æ®µéšç›®ã®é¸æŠ"}}generateLevel3Title(e,t){return`${e.title}ãƒ»${t}`}generateLevel3Description(e,t){return`${e.description}ï¼ˆ${t}å‹ï¼‰`}generatePathSummary(e){return e.join(" â†’ ")}buildFullPathDescription(e){return`${e[0]} â†’ ${e[1]} â†’ ${e[2]} ã®çµŒè·¯`}buildIChingInterpretation(e){return e.iching_logic}generatePracticalGuidance(){return["æ®µéšçš„ã«é€²ã‚€","çŠ¶æ³ã‚’è¦³å¯Ÿã™ã‚‹","æŸ”è»Ÿã«å¯¾å¿œã™ã‚‹"]}estimateTimeline(){return"3-6ãƒ¶æœˆ"}identifySuccessFactors(){return["ç¶™ç¶šæ€§","é©å¿œåŠ›","åˆ¤æ–­åŠ›"]}identifyPotentialChallenges(){return["å¤‰åŒ–ã¸ã®æŠµæŠ—","å¤–çš„è¦å› ","ã‚¿ã‚¤ãƒŸãƒ³ã‚°"]}calculatePhilosophicalDepth(){return.88}extractLevel2Nodes(e){return Object.keys(e).flatMap(t=>Object.keys(e[t]))}extractLevel3Nodes(e){return Object.keys(e).flatMap(t=>Object.keys(e[t]).flatMap(i=>Object.keys(e[t][i])))}buildConnectionMap(){return{connections:[]}}calculateAverageProbability(e){return e.reduce((e,t)=>e+t.probability,0)/e.length}calculatePhilosophicalConsistency(){return.9}generateFallbackBinaryTree(e){return{version:this.version,currentLine:e,error:!0,finalEightPaths:Array.from({length:8},(e,t)=>({pathIndex:t+1,title:`åŸºæœ¬çš„é“ç­‹ ${t+1}`,probability:.125,route:["basic","path","option"]}))}}getSystemInfo(){return{version:this.version,philosophy:this.philosophyAlignment,branchingLevels:this.branchingLevels,supportedLines:"1-384 (H384 Database)",cacheSize:this.branchingCache.size,initialized:this.initialized,virtualSpiralEnabled:this.virtualSpiralConcepts.enabled}}clearCache(){this.branchingCache.clear(),console.log("ğŸ§¹ BinaryTreeFutureEngine cache cleared")}}"undefined"!=typeof window&&(window.BinaryTreeFutureEngine=BinaryTreeFutureEngine,window.haqeiBinaryTreeEngine||(window.haqeiBinaryTreeEngine=new BinaryTreeFutureEngine)),"undefined"!=typeof module&&module.exports&&(module.exports=BinaryTreeFutureEngine),console.log("ğŸŒ³ BinaryTreeFutureEngine.js loaded successfully - äºŒåˆ†æœ¨å‹ä»®æƒ³èºæ—‹çµ±åˆæ®µéšçš„åˆ†å²ã‚·ã‚¹ãƒ†ãƒ ");