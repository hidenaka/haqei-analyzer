/**
 * HAQEIÁµ±‰∏Ä„Ç®„É©„Éº„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà„Ç®„É≥„Ç∏„É≥ v2.0.0
 * Êó¢Â≠ò„Ç∑„Çπ„ÉÜ„É†„Å®„ÅÆÂÆåÂÖ®Áµ±Âêà„Å®ÂæåÊñπ‰∫íÊèõÊÄß‰øùË®º
 * 
 * ‰∏ªË¶ÅÊ©üËÉΩ:
 * - Êó¢Â≠òErrorHandler„Å®„ÅÆÁµ±Âêà
 * - ÂÖ®HAQEI„Ç∑„Çπ„ÉÜ„É†„Å®„ÅÆÈÄ£Êê∫
 * - „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©ÂåñÁµ±Âêà
 * - Âì≤Â≠¶ÁöÑ„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
 * 
 * @version 2.0.0
 * @author HAQEI Development Team
 * @philosophy bunenjin Triple OS
 */

class UnifiedErrorSystemIntegrator {
    constructor() {
        this.version = "2.0.0";
        this.philosophy = "bunenjin-triple-os-integration";
        
        this.integrationStatus = {
            core: false,
            ui: false,
            philosophy: false,
            performance: false,
            legacy: false
        };
        
        this.errorHandlerInstance = null;
        this.integrationLog = [];
        
        this.initialize();
    }

    /**
     * Áµ±Âêà„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ
     */
    async initialize() {
        console.log("üîß HAQEI Unified Error System Integrator v2.0.0 starting...");
        
        try {
            // Step 1: „Ç≥„Ç¢„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
            await this.integrateCore();
            
            // Step 2: UIÁµ±Âêà
            await this.integrateUI();
            
            // Step 3: Âì≤Â≠¶ÁöÑ„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
            await this.integratePhilosophy();
            
            // Step 4: „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁµ±Âêà
            await this.integratePerformance();
            
            // Step 5: „É¨„Ç¨„Ç∑„ÉºÁµ±Âêà
            await this.integrateLegacySystems();
            
            // Step 6: „Ç∞„É≠„Éº„Éê„É´Áµ±Âêà
            await this.setupGlobalIntegration();
            
            console.log("‚úÖ HAQEI Unified Error System Integration completed successfully");
            this.logIntegration("‚úÖ Full system integration completed", "success");
            
        } catch (error) {
            console.error("‚ùå Integration failed:", error);
            this.logIntegration(`‚ùå Integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * „Ç≥„Ç¢„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    async integrateCore() {
        try {
            console.log("üöÄ Integrating core error handling systems...");
            
            // Check if UnifiedErrorHandler is available
            if (typeof UnifiedErrorHandler !== 'undefined') {
                this.errorHandlerInstance = new UnifiedErrorHandler({
                    uiContainerId: 'haqei-unified-error-container',
                    performanceThreshold: 10,
                    memoryThreshold: 10485760,
                    throughputTarget: 1000,
                    enablePhilosophicalGuidance: true,
                    enableTripleOS: true,
                    enableRealTimeMonitoring: true
                });
                
                this.integrationStatus.core = true;
                this.logIntegration("Core error handler integrated", "success");
            } else {
                throw new Error("UnifiedErrorHandler not available");
            }
            
        } catch (error) {
            this.logIntegration(`Core integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * UIÁµ±Âêà
     */
    async integrateUI() {
        try {
            console.log("üé® Integrating UI systems...");
            
            // Create unified error container
            this.createUnifiedErrorContainer();
            
            // Integrate CSS
            this.integrateErrorHandlingCSS();
            
            // Setup UI event handlers
            this.setupUIEventHandlers();
            
            this.integrationStatus.ui = true;
            this.logIntegration("UI systems integrated", "success");
            
        } catch (error) {
            this.logIntegration(`UI integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * Âì≤Â≠¶ÁöÑ„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    async integratePhilosophy() {
        try {
            console.log("üîÆ Integrating philosophical systems...");
            
            // bunenjin philosophy integration
            this.integrateBunenjinPhilosophy();
            
            // I Ching integration
            this.integrateIChingSystem();
            
            // Triple OS integration
            this.integrateTripleOSSystem();
            
            this.integrationStatus.philosophy = true;
            this.logIntegration("Philosophical systems integrated", "success");
            
        } catch (error) {
            this.logIntegration(`Philosophy integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁµ±Âêà
     */
    async integratePerformance() {
        try {
            console.log("‚ö° Integrating performance systems...");
            
            // Performance monitoring
            this.setupPerformanceMonitoring();
            
            // Memory optimization
            this.setupMemoryOptimization();
            
            // Real-time metrics
            this.setupRealtimeMetrics();
            
            this.integrationStatus.performance = true;
            this.logIntegration("Performance systems integrated", "success");
            
        } catch (error) {
            this.logIntegration(`Performance integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * „É¨„Ç¨„Ç∑„Éº„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    async integrateLegacySystems() {
        try {
            console.log("üîÑ Integrating legacy systems...");
            
            // Backward compatibility for existing ErrorHandler
            this.setupBackwardCompatibility();
            
            // Legacy error format support
            this.setupLegacyErrorFormatSupport();
            
            // Migration path for existing implementations
            this.setupMigrationSupport();
            
            this.integrationStatus.legacy = true;
            this.logIntegration("Legacy systems integrated", "success");
            
        } catch (error) {
            this.logIntegration(`Legacy integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * „Ç∞„É≠„Éº„Éê„É´Áµ±Âêà„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
     */
    async setupGlobalIntegration() {
        try {
            console.log("üåê Setting up global integration...");
            
            // Global error handlers
            this.setupGlobalErrorHandlers();
            
            // Window object integration
            this.setupWindowIntegration();
            
            // Event system integration
            this.setupEventSystemIntegration();
            
            // Module system integration
            this.setupModuleSystemIntegration();
            
            this.logIntegration("Global integration completed", "success");
            
        } catch (error) {
            this.logIntegration(`Global integration failed: ${error.message}`, "error");
            throw error;
        }
    }

    /**
     * Áµ±‰∏Ä„Ç®„É©„Éº„Ç≥„É≥„ÉÜ„Éä‰ΩúÊàê
     */
    createUnifiedErrorContainer() {
        let container = document.getElementById('haqei-unified-error-container');
        
        if (!container) {
            container = document.createElement('div');
            container.id = 'haqei-unified-error-container';
            container.className = 'haqei-unified-error-container';
            container.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 999999;
                pointer-events: none;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            `;
            
            document.body.appendChild(container);
        }
        
        return container;
    }

    /**
     * „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞CSSÁµ±Âêà
     */
    integrateErrorHandlingCSS() {
        const existingStyles = document.getElementById('haqei-error-handling-styles');
        
        if (!existingStyles) {
            const link = document.createElement('link');
            link.id = 'haqei-error-handling-styles';
            link.rel = 'stylesheet';
            link.href = 'css/error-handling.css';
            document.head.appendChild(link);
        }
    }

    /**
     * UI„Ç§„Éô„É≥„Éà„Éè„É≥„Éâ„É©„ÉºË®≠ÂÆö
     */
    setupUIEventHandlers() {
        // Custom error events
        window.addEventListener('haqei-error', (event) => {
            if (this.errorHandlerInstance) {
                this.errorHandlerInstance.handleError(
                    event.detail.error,
                    event.detail.context,
                    event.detail.details,
                    event.detail.options
                );
            }
        });

        // Recovery events
        window.addEventListener('haqei-error-recovery', (event) => {
            if (this.errorHandlerInstance) {
                this.logIntegration(`Recovery requested for: ${event.detail.error?.message}`, "info");
            }
        });

        // Retry events
        window.addEventListener('haqei-error-retry', (event) => {
            if (this.errorHandlerInstance) {
                this.logIntegration(`Retry requested for: ${event.detail.error?.message}`, "info");
            }
        });
    }

    /**
     * bunenjinÂì≤Â≠¶Áµ±Âêà
     */
    integrateBunenjinPhilosophy() {
        // Persona balance monitoring
        if (this.errorHandlerInstance) {
            this.errorHandlerInstance.bunenjinPersonas = {
                analyticalSelf: { weight: 0.4, approach: 'logical_analysis' },
                intuitiveSelf: { weight: 0.3, approach: 'spiritual_guidance' },
                socialSelf: { weight: 0.3, approach: 'user_empathy' }
            };
        }

        // Philosophy validation
        this.validatePhilosophicalAlignment = () => {
            return {
                bunenjin: true,
                tripleOS: true,
                iching: true,
                overall: true
            };
        };
    }

    /**
     * ÊòìÁµå„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    integrateIChingSystem() {
        // Hexagram mapping for errors
        this.hexagramErrorMapping = {
            network: 5,  // Ê∞¥Â§©ÈúÄ - ÂæÖÊ©ü„ÅÆÊô∫ÊÖß
            memory: 2,   // Âù§ÁÇ∫Âú∞ - ÂèóÂÆπ„Å®ÂåÖÂÆπ
            ui: 30,      // Èõ¢ÁÇ∫ÁÅ´ - ÊòéÊô∞„Åï
            validation: 15, // Âú∞Â±±Ë¨ô - Ë¨ôËôö„Å®Ë™øÊï¥
            system: 3,   // Ê∞¥Èõ∑Â±Ø - Âõ∞Èõ£„ÅÆÂßã„Åæ„Çä
            philosophy: 32 // Èõ∑È¢®ÊÅí - ÊåÅÁ∂öÊÄß
        };

        // Guidance system
        this.generateIChingGuidance = (errorType) => {
            const hexagram = this.hexagramErrorMapping[errorType] || 1;
            return this.getHexagramGuidance(hexagram);
        };
    }

    /**
     * Triple OS„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    integrateTripleOSSystem() {
        this.tripleOSIntegration = {
            engineOS: {
                role: "Core error processing",
                processor: (error) => this.processInEngineOS(error)
            },
            interfaceOS: {
                role: "User error communication",
                processor: (error) => this.processInInterfaceOS(error)
            },
            safeModeOS: {
                role: "System protection",
                processor: (error) => this.processInSafeModeOS(error)
            }
        };
    }

    /**
     * „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁõ£Ë¶ñË®≠ÂÆö
     */
    setupPerformanceMonitoring() {
        this.performanceMonitor = {
            startTime: Date.now(),
            metrics: {
                errorCount: 0,
                averageResponseTime: 0,
                memoryUsage: 0,
                throughput: 0
            },
            
            recordError: (responseTime) => {
                this.performanceMonitor.metrics.errorCount++;
                this.performanceMonitor.metrics.averageResponseTime = 
                    (this.performanceMonitor.metrics.averageResponseTime + responseTime) / 2;
                
                if (performance.memory) {
                    this.performanceMonitor.metrics.memoryUsage = performance.memory.usedJSHeapSize;
                }
                
                const timeElapsed = (Date.now() - this.performanceMonitor.startTime) / 1000;
                this.performanceMonitor.metrics.throughput = 
                    this.performanceMonitor.metrics.errorCount / timeElapsed;
            }
        };
    }

    /**
     * „É°„É¢„É™ÊúÄÈÅ©ÂåñË®≠ÂÆö
     */
    setupMemoryOptimization() {
        this.memoryOptimizer = {
            threshold: 10485760, // 10MB
            
            checkMemory: () => {
                if (performance.memory) {
                    const used = performance.memory.usedJSHeapSize;
                    if (used > this.memoryOptimizer.threshold) {
                        this.memoryOptimizer.optimize();
                    }
                }
            },
            
            optimize: () => {
                // Trigger garbage collection if available
                if (window.gc) {
                    window.gc();
                }
                
                // Clear caches
                if (this.errorHandlerInstance) {
                    this.errorHandlerInstance.compressErrorHistory();
                }
            }
        };

        // Periodic memory check
        setInterval(() => {
            this.memoryOptimizer.checkMemory();
        }, 30000);
    }

    /**
     * „É™„Ç¢„É´„Çø„Ç§„É†„É°„Éà„É™„ÇØ„ÇπË®≠ÂÆö
     */
    setupRealtimeMetrics() {
        this.metricsUpdateInterval = setInterval(() => {
            this.updateRealtimeMetrics();
        }, 5000);
    }

    /**
     * ÂæåÊñπ‰∫íÊèõÊÄßË®≠ÂÆö
     */
    setupBackwardCompatibility() {
        // Legacy ErrorHandler compatibility
        if (!window.ErrorHandler && this.errorHandlerInstance) {
            window.ErrorHandler = function(containerId) {
                console.warn("‚ö†Ô∏è Using legacy ErrorHandler constructor. Consider migrating to UnifiedErrorHandler.");
                return new UnifiedErrorHandler({ uiContainerId: containerId || 'error-container' });
            };
        }

        // Legacy method aliases
        if (this.errorHandlerInstance) {
            // Alias for legacy methods
            this.errorHandlerInstance.displayError = this.errorHandlerInstance.displayErrorWithUI;
            this.errorHandlerInstance.showNotification = this.errorHandlerInstance.showPhilosophicalNotification;
        }
    }

    /**
     * „É¨„Ç¨„Ç∑„Éº„Ç®„É©„Éº„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Çµ„Éù„Éº„Éà
     */
    setupLegacyErrorFormatSupport() {
        this.convertLegacyError = (legacyError) => {
            // Convert old error format to new format
            return {
                error: legacyError.error || new Error(legacyError.message || 'Unknown error'),
                context: legacyError.context || 'Legacy Error',
                details: legacyError.details || {},
                options: {
                    legacy: true,
                    originalFormat: legacyError
                }
            };
        };
    }

    /**
     * „Ç∞„É≠„Éº„Éê„É´„Ç®„É©„Éº„Éè„É≥„Éâ„É©„ÉºË®≠ÂÆö
     */
    setupGlobalErrorHandlers() {
        // Enhanced global error handler
        window.addEventListener('error', (event) => {
            if (this.errorHandlerInstance) {
                this.errorHandlerInstance.handleError(
                    event.error || new Error(event.message),
                    '„Ç∞„É≠„Éº„Éê„É´„Ç®„É©„Éº',
                    {
                        filename: event.filename,
                        lineno: event.lineno,
                        colno: event.colno,
                        stack: event.error?.stack
                    }
                );
            }
        });

        // Enhanced unhandled rejection handler
        window.addEventListener('unhandledrejection', (event) => {
            if (this.errorHandlerInstance) {
                const error = event.reason instanceof Error ? 
                    event.reason : new Error(String(event.reason));
                
                this.errorHandlerInstance.handleError(
                    error,
                    'Êú™Âá¶ÁêÜ„ÅÆPromiseÊãíÂê¶',
                    { promise: event.promise }
                );
            }
        });
    }

    /**
     * Window„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÁµ±Âêà
     */
    setupWindowIntegration() {
        // Make unified error handler globally available
        window.HAQEIErrorSystem = {
            handler: this.errorHandlerInstance,
            integrator: this,
            version: this.version,
            
            // Public API
            handleError: (error, context, details, options) => {
                if (this.errorHandlerInstance) {
                    return this.errorHandlerInstance.handleError(error, context, details, options);
                }
            },
            
            getStatistics: () => {
                if (this.errorHandlerInstance) {
                    return this.errorHandlerInstance.getEnhancedStatistics();
                }
                return null;
            },
            
            getIntegrationStatus: () => {
                return this.integrationStatus;
            },
            
            getIntegrationLog: () => {
                return this.integrationLog;
            }
        };
    }

    /**
     * „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    setupEventSystemIntegration() {
        // Custom event dispatcher for HAQEI error system
        this.eventDispatcher = {
            dispatch: (eventName, data) => {
                const event = new CustomEvent(eventName, { detail: data });
                window.dispatchEvent(event);
            },
            
            on: (eventName, handler) => {
                window.addEventListener(eventName, handler);
            },
            
            off: (eventName, handler) => {
                window.removeEventListener(eventName, handler);
            }
        };

        // Make it globally available
        window.HAQEIEvents = this.eventDispatcher;
    }

    /**
     * „É¢„Ç∏„É•„Éº„É´„Ç∑„Çπ„ÉÜ„É†Áµ±Âêà
     */
    setupModuleSystemIntegration() {
        // CommonJS/Node.js support
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = {
                UnifiedErrorHandler: this.errorHandlerInstance?.constructor,
                HAQEIErrorManager: typeof HAQEIErrorManager !== 'undefined' ? HAQEIErrorManager : null,
                ErrorDisplayUI: typeof ErrorDisplayUI !== 'undefined' ? ErrorDisplayUI : null,
                UnifiedErrorSystemIntegrator: UnifiedErrorSystemIntegrator
            };
        }

        // AMD support
        if (typeof define === 'function' && define.amd) {
            define('haqei-unified-error-system', [], () => {
                return {
                    UnifiedErrorHandler: this.errorHandlerInstance?.constructor,
                    HAQEIErrorManager: typeof HAQEIErrorManager !== 'undefined' ? HAQEIErrorManager : null,
                    ErrorDisplayUI: typeof ErrorDisplayUI !== 'undefined' ? ErrorDisplayUI : null,
                    UnifiedErrorSystemIntegrator: UnifiedErrorSystemIntegrator
                };
            });
        }
    }

    // ============ Helper Methods ============

    /**
     * Áµ±Âêà„É≠„Ç∞Ë®òÈå≤
     */
    logIntegration(message, type = 'info') {
        const logEntry = {
            timestamp: new Date().toISOString(),
            message: message,
            type: type
        };
        
        this.integrationLog.push(logEntry);
        
        const prefix = {
            success: '‚úÖ',
            error: '‚ùå',
            warning: '‚ö†Ô∏è',
            info: '‚ÑπÔ∏è'
        }[type] || '‚ÑπÔ∏è';
        
        console.log(`${prefix} [HAQEI Integration] ${message}`);
    }

    /**
     * „É™„Ç¢„É´„Çø„Ç§„É†„É°„Éà„É™„ÇØ„ÇπÊõ¥Êñ∞
     */
    updateRealtimeMetrics() {
        if (this.performanceMonitor && this.errorHandlerInstance) {
            const stats = this.errorHandlerInstance.getEnhancedStatistics();
            
            // Dispatch metrics update event
            this.eventDispatcher.dispatch('haqei-metrics-update', {
                performance: this.performanceMonitor.metrics,
                system: stats,
                integration: this.integrationStatus
            });
        }
    }

    /**
     * ÊòìÁµå„Ç¨„Ç§„ÉÄ„É≥„ÇπÂèñÂæó
     */
    getHexagramGuidance(hexagramNumber) {
        const guidanceDatabase = {
            1: { name: "‰πæÁÇ∫Â§©", symbol: "‚ò∞", guidance: "ÂâµÈÄ†Âäõ„Å®Ë°åÂãïÂäõ„ÅßÂõ∞Èõ£„Çí‰πó„ÇäË∂ä„Åà„ÇãÊôÇ„Åß„Åô" },
            2: { name: "Âù§ÁÇ∫Âú∞", symbol: "‚ò∑", guidance: "ÂèóÂÆπÊÄß„Å®ÂøçËÄêÂäõ„ÅßÁä∂Ê≥Å„ÇíÂèó„ÅëÂÖ•„Çå„ÄÅÈÅ©Âøú„Åô„Çã„Åì„Å®„ÅåÈáçË¶Å„Åß„Åô" },
            3: { name: "Ê∞¥Èõ∑Â±Ø", symbol: "‚òµ‚ò≥", guidance: "Âõ∞Èõ£„ÅÆÂßã„Åæ„Çä„Åß„Åô„Åå„ÄÅ„Åì„Çå„ÅØÊàêÈï∑„ÅÆÊ©ü‰ºö„Åß„ÇÇ„ÅÇ„Çä„Åæ„Åô" },
            5: { name: "Ê∞¥Â§©ÈúÄ", symbol: "‚òµ‚ò∞", guidance: "ÂæÖÊ©ü„ÅÆÊô∫ÊÖß„ÇíÁô∫ÊèÆ„Åô„ÇãÊôÇ„Åß„Åô" },
            15: { name: "Âú∞Â±±Ë¨ô", symbol: "‚ò∑‚ò∂", guidance: "Ë¨ôËôö„Åï„ÅåËß£Ê±∫„Å∏„ÅÆÈÅì„Åß„Åô" },
            30: { name: "Èõ¢ÁÇ∫ÁÅ´", symbol: "‚ò≤", guidance: "ÊòéÊô∞„Åï„Å®Ê¥ûÂØüÂäõ„ÅßÁúüÁõ∏„ÇíË¶ãÊäú„Åç„Åæ„Åô" },
            32: { name: "Èõ∑È¢®ÊÅí", symbol: "‚ò≥‚ò¥", guidance: "ÊåÅÁ∂öÊÄß„Å®‰∏ÄË≤´ÊÄß„Çí‰øù„Å§„Åì„Å®„ÅåÂ§ßÂàá„Åß„Åô" }
        };
        
        return guidanceDatabase[hexagramNumber] || guidanceDatabase[1];
    }

    /**
     * Triple OSÂá¶ÁêÜ„É°„ÇΩ„ÉÉ„Éâ
     */
    processInEngineOS(error) {
        return { processed: true, os: 'engine', error: error };
    }

    processInInterfaceOS(error) {
        return { processed: true, os: 'interface', error: error };
    }

    processInSafeModeOS(error) {
        return { processed: true, os: 'safeMode', error: error };
    }

    /**
     * Áµ±ÂêàÁä∂ÊÖãÂèñÂæó
     */
    getIntegrationStatus() {
        return {
            version: this.version,
            philosophy: this.philosophy,
            status: this.integrationStatus,
            log: this.integrationLog,
            errorHandler: !!this.errorHandlerInstance,
            timestamp: new Date().toISOString()
        };
    }

    /**
     * „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
     */
    cleanup() {
        console.log("üßπ Cleaning up HAQEI Unified Error System Integrator...");
        
        // Clear intervals
        if (this.metricsUpdateInterval) {
            clearInterval(this.metricsUpdateInterval);
        }

        // Cleanup error handler
        if (this.errorHandlerInstance && this.errorHandlerInstance.cleanup) {
            this.errorHandlerInstance.cleanup();
        }

        // Clear global references
        if (window.HAQEIErrorSystem) {
            delete window.HAQEIErrorSystem;
        }
        
        if (window.HAQEIEvents) {
            delete window.HAQEIEvents;
        }

        console.log("‚úÖ HAQEI Unified Error System Integrator cleanup completed");
    }
}

// Auto-initialize if in browser environment
if (typeof window !== 'undefined') {
    // Wait for DOM to be ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            window.HAQEIUnifiedErrorSystemIntegrator = new UnifiedErrorSystemIntegrator();
        });
    } else {
        window.HAQEIUnifiedErrorSystemIntegrator = new UnifiedErrorSystemIntegrator();
    }
}

// Export for module systems
if (typeof module !== 'undefined' && module.exports) {
    module.exports = UnifiedErrorSystemIntegrator;
}

console.log("‚úÖ HAQEI Unified Error System Integrator v2.0.0 loaded and ready for integration");