class KPIDashboard{constructor(n){this.container=document.getElementById(n),this.kpiAnalyzer=window.kpiAnalyzer,this.isVisible=!1,this.updateInterval=null,this.charts=new Map,this.config={updateFrequency:3e4,chartColors:{success:"#22c55e",warning:"#f59e0b",danger:"#ef4444",info:"#6366f1",primary:"#8b5cf6"},animations:{duration:1e3,easing:"cubic-bezier(0.4, 0, 0.2, 1)"}},this.init()}init(){this.container?this.kpiAnalyzer?(this.createDashboardHTML(),this.setupEventListeners(),this.loadInitialData(),console.log("KPI Dashboard initialized")):console.error("KPI Analyzer not found"):console.error("KPI Dashboard container not found")}createDashboardHTML(){this.container.innerHTML='\n            <div class="kpi-dashboard">\n                <div class="dashboard-header">\n                    <div class="header-content">\n                        <h2 class="dashboard-title">\n                            <span class="title-icon">üìä</span>\n                            OS Analyzer KPI „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ\n                        </h2>\n                        <div class="header-controls">\n                            <button class="btn btn-refresh" id="refresh-btn">\n                                <span class="btn-icon">üîÑ</span>\n                                Êõ¥Êñ∞\n                            </button>\n                            <button class="btn btn-export" id="export-btn">\n                                <span class="btn-icon">üíæ</span>\n                                „Ç®„ÇØ„Çπ„Éù„Éº„Éà\n                            </button>\n                            <button class="btn btn-toggle" id="toggle-btn">\n                                <span class="btn-icon">üëÅÔ∏è</span>\n                                Ë°®Á§∫ÂàáÊõø\n                            </button>\n                        </div>\n                    </div>\n                    <div class="last-updated">\n                        ÊúÄÁµÇÊõ¥Êñ∞: <span id="last-updated-time">-</span>\n                    </div>\n                </div>\n                \n                <div class="dashboard-content" id="dashboard-content">\n                    <div class="kpi-overview">\n                        <div class="overview-card overall-score">\n                            <div class="card-header">\n                                <h3>Á∑èÂêà„Çπ„Ç≥„Ç¢</h3>\n                                <span class="card-icon">üéØ</span>\n                            </div>\n                            <div class="card-body">\n                                <div class="score-display">\n                                    <span class="score-value" id="overall-score">-</span>\n                                    <span class="score-unit">%</span>\n                                </div>\n                                <div class="score-status" id="overall-status">Ë©ï‰æ°‰∏≠</div>\n                            </div>\n                        </div>\n                        \n                        <div class="overview-card">\n                            <div class="card-header">\n                                <h3>‰ªäÊó•„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥</h3>\n                                <span class="card-icon">üë•</span>\n                            </div>\n                            <div class="card-body">\n                                <div class="metric-value" id="daily-sessions">-</div>\n                                <div class="metric-change" id="daily-sessions-change">-</div>\n                            </div>\n                        </div>\n                        \n                        <div class="overview-card">\n                            <div class="card-header">\n                                <h3>ÂÆå‰∫ÜÁéá</h3>\n                                <span class="card-icon">‚úÖ</span>\n                            </div>\n                            <div class="card-body">\n                                <div class="metric-value" id="completion-rate">-</div>\n                                <div class="metric-target">ÁõÆÊ®ô: 75%</div>\n                            </div>\n                        </div>\n                        \n                        <div class="overview-card">\n                            <div class="card-header">\n                                <h3>„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØÁéá</h3>\n                                <span class="card-icon">üí¨</span>\n                            </div>\n                            <div class="card-body">\n                                <div class="metric-value" id="feedback-rate">-</div>\n                                <div class="metric-target">ÁõÆÊ®ô: 20%</div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class="kpi-categories">\n                        <div class="category-section" id="user-experience-section">\n                            <div class="section-header">\n                                <h3>\n                                    <span class="section-icon">üë§</span>\n                                    „É¶„Éº„Ç∂„Éº‰ΩìÈ®ì\n                                </h3>\n                                <button class="section-toggle" data-section="user-experience">\n                                    <span class="toggle-icon">‚ñº</span>\n                                </button>\n                            </div>\n                            <div class="section-content" id="user-experience-content">\n                                <div class="kpi-grid">\n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>Ë®∫Êñ≠ÂÆå‰∫ÜÁéá</h4>\n                                            <div class="kpi-status" id="completion-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="completion-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="completion-value">-</span>\n                                            <span class="kpi-trend" id="completion-trend">-</span>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>Âπ≥Âùá„Çª„ÉÉ„Ç∑„Éß„É≥ÊôÇÈñì</h4>\n                                            <div class="kpi-status" id="session-duration-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="session-duration-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="session-duration-value">-</span>\n                                            <span class="kpi-trend" id="session-duration-trend">-</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class="category-section" id="zone-d-section">\n                            <div class="section-header">\n                                <h3>\n                                    <span class="section-icon">üîç</span>\n                                    Zone D ÂäπÊûú\n                                </h3>\n                                <button class="section-toggle" data-section="zone-d">\n                                    <span class="toggle-icon">‚ñº</span>\n                                </button>\n                            </div>\n                            <div class="section-content" id="zone-d-content">\n                                <div class="kpi-grid">\n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>‰∏ç‰∏ÄËá¥„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØÁéá</h4>\n                                            <div class="kpi-status" id="disagreement-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="disagreement-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="disagreement-value">-</span>\n                                            <span class="kpi-trend" id="disagreement-trend">-</span>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>„Éè„É≥„Éâ„Ç™„ÉïÂÆå‰∫ÜÁéá</h4>\n                                            <div class="kpi-status" id="handoff-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="handoff-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="handoff-value">-</span>\n                                            <span class="kpi-trend" id="handoff-trend">-</span>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>Âπ≥ÂùáÁ¢∫‰ø°Â∫¶</h4>\n                                            <div class="kpi-status" id="confidence-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="confidence-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="confidence-value">-</span>\n                                            <span class="kpi-trend" id="confidence-trend">-</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class="category-section" id="mobile-section">\n                            <div class="section-header">\n                                <h3>\n                                    <span class="section-icon">üì±</span>\n                                    „É¢„Éê„Ç§„É´ÊúÄÈÅ©Âåñ\n                                </h3>\n                                <button class="section-toggle" data-section="mobile">\n                                    <span class="toggle-icon">‚ñº</span>\n                                </button>\n                            </div>\n                            <div class="section-content" id="mobile-content">\n                                <div class="kpi-grid">\n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>„É¢„Éê„Ç§„É´ÂÆå‰∫ÜÁéá</h4>\n                                            <div class="kpi-status" id="mobile-completion-status">-</div>\n                                        </div>\n                                        <div class="kpi-chart" id="mobile-completion-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value" id="mobile-completion-value">-</span>\n                                            <span class="kpi-trend" id="mobile-completion-trend">-</span>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class="kpi-card">\n                                        <div class="kpi-header">\n                                            <h4>„Éá„Éê„Ç§„ÇπÂàÜÂ∏É</h4>\n                                            <div class="kpi-status">ÊÉÖÂ†±</div>\n                                        </div>\n                                        <div class="kpi-chart" id="device-distribution-chart"></div>\n                                        <div class="kpi-details">\n                                            <span class="kpi-value">„Éá„Éê„Ç§„ÇπÂà•Âà©Áî®Áä∂Ê≥Å</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class="category-section" id="paradigm-shift-section">\n                            <div class="section-header">\n                                <h3>\n                                    <span class="section-icon">üîÑ</span>\n                                    „Éë„É©„ÉÄ„Ç§„É†„Ç∑„Éï„ÉàÂäπÊûú\n                                </h3>\n                                <button class="section-toggle" data-section="paradigm-shift">\n                                    <span class="toggle-icon">‚ñº</span>\n                                </button>\n                            </div>\n                            <div class="section-content" id="paradigm-shift-content">\n                                <div class="kpi-grid">\n                                    <div class="kpi-card full-width">\n                                        <div class="kpi-header">\n                                            <h4>„Éë„É©„ÉÄ„Ç§„É†„Ç∑„Éï„Éà„Çπ„Ç≥„Ç¢</h4>\n                                            <div class="kpi-status" id="paradigm-shift-status">-</div>\n                                        </div>\n                                        <div class="paradigm-breakdown">\n                                            <div class="breakdown-item">\n                                                <span class="breakdown-label">ÂèçË®ºÊ≠ìËøéÂ∫¶</span>\n                                                <div class="breakdown-bar">\n                                                    <div class="breakdown-fill" id="feedback-engagement-bar"></div>\n                                                </div>\n                                                <span class="breakdown-value" id="feedback-engagement-value">-</span>\n                                            </div>\n                                            <div class="breakdown-item">\n                                                <span class="breakdown-label">‰∏çÁ¢∫ÂÆüÊÄßÂèóÂÆπ</span>\n                                                <div class="breakdown-bar">\n                                                    <div class="breakdown-fill" id="uncertainty-acceptance-bar"></div>\n                                                </div>\n                                                <span class="breakdown-value" id="uncertainty-acceptance-value">-</span>\n                                            </div>\n                                            <div class="breakdown-item">\n                                                <span class="breakdown-label">Á∂ôÁ∂öÂà©Áî®ÊÑèÂêë</span>\n                                                <div class="breakdown-bar">\n                                                    <div class="breakdown-fill" id="repeat-usage-bar"></div>\n                                                </div>\n                                                <span class="breakdown-value" id="repeat-usage-value">-</span>\n                                            </div>\n                                            <div class="breakdown-item">\n                                                <span class="breakdown-label">AIÂºï„ÅçÁ∂ô„ÅéÊÑèÊ¨≤</span>\n                                                <div class="breakdown-bar">\n                                                    <div class="breakdown-fill" id="handoff-willingness-bar"></div>\n                                                </div>\n                                                <span class="breakdown-value" id="handoff-willingness-value">-</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class="dashboard-alerts" id="dashboard-alerts">\n                        \x3c!-- „Ç¢„É©„Éº„Éà„ÅåÂãïÁöÑ„Å´Ë°®Á§∫„Åï„Çå„Çã --\x3e\n                    </div>\n                </div>\n            </div>\n        ',this.attachStyles()}attachStyles(){if(document.getElementById("kpi-dashboard-styles"))return;const n=document.createElement("style");n.id="kpi-dashboard-styles",n.textContent='\n            .kpi-dashboard {\n                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n                background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);\n                color: #e2e8f0;\n                min-height: 100vh;\n                padding: 2rem;\n            }\n            \n            .dashboard-header {\n                background: rgba(15, 23, 42, 0.8);\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(99, 102, 241, 0.2);\n                border-radius: 16px;\n                padding: 2rem;\n                margin-bottom: 2rem;\n            }\n            \n            .header-content {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 1rem;\n            }\n            \n            .dashboard-title {\n                font-size: 2rem;\n                font-weight: 700;\n                background: linear-gradient(135deg, #6366f1, #8b5cf6);\n                -webkit-background-clip: text;\n                -webkit-text-fill-color: transparent;\n                display: flex;\n                align-items: center;\n                gap: 0.5rem;\n                margin: 0;\n            }\n            \n            .header-controls {\n                display: flex;\n                gap: 1rem;\n            }\n            \n            .btn {\n                background: linear-gradient(135deg, #6366f1, #8b5cf6);\n                color: white;\n                border: none;\n                padding: 0.75rem 1.5rem;\n                border-radius: 8px;\n                cursor: pointer;\n                font-size: 0.9rem;\n                display: flex;\n                align-items: center;\n                gap: 0.5rem;\n                transition: transform 0.2s;\n            }\n            \n            .btn:hover {\n                transform: translateY(-2px);\n            }\n            \n            .btn-export {\n                background: linear-gradient(135deg, #10b981, #22c55e);\n            }\n            \n            .btn-toggle {\n                background: linear-gradient(135deg, #f59e0b, #eab308);\n            }\n            \n            .last-updated {\n                color: #94a3b8;\n                font-size: 0.9rem;\n            }\n            \n            .kpi-overview {\n                display: grid;\n                grid-template-columns: 2fr repeat(3, 1fr);\n                gap: 1.5rem;\n                margin-bottom: 3rem;\n            }\n            \n            .overview-card {\n                background: rgba(15, 23, 42, 0.6);\n                border: 1px solid rgba(99, 102, 241, 0.2);\n                border-radius: 12px;\n                padding: 1.5rem;\n                transition: transform 0.2s;\n            }\n            \n            .overview-card:hover {\n                transform: translateY(-2px);\n            }\n            \n            .overall-score {\n                background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));\n                border-color: rgba(99, 102, 241, 0.3);\n            }\n            \n            .card-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 1rem;\n            }\n            \n            .card-header h3 {\n                font-size: 1rem;\n                font-weight: 600;\n                color: #cbd5e1;\n                margin: 0;\n            }\n            \n            .score-display {\n                display: flex;\n                align-items: baseline;\n                gap: 0.25rem;\n            }\n            \n            .score-value {\n                font-size: 3rem;\n                font-weight: 700;\n                color: #10b981;\n            }\n            \n            .score-unit {\n                font-size: 1.5rem;\n                color: #6b7280;\n            }\n            \n            .score-status {\n                color: #10b981;\n                font-weight: 600;\n                margin-top: 0.5rem;\n            }\n            \n            .metric-value {\n                font-size: 2rem;\n                font-weight: 700;\n                color: #e2e8f0;\n                margin-bottom: 0.5rem;\n            }\n            \n            .metric-change {\n                color: #10b981;\n                font-size: 0.9rem;\n                font-weight: 500;\n            }\n            \n            .metric-target {\n                color: #94a3b8;\n                font-size: 0.85rem;\n            }\n            \n            .category-section {\n                background: rgba(15, 23, 42, 0.4);\n                border: 1px solid rgba(99, 102, 241, 0.2);\n                border-radius: 16px;\n                margin-bottom: 2rem;\n                overflow: hidden;\n            }\n            \n            .section-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 1.5rem 2rem;\n                background: rgba(15, 23, 42, 0.8);\n                border-bottom: 1px solid rgba(99, 102, 241, 0.1);\n                cursor: pointer;\n            }\n            \n            .section-header h3 {\n                display: flex;\n                align-items: center;\n                gap: 0.75rem;\n                font-size: 1.25rem;\n                font-weight: 600;\n                margin: 0;\n                color: #e2e8f0;\n            }\n            \n            .section-toggle {\n                background: none;\n                border: none;\n                color: #94a3b8;\n                cursor: pointer;\n                font-size: 1rem;\n                padding: 0.5rem;\n                border-radius: 4px;\n                transition: all 0.2s;\n            }\n            \n            .section-toggle:hover {\n                background: rgba(99, 102, 241, 0.1);\n                color: #6366f1;\n            }\n            \n            .section-content {\n                padding: 2rem;\n                display: block;\n            }\n            \n            .section-content.collapsed {\n                display: none;\n            }\n            \n            .kpi-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n                gap: 1.5rem;\n            }\n            \n            .kpi-card {\n                background: rgba(15, 23, 42, 0.6);\n                border: 1px solid rgba(99, 102, 241, 0.1);\n                border-radius: 12px;\n                padding: 1.5rem;\n                transition: transform 0.2s;\n            }\n            \n            .kpi-card:hover {\n                transform: translateY(-2px);\n                border-color: rgba(99, 102, 241, 0.3);\n            }\n            \n            .kpi-card.full-width {\n                grid-column: 1 / -1;\n            }\n            \n            .kpi-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 1rem;\n            }\n            \n            .kpi-header h4 {\n                font-size: 1rem;\n                font-weight: 600;\n                color: #cbd5e1;\n                margin: 0;\n            }\n            \n            .kpi-status {\n                padding: 0.25rem 0.75rem;\n                border-radius: 12px;\n                font-size: 0.75rem;\n                font-weight: 600;\n                text-transform: uppercase;\n            }\n            \n            .kpi-status.success { background: rgba(34, 197, 94, 0.2); color: #22c55e; }\n            .kpi-status.warning { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }\n            .kpi-status.danger { background: rgba(239, 68, 68, 0.2); color: #ef4444; }\n            .kpi-status.info { background: rgba(99, 102, 241, 0.2); color: #6366f1; }\n            \n            .kpi-chart {\n                height: 120px;\n                background: rgba(0, 0, 0, 0.2);\n                border-radius: 8px;\n                margin-bottom: 1rem;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: #6b7280;\n                font-size: 0.9rem;\n            }\n            \n            .kpi-details {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n            }\n            \n            .kpi-value {\n                font-size: 1.5rem;\n                font-weight: 700;\n                color: #e2e8f0;\n            }\n            \n            .kpi-trend {\n                color: #10b981;\n                font-size: 0.9rem;\n                font-weight: 500;\n            }\n            \n            .paradigm-breakdown {\n                display: flex;\n                flex-direction: column;\n                gap: 1rem;\n            }\n            \n            .breakdown-item {\n                display: grid;\n                grid-template-columns: 150px 1fr 60px;\n                align-items: center;\n                gap: 1rem;\n            }\n            \n            .breakdown-label {\n                color: #94a3b8;\n                font-size: 0.9rem;\n            }\n            \n            .breakdown-bar {\n                height: 8px;\n                background: rgba(99, 102, 241, 0.2);\n                border-radius: 4px;\n                overflow: hidden;\n            }\n            \n            .breakdown-fill {\n                height: 100%;\n                background: linear-gradient(90deg, #6366f1, #8b5cf6);\n                border-radius: 4px;\n                width: 0%;\n                transition: width 1s ease-out;\n            }\n            \n            .breakdown-value {\n                color: #e2e8f0;\n                font-weight: 600;\n                font-size: 0.9rem;\n                text-align: right;\n            }\n            \n            .dashboard-alerts {\n                margin-top: 2rem;\n            }\n            \n            .alert {\n                background: rgba(239, 68, 68, 0.1);\n                border: 1px solid rgba(239, 68, 68, 0.3);\n                border-radius: 8px;\n                padding: 1rem;\n                margin-bottom: 1rem;\n                display: flex;\n                align-items: start;\n                gap: 0.75rem;\n            }\n            \n            .alert-icon {\n                font-size: 1.25rem;\n                flex-shrink: 0;\n                margin-top: 0.1rem;\n            }\n            \n            .alert-content h4 {\n                color: #ef4444;\n                font-size: 1rem;\n                font-weight: 600;\n                margin: 0 0 0.5rem 0;\n            }\n            \n            .alert-content p {\n                color: #cbd5e1;\n                margin: 0;\n                line-height: 1.5;\n            }\n            \n            /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */\n            @media (max-width: 1024px) {\n                .kpi-overview {\n                    grid-template-columns: 1fr;\n                }\n                \n                .header-content {\n                    flex-direction: column;\n                    gap: 1rem;\n                    align-items: stretch;\n                }\n                \n                .header-controls {\n                    justify-content: center;\n                }\n            }\n            \n            @media (max-width: 768px) {\n                .kpi-dashboard {\n                    padding: 1rem;\n                }\n                \n                .dashboard-header {\n                    padding: 1.5rem;\n                }\n                \n                .dashboard-title {\n                    font-size: 1.5rem;\n                }\n                \n                .kpi-grid {\n                    grid-template-columns: 1fr;\n                }\n                \n                .breakdown-item {\n                    grid-template-columns: 1fr;\n                    gap: 0.5rem;\n                }\n            }\n        ',document.head.appendChild(n)}setupEventListeners(){const n=document.getElementById("refresh-btn");n?.addEventListener("click",()=>this.refreshData());const e=document.getElementById("export-btn");e?.addEventListener("click",()=>this.exportData());const a=document.getElementById("toggle-btn");a?.addEventListener("click",()=>this.toggleVisibility());document.querySelectorAll(".section-toggle").forEach(n=>{n.addEventListener("click",e=>{e.stopPropagation(),this.toggleSection(n.dataset.section)})});document.querySelectorAll(".section-header").forEach(n=>{n.addEventListener("click",()=>{const e=n.querySelector(".section-toggle");e&&this.toggleSection(e.dataset.section)})}),document.addEventListener("kpiDashboardUpdate",n=>{this.updateDashboard(n.detail)}),window.addEventListener("resize",this.debounce(()=>{this.handleResize()},250))}loadInitialData(){const n=this.kpiAnalyzer.generateDashboardData();this.updateDashboard(n),this.startAutoUpdate()}updateDashboard(n){try{const e=document.getElementById("last-updated-time");e&&(e.textContent=(new Date).toLocaleTimeString("ja-JP")),this.updateOverallScore(n.overallScore),this.updateOverviewCards(n.categories),this.updateUserExperienceKPIs(n.categories.userExperience),this.updateZoneDKPIs(n.categories.zoneD),this.updateMobileKPIs(n.categories.mobile),this.updateParadigmShiftKPIs(n.categories.paradigmShift),this.updateAlerts(n.alerts),console.log("KPI Dashboard updated",n)}catch(e){console.error("Failed to update KPI dashboard:",e),this.showError("„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆÊõ¥Êñ∞„Å´Â§±Êïó„Åó„Åæ„Åó„Åü")}}updateOverallScore(n){const e=document.getElementById("overall-score"),a=document.getElementById("overall-status");if(e&&a){let t,s;e.textContent=Math.round(100*n),n>=.8?(t="ÂÑ™ÁßÄ",s="success"):n>=.6?(t="ËâØÂ•Ω",s="info"):n>=.4?(t="ÊîπÂñÑË¶Å",s="warning"):(t="Ë¶ÅÊ≥®ÊÑè",s="danger"),a.textContent=t,a.className=`score-status ${s}`}}updateOverviewCards(n){const e=document.getElementById("daily-sessions");e&&(e.textContent="24");const a=document.getElementById("completion-rate");a&&n.userExperience?.completionRate&&(a.textContent=Math.round(100*n.userExperience.completionRate.value)+"%");const t=document.getElementById("feedback-rate");t&&n.zoneD?.disagreementRate&&(t.textContent=Math.round(100*n.zoneD.disagreementRate.value)+"%")}updateUserExperienceKPIs(n){n&&(this.updateKPICard("completion",n.completionRate),this.updateKPICard("session-duration",n.avgSessionDuration))}updateZoneDKPIs(n){n&&(this.updateKPICard("disagreement",n.disagreementRate),this.updateKPICard("handoff",n.handoffRate),this.updateKPICard("confidence",n.avgConfidence))}updateMobileKPIs(n){n&&this.updateKPICard("mobile-completion",n.mobileCompletionRate)}updateParadigmShiftKPIs(n){if(!n)return;const e=document.getElementById("paradigm-shift-status");e&&n.paradigmShiftScore&&(e.textContent=n.paradigmShiftScore.status.toUpperCase(),e.className=`kpi-status ${n.paradigmShiftScore.status}`),this.updateBreakdownBar("feedback-engagement",n.feedbackEngagement?.value||0),this.updateBreakdownBar("uncertainty-acceptance",n.lowConfidenceAcceptance?.value||0),this.updateBreakdownBar("repeat-usage",n.repeatUsage?.value||0),this.updateBreakdownBar("handoff-willingness",n.handoffWillingness?.value||0)}updateKPICard(n,e){if(!e)return;const a=document.getElementById(`${n}-status`),t=document.getElementById(`${n}-value`);a&&(a.textContent=e.status.toUpperCase(),a.className=`kpi-status ${e.status}`),t&&("number"==typeof e.value?t.textContent=e.value<1?Math.round(100*e.value)+"%":Math.round(e.value).toLocaleString():t.textContent=e.value)}updateBreakdownBar(n,e){const a=document.getElementById(`${n}-bar`),t=document.getElementById(`${n}-value`);a&&setTimeout(()=>{a.style.width=`${Math.round(100*e)}%`},100),t&&(t.textContent=Math.round(100*e)+"%")}updateAlerts(n){const e=document.getElementById("dashboard-alerts");if(!e)return;if(!n||0===n.length)return void(e.innerHTML="");const a=n.map(n=>`\n            <div class="alert">\n                <div class="alert-icon">${n.icon||"‚ö†Ô∏è"}</div>\n                <div class="alert-content">\n                    <h4>${n.title}</h4>\n                    <p>${n.message}</p>\n                </div>\n            </div>\n        `).join("");e.innerHTML=a}refreshData(){console.log("Refreshing KPI dashboard data...");const n=this.kpiAnalyzer.generateDashboardData();this.updateDashboard(n);const e=document.getElementById("refresh-btn");e&&(e.style.transform="rotate(360deg)",setTimeout(()=>{e.style.transform=""},500))}exportData(){try{const n=this.kpiAnalyzer.generateDashboardData(),e={exportDate:(new Date).toISOString(),dashboardData:n,weeklyReport:this.kpiAnalyzer.generateWeeklyReport(),monthlyReport:this.kpiAnalyzer.generateMonthlyReport()},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`kpi-dashboard-export-${Date.now()}.json`,s.click(),URL.revokeObjectURL(t),console.log("KPI dashboard data exported")}catch(n){console.error("Failed to export KPI data:",n),this.showError("„Éá„Éº„Çø„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü")}}toggleVisibility(){this.isVisible=!this.isVisible;const n=document.getElementById("dashboard-content");n&&(n.style.display=this.isVisible?"block":"none");const e=document.getElementById("toggle-btn");if(e){e.querySelector(".btn-icon").textContent=this.isVisible?"üëÅÔ∏è":"üôà"}}toggleSection(n){const e=document.getElementById(`${n}-content`),a=document.querySelector(`[data-section="${n}"] .toggle-icon`);if(e&&a){const n=e.classList.contains("collapsed");e.classList.toggle("collapsed",!n),a.textContent=n?"‚ñº":"‚ñ∂"}}startAutoUpdate(){this.updateInterval=setInterval(()=>{this.isVisible&&this.refreshData()},this.config.updateFrequency)}showError(n){const e=document.getElementById("dashboard-alerts");if(e){const a=`\n                <div class="alert">\n                    <div class="alert-icon">‚ùå</div>\n                    <div class="alert-content">\n                        <h4>„Ç®„É©„Éº</h4>\n                        <p>${n}</p>\n                    </div>\n                </div>\n            `;e.innerHTML=a}}handleResize(){console.log("KPI Dashboard resized")}debounce(n,e){let a;return function(...t){clearTimeout(a),a=setTimeout(()=>{clearTimeout(a),n(...t)},e)}}destroy(){this.updateInterval&&clearInterval(this.updateInterval),this.charts.forEach(n=>{n.destroy&&n.destroy()}),console.log("KPI Dashboard destroyed")}}"undefined"!=typeof module&&module.exports&&(module.exports=KPIDashboard);