export class MultiLineInterpreter{constructor(){this.interpretationRules={1:"single",2:"dual",3:"triple",4:"hexagram",5:"hexagram",6:"total"},this.mainLinePriority={default:[5,"lowest"],upperFirst:["highest",5],balanced:["middle"]}}interpretMultipleChanges(e,t,i,n="default"){const r=t.length;switch(this.interpretationRules[r]){case"single":return this.interpretSingleLine(e,t[0]);case"dual":case"triple":default:return this.interpretMainLine(e,t,i,n);case"hexagram":return this.interpretHexagramFocus(e,i,t);case"total":return this.interpretTotalTransformation(e,i)}}interpretSingleLine(e,t){const i=this.getLineData(e,t);return{focus:"line",primaryLine:t,interpretation:`ç¬¬${t}çˆ»ãŒç¤ºã™ã€Œ${i.keyword}ã€ãŒä¸­å¿ƒçš„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚`,detail:i.description,emphasis:"ã“ã®çˆ»ã®æŒ‡ç¤ºã«å¾“ã†ã“ã¨ãŒé‡è¦",guidance:this.generateLineGuidance(t,i),confidence:.95}}interpretMainLine(e,t,i,n="default"){const r=this.selectMainLine(t,n),a=t.filter(e=>e!==r),o=this.getLineData(e,r),s=a.map(t=>this.getLineData(e,t));return{focus:"main_line_with_support",primaryLine:r,secondaryLines:a,interpretation:`ç¬¬${r}çˆ»ã€Œ${o.keyword}ã€ã‚’ä¸­å¿ƒã«ã€${a.join("ãƒ»")}çˆ»ãŒè£œåŠ©çš„ã«ä½œç”¨ã€‚`,mainMessage:o.description,supportMessages:s.map(e=>e.description),toHex:i,emphasis:"ä¸»çˆ»ã®æ–¹å‘æ€§ã‚’è»¸ã«ã€ä»–ã®çˆ»ãŒçŠ¶æ³ã‚’ä¿®é£¾",guidance:this.generateMultiLineGuidance(o,s),confidence:.8}}interpretHexagramFocus(e,t,i){const n=this.getHexagramData(e),r=this.getHexagramData(t);return{focus:"hexagram_transition",fromHex:e,toHex:t,changedLines:i,interpretation:`${i.length}æœ¬ã®å¤‰çˆ»ã«ã‚ˆã‚Šã€${n.name}ã‹ã‚‰${r.name}ã¸ã®å¤§ããªå¤‰åŒ–ã€‚æœ¬å¦ã®å…¨ä½“çš„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ä¹‹å¦ã®æ–¹å‘æ€§ã¸ã®ç§»è¡ŒãŒé‡è¦ã€‚`,fromMeaning:n.meaning,toMeaning:r.meaning,transitionAdvice:this.generateTransitionAdvice(n,r),linesSummary:"å€‹ã€…ã®çˆ»è¾ã¯å‚è€ƒç¨‹åº¦ã«ç•™ã‚ã‚‹",emphasis:"å¦ã®å¤§å±€çš„å¤‰åŒ–ã«æ³¨ç›®",confidence:.7}}interpretTotalTransformation(e,t){const i=this.getHexagramData(e),n=this.getHexagramData(t);return{focus:"complete_reversal",fromHex:e,toHex:t,interpretation:`å…¨çˆ»ãŒå¤‰åŒ–ã™ã‚‹å®Œå…¨ãªè»¢æ›ã€‚${i.name}ã‹ã‚‰${n.name}ã¸ã®æ ¹æœ¬çš„ãªåè»¢ã€‚ç¾çŠ¶ã®å®Œå…¨ãªé€†è»¢ãƒ»é©å‘½çš„å¤‰åŒ–ã‚’ç¤ºã™ã€‚`,warning:"æ¥µã‚ã¦ç¨€ãªçŠ¶æ³ã€‚æ…é‡ãªåˆ¤æ–­ãŒå¿…è¦ã€‚",guidance:"æ ¹æœ¬çš„ãªä¾¡å€¤è¦³ã‚„æ–¹å‘æ€§ã®è¦‹ç›´ã—ãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã¾ã™",philosophicalMeaning:this.getPhilosophicalMeaning(e,t),emphasis:"æ ¹æœ¬çš„ãªä¾¡å€¤è¦³ãƒ»æ–¹å‘æ€§ã®è»¢æ›",confidence:.9}}selectMainLine(e,t="default"){const i=this.mainLinePriority[t]||this.mainLinePriority.default;for(const n of i){if(5===n&&e.includes(5))return 5;if("lowest"===n)return Math.min(...e);if("highest"===n)return Math.max(...e);if("middle"===n){return e[Math.floor(e.length/2)]}}return e[0]}getLineData(e,t){if("undefined"!=typeof window&&window.H384_DATA){const i=window.H384_DATA.find(i=>i["å¦ç•ªå·"]===e&&i["çˆ»ä½"]===t);if(i)return{keyword:i["ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰"]||`ç¬¬${t}çˆ»`,description:i["ç¾ä»£è§£é‡ˆã®è¦ç´„"]||"å¤‰åŒ–ã®å…†ã—",action:i["è¡Œå‹•æŒ‡é‡"]||"æ…é‡ã«é€²ã‚€"}}return{keyword:this.getDefaultLineKeyword(t),description:this.getDefaultLineDescription(e,t),action:this.getDefaultLineAction(t)}}getHexagramData(e){return{name:{1:"ä¹¾ç‚ºå¤©",2:"å¤ç‚ºåœ°",11:"åœ°å¤©æ³°",12:"å¤©åœ°å¦",63:"æ°´ç«æ—¢æ¸ˆ",64:"ç«æ°´æœªæ¸ˆ"}[e]||`ç¬¬${e}å¦`,meaning:this.getHexagramMeaning(e)}}getDefaultLineKeyword(e){return{1:"æ½œåœ¨",2:"å†…çœ",3:"æ±ºæ–­",4:"é€²å±•",5:"çµ±ç‡",6:"æ¥µé™"}[e]||`ç¬¬${e}çˆ»`}getDefaultLineDescription(e,t){return`å¦${e}ã®ç¬¬${t}çˆ»ã«ãŠã‘ã‚‹å¤‰åŒ–ã®æ„å‘³`}getDefaultLineAction(e){return{1:"æ…é‡ã«æº–å‚™ã‚’é€²ã‚ã‚‹",2:"å†…é¢ã‚’è¦‹ã¤ã‚ç›´ã™",3:"å‹‡æ°—ã‚’æŒã£ã¦è¸ã¿å‡ºã™",4:"ç€å®Ÿã«å‰é€²ã™ã‚‹",5:"å…¨ä½“ã‚’çµ±æ‹¬ã™ã‚‹",6:"æ–°ãŸãªè»¢æ›ã«å‚™ãˆã‚‹"}[e]||"çŠ¶æ³ã‚’è¦‹æ¥µã‚ã¦è¡Œå‹•ã™ã‚‹"}getHexagramMeaning(e){return{1:"å‰µé€ ã¨åŠ›å¼·ã•",2:"å—å®¹ã¨æŸ”è»Ÿæ€§",11:"èª¿å’Œã¨ç¹æ „",12:"åœæ»ã¨å›°é›£",63:"å®Œæˆã¨å®‰å®š",64:"æœªå®Œã¨å¯èƒ½æ€§"}[e]||"å¤‰åŒ–ã¨ç™ºå±•"}generateLineGuidance(e,t){return`${t.keyword}ã®æ®µéšã«ãŠã„ã¦ã€${t.action}ã“ã¨ãŒé‡è¦ã§ã™ã€‚`}generateMultiLineGuidance(e,t){const i=t.map(e=>e.keyword).join("ãƒ»");return`${e.keyword}ã‚’ä¸­å¿ƒã«ã€${i}ã®è¦ç´ ã‚‚è€ƒæ…®ã—ãªãŒã‚‰é€²ã‚ã¾ã—ã‚‡ã†ã€‚`}generateTransitionAdvice(e,t){return`${e.meaning}ã‹ã‚‰${t.meaning}ã¸ã®ç§»è¡ŒæœŸã«ã‚ã‚Šã¾ã™ã€‚å¤§ããªè¦–ç‚¹ã§å¤‰åŒ–ã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚`}getPhilosophicalMeaning(e,t){return 1===e&&2===t?"ç´”é™½ã‹ã‚‰ç´”é™°ã¸ã®å®Œå…¨ãªè»¢æ›ã€‚ç©æ¥µæ€§ã‹ã‚‰å—å®¹æ€§ã¸ã®æ ¹æœ¬çš„ãªå¤‰åŒ–ã€‚":2===e&&1===t?"ç´”é™°ã‹ã‚‰ç´”é™½ã¸ã®å®Œå…¨ãªè»¢æ›ã€‚å—å®¹æ€§ã‹ã‚‰ç©æ¥µæ€§ã¸ã®æ ¹æœ¬çš„ãªå¤‰åŒ–ã€‚":"é™°é™½ã®å®Œå…¨ãªåè»¢ã€‚ç‰©äº‹ã®æ ¹æœ¬çš„ãªè»¢æ›æœŸã€‚"}}"undefined"!=typeof window&&(window.MultiLineInterpreter=MultiLineInterpreter,console.log("ğŸŒ MultiLineInterpreter registered to window object"));