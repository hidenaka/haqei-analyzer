console.log("â˜¯ï¸ HexagramMappingEngine Loading..."),function(){"use strict";class HexagramMappingEngine{constructor(){this.name="HexagramMappingEngine",this.version="1.0.0",this.philosophy="haqei-hexagram-wisdom",this.tripleOS={engineOS:null,interfaceOS:null,safeModeOS:null},this.hexagramDatabase=this.initializeHexagramDatabase(),this.trigrams=this.initializeTrigrams(),this.changePatterns=this.initializeChangePatterns(),this.haqeiIntegration={wisdom:"æ™ºæ…§ã¨ç°¡æ½”ã•ã®çµ±åˆ",clarity:"æ˜æ™°ã•ã¨æ·±é ã•ã®èª¿å’Œ",practicality:"å®Ÿç”¨æ€§ã¨ç¥ç§˜æ€§ã®èåˆ",accessibility:"èª°ã‚‚ãŒç†è§£ã§ãã‚‹æ˜“çµŒ"},this.isInitialized=!1}async initialize(){console.log("ğŸ”§ HexagramMappingEngine initializing...");try{return await this.setupTripleOS(),await this.initializeDatabase(),await this.initializeChangeAnalyzer(),await this.integrateHaQeiPhilosophy(),this.isInitialized=!0,console.log("âœ… HexagramMappingEngine initialized successfully"),!0}catch(e){return console.error("âŒ HexagramMappingEngine initialization failed:",e),this.initializeSafeMode()}}async setupTripleOS(){this.tripleOS.engineOS={analyze:e=>this.analyzeTextToHexagram(e),map:e=>this.mapContextToHexagram(e),transform:e=>this.transformHexagram(e)},this.tripleOS.interfaceOS={display:e=>this.formatHexagramDisplay(e),visualize:e=>this.createHexagramVisualization(e),explain:e=>this.generateExplanation(e)},this.tripleOS.safeModeOS={fallback:()=>this.getDefaultHexagram(),validate:e=>this.validateHexagram(e),recover:e=>this.recoverFromError(e)}}initializeHexagramDatabase(){return{1:{name:"ä¹¾",meaning:"å¤©",attributes:["å‰µé€ ","å¼·å¥","ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—"]},2:{name:"å¤",meaning:"åœ°",attributes:["å—å®¹","åŒ…å®¹","ã‚µãƒãƒ¼ãƒˆ"]},3:{name:"å±¯",meaning:"å§‹ã¾ã‚Šã®å›°é›£",attributes:["èª•ç”Ÿ","æˆé•·","æŒ‘æˆ¦"]},4:{name:"è’™",meaning:"å•“è’™",attributes:["å­¦ç¿’","æ•™è‚²","æˆé•·"]},63:{name:"æ—¢æ¸ˆ",meaning:"å®Œæˆ",attributes:["é”æˆ","èª¿å’Œ","å®Œäº†"]},64:{name:"æœªæ¸ˆ",meaning:"æœªå®Œæˆ",attributes:["ç¶™ç¶š","å¯èƒ½æ€§","æœªæ¥"]}}}initializeTrigrams(){return{"â˜°":{name:"ä¹¾",element:"å¤©",attributes:["å‰µé€ çš„","ç©æ¥µçš„","çˆ¶"]},"â˜·":{name:"å¤",element:"åœ°",attributes:["å—å®¹çš„","æ¶ˆæ¥µçš„","æ¯"]},"â˜³":{name:"éœ‡",element:"é›·",attributes:["å‹•ã","è¡æ’ƒ","é•·ç”·"]},"â˜´":{name:"å·½",element:"é¢¨",attributes:["æµ¸é€","æŸ”è»Ÿ","é•·å¥³"]},"â˜µ":{name:"å",element:"æ°´",attributes:["å±é™º","æ·±æ·µ","ä¸­ç”·"]},"â˜²":{name:"é›¢",element:"ç«",attributes:["æ˜ã‚‹ã•","ç¾","ä¸­å¥³"]},"â˜¶":{name:"è‰®",element:"å±±",attributes:["é™æ­¢","ç‘æƒ³","å°‘ç”·"]},"â˜±":{name:"å…Œ",element:"æ²¢",attributes:["å–œã³","èª¬å¾—","å°‘å¥³"]}}}initializeChangePatterns(){return{"äº’ç¶œ":e=>this.calculateMutualChange(e),"éŒ¯å¦":e=>this.calculateOppositeChange(e),"ç¶œå¦":e=>this.calculateReverseChange(e),"å¤‰çˆ»":(e,a)=>this.calculateLineChange(e,a)}}async analyzeTextToHexagram(e){if(!e)return this.getDefaultHexagram();try{const a=await this.extractKeywords(e),i=await this.analyzeSentiment(e),t=await this.analyzeContext(e),n=this.calculateHexagramNumber(a,i,t),s=this.hexagramDatabase[n]||this.getDefaultHexagram();return s.changes=this.calculatePossibleChanges(n),s}catch(a){return console.error("Text to hexagram mapping failed:",a),this.tripleOS.safeModeOS.fallback()}}async mapContextToHexagram(e){const a={time:this.mapTimeToTrigram(e.time),space:this.mapSpaceToTrigram(e.space),emotion:this.mapEmotionToTrigram(e.emotion),action:this.mapActionToTrigram(e.action)},i=this.combineTrigrams([a.time,a.space]),t=this.combineTrigrams([a.emotion,a.action]);return this.combineTrigramsToHexagram(i,t)}transformHexagram(e){return{original:e,mutual:this.changePatterns["äº’ç¶œ"](e),opposite:this.changePatterns["éŒ¯å¦"](e),reverse:this.changePatterns["ç¶œå¦"](e),evolution:this.calculateEvolution(e)}}async extractKeywords(e){return e.split(/\s+/).filter(e=>e.length>2)}async analyzeSentiment(e){let a=0;return["è‰¯ã„","ç´ æ™´ã‚‰ã—ã„","æˆåŠŸ","å¹¸ã›"].forEach(i=>{e.includes(i)&&a++}),["æ‚ªã„","å¤±æ•—","å›°é›£","ä¸å®‰"].forEach(i=>{e.includes(i)&&a--}),a}async analyzeContext(e){return{length:e.length,complexity:e.split(/[.!?]/).length,urgency:e.includes("ç·Šæ€¥")||e.includes("ä»Šã™ã"),uncertainty:e.includes("ã‹ã‚‚")||e.includes("ãŸã¶ã‚“")}}calculateHexagramNumber(e,a,i){let t=1;return t+=e.length%64,t+=a>0?10:-10,t+=5*i.complexity,t=Math.abs(t)%64+1,t}calculatePossibleChanges(e){return{next:e%64+1,previous:e>1?e-1:64,opposite:65-e,complement:(e+31)%64+1}}getDefaultHexagram(){return{number:1,name:"ä¹¾",meaning:"å¤©",attributes:["å‰µé€ ","å¼·å¥","ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—"],message:"HaQeiå“²å­¦ã«ã‚ˆã‚‹åˆæœŸçŠ¶æ…‹"}}formatHexagramDisplay(e){return`\n        ã€${e.name}å¦ã€‘\n        æ„å‘³: ${e.meaning}\n        ç‰¹æ€§: ${e.attributes.join(", ")}\n        ${e.message||""}\n      `}async integrateHaQeiPhilosophy(){this.philosophicalFramework={simplicity:"ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„",depth:"æ·±ã„æ´å¯Ÿã‚’æä¾›",practicality:"å®Ÿç”¨çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹",universality:"æ™®éçš„ãªæ™ºæ…§"}}initializeSafeMode(){return console.log("âš ï¸ Initializing safe mode..."),this.isInitialized=!0,!0}}"undefined"!=typeof window&&(window.HexagramMappingEngine=HexagramMappingEngine),"undefined"!=typeof module&&module.exports&&(module.exports=HexagramMappingEngine),console.log("âœ… HexagramMappingEngine loaded successfully with HaQei Philosophy")}("undefined"!=typeof window?window:global);