console.log("ðŸŽ­ SituationalContextEngine Loading..."),window.SituationalContextEngine={init(){console.log("ðŸ”§ SituationalContextEngine initializing..."),this.setupTripleOS(),this.initializeContextFrameworks(),this.loadSituationalMappings(),console.log("âœ… SituationalContextEngine initialized successfully")},setupTripleOS(){this.engineOS={name:"Situational Context Engine OS",version:"1.0.0",philosophy:"haqei-situational",async analyzeSituationalContext(t,e={}){try{const i=this.recognizeSituation(t),a=await this.mapSituationalContext(i,e),n=this.analyzeEnvironmentalFactors(t,a),s=this.analyzeStakeholders(t,a),o=this.analyzeDynamicFactors(t,a),r=this.generateAdaptationStrategies(a,o);return{input:t,situation:i,context:a,environmental:n,stakeholders:s,dynamics:o,adaptations:r,metadata:{contextComplexity:this.calculateContextComplexity(a),adaptationPotential:this.calculateAdaptationPotential(r),situationalStability:this.assessSituationalStability(o),philosophy:"haqei-situational"}}}catch(i){return console.warn("âš ï¸ Situational context analysis error:",i),this.createFallbackContext(t)}},recognizeSituation(t){const e=this.identifySituationTypes(t);return{types:e,urgency:this.assessUrgencyLevel(t),complexity:this.assessSituationComplexity(t),scope:this.determineSituationScope(t),nature:this.analyzeSituationNature(t),primaryType:this.determinePrimarySituationType(e),confidence:this.calculateRecognitionConfidence(e)}},identifySituationTypes(t){const e=[];return Object.entries({decision:/æ±ºã‚ã‚‹|é¸ã¶|åˆ¤æ–­|æ±ºæ–­|æ–¹é‡|é¸æŠž/,problem:/å•é¡Œ|å›°é›£|èª²é¡Œ|ãƒˆãƒ©ãƒ–ãƒ«|æ‚©ã¿|éšœå®³/,opportunity:/ãƒãƒ£ãƒ³ã‚¹|æ©Ÿä¼š|å¯èƒ½æ€§|å¥½æ©Ÿ|ã‚¿ã‚¤ãƒŸãƒ³ã‚°/,relationship:/äººé–“é–¢ä¿‚|å‹äºº|å®¶æ—|åŒåƒš|ãƒãƒ¼ãƒ |ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼/,career:/ä»•äº‹|è»¢è·|æ˜‡é€²|ã‚­ãƒ£ãƒªã‚¢|è·æ¥­|ä¼šç¤¾/,health:/å¥åº·|ä½“èª¿|ç—…æ°—|æ²»ç™‚|åŒ»ç™‚|ã‚±ã‚¢/,learning:/å­¦ç¿’|å‹‰å¼·|æ•™è‚²|ã‚¹ã‚­ãƒ«|çŸ¥è­˜|æˆé•·/,finance:/ãŠé‡‘|é‡‘èž|æŠ•è³‡|åŽå…¥|æ”¯å‡º|çµŒæ¸ˆ/,creative:/å‰µä½œ|èŠ¸è¡“|ãƒ‡ã‚¶ã‚¤ãƒ³|ã‚¢ã‚¤ãƒ‡ã‚¢|è¡¨ç¾|ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–/,communication:/ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³|ä¼šè©±|ä¼é”|ç›¸è«‡|å¯¾è©±/,conflict:/å¯¾ç«‹|äº‰ã„|è¡çª|ç·Šå¼µ|æ‘©æ“¦|å¯¾æŠ—/,change:/å¤‰åŒ–|å¤‰æ›´|è»¢æ›|ç§»è¡Œ|æ”¹é©|é©æ–°/}).forEach(([i,a])=>{a.test(t)&&e.push({type:i,confidence:this.calculatePatternConfidence(a,t),relevance:this.assessTypeRelevance(i,t)})}),e.sort((t,e)=>e.confidence-t.confidence)},assessUrgencyLevel(t){const e={high:/ç·Šæ€¥|æ€¥ãŽ|ã™ãã«|ä»Šã™ã|è‡³æ€¥|å±é™º|ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«/,medium:/æ—©ã‚|è¿‘ã„ã†ã¡|ãã‚ãã‚|ãªã‚‹ã¹ã|ã§ãã‚Œã°/,low:/ã„ã¤ã‹|å°†æ¥|æ™‚é–“ãŒã‚ã‚‹ã¨ã|ä½™è£•ãŒã‚ã‚‹ã¨ã/};for(const[i,a]of Object.entries(e))if(a.test(t))return{level:i,confidence:this.calculatePatternConfidence(a,t),indicators:this.extractUrgencyIndicators(t,a)};return{level:"medium",confidence:.5,indicators:[]}},assessSituationComplexity(t){let e=.5;e+=.3*(new Set(t.split(/\s+/)).size/t.split(/\s+/).length);e+=.1*this.identifyDomains(t).length;e+=.05*this.identifyStakeholders(t).length;return e+=.1*this.identifyTimeframes(t).length,Math.min(e,1)},determineSituationScope(t){const e=[];return Object.entries({personal:/è‡ªåˆ†|ç§|å€‹äººçš„|ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ|ä¸€äººã§/,interpersonal:/ç›¸æ‰‹|ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼|å‹äºº|å®¶æ—|æ‹äºº/,group:/ãƒãƒ¼ãƒ |ã‚°ãƒ«ãƒ¼ãƒ—|ä»²é–“|ã¿ã‚“ãª|é›†å›£/,organizational:/ä¼šç¤¾|çµ„ç¹”|éƒ¨ç½²|è·å ´|ä¼æ¥­/,societal:/ç¤¾ä¼š|åœ°åŸŸ|ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£|ä¸–é–“|å…¬å…±/,global:/ä¸–ç•Œ|ã‚°ãƒ­ãƒ¼ãƒãƒ«|å›½éš›|å…¨ä½“|æ™®é/}).forEach(([i,a])=>{a.test(t)&&e.push({scope:i,strength:this.calculatePatternStrength(a,t)})}),e.length>0?e:[{scope:"personal",strength:.5}]},analyzeSituationNature(t){const e=[];return Object.entries({analytical:/åˆ†æž|æ¤œè¨Ž|èª¿æŸ»|ç ”ç©¶|ãƒ‡ãƒ¼ã‚¿|æƒ…å ±/,creative:/å‰µé€ |ã‚¢ã‚¤ãƒ‡ã‚¢|ç™ºæƒ³|ã‚¤ãƒŽãƒ™ãƒ¼ã‚·ãƒ§ãƒ³|ãƒ‡ã‚¶ã‚¤ãƒ³/,emotional:/æ„Ÿæƒ…|æ°—æŒã¡|å¿ƒ|æ„›|ä¸å®‰|å–œã³|æ‚²ã—ã¿/,practical:/å®Ÿè·µ|å®Ÿè¡Œ|è¡Œå‹•|å®Ÿéš›|å…·ä½“çš„|ç¾å®Ÿ/,strategic:/æˆ¦ç•¥|è¨ˆç”»|æ–¹é‡|é•·æœŸ|ç›®æ¨™|ãƒ“ã‚¸ãƒ§ãƒ³/,tactical:/æˆ¦è¡“|æ‰‹æ³•|æ–¹æ³•|çŸ­æœŸ|å³åŠ¹|ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯/,philosophical:/å“²å­¦|ä¾¡å€¤è¦³|ä¿¡å¿µ|äººç”Ÿ|æ„å‘³|æœ¬è³ª/}).forEach(([i,a])=>{a.test(t)&&e.push({nature:i,strength:this.calculatePatternStrength(a,t),relevance:this.assessNatureRelevance(i,t)})}),e.sort((t,e)=>e.strength-t.strength)},async mapSituationalContext(t,e){const i={situation:t,previous:e,timestamp:(new Date).toISOString()},a=await this.createSituationalContextMap(t),n=this.analyzeContinuity(i,e);return{base:i,map:a,continuity:n,constraints:this.identifyContextualConstraints(t),opportunities:this.identifyContextualOpportunities(t),coherence:this.calculateContextualCoherence(a,n)}},analyzeEnvironmentalFactors(t,e){const i={physical:this.analyzePhysicalEnvironment(t),social:this.analyzeSocialEnvironment(t),cultural:this.analyzeCulturalEnvironment(t),economic:this.analyzeEconomicEnvironment(t),technological:this.analyzeTechnologicalEnvironment(t),temporal:this.analyzeTemporalEnvironment(t)};return{factors:i,interactions:this.analyzeFactorInteractions(i),influences:this.assessEnvironmentalInfluences(i,e),dominantFactors:this.identifyDominantFactors(i),stability:this.assessEnvironmentalStability(i)}},analyzeStakeholders(t,e){const i=this.identifyStakeholders(t),a=this.analyzeStakeholderRoles(i,e),n=this.mapStakeholderRelationships(i,t),s=this.assessStakeholderInfluences(i,e);return{stakeholders:i,roles:a,relationships:n,influences:s,dynamics:this.analyzeStakeholderDynamics(i,n),keyStakeholders:this.identifyKeyStakeholders(i,s),alignment:this.assessStakeholderAlignment(i,n)}},analyzeDynamicFactors(t,e){const i=this.identifyTrends(t,e),a=this.identifyPressures(t,e),n=this.identifyChanges(t,e),s=this.assessMomentum(t,e),o=this.assessVolatility(i,a,n);return{trends:i,pressures:a,changes:n,momentum:s,volatility:o,predictability:this.assessPredictability(i,o),adaptationRequired:this.assessAdaptationRequirement(n,o)}},generateAdaptationStrategies(t,e){const i=[];return e.volatility>.6&&i.push(...this.generateVolatilityStrategies(e)),e.volatility<.4&&i.push(...this.generateStabilityStrategies(e)),t.opportunities.length>0&&i.push(...this.generateOpportunityStrategies(t.opportunities)),t.constraints.length>0&&i.push(...this.generateConstraintStrategies(t.constraints)),i.push(...this.generateHaQeiIntegrationStrategies(t,e)),this.prioritizeStrategies(i)}},this.interfaceOS={name:"Situational Context Interface OS",formatContextResult(t){return{overview:this.createContextOverview(t),situation:this.formatSituation(t.situation),context:this.formatContext(t.context),environmental:this.formatEnvironmentalFactors(t.environmental),stakeholders:this.formatStakeholders(t.stakeholders),dynamics:this.formatDynamics(t.dynamics),adaptations:this.formatAdaptations(t.adaptations),insights:this.generateContextualInsights(t),visualizations:this.generateVisualizationSpecs(t),philosophy:t.metadata.philosophy}},createContextOverview(t){return{title:"HaQeiçŠ¶æ³ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ†æž",summary:{situationType:t.situation.primaryType,urgency:t.situation.urgency.level,complexity:this.formatComplexity(t.situation.complexity),scope:t.situation.scope[0]?.scope||"unknown"},keyInsights:this.extractKeyInsights(t),urgentActions:this.extractUrgentActions(t.adaptations),contextualTheme:this.deriveContextualTheme(t)}},formatSituation(t){return{primary:this.formatSituationType(t.primaryType),types:t.types.map(t=>({name:this.formatSituationType(t.type),confidence:this.formatPercentage(t.confidence),relevance:this.formatPercentage(t.relevance)})),urgency:{level:this.formatUrgencyLevel(t.urgency.level),indicators:t.urgency.indicators},complexity:this.formatComplexity(t.complexity),scope:t.scope.map(t=>({name:this.formatScopeType(t.scope),strength:this.formatPercentage(t.strength)})),nature:t.nature.map(t=>({name:this.formatNatureType(t.nature),strength:this.formatPercentage(t.strength)}))}}},this.safeMode={name:"Situational Context Safe Mode OS",active:!1,activate(){return console.log("ðŸ›¡ï¸ SituationalContextEngine Safe Mode activated"),this.active=!0,{basicContextAnalysis:!0,advancedFeatures:!1,philosophy:"haqei-safe"}},performBasicSituationalAnalysis(t){const e={type:this.identifyBasicSituationType(t),urgency:this.assessBasicUrgency(t),complexity:this.estimateBasicComplexity(t),scope:"personal"};return{input:t,situation:e,insights:[`åŸºæœ¬çš„ãªçŠ¶æ³åˆ†æž: ${e.type}ã¨ã—ã¦èªè­˜`],metadata:{contextComplexity:e.complexity,adaptationPotential:.5,situationalStability:.5,philosophy:"haqei-safe"}}}}},initializeContextFrameworks(){try{console.log("ðŸ”§ Initializing context frameworks..."),this.contextFrameworks={situationType:this.safeCreateFramework("createSituationTypeFramework"),urgency:this.safeCreateFramework("createUrgencyFramework"),scope:this.safeCreateFramework("createScopeFramework"),nature:this.safeCreateFramework("createNatureFramework"),adaptation:this.safeCreateFramework("createAdaptationFramework")},console.log("âœ… Context frameworks initialized successfully")}catch(t){console.error("âŒ Context frameworks initialization error:",t),this.contextFrameworks={}}},safeCreateFramework(t){try{const e=this[t];if("function"==typeof e){const i=e.call(this);return console.log(`âœ… ${t} framework created`),i}return console.warn(`âš ï¸ Framework method ${t} not available`),{}}catch(e){return console.error(`âŒ Error creating framework ${t}:`,e.message),{}}},createSituationTypeFramework:()=>({categories:["decision","problem","opportunity","relationship","career","health","learning","finance","creative","communication","conflict","change"],hierarchies:{problem:["technical","interpersonal","strategic"],decision:["binary","multiple","strategic"],opportunity:["immediate","strategic","creative"]}}),loadSituationalMappings(){this.situationalMappings={contexts:this.loadContextMappings(),adaptations:this.loadAdaptationMappings(),strategies:this.loadStrategyMappings()}},loadContextMappings:()=>({situational:{decision:["æ±ºã‚ã‚‹","é¸ã¶","åˆ¤æ–­","æ±ºæ–­","é¸æŠž"],problem:["å•é¡Œ","å›°é›£","èª²é¡Œ","ãƒˆãƒ©ãƒ–ãƒ«","éšœå®³"],opportunity:["ãƒãƒ£ãƒ³ã‚¹","æ©Ÿä¼š","å¯èƒ½æ€§","å¥½æ©Ÿ"],relationship:["äººé–“é–¢ä¿‚","é–¢ä¿‚","ä»˜ãåˆã„","ã¤ãªãŒã‚Š"]},environmental:{work:["ä»•äº‹","è·å ´","ä¼šç¤¾","æ¥­å‹™","ã‚­ãƒ£ãƒªã‚¢"],personal:["å€‹äººçš„","ç§çš„","ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ"],social:["ç¤¾ä¼šçš„","å…¬çš„","ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£"],family:["å®¶åº­","å®¶æ—","å®¶åº­çš„"]},adaptations:{flexible:["æŸ”è»Ÿ","é©å¿œ","å¤‰åŒ–å¯¾å¿œ","è‡¨æ©Ÿå¿œå¤‰"],stable:["å®‰å®š","ä¸€è²«","ç¶™ç¶š","ä¿æŒ"],innovative:["é©æ–°","æ–°ã—ã„","å‰µé€ ","ç‹¬åˆ›"]}}),loadAdaptationMappings:()=>({strategies:{accommodation:["é©å¿œ","å—å®¹","æŸ”è»Ÿå¯¾å¿œ","èª¿æ•´"],resistance:["æŠµæŠ—","åå¯¾","ç¶­æŒ","å®ˆã‚‹"],transformation:["å¤‰åŒ–","å¤‰é©","é€²åŒ–","æˆé•·"],integration:["çµ±åˆ","èžåˆ","çµåˆ","ä¸€ä½“åŒ–"]},contexts:{high_pressure:["ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼","ã‚¹ãƒˆãƒ¬ã‚¹","ç·Šå¼µ","çŽ‰é™"],supportive:["æ”¯æ´","ã‚µãƒãƒ¼ãƒˆ","å”åŠ›","æ”¯ãˆ"],uncertain:["ä¸ç¢ºå®Ÿ","æ›–æ˜§","ä¸æ˜Ž","ä¸å®‰å®š"]}}),loadStrategyMappings:()=>({haqei:{harmony:["èª¿å’Œ","ãƒãƒ©ãƒ³ã‚¹","å‡è¡¡","ç©ã‚„ã‹"],transformation:["å¤‰åŒ–","æˆé•·","é€²åŒ–","ç™ºå±•"],integration:["çµ±åˆ","èžåˆ","ä¸€ä½“","çµåˆ"],wisdom:["çŸ¥æµ","æ´žå¯Ÿ","ç†è§£","æ°—ã¥ã"]},practical:{planning:["è¨ˆç”»","æº–å‚™","æ®µå–ã‚Š","æ–¹é‡"],action:["è¡Œå‹•","å®Ÿè¡Œ","å®Ÿè·µ","å–ã‚Šçµ„ã¿"],reflection:["æŒ¯ã‚Šè¿”ã‚Š","åçœ","è€ƒå¯Ÿ","è¦‹ç›´ã—"]}}),identifyStakeholders(t){const e=[];return[/ç§|è‡ªåˆ†|å€‹äºº/,/å®¶æ—|ä¸¡è¦ª|å…„å¼Ÿ|å§‰å¦¹|å­ä¾›/,/å‹äºº|å‹é”|ä»²é–“|çŸ¥äºº/,/æ‹äºº|ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼|é…å¶è€…/,/ä¸Šå¸|éƒ¨ä¸‹|åŒåƒš|ãƒãƒ¼ãƒ /,/é¡§å®¢|ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ|ãŠå®¢æ§˜/,/å°‚é–€å®¶|åŒ»è€…|å¼è­·å£«|ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ/].forEach((i,a)=>{i.test(t)&&e.push({type:this.getStakeholderType(a),relevance:this.calculateStakeholderRelevance(t,i)})}),e},getStakeholderType:t=>["self","family","friends","partner","colleagues","clients","experts"][t]||"unknown",calculatePatternConfidence(t,e){const i=e.match(t);if(!i)return 0;const a=i.length,n=e.length;return Math.min(a/(n/100),1)},calculatePatternStrength(t,e){return(this.calculatePatternConfidence(t,e)+this.assessContextualRelevance(t,e))/2},assessContextualRelevance(t,e){const i=this.extractSurroundingContext(t,e);return this.calculateSemanticRelevance(i)},generateHaQeiIntegrationStrategies(t,e){const i=[];return i.push({type:"harmony",description:"çŠ¶æ³ã®ç•°ãªã‚‹è¦ç´ é–“ã®èª¿å’Œã‚’å›³ã‚‹",actions:["å¯¾ç«‹è¦ç´ ã®çµ±åˆ","ç•°ãªã‚‹è¦–ç‚¹ã®å—å®¹","ãƒãƒ©ãƒ³ã‚¹ã®æ¨¡ç´¢"],priority:"high",philosophy:"haqei-harmony"}),i.push({type:"transformation",description:"çŠ¶æ³ã‚’é€šã˜ãŸæˆé•·ã¨å¤‰å®¹ã‚’ä¿ƒé€²",actions:["å­¦ç¿’æ©Ÿä¼šã®æ´»ç”¨","è¦–é‡Žã®æ‹¡å¼µ","ä¾¡å€¤è¦³ã®æ·±åŒ–"],priority:"medium",philosophy:"haqei-transformation"}),i.push({type:"integration",description:"åˆ†æ•£ã—ãŸè¦ç´ ã®çµ±åˆçš„ç†è§£",actions:["å…¨ä½“åƒã®æŠŠæ¡","é–¢é€£æ€§ã®ç™ºè¦‹","æœ¬è³ªã®æ´žå¯Ÿ"],priority:"medium",philosophy:"haqei-integration"}),i},async analyzeSituationalContext(t,e={}){this.engineOS||await this.init();try{if(this.safeMode.active)return this.safeMode.performBasicSituationalAnalysis(t);const i=await this.engineOS.analyzeSituationalContext(t,e);return this.interfaceOS.formatContextResult(i)}catch(i){return console.error("âŒ Situational context analysis failed:",i),this.safeMode.activate(),this.safeMode.performBasicSituationalAnalysis(t)}},getContextCapabilities(){const t=["basic_situation_recognition","urgency_assessment"];return this.contextFrameworks&&t.push("advanced_situation_analysis","stakeholder_analysis","environmental_analysis"),this.situationalMappings&&t.push("adaptation_strategies","haqei_integration","context_synthesis"),this.safeMode.active||t.push("dynamic_adaptation","complex_context_mapping","philosophical_integration"),t},createUrgencyFramework:()=>({levels:["low","medium","high","critical","emergency"],timescales:["immediate","today","this_week","this_month","future"],consequences:["minor","moderate","significant","major","catastrophic"],reversibility:["reversible","partially_reversible","irreversible"]}),createScopeFramework:()=>({impact:["personal","interpersonal","team","organization","society"],reach:["local","regional","national","international","global"],duration:["temporary","short-term","medium-term","long-term","permanent"],depth:["surface","moderate","deep","fundamental","transformational"]}),createNatureFramework:()=>({types:["problem","opportunity","crisis","routine","creative"],complexity:["simple","complicated","complex","chaotic"],predictability:["predictable","somewhat_predictable","unpredictable"],controllability:["controllable","influenceable","uncontrollable"]}),createAdaptationFramework:()=>({strategies:["accommodation","assimilation","transformation","resistance"],flexibility:["rigid","adaptive","flexible","fluid"],resilience:["fragile","robust","antifragile"],learning:["surface","deep","transformational"]})},document.addEventListener("DOMContentLoaded",()=>{window.SituationalContextEngine.init()}),console.log("âœ… SituationalContextEngine loaded successfully with HaQei Philosophy");