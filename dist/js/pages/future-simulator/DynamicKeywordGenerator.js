console.log("ğŸ”„ DynamicKeywordGenerator Loading..."),window.DynamicKeywordGenerator={init(){console.log("ğŸ”§ DynamicKeywordGenerator initializing..."),this.setupTripleOS(),this.initializeGenerationRules(),this.loadContextDatabase(),console.log("âœ… DynamicKeywordGenerator initialized successfully")},setupTripleOS(){this.engineOS={name:"Dynamic Keyword Engine OS",version:"1.0.0",philosophy:"haqei-dynamic",async generateKeywords(e,t={}){try{const n=this.analyzeInput(e),i=this.extractBaseKeywords(n),o=await this.expandKeywords(i,t),a=this.generateContextualKeywords(o,t),r=this.refineKeywords(a,n);return{original:e,base:i,expanded:o,contextual:a,final:r,metadata:{totalGenerated:r.length,expansionRatio:r.length/i.length,contextQuality:this.calculateContextQuality(t),philosophy:"haqei-dynamic"}}}catch(n){return console.warn("âš ï¸ Dynamic keyword generation error:",n),this.createFallbackKeywords(e)}},analyzeInput(e){return{text:e,tokens:this.tokenize(e),entities:this.extractEntities(e),intent:this.detectIntent(e),emotion:this.detectEmotion(e),complexity:this.calculateComplexity(e)}},tokenize(e){return e.replace(/[ã€‚ã€ï¼ï¼Ÿ]/g," ").split(/\s+/).filter(e=>e.length>0).map(e=>({surface:e,reading:this.inferReading(e),pos:this.inferPOS(e),importance:this.calculateTokenImportance(e)}))},extractEntities(e){const t=[],n={person:/([ä¸€-é¾¯]+)(ã•ã‚“|ãã‚“|ã¡ã‚ƒã‚“|æ°|å…ˆç”Ÿ)/g,organization:/(ä¼šç¤¾|ä¼æ¥­|çµ„ç¹”|å›£ä½“|éƒ¨é–€|ãƒãƒ¼ãƒ )/g,location:/(æ±äº¬|å¤§é˜ª|åœ°åŸŸ|å ´æ‰€|ä¼šå ´)/g,time:/(ä»Šæ—¥|æ˜æ—¥|æ¥é€±|æ¥æœˆ|å°†æ¥|éå»|ç¾åœ¨)/g,number:/(\d+|ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹|å)/g};for(const[i,o]of Object.entries(n)){let n;for(;null!==(n=o.exec(e));)t.push({text:n[0],type:i,position:n.index,confidence:.8})}return t},detectIntent(e){const t={question:/[ï¼Ÿ?]|ã©ã†|ãªãœ|ã„ã¤|ã©ã“|ã ã‚Œ|ãªã«/,request:/ã—ã¦ãã ã•ã„|ãŠé¡˜ã„|æ¬²ã—ã„|å¿…è¦/,decision:/æ±ºã‚ã‚‹|é¸ã¶|åˆ¤æ–­|è¿·ã£ã¦/,future:/æœªæ¥|å°†æ¥|ã“ã‚Œã‹ã‚‰|äºˆæƒ³|äºˆæ¸¬/,problem:/å•é¡Œ|å›°ã£ãŸ|æ‚©ã¿|å¿ƒé…|ä¸å®‰/,goal:/ç›®æ¨™|ã‚´ãƒ¼ãƒ«|é”æˆ|æˆåŠŸ|å®Ÿç¾/};for(const[n,i]of Object.entries(t))if(i.test(e))return n;return"general"},detectEmotion(e){const t={positive:/å¬‰ã—ã„|æ¥½ã—ã„|å¹¸ã›|æº€è¶³|å–œã³|è‰¯ã„/,negative:/æ‚²ã—ã„|è¾›ã„|è‹¦ã—ã„|ä¸å®‰|å¿ƒé…|æ‚ªã„/,excited:/èˆˆå¥®|ã‚ãã‚ã|æœŸå¾…|æ¥½ã—ã¿/,calm:/è½ã¡ç€|å¹³é™|ç©ã‚„ã‹|å®‰å¿ƒ/,anxious:/ä¸å®‰|å¿ƒé…|ç·Šå¼µ|æ€–ã„/,confident:/è‡ªä¿¡|ç¢ºä¿¡|å¤§ä¸ˆå¤«|ã§ãã‚‹/};for(const[n,i]of Object.entries(t))if(i.test(e))return n;return"neutral"},calculateComplexity(e){const t={length:e.length/100,uniqueChars:new Set(e).size/e.length,kanji:(e.match(/[ä¸€-é¾¯]/g)||[]).length/e.length,punctuation:(e.match(/[ã€‚ã€ï¼ï¼Ÿ]/g)||[]).length/e.length},n=Object.values(t).reduce((e,t)=>e+t,0)/4;return Math.min(n,1)},extractBaseKeywords(e){const t=[];e.tokens.filter(e=>e.importance>.5).forEach(e=>{t.push({word:e.surface,source:"token",importance:e.importance,pos:e.pos})}),e.entities.forEach(e=>{t.push({word:e.text,source:"entity",importance:e.confidence,type:e.type})});if(this.getIntentKeywords(e.intent).forEach(n=>{t.push({word:n,source:"intent",importance:.7,intent:e.intent})}),"neutral"!==e.emotion){this.getEmotionKeywords(e.emotion).forEach(n=>{t.push({word:n,source:"emotion",importance:.6,emotion:e.emotion})})}return this.deduplicateKeywords(t)},async expandKeywords(e,t){const n=[];for(const i of e){const e=this.getSemanticExpansions(i.word);n.push(...e.map(e=>({word:e,source:"semantic",parent:i.word,importance:.8*i.importance})));const o=this.getRelatedWords(i.word,t);n.push(...o.map(e=>({word:e,source:"related",parent:i.word,importance:.7*i.importance})));const a=this.getSynonyms(i.word);n.push(...a.map(e=>({word:e,source:"synonym",parent:i.word,importance:.9*i.importance})))}return[...e,...this.deduplicateKeywords(n)]},generateContextualKeywords(e,t){const n=[...e];if(t.domain){const e=this.getDomainKeywords(t.domain);n.push(...e.map(e=>({word:e,source:"domain",importance:.6,domain:t.domain})))}if(t.timeframe){const e=this.getTimeframeKeywords(t.timeframe);n.push(...e.map(e=>({word:e,source:"timeframe",importance:.5,timeframe:t.timeframe})))}if(t.situation){const e=this.getSituationKeywords(t.situation);n.push(...e.map(e=>({word:e,source:"situation",importance:.6,situation:t.situation})))}return this.deduplicateKeywords(n)},refineKeywords(e,t){const n=e.sort((e,t)=>t.importance-e.importance).filter(e=>!(e.importance<.3)&&(!(e.word.length<2||e.word.length>15)&&!(/[0-9a-zA-Z]/.test(e.word)&&e.word.length<3)));return this.ensureDiversity(n).slice(0,30)},deduplicateKeywords(e){const t=new Map;return e.forEach(e=>{const n=e.word;if(t.has(n)){const i=t.get(n);e.importance>i.importance&&t.set(n,e)}else t.set(n,e)}),Array.from(t.values())},ensureDiversity(e){const t=[],n=new Set,i=new Set;for(const o of e){const e=Array.from(n).filter(e=>e===o.source).length,a=o.type?Array.from(i).filter(e=>e===o.type).length:0;if(e<5&&a<3&&(t.push(o),n.add(o.source),o.type&&i.add(o.type),t.length>=30))break}return t},createFallbackKeywords(e){const t=e.replace(/[ã€‚ã€ï¼ï¼Ÿ]/g," ").split(/\s+/).filter(e=>e.length>1).slice(0,10).map(e=>({word:e,source:"fallback",importance:.5}));return{original:e,base:t,expanded:t,contextual:t,final:t,metadata:{totalGenerated:t.length,expansionRatio:1,contextQuality:.3,philosophy:"haqei-fallback"}}},inferReading:e=>(/[ã²ã‚‰ãŒãª]/.test(e)||/[ã‚«ã‚¿ã‚«ãƒŠ]/.test(e),e),inferPOS:e=>e.endsWith("ã™ã‚‹")?"å‹•è©":e.endsWith("ã ")||e.endsWith("ã§ã‚ã‚‹")?"åŠ©å‹•è©":e.endsWith("ãª")||e.endsWith("ã®")?"é€£ä½“è©":/[ã€‚ã€ï¼ï¼Ÿ]/.test(e)?"è¨˜å·":"åè©",calculateTokenImportance(e){let t=.5;return e.length>=3&&(t+=.2),e.length>=5&&(t+=.1),/[ä¸€-é¾¯]/.test(e)&&(t+=.2),/^[ã‚-ã‚“]+$/.test(e)&&e.length<=2&&(t-=.3),Math.max(.1,Math.min(t,1))},getIntentKeywords:e=>({question:["ç–‘å•","è³ªå•","ç†ç”±","æ–¹æ³•","æ™‚æœŸ","å ´æ‰€","å¯¾è±¡"],request:["ä¾é ¼","è¦æ±‚","å¸Œæœ›","å¿…è¦","æ¬²æ±‚","é¡˜ã„"],decision:["åˆ¤æ–­","é¸æŠ","æ±ºå®š","æ–¹é‡","æ–¹å‘","çµè«–"],future:["äºˆæ¸¬","è¨ˆç”»","ç›®æ¨™","è¦‹é€šã—","æœŸå¾…","å¸Œæœ›"],problem:["èª²é¡Œ","å›°é›£","éšœå®³","æ‚©ã¿","å¿ƒé…","å¯¾å‡¦"],goal:["ç›®çš„","ç†æƒ³","é”æˆ","æˆåŠŸ","å®Ÿç¾","å®Œé‚"]}[e]||[]),getEmotionKeywords:e=>({positive:["å–œã³","æº€è¶³","å¹¸ç¦","æ¥½ã—ã•","å¬‰ã—ã•","å®‰å¿ƒ"],negative:["æ‚²ã—ã¿","ä¸å®‰","å¿ƒé…","è¾›ã•","è‹¦ã—ã•","å›°æƒ‘"],excited:["èˆˆå¥®","æœŸå¾…","ã‚ãã‚ã","æ¥½ã—ã¿","å¾…æœ›"],calm:["è½ã¡ç€ã","å¹³é™","ç©ã‚„ã‹","å®‰å®š","é™å¯‚"],anxious:["ä¸å®‰","ç·Šå¼µ","å¿ƒé…","æã‚Œ","å‹•æº"],confident:["è‡ªä¿¡","ç¢ºä¿¡","ä¿¡å¿µ","æ±ºæ„","æ„å¿—"]}[e]||[]),getSemanticExpansions(e){const t=[];return e.includes("å•é¡Œ")&&t.push("èª²é¡Œ","å›°é›£","è§£æ±º"),e.includes("æœªæ¥")&&t.push("å°†æ¥","å¸Œæœ›","è¨ˆç”»"),e.includes("æˆåŠŸ")&&t.push("é”æˆ","æˆæœ","çµæœ"),e.includes("é–¢ä¿‚")&&t.push("ç¹‹ãŒã‚Š","çµ†","äº¤æµ"),t},getRelatedWords(e,t){const n=[];return"business"===t.domain&&e.includes("ç›®æ¨™")&&n.push("å£²ä¸Š","æˆæœ","KPI","æ¥­ç¸¾"),"relationship"===t.domain&&e.includes("ä¿¡é ¼")&&n.push("ç†è§£","å°Šé‡","å”åŠ›","æ”¯æ´"),n},getSynonyms:e=>({"å•é¡Œ":["èª²é¡Œ","ãƒˆãƒ©ãƒ–ãƒ«","å›°é›£"],"è§£æ±º":["å¯¾å‡¦","è§£æ¶ˆ","æ”¹å–„"],"æœªæ¥":["å°†æ¥","ä»Šå¾Œ","ã“ã‚Œã‹ã‚‰"],"æˆåŠŸ":["é”æˆ","æˆæœ","å‹åˆ©"]}[e]||[]),getDomainKeywords:e=>({business:["ä»•äº‹","ä¼šç¤¾","è·å ´","æ¥­å‹™","ãƒ“ã‚¸ãƒã‚¹","ä¼æ¥­","çµ„ç¹”"],relationship:["äººé–“é–¢ä¿‚","å‹äºº","æ‹äºº","å®¶æ—","ä»²é–“","çµ†"],health:["å¥åº·","ä½“èª¿","ç—…æ°—","æ²»ç™‚","äºˆé˜²","é‹å‹•"],learning:["å­¦ç¿’","å‹‰å¼·","çŸ¥è­˜","ã‚¹ã‚­ãƒ«","æˆé•·","ç†è§£"],hobby:["è¶£å‘³","å¨¯æ¥½","æ¥½ã—ã¿","ãƒªãƒ©ãƒƒã‚¯ã‚¹","ä½™æš‡"]}[e]||[]),getTimeframeKeywords:e=>({past:["çµŒé¨“","å­¦ç¿’","åçœ","è¨˜æ†¶"],present:["ç¾çŠ¶","çŠ¶æ³","å¯¾å¿œ","è¡Œå‹•"],future:["è¨ˆç”»","ç›®æ¨™","å¸Œæœ›","äºˆæ¸¬"]}[e]||[]),getSituationKeywords:e=>({crisis:["ç·Šæ€¥","å¯¾å¿œ","è§£æ±º","æ”¯æ´"],opportunity:["ãƒãƒ£ãƒ³ã‚¹","å¯èƒ½æ€§","æˆé•·","ç™ºå±•"],routine:["æ—¥å¸¸","ç¿’æ…£","ç¶™ç¶š","å®‰å®š"]}[e]||[]),calculateContextQuality(e){let t=.3;return e.domain&&(t+=.2),e.emotion&&"neutral"!==e.emotion&&(t+=.2),e.timeframe&&(t+=.1),e.situation&&(t+=.2),Math.min(t,1)}},this.interfaceOS={name:"Dynamic Keyword Interface OS",formatGenerationResult(e){return{display:{summary:{input:e.original.substring(0,50)+(e.original.length>50?"...":""),generated:e.metadata.totalGenerated,expansion:`${e.metadata.expansionRatio.toFixed(1)}x`,quality:this.formatQuality(e.metadata.contextQuality)},keywords:this.formatKeywordList(e.final),breakdown:this.createBreakdown(e),suggestions:this.generateSuggestions(e)},philosophy:e.metadata.philosophy}},formatKeywordList(e){return e.map(e=>({word:e.word,importance:Math.round(100*e.importance)+"%",source:this.formatSource(e.source),category:this.determineCategory(e)}))},createBreakdown(e){const t={sources:{},importance:{high:0,medium:0,low:0},categories:{}};return e.final.forEach(e=>{t.sources[e.source]=(t.sources[e.source]||0)+1,e.importance>=.7?t.importance.high++:e.importance>=.5?t.importance.medium++:t.importance.low++;const n=this.determineCategory(e);t.categories[n]=(t.categories[n]||0)+1}),t},generateSuggestions(e){const t=[],n=new Set(e.final.map(e=>this.determineCategory(e)));return["action","emotion","time","place","person"].forEach(e=>{n.has(e)||t.push(`${e}ã«é–¢ã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™`)}),e.metadata.contextQuality<.5&&t.push("ã‚ˆã‚Šå…·ä½“çš„ãªçŠ¶æ³èª¬æ˜ãŒã‚ã‚‹ã¨ã€è³ªã®é«˜ã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã§ãã¾ã™"),t},formatSource:e=>({token:"ğŸ“ æ–‡ç« è§£æ",entity:"ğŸ·ï¸ å›ºæœ‰è¡¨ç¾",intent:"ğŸ¯ æ„å›³æ¨å®š",emotion:"ğŸ’­ æ„Ÿæƒ…åˆ†æ",semantic:"ğŸ§  æ„å‘³é–¢ä¿‚",related:"ğŸ”— é–¢é€£èª",synonym:"ğŸ”„ åŒç¾©èª",domain:"ğŸ¢ ãƒ‰ãƒ¡ã‚¤ãƒ³",timeframe:"â° æ™‚é–“è»¸",situation:"ğŸ¬ çŠ¶æ³",fallback:"ğŸ›¡ï¸ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯"}[e]||`ğŸ“Œ ${e}`),determineCategory(e){const t={action:/ã™ã‚‹|ã‚„ã‚‹|è¡Œã†|å®Ÿè¡Œ|å®Ÿæ–½|å–çµ„/,emotion:/å¬‰ã—|æ‚²ã—|æ€–|ä¸å®‰|æ¥½ã—|å¹¸ã›|æº€è¶³/,time:/æ™‚|æ—¥|é€±|æœˆ|å¹´|éå»|ç¾åœ¨|æœªæ¥|ã„ã¤/,place:/å ´æ‰€|æ‰€|åœ°åŸŸ|ä¼šå ´|å®¶|ä¼šç¤¾|å­¦æ ¡/,person:/äºº|è€…|ã•ã‚“|ãã‚“|ã¡ã‚ƒã‚“|å…ˆç”Ÿ|å‹/};for(const[n,i]of Object.entries(t))if(i.test(e.word))return n;return"general"},formatQuality:e=>e>=.8?"ğŸŒŸ é«˜å“è³ª":e>=.6?"âœ¨ è‰¯å¥½":e>=.4?"ğŸ‘ æ™®é€š":"ğŸ”„ è¦æ”¹å–„"},this.safeMode={name:"Dynamic Keyword Safe Mode OS",active:!1,activate(){return console.log("ğŸ›¡ï¸ DynamicKeywordGenerator Safe Mode activated"),this.active=!0,{basicGeneration:!0,advancedFeatures:!1,philosophy:"haqei-safe"}},generateSafeKeywords(e){const t=e.replace(/[^\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF\u3400-\u4DBF]/g," ").split(/\s+/).filter(e=>e.length>=2).slice(0,10);return{original:e,base:t.map(e=>({word:e,source:"safe",importance:.5})),expanded:t.map(e=>({word:e,source:"safe",importance:.5})),contextual:t.map(e=>({word:e,source:"safe",importance:.5})),final:t.map(e=>({word:e,source:"safe",importance:.5})),metadata:{totalGenerated:t.length,expansionRatio:1,contextQuality:.3,philosophy:"haqei-safe"}}}}},initializeGenerationRules(){this.generationRules={maxKeywords:30,minImportance:.3,expansionRatio:3,diversityThreshold:.7}},loadContextDatabase(){this.contextDatabase={intents:{question:["ç–‘å•","è³ªå•","ç†ç”±","æ–¹æ³•","æ™‚æœŸ","å ´æ‰€","å¯¾è±¡"],request:["ä¾é ¼","è¦æ±‚","å¸Œæœ›","å¿…è¦","æ¬²æ±‚","é¡˜ã„"],decision:["åˆ¤æ–­","é¸æŠ","æ±ºå®š","æ–¹é‡","æ–¹å‘","çµè«–"],future:["äºˆæ¸¬","è¨ˆç”»","ç›®æ¨™","è¦‹é€šã—","æœŸå¾…","å¸Œæœ›"],problem:["èª²é¡Œ","å›°é›£","éšœå®³","æ‚©ã¿","å¿ƒé…","å¯¾å‡¦"],goal:["ç›®çš„","ç†æƒ³","é”æˆ","æˆåŠŸ","å®Ÿç¾","å®Œé‚"]},emotions:{positive:["å–œã³","æº€è¶³","å¹¸ç¦","æ¥½ã—ã•","å¬‰ã—ã•","å®‰å¿ƒ"],negative:["æ‚²ã—ã¿","ä¸å®‰","å¿ƒé…","è¾›ã•","è‹¦ã—ã•","å›°æƒ‘"],excited:["èˆˆå¥®","æœŸå¾…","ã‚ãã‚ã","æ¥½ã—ã¿","å¾…æœ›"],calm:["è½ã¡ç€ã","å¹³é™","ç©ã‚„ã‹","å®‰å®š","é™å¯‚"],anxious:["ä¸å®‰","ç·Šå¼µ","å¿ƒé…","æã‚Œ","å‹•æº"],confident:["è‡ªä¿¡","ç¢ºä¿¡","ä¿¡å¿µ","æ±ºæ„","æ„å¿—"]},domains:{business:["ä»•äº‹","ä¼šç¤¾","è·å ´","æ¥­å‹™","ãƒ“ã‚¸ãƒã‚¹","ä¼æ¥­","çµ„ç¹”"],relationship:["äººé–“é–¢ä¿‚","å‹äºº","æ‹äºº","å®¶æ—","ä»²é–“","çµ†"],health:["å¥åº·","ä½“èª¿","ç—…æ°—","æ²»ç™‚","äºˆé˜²","é‹å‹•"],learning:["å­¦ç¿’","å‹‰å¼·","çŸ¥è­˜","ã‚¹ã‚­ãƒ«","æˆé•·","ç†è§£"],hobby:["è¶£å‘³","å¨¯æ¥½","æ¥½ã—ã¿","ãƒªãƒ©ãƒƒã‚¯ã‚¹","ä½™æš‡"]}}},inferReading:e=>(/[ã²ã‚‰ãŒãª]/.test(e)||/[ã‚«ã‚¿ã‚«ãƒŠ]/.test(e),e),inferPOS:e=>e.endsWith("ã™ã‚‹")?"å‹•è©":e.endsWith("ã ")||e.endsWith("ã§ã‚ã‚‹")?"åŠ©å‹•è©":e.endsWith("ãª")||e.endsWith("ã®")?"é€£ä½“è©":/[ã€‚ã€ï¼ï¼Ÿ]/.test(e)?"è¨˜å·":"åè©",calculateTokenImportance(e){let t=.5;return e.length>=3&&(t+=.2),e.length>=5&&(t+=.1),/[ä¸€-é¾¯]/.test(e)&&(t+=.2),/^[ã‚-ã‚“]+$/.test(e)&&e.length<=2&&(t-=.3),Math.max(.1,Math.min(t,1))},getIntentKeywords(e){return this.contextDatabase.intents[e]||[]},getEmotionKeywords(e){return this.contextDatabase.emotions[e]||[]},getSemanticExpansions(e){const t=[];return e.includes("å•é¡Œ")&&t.push("èª²é¡Œ","å›°é›£","è§£æ±º"),e.includes("æœªæ¥")&&t.push("å°†æ¥","å¸Œæœ›","è¨ˆç”»"),e.includes("æˆåŠŸ")&&t.push("é”æˆ","æˆæœ","çµæœ"),e.includes("é–¢ä¿‚")&&t.push("ç¹‹ãŒã‚Š","çµ†","äº¤æµ"),t},getRelatedWords(e,t){const n=[];return"business"===t.domain&&e.includes("ç›®æ¨™")&&n.push("å£²ä¸Š","æˆæœ","KPI","æ¥­ç¸¾"),"relationship"===t.domain&&e.includes("ä¿¡é ¼")&&n.push("ç†è§£","å°Šé‡","å”åŠ›","æ”¯æ´"),n},getSynonyms:e=>({"å•é¡Œ":["èª²é¡Œ","ãƒˆãƒ©ãƒ–ãƒ«","å›°é›£"],"è§£æ±º":["å¯¾å‡¦","è§£æ¶ˆ","æ”¹å–„"],"æœªæ¥":["å°†æ¥","ä»Šå¾Œ","ã“ã‚Œã‹ã‚‰"],"æˆåŠŸ":["é”æˆ","æˆæœ","å‹åˆ©"]}[e]||[]),getDomainKeywords(e){return this.contextDatabase.domains[e]||[]},getTimeframeKeywords:e=>({past:["çµŒé¨“","å­¦ç¿’","åçœ","è¨˜æ†¶"],present:["ç¾çŠ¶","çŠ¶æ³","å¯¾å¿œ","è¡Œå‹•"],future:["è¨ˆç”»","ç›®æ¨™","å¸Œæœ›","äºˆæ¸¬"]}[e]||[]),getSituationKeywords:e=>({crisis:["ç·Šæ€¥","å¯¾å¿œ","è§£æ±º","æ”¯æ´"],opportunity:["ãƒãƒ£ãƒ³ã‚¹","å¯èƒ½æ€§","æˆé•·","ç™ºå±•"],routine:["æ—¥å¸¸","ç¿’æ…£","ç¶™ç¶š","å®‰å®š"]}[e]||[]),calculateContextQuality(e){let t=.3;return e.domain&&(t+=.2),e.emotion&&"neutral"!==e.emotion&&(t+=.2),e.timeframe&&(t+=.1),e.situation&&(t+=.2),Math.min(t,1)},async generateDynamicKeywords(e,t={}){this.engineOS||await this.init();try{if(this.safeMode.active)return this.safeMode.generateSafeKeywords(e);const n=await this.engineOS.generateKeywords(e,t);return this.interfaceOS.formatGenerationResult(n)}catch(n){return console.error("âŒ Dynamic keyword generation failed:",n),this.safeMode.activate(),this.safeMode.generateSafeKeywords(e)}},async generateKeywords(e,t={}){if(console.log("ğŸ”¤ DynamicKeywordGenerator.generateKeywords called with:",e.substring(0,50)),this.engineOS||await this.init(),this.safeMode&&this.safeMode.active)return this.safeMode.generateSafeKeywords(e);const n=await this.engineOS.generateKeywords.call(this.engineOS,e,t),i=this.interfaceOS.formatGenerationResult(n);return console.log("âœ… Dynamic keywords generation complete"),console.log("ğŸ”¤ Dynamic keywords generated:",{original:i.display?i.display.summary.input:e.substring(0,30),base:n.base?n.base.slice(0,3).map(e=>e.word||e):[],expanded:n.expanded?n.expanded.slice(0,5).map(e=>e.word||e):[],final:n.final?n.final.slice(0,4).map(e=>e.word||e):[]}),i},getGenerationCapabilities(){const e=["basic_generation","text_analysis"];return this.contextDatabase&&e.push("context_aware","domain_specific","intent_detection"),this.safeMode.active||e.push("semantic_expansion","emotion_detection","entity_extraction"),e}},document.addEventListener("DOMContentLoaded",()=>{window.DynamicKeywordGenerator.init()}),console.log("âœ… DynamicKeywordGenerator loaded successfully with HaQei Philosophy");