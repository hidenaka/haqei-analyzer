console.log("ğŸš€ Error Handler Module loading...");class ComprehensiveErrorHandler{constructor(){this.errorLog=[],this.maxLogSize=100,this.retryAttempts=new Map,this.maxRetries=3,this.userNotifications=new Set,this.setupErrorHandling()}setupErrorHandling(){window.addEventListener("error",e=>this.handleGlobalError(e)),window.addEventListener("unhandledrejection",e=>this.handleUnhandledRejection(e)),window.addEventListener("online",()=>this.handleNetworkRestore()),window.addEventListener("offline",()=>this.handleNetworkLoss())}handleGlobalError(e){if(["chrome-extension://","moz-extension://","safari-extension://","extension:","content.js","background.js","popup.js","inject.js"].some(r=>e.filename?.includes(r)||e.message?.includes(r)))return e.preventDefault(),!0;this.logError({type:"javascript",message:e.message,filename:e.filename,lineno:e.lineno,error:e.error,timestamp:(new Date).toISOString()}),this.handleApplicationError(e.error||new Error(e.message))}handleUnhandledRejection(e){if(e.reason?.message&&["chrome-extension","moz-extension","safari-extension","Extension context","port closed","context invalidated"].some(r=>e.reason.message.includes(r)))return e.preventDefault(),!0;this.logError({type:"promise_rejection",reason:e.reason,timestamp:(new Date).toISOString()}),this.handleApplicationError(e.reason)}handleApplicationError(e){switch(this.categorizeError(e)){case"kuromoji":this.handleKuromojiError(e);break;case"network":this.handleNetworkError(e);break;case"data_loading":this.handleDataLoadingError(e);break;case"analysis":this.handleAnalysisError(e);break;case"input_validation":this.handleInputValidationError(e);break;default:this.handleGenericError(e)}}categorizeError(e){const r=e?.message?.toLowerCase()||"",o=e?.stack?.toLowerCase()||"";return r.includes("kuromoji")||o.includes("kuromoji")?"kuromoji":r.includes("network")||r.includes("fetch")?"network":r.includes("data")||r.includes("loading")?"data_loading":r.includes("analysis")||r.includes("åˆ†æ")?"analysis":r.includes("validation")||r.includes("å…¥åŠ›")?"input_validation":"generic"}logError(e){this.errorLog.push(e),this.errorLog.length>this.maxLogSize&&this.errorLog.shift(),console.error("ğŸ“‹ Error logged:",e)}async handleKuromojiError(e){console.warn("ğŸ”¤ Kuromoji error handled gracefully:",e.message);try{if(window.dictionaryLoader){console.log("ğŸ“š Attempting to load essential dictionaries as fallback...");if(await window.dictionaryLoader.loadEssentialDictionaries())return void console.log("âœ… Essential dictionaries loaded - basic functionality restored")}}catch(o){console.warn("âš ï¸ Dictionary fallback failed:",o)}const r=document.getElementById("error-container");if(r){const e='\n        <div class="fallback-notice bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">\n          <h4 class="text-yellow-800 font-semibold mb-2">æ—¥æœ¬èªè§£ææ©Ÿèƒ½ã®åˆ¶é™</h4>\n          <p class="text-yellow-700 text-sm">\n            é«˜åº¦ãªæ—¥æœ¬èªè§£ææ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ãŒã€HAQEIåˆ†æã®æ ¸å¿ƒæ©Ÿèƒ½ã¯æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚\n            ã‚ˆã‚Šè©³ç´°ãªè§£æã‚’ã”å¸Œæœ›ã®å ´åˆã¯ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã§è¿½åŠ æ©Ÿèƒ½ã‚’èª­ã¿è¾¼ã‚ã¾ã™ã€‚\n          </p>\n          <button onclick="window.dictionaryLoader?.loadAdvancedDictionaries().then(() => location.reload())" \n                  class="mt-2 px-3 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700 transition-colors">\n            é«˜åº¦æ©Ÿèƒ½ã‚’èª­ã¿è¾¼ã‚€\n          </button>\n        </div>\n      ';r.innerHTML=e,setTimeout(()=>r.innerHTML="",15e3)}}handleNetworkError(e){console.warn("ğŸŒ Network error handled:",e.message)}handleDataLoadingError(e){console.warn("ğŸ“Š Data loading error handled:",e.message)}handleAnalysisError(e){console.warn("ğŸ” Analysis error handled:",e.message)}handleInputValidationError(e){console.warn("âœï¸ Input validation error handled:",e.message)}handleGenericError(e){console.warn("âš ï¸ Generic error handled:",e.message)}handleNetworkRestore(){console.log("ğŸŒ Network restored")}handleNetworkLoss(){console.log("ğŸ“¡ Network lost - switching to offline mode")}}const errorHandler=new ComprehensiveErrorHandler;window.errorHandler=errorHandler;export{ComprehensiveErrorHandler};console.log("âœ… Error Handler Module loaded");