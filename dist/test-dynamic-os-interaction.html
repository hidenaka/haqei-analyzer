<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>OS Analyzer å‹•çš„ç”Ÿæˆæ¤œè¨¼</title>
    <style>
        body { 
            font-family: monospace; 
            padding: 20px; 
            background: #1a1a1a; 
            color: #fff; 
        }
        .test-section { 
            margin: 30px 0; 
            padding: 20px; 
            border: 1px solid #444; 
            border-radius: 8px;
        }
        .os-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .os-input {
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 5px;
        }
        .os-input label {
            display: block;
            color: #60a5fa;
            margin-bottom: 5px;
        }
        .os-input select {
            width: 100%;
            padding: 8px;
            background: #0f172a;
            color: #e5e7eb;
            border: 1px solid #475569;
            border-radius: 4px;
        }
        .os-input input[type="number"] {
            width: 100%;
            padding: 8px;
            background: #0f172a;
            color: #e5e7eb;
            border: 1px solid #475569;
            border-radius: 4px;
            margin-top: 5px;
        }
        button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            opacity: 0.9;
        }
        #interaction-result {
            margin-top: 30px;
            padding: 20px;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 8px;
            min-height: 200px;
        }
        .result-section {
            margin: 15px 0;
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 5px;
        }
        .pair-insight {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: rgba(30, 41, 59, 0.3);
            border-radius: 4px;
        }
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .synergy { background: #10b981; }
        .harmony { background: #3b82f6; }
        .tension { background: #f59e0b; }
        .conflict { background: #ef4444; }
    </style>
</head>
<body>
    <h1>ğŸ”® OS Analyzer å‹•çš„ç”Ÿæˆæ¤œè¨¼ãƒ„ãƒ¼ãƒ«</h1>
    <p>ç•°ãªã‚‹OSã®çµ„ã¿åˆã‚ã›ã§ç›¸äº’ä½œç”¨ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ç¢ºèªã§ãã¾ã™</p>

    <div class="test-section">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ç•°ãªã‚‹å¦ã®çµ„ã¿åˆã‚ã›</h2>
        
        <div class="os-selector">
            <div class="os-input">
                <label for="engine-hex-1">âš¡ Engine OS</label>
                <select id="engine-hex-1">
                    <option value="1">1. ä¹¾ç‚ºå¤©ï¼ˆå¤©ï¼‰</option>
                    <option value="2">2. å¤ç‚ºåœ°ï¼ˆåœ°ï¼‰</option>
                    <option value="3">3. æ°´é›·å±¯ï¼ˆå§‹å‹•ï¼‰</option>
                    <option value="29">29. åç‚ºæ°´ï¼ˆæ°´ï¼‰</option>
                    <option value="30">30. é›¢ç‚ºç«ï¼ˆç«ï¼‰</option>
                    <option value="63">63. æ°´ç«æ—¢æ¸ˆï¼ˆå®Œæˆï¼‰</option>
                    <option value="64">64. ç«æ°´æœªæ¸ˆï¼ˆæœªå®Œï¼‰</option>
                </select>
                <input type="number" id="engine-score-1" min="0" max="1" step="0.1" value="0.8" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
            
            <div class="os-input">
                <label for="interface-hex-1">ğŸ”„ Interface OS</label>
                <select id="interface-hex-1">
                    <option value="2">2. å¤ç‚ºåœ°ï¼ˆåœ°ï¼‰</option>
                    <option value="11">11. åœ°å¤©æ³°ï¼ˆèª¿å’Œï¼‰</option>
                    <option value="12">12. å¤©åœ°å¦ï¼ˆé–‰å¡ï¼‰</option>
                    <option value="31">31. æ²¢å±±å’¸ï¼ˆæ„Ÿå¿œï¼‰</option>
                    <option value="41">41. å±±æ²¢æï¼ˆè¬™éœï¼‰</option>
                </select>
                <input type="number" id="interface-score-1" min="0" max="1" step="0.1" value="0.7" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
            
            <div class="os-input">
                <label for="safe-hex-1">ğŸ›¡ï¸ SafeMode OS</label>
                <select id="safe-hex-1">
                    <option value="29">29. åç‚ºæ°´ï¼ˆæ°´ï¼‰</option>
                    <option value="52">52. è‰®ç‚ºå±±ï¼ˆé™æ­¢ï¼‰</option>
                    <option value="33">33. å¤©å±±é¯ï¼ˆé€€é¿ï¼‰</option>
                    <option value="39">39. æ°´å±±è¹‡ï¼ˆå›°é›£ï¼‰</option>
                </select>
                <input type="number" id="safe-score-1" min="0" max="1" step="0.1" value="0.6" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
        </div>
        
        <button onclick="runTest(1)">ğŸš€ ãƒ†ã‚¹ãƒˆ1å®Ÿè¡Œ</button>
        <div id="result-1" class="result-section"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: ã‚¹ã‚³ã‚¢ã®å¤‰åŒ–ã«ã‚ˆã‚‹å½±éŸ¿</h2>
        
        <div class="os-selector">
            <div class="os-input">
                <label for="engine-hex-2">âš¡ Engine OSï¼ˆå›ºå®šï¼‰</label>
                <select id="engine-hex-2" disabled>
                    <option value="1">1. ä¹¾ç‚ºå¤©ï¼ˆå¤©ï¼‰</option>
                </select>
                <input type="number" id="engine-score-2" min="0" max="1" step="0.1" value="0.9" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
            
            <div class="os-input">
                <label for="interface-hex-2">ğŸ”„ Interface OSï¼ˆå›ºå®šï¼‰</label>
                <select id="interface-hex-2" disabled>
                    <option value="2">2. å¤ç‚ºåœ°ï¼ˆåœ°ï¼‰</option>
                </select>
                <input type="number" id="interface-score-2" min="0" max="1" step="0.1" value="0.3" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
            
            <div class="os-input">
                <label for="safe-hex-2">ğŸ›¡ï¸ SafeMode OSï¼ˆå›ºå®šï¼‰</label>
                <select id="safe-hex-2" disabled>
                    <option value="29">29. åç‚ºæ°´ï¼ˆæ°´ï¼‰</option>
                </select>
                <input type="number" id="safe-score-2" min="0" max="1" step="0.1" value="0.5" placeholder="ã‚¹ã‚³ã‚¢ (0-1)">
            </div>
        </div>
        
        <button onclick="runTest(2)">ğŸš€ ãƒ†ã‚¹ãƒˆ2å®Ÿè¡Œï¼ˆã‚¹ã‚³ã‚¢å·®ã«ã‚ˆã‚‹è‘›è—¤ï¼‰</button>
        <div id="result-2" class="result-section"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆï¼ˆå‹•çš„ç¢ºèªï¼‰</h2>
        <button onclick="runRandomTest()">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ OSç”Ÿæˆï¼†åˆ†æ</button>
        <div id="random-config"></div>
        <div id="result-3" class="result-section"></div>
    </div>

    <script src="./js/core/TripleOSInteractionAnalyzer.js"></script>
    <script>
        const hexagramNames = {
            1: 'ä¹¾ç‚ºå¤©', 2: 'å¤ç‚ºåœ°', 3: 'æ°´é›·å±¯', 11: 'åœ°å¤©æ³°', 12: 'å¤©åœ°å¦',
            29: 'åç‚ºæ°´', 30: 'é›¢ç‚ºç«', 31: 'æ²¢å±±å’¸', 33: 'å¤©å±±é¯', 39: 'æ°´å±±è¹‡',
            41: 'å±±æ²¢æ', 52: 'è‰®ç‚ºå±±', 63: 'æ°´ç«æ—¢æ¸ˆ', 64: 'ç«æ°´æœªæ¸ˆ'
        };

        function runTest(testNum) {
            const analyzer = new TripleOSInteractionAnalyzer();
            
            // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‹ã‚‰OSè¨­å®šã‚’å–å¾—
            const engineOS = {
                hexagramId: parseInt(document.getElementById(`engine-hex-${testNum}`).value),
                name: hexagramNames[parseInt(document.getElementById(`engine-hex-${testNum}`).value)],
                score: parseFloat(document.getElementById(`engine-score-${testNum}`).value)
            };
            
            const interfaceOS = {
                hexagramId: parseInt(document.getElementById(`interface-hex-${testNum}`).value),
                name: hexagramNames[parseInt(document.getElementById(`interface-hex-${testNum}`).value)],
                score: parseFloat(document.getElementById(`interface-score-${testNum}`).value)
            };
            
            const safeModeOS = {
                hexagramId: parseInt(document.getElementById(`safe-hex-${testNum}`).value),
                name: hexagramNames[parseInt(document.getElementById(`safe-hex-${testNum}`).value)],
                score: parseFloat(document.getElementById(`safe-score-${testNum}`).value)
            };
            
            // åˆ†æå®Ÿè¡Œ
            const analysis = analyzer.analyze(engineOS, interfaceOS, safeModeOS);
            
            // çµæœè¡¨ç¤º
            displayResult(analysis, `result-${testNum}`);
        }
        
        function runRandomTest() {
            const analyzer = new TripleOSInteractionAnalyzer();
            
            // ãƒ©ãƒ³ãƒ€ãƒ OSç”Ÿæˆ
            const allHexagrams = [1, 2, 3, 11, 12, 29, 30, 31, 33, 39, 41, 52, 63, 64];
            const randomHexagrams = [];
            for (let i = 0; i < 3; i++) {
                const idx = Math.floor(Math.random() * allHexagrams.length);
                randomHexagrams.push(allHexagrams[idx]);
            }
            
            const engineOS = {
                hexagramId: randomHexagrams[0],
                name: hexagramNames[randomHexagrams[0]] || `ç¬¬${randomHexagrams[0]}å¦`,
                score: Math.random() * 0.4 + 0.6 // 0.6-1.0
            };
            
            const interfaceOS = {
                hexagramId: randomHexagrams[1],
                name: hexagramNames[randomHexagrams[1]] || `ç¬¬${randomHexagrams[1]}å¦`,
                score: Math.random() * 0.4 + 0.5 // 0.5-0.9
            };
            
            const safeModeOS = {
                hexagramId: randomHexagrams[2],
                name: hexagramNames[randomHexagrams[2]] || `ç¬¬${randomHexagrams[2]}å¦`,
                score: Math.random() * 0.4 + 0.4 // 0.4-0.8
            };
            
            // è¨­å®šè¡¨ç¤º
            document.getElementById('random-config').innerHTML = `
                <div style="margin: 10px 0; padding: 10px; background: rgba(30, 41, 59, 0.5); border-radius: 5px;">
                    <strong>ç”Ÿæˆã•ã‚ŒãŸOSæ§‹æˆ:</strong><br>
                    âš¡ Engine: ${engineOS.name} (ID: ${engineOS.hexagramId}, Score: ${engineOS.score.toFixed(2)})<br>
                    ğŸ”„ Interface: ${interfaceOS.name} (ID: ${interfaceOS.hexagramId}, Score: ${interfaceOS.score.toFixed(2)})<br>
                    ğŸ›¡ï¸ SafeMode: ${safeModeOS.name} (ID: ${safeModeOS.hexagramId}, Score: ${safeModeOS.score.toFixed(2)})
                </div>
            `;
            
            // åˆ†æå®Ÿè¡Œ
            const analysis = analyzer.analyze(engineOS, interfaceOS, safeModeOS);
            
            // çµæœè¡¨ç¤º
            displayResult(analysis, 'result-3');
        }
        
        function displayResult(analysis, containerId) {
            const container = document.getElementById(containerId);
            const { interactions, synergy } = analysis;
            
            let html = '<h3>ğŸ” åˆ†æçµæœ</h3>';
            
            // ãƒšã‚¢åˆ†æ
            html += '<h4>ğŸ“Š ãƒšã‚¢é–“ç›¸äº’ä½œç”¨ï¼ˆå‹•çš„ç”Ÿæˆï¼‰</h4>';
            interactions.pair_insights.forEach(pair => {
                const badgeClass = pair.category.toLowerCase();
                html += `
                    <div class="pair-insight">
                        <span>${pair.summary}</span>
                        <span class="badge ${badgeClass}">${pair.category}</span>
                    </div>
                `;
            });
            
            // å†…çš„è‘›è—¤ï¼ˆå‹•çš„ï¼‰
            html += '<h4>âš¡ å†…çš„è‘›è—¤ãƒ†ãƒ¼ãƒï¼ˆ' + interactions.inner_conflicts.length + 'å€‹ï¼‰</h4>';
            html += '<ul>';
            interactions.inner_conflicts.forEach(conflict => {
                html += `<li>${conflict}</li>`;
            });
            html += '</ul>';
            
            // ã‚¢ãƒ•ã‚©ãƒ¼ãƒ€ãƒ³ã‚¹ï¼ˆä¸€éƒ¨ï¼‰
            html += '<h4>ğŸ’¡ Engine OSã®å¼·ã¿/å¼±ã¿</h4>';
            html += '<div style="margin-left: 20px;">';
            html += '<strong style="color: #10b981;">å¼·ã¿ãŒå‡ºã‚‹å ´é¢:</strong><ul>';
            interactions.affordances.engine.thrives_with.forEach(t => {
                html += `<li>${t}</li>`;
            });
            html += '</ul>';
            html += '<strong style="color: #f59e0b;">å¼±ã¿ãŒå‡ºã‚‹å ´é¢:</strong><ul>';
            interactions.affordances.engine.struggles_with.forEach(s => {
                html += `<li>${s}</li>`;
            });
            html += '</ul></div>';
            
            // ã‚·ãƒŠã‚¸ãƒ¼
            html += `<h4>ğŸŒŸ ã‚·ãƒŠã‚¸ãƒ¼åˆ†æ</h4>`;
            html += `<p>${synergy.notes}</p>`;
            
            // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
            html += `<p style="color: #64748b; font-size: 0.875rem;">ç”Ÿæˆæ™‚åˆ»: ${new Date(analysis.created_at).toLocaleString()}</p>`;
            
            container.innerHTML = html;
        }
    </script>
</body>
</html>