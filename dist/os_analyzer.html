<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="HaQei Analyzer - å¤ä»£ã®å¡æ™ºã¨ç¾ä»£ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãŒèåˆã—ãŸã€æ·±ã„è‡ªå·±æ´å¯Ÿä½“é¨“"
    />
    <title>HaQei Analyzer - æ·±ã„è‡ªå·±æ´å¯Ÿã¸ã®å…¥ã‚Šå£</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Shippori+Mincho:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- HAQEIã‚¢ãƒŠãƒ©ã‚¤ã‚¶ãƒ¼çµ±åˆCSSã‚·ã‚¹ãƒ†ãƒ  - bunenjinå“²å­¦ã«ã‚ˆã‚‹7ãƒ•ã‚¡ã‚¤ãƒ«ä½“åˆ¶ -->
    <!-- 1. åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ ï¼šãƒªã‚»ãƒƒãƒˆãƒ»å¤‰æ•°ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåŸºç›¤ -->
    <link rel="stylesheet" href="/css/core.css" />
    
    <!-- 2. UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼šãƒœã‚¿ãƒ³ãƒ»ã‚«ãƒ¼ãƒ‰ãƒ»ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  -->
    <link rel="stylesheet" href="/css/components.css" />
    
    <!-- 3. ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ»è¨­å•ãƒ»çµæœç”»é¢é…ç½® -->
    <link rel="stylesheet" href="/css/layouts.css" />
    
    <!-- 4. å¯¾è©±è¦ç´ ï¼šã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ -->
    <link rel="stylesheet" href="/css/interactive.css" />
    
    <!-- 5. çµæœè¡¨ç¤ºï¼šã‚¹ã‚³ã‚¢ãƒ»ãƒãƒ£ãƒ¼ãƒˆãƒ»è©³ç´°åˆ†æè¡¨ç¤º -->
    <link rel="stylesheet" href="/css/results.css" />
    
    <!-- 6. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ï¼šå…¨ãƒ‡ãƒã‚¤ã‚¹å¯¾å¿œãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ -->
    <link rel="stylesheet" href="/css/responsive.css" />
    
    <!-- 7. ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ ï¼šã‚«ãƒ©ãƒ¼ãƒ»å…«å¦ãƒ»å­£ç¯€ãƒ†ãƒ¼ãƒ -->
    <link rel="stylesheet" href="/css/themes.css" />
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Performance optimization integrated into VirtualQuestionFlow v2.0 -->
    
    <!-- çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Stage 1: Bootstrapèª­ã¿è¾¼ã¿ -->
    <script src="/js/core/HAQEIErrorSystemBootstrap.js"></script>
    <script>
        // Bootstrapç„¡åŠ¹åŒ–ï¼ˆå®‰å…¨ç¢ºèªã®ãŸã‚ï¼‰
        if (window.HAQEIErrorSystemBootstrap) {
            window.HAQEIErrorSystemBootstrap.prototype.config = 
                Object.assign(window.HAQEIErrorSystemBootstrap.prototype.config || {}, {
                    autoInitialize: false
                });
        }
    </script>
    
    <!-- Stage 2: è¨­å®šãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼çµ±åˆ -->
    <script src="/js/core/HAQEIConfigurationManager.js"></script>
    <script>
        // è¨­å®šãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–ï¼ˆé–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            if (window.HAQEIConfigurationManager) {
                window.haqeiConfig = new HAQEIConfigurationManager({
                    system: { 
                        debugMode: true,
                        environment: 'staging' 
                    }
                });
            }
        });
    </script>
    
    <!-- Stage 3: çµ±ä¸€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å°å…¥ -->
    <script src="/js/core/UnifiedErrorHandler.js"></script>
    <script src="/js/core/GlobalErrorSystemInitializer.js"></script>
    <script src="/js/shared/core/HAQEIErrorManager.js"></script>
    <script src="/js/components/ErrorDisplayUI.js"></script>
    <script>
        // æ®µéšçš„åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ã®ä¸¦è¡Œé‹ç”¨ãƒ¢ãƒ¼ãƒ‰
                if (window.GlobalErrorSystemInitializer) {
                    const initializer = new GlobalErrorSystemInitializer({
                        migrationStrategy: 'gradual',
                        backwardCompatibility: true,
                        debugMode: true
                    });
                    
                    const result = await initializer.initialize();
                    console.log('ğŸ¯ çµ±ä¸€ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–:', result);
                }
            } catch (error) {
                console.warn('âš ï¸ çµ±ä¸€ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å¤±æ•—ï¼ˆæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã§ç¶™ç¶šï¼‰:', error);
            }
        });
    </script>
    
    <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç”¨CSSçµ±åˆæ¸ˆã¿ï¼ˆcore.cssã«å«ã‚€ï¼‰ -->
    
    <!-- Stage 4: OSAnalyzerçµ±åˆãƒ‘ãƒƒãƒé©ç”¨ -->
    <script src="/js/core/OSAnalyzerIntegrationPatch.js"></script>
    <script>
        // å®Œå…¨çµ±åˆãƒ¢ãƒ¼ãƒ‰
        document.addEventListener('DOMContentLoaded', function() {
            // çµ±åˆãƒ‘ãƒƒãƒè‡ªå‹•é©ç”¨ï¼ˆæ—¢ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§å®Ÿè£…æ¸ˆã¿ï¼‰
            console.log('ğŸ”§ OSAnalyzerçµ±åˆãƒ‘ãƒƒãƒé©ç”¨æº–å‚™å®Œäº†');
        });
    </script>
    
    <!-- Welcome Screen Cleaner -->
    <script src="/js/welcome-screen-cleaner.js"></script>
    
    <!-- Question fixes integrated into VirtualQuestionFlow v2.0 -->
    
    <!-- Welcome Screen Fixçµ±åˆæ¸ˆã¿ï¼ˆlayouts.cssã«å«ã‚€ï¼‰ -->
    
    <!-- All fixes integrated into VirtualQuestionFlow v2.0 -->
  </head>
  <body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã‚¹ã‚­ãƒƒãƒ—</a>
    <!-- åˆæœŸã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ä¿®æ­£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å¿…ãšä¸Šéƒ¨ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’è¨­å®š
      window.addEventListener('load', function() {
        window.scrollTo(0, 0);
        document.documentElement.scrollTop = 0;
        document.body.scrollTop = 0;
      });
      
      // DOMèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚‚å®Ÿè¡Œ
      document.addEventListener('DOMContentLoaded', function() {
        window.scrollTo(0, 0);
        document.documentElement.scrollTop = 0;
        document.body.scrollTop = 0;
      });
    </script>
    
    <!-- Global Progress Indicator -->
    <div class="global-progress">
      <div class="progress-bar" style="width: var(--progress, 0%)"></div>
    </div>

    <!-- Main Application Container -->
    <div id="app" class="app-container">
      <!-- Live Region for Screen Reader Announcements -->
      <div id="announcements" class="sr-only" aria-live="polite" role="status"></div>
      <!-- Welcome Screen -->
      <section id="welcome-container" class="screen-container" role="main" aria-labelledby="welcome-title">
        <!-- WelcomeScreen component will render here -->
      </section>

      <!-- Questions Flow -->
      <section
        id="questions-container"
        class="screen-container"
        style="display: none"
      >
        <!-- QuestionFlow component will render here -->
        <!-- HaqeiQuestionElement v2.0 will be dynamically inserted here -->
        <!-- Example: <haqei-question data-question-id="q1" data-question-type="value" animated></haqei-question> -->
      </section>

      <!-- Analysis View -->
      <section
        id="analysis-container"
        class="screen-container"
        style="display: none"
      >
        <!-- AnalysisView component will render here -->
      </section>

      <!-- Results View -->
      <section
        id="results-container"
        class="screen-container"
        style="display: none"
      >
        <!-- ResultsView component will render here -->
      </section>

      <!-- Deep Insights Panel -->
      <section
        id="insights-container"
        class="screen-container"
        style="display: none"
      >
        <!-- InsightPanel component will render here -->
      </section>
    </div>

    <!-- Error Display Container -->
    <div id="data-manager-errors" class="error-container" style="display: none;">
      <!-- ErrorHandler will render error messages here -->
    </div>

    <!-- HAQEI Help System Container -->
    <div id="haqei-help-container">
      <!-- Help system components will be inserted here -->
    </div>

    <!-- ğŸš€ Ultra Critical Path - çµ¶å¯¾å¿…è¦æœ€å°é™ã®ã¿ (50KBä»¥ä¸‹ç›®æ¨™) -->
    <!-- Preload critical resources for better performance -->
    <link rel="preload" href="/js/shared/core/BaseComponent.js" as="script">
    <link rel="preload" href="/js/shared/data/questions.js" as="script">
    <link rel="preload" href="/js/os-analyzer/core/PrecompiledQuestions.js" as="script">
    
    <script src="/js/shared/core/BaseComponent.js"></script>
    <script src="/js/shared/core/MicroStorageManager.js"></script>
    <script src="/js/shared/core/BridgeStorageManager.js"></script>
    <script src="/js/shared/core/SimpleStorageManager.js"></script>
    <script src="/js/shared/core/MicroDataManager.js"></script>
    <script src="/js/shared/data/questions.js"></script>
    <script src="/js/os-analyzer/core/PrecompiledQuestions.js"></script>
    
    <!-- ğŸ¯ è³ªå•è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  v2.0 çµ±åˆï¼ˆä¾å­˜é–¢ä¿‚é †ï¼‰-->
    <script src="/js/ui/DisplayController.js"></script>
    <script src="/js/ui/QuestionManager.js"></script>
    
    <!-- ğŸš€ Core UI - è¶…é«˜é€Ÿã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ -->
    <script src="/js/os-analyzer/components/WelcomeScreen.js"></script>
    <script src="/js/os-analyzer/components/HaqeiQuestionElement.js"></script>
    <script src="/js/os-analyzer/utils/TouchGestureHandler.js"></script>
    
    <!-- Performance Enhancement Dependencies - VirtualQuestionFlow.js needs these -->
    <script src="/js/core/CacheManager.js"></script>
    <script src="/js/core/PerformanceOptimizer.js"></script>
    
    <!-- VirtualQuestionFlow v2.0 Modular System -->
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-core.js"></script>
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-renderer.js"></script>
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-navigator.js"></script>
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-state.js"></script>
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-utils.js"></script>
    <script src="/js/os-analyzer/components/VirtualQuestionFlow-v2.js"></script>
    
    <!-- HAQEI Help System (removed - loaded in app init section to prevent duplicates) -->
    
    <!-- â³ ALL OTHER SCRIPTS - è¨­å•å®Œäº†å¾Œã«å‹•çš„èª­ã¿è¾¼ã¿ -->
    <!-- ä»¥ä¸‹ã¯å…¨ã¦è¨­å•å®Œäº†å¾Œã¾ãŸã¯ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã§èª­ã¿è¾¼ã¿ -->
    
    <!-- ğŸš« å…¨ã¦ã®éå¿…é ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ãƒ­ãƒ¼ãƒ‰ã«å¤‰æ›´ -->
    <!-- ã“ã‚Œã‚‰ã¯å…¨ã¦app.jsã®å‹•çš„ãƒ­ãƒ¼ãƒ‰ã«ç§»è¡Œ -->

    <!-- ãƒ‡ãƒãƒƒã‚°ç”¨ãƒœã‚¿ãƒ³ -->
    <div id="debug-panel" style="position: fixed; top: 10px; right: 10px; z-index: 9999; background: rgba(0,0,0,0.8); padding: 10px; border-radius: 5px; display: none;">
      <button onclick="debugTripleOS()" style="background: #444; color: #fff; border: 1px solid #666; padding: 5px 10px; margin: 2px; cursor: pointer;">Triple OS ãƒ‡ãƒãƒƒã‚°</button>
      <button onclick="checkAnswerFormat()" style="background: #444; color: #fff; border: 1px solid #666; padding: 5px 10px; margin: 2px; cursor: pointer;">å›ç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèª</button>
      <button onclick="toggleDebugPanel()" style="background: #600; color: #fff; border: 1px solid #800; padding: 5px 10px; margin: 2px; cursor: pointer;">é–‰ã˜ã‚‹</button>
    </div>
    
    <!-- Service Worker ç™»éŒ² -->
    <script>
      // ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ«è¡¨ç¤ºï¼ˆCtrl+Shift+Dï¼‰
      document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.shiftKey && e.key === 'D') {
          document.getElementById('debug-panel').style.display = 'block';
        }
      });
      
      function toggleDebugPanel() {
        document.getElementById('debug-panel').style.display = 'none';
      }
      
      async function debugTripleOS() {
        console.log('ğŸ”¬ Triple OS ãƒ‡ãƒãƒƒã‚°é–‹å§‹');
        
        try {
          // ç¾åœ¨ã®å›ç­”ã‚’ç¢ºèª
          const answers = JSON.parse(localStorage.getItem('haqei_answers') || '[]');
          console.log('ğŸ“ ç¾åœ¨ã®å›ç­”æ•°:', answers.length);
          
          if (answers.length > 0) {
            console.log('ğŸ“„ å›ç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹:', answers[0]);
            
            // å›ç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä¿®æ­£
            const fixedAnswers = answers.map(answer => {
              if (!answer.selectedChoice && answer.selectedValue) {
                return {
                  ...answer,
                  selectedChoice: `${answer.questionId}${answer.selectedValue.toLowerCase()}`,
                  choiceText: answer.choiceText || `é¸æŠè‚¢${answer.selectedValue}`
                };
              }
              return answer;
            });
            
            console.log('ğŸ”§ ä¿®æ­£å¾Œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹:', fixedAnswers[0]);
            localStorage.setItem('haqei_answers', JSON.stringify(fixedAnswers));
            
            // ç›´æ¥åˆ†æã‚’å®Ÿè¡Œ
            if (window.proceedToAnalysis) {
              console.log('ğŸš€ åˆ†æã‚’ç›´æ¥å®Ÿè¡Œ...');
              window.proceedToAnalysis(fixedAnswers);
            } else {
              console.log('âš ï¸ proceedToAnalysis ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            }
          } else {
            console.log('âš ï¸ å›ç­”ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
          }
        } catch (error) {
          console.error('âŒ ãƒ‡ãƒãƒƒã‚°ã‚¨ãƒ©ãƒ¼:', error);
        }
      }
      
      function checkAnswerFormat() {
        const answers = JSON.parse(localStorage.getItem('haqei_answers') || '[]');
        console.log('ğŸ“Š å›ç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆåˆ†æ:');
        console.log('ç·æ•°:', answers.length);
        
        if (answers.length > 0) {
          const sample = answers[0];
          console.log('ã‚µãƒ³ãƒ—ãƒ«:', sample);
          console.log('å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:');
          console.log('- questionId:', !!sample.questionId);
          console.log('- selectedValue:', !!sample.selectedValue);
          console.log('- selectedChoice:', !!sample.selectedChoice);
          console.log('- choiceText:', !!sample.choiceText);
        }
      }
      
      // Service Workerå®Œå…¨ç„¡åŠ¹åŒ–ï¼ˆDataManager.js 404å•é¡Œã®è§£æ±ºã¾ã§ï¼‰
      if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
        navigator.serviceWorker.controller.postMessage('CLEAR_CACHE');
        console.log('ğŸ§¹ Service Worker cache cleared');
      }
      
      // å¤ã„Service Workerã‚’å‰Šé™¤
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
          for(let registration of registrations) {
            registration.unregister();
            console.log('ğŸ—‘ï¸ Unregistered Service Worker');
          }
        });
      }
    </script>
    
    <!-- ãƒ‡ãƒ¼ã‚¿è»¢é€ä¿®æ­£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script src="/fix-data-transfer.js"></script>
    
    <!-- Enhanced Question Flow UX - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–UXæ”¹å–„ -->
    <script src="/js/enhanced-question-flow-ux.js"></script>
    
    <!-- Help System Core Components -->
    <script src="/js/help-system/core/HelpSystemCore.js"></script>
    <script src="/js/help-system/ui/HelpButton.js"></script>
    <script src="/js/help-system/ui/HelpModal.js"></script>
    <script src="/js/help-system/ui/TooltipManager.js"></script>
    <script src="/js/help-system/ui/HelpSystemUI.js"></script>
    
    <!-- Help System Integration -->
    <script src="/js/help-system/integration/haqei-element-enhancer.js"></script>
    
    <!-- Security Utilities -->
    <script src="/js/shared/utils/SecurityValidator.js"></script>
    <script src="/js/shared/utils/SecureDOM.js"></script>
    <script src="/js/shared/utils/CSRFProtection.js"></script>
    <script src="/js/shared/utils/SecureAPI.js"></script>
    <script src="/js/shared/utils/SecurityHeaders.js"></script>
    <!-- DOMPurify for HTML sanitization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js" integrity="sha512-H+rglffZ6f5gF7UJgvH4Naa+fGCgjrHKMgoFOGmcPTRwR6oILo5R+gtzNrpDp7iMV3udbymBVjkeZGNz1Em4rQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Security Patch for TripleOSResultsView -->
    <script src="/js/components/TripleOSResultsView_security_patch.js"></script>
    
    <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ– -->
    <script src="/js/app.js"></script>
    
    <!-- Help System åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
      // HAQEI Help System åˆæœŸåŒ–
      document.addEventListener('DOMContentLoaded', function() {
        try {
          // ãƒ˜ãƒ«ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ã‚’é…å»¶å®Ÿè¡Œ
          setTimeout(function() {
            if (typeof HelpSystemUI !== 'undefined') {
              window.haqeiHelpSystem = new HelpSystemUI({
                theme: 'adaptive',
                helpButtonPosition: 'bottom-right',
                animations: true,
                accessibility: true,
                components: {
                  tooltips: true,
                  modal: true,
                  tutorial: false, // TutorialOverlayãŒæœªå®Ÿè£…ã®ãŸã‚ç„¡åŠ¹åŒ–
                  helpButton: true
                }
              });
              
              console.log('âœ… HAQEI Help System initialized successfully');
              
              // åˆæœŸåŒ–å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
              document.addEventListener('haqei:helpSystemReady', function(event) {
                console.log('ğŸ¯ Help System Ready:', event.detail);
                
                // æ—¢å­˜è¦ç´ ã®è‡ªå‹•å¼·åŒ–
                if (window.haqeiHelpSystem && window.haqeiHelpSystem.enhanceExistingElements) {
                  window.haqeiHelpSystem.enhanceExistingElements();
                }
                
                // Element Enhancerã«ã‚ˆã‚‹è‡ªå‹•è¦ç´ å¼·åŒ–
                if (window.haqeiElementEnhancer) {
                  window.haqeiElementEnhancer.enhanceAllElements();
                  console.log('ğŸ¯ HAQEI elements enhanced:', window.haqeiElementEnhancer.getStats());
                }
              });
              
            } else {
              console.warn('âš ï¸ HelpSystemUI not available');
            }
          }, 1000); // 1ç§’å¾Œã«åˆæœŸåŒ–ï¼ˆæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–å®Œäº†ã‚’å¾…ã¤ï¼‰
          
        } catch (error) {
          console.error('âŒ Failed to initialize HAQEI Help System:', error);
        }
      });
      
      // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ˜ãƒ«ãƒ—é–¢æ•°
      window.showHaqeiHelp = function(term, type = 'concept', options = {}) {
        if (window.haqeiHelpSystem) {
          return window.haqeiHelpSystem.showHelp(term, type, options);
        } else {
          console.warn('Help system not initialized yet');
        }
      };
      
      // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ç™»éŒ²é–¢æ•°
      window.addHaqeiTooltip = function(element, data) {
        if (window.haqeiHelpSystem && window.haqeiHelpSystem.showTooltip) {
          window.haqeiHelpSystem.showTooltip(element, data);
        } else {
          console.warn('Help system not initialized yet');
        }
      };
      
      // ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ†ã‚¹ãƒˆç”¨é–¢æ•°
      window.testHelpSystem = function() {
        console.log('ğŸ§ª Testing HAQEI Help System...');
        
        if (window.haqeiHelpSystem) {
          console.log('ğŸ“Š Help System Stats:', window.haqeiHelpSystem.getStats());
          
          // ãƒ˜ãƒ«ãƒ—ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ãƒ†ã‚¹ãƒˆ
          window.showHaqeiHelp('bunenjin', 'concept');
          
          return true;
        } else {
          console.warn('âš ï¸ Help system not available for testing');
          return false;
        }
      };
      
      window.showHelpSystemStats = function() {
        if (window.haqeiHelpSystem) {
          console.log('ğŸ“Š Help System Stats:', window.haqeiHelpSystem.getStats());
        }
        if (window.haqeiElementEnhancer) {
          console.log('ğŸ¯ Element Enhancer Stats:', window.haqeiElementEnhancer.getStats());
        }
      };
    </script>

  </body>
</html>
