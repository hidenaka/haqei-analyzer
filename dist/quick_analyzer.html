<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HaQei クイック診断 - あなたの八卦アバターを見つけよう</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>易</text></svg>"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", "Noto Sans JP", sans-serif;
      }
      .brand-text {
        background: -webkit-linear-gradient(45deg, #a5b4fc, #e0e7ff);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
      }
      .question-card {
        background-color: rgba(31, 41, 55, 0.7);
        border: 1px solid #374151;
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        backdrop-filter: blur(10px);
      }
      .option-label {
        display: block;
        padding: 0.75rem 1.25rem;
        border: 1px solid #4b5563;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      .option-label:hover {
        background-color: #4b5563;
        border-color: #6366f1;
      }
      input[type="radio"]:checked + .option-label {
        background-color: #4338ca;
        border-color: #a5b4fc;
        color: #e0e7ff;
        font-weight: 600;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-gray-200 min-h-screen p-4 sm:p-8">
    <div
      class="w-full max-w-2xl mx-auto bg-gray-800 shadow-2xl rounded-2xl p-6 sm:p-10"
    >
      <header class="text-center mb-10">
        <a
          href="index.html"
          class="text-indigo-400 hover:text-indigo-300 mb-4 inline-block text-sm"
          >← トップページへ戻る</a
        >
        <h1 class="text-3xl sm:text-4xl font-bold brand-text tracking-wider">
          HaQei クイック診断
        </h1>
        <p class="text-gray-400 mt-2 text-lg">
          あなたの「第一印象」となる『八卦アバター』を見つけよう
        </p>
      </header>

      <div id="diagnostic-container">
        <p class="text-center text-gray-300 mb-6">
          5つの質問に直感で答えてください。
        </p>
        <div id="questions-wrapper"></div>
        <button
          id="submit-btn"
          class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 ease-in-out transform hover:scale-105"
        >
          結果を見る
        </button>
      </div>

      <div id="result-container" class="hidden text-center">
        <h2 class="text-2xl font-bold text-indigo-300 mb-4">診断結果</h2>
        <div id="result-content" class="bg-gray-900/50 p-6 rounded-xl"></div>
        <a
          href="os_analyzer.html"
          class="mt-8 inline-block bg-amber-500 hover:bg-amber-600 text-gray-900 font-bold py-2 px-6 rounded-lg transition duration-300"
        >
          さらに詳しく！３つの人格OSを特定する(無料) &rarr;
        </a>
      </div>
    </div>

    <script type="module">
      document.addEventListener("DOMContentLoaded", () => {
        // --- データ定義 ---

        // 設問データ
        const QUESTIONS = [
          {
            id: "q1",
            text: "困難な課題に直面した時、あなたはまず...",
            options: [
              { value: "A", text: "行動計画を立て、戦略的に進む" },
              { value: "B", text: "直感を信じ、まず行動してみる" },
            ],
          },
          {
            id: "q2",
            text: "チームで何かを成し遂げた時、より喜びを感じるのは...",
            options: [
              { value: "A", text: "目標を達成した「達成感」そのもの" },
              { value: "B", text: "仲間と喜びを分かち合う「一体感」" },
            ],
          },
          {
            id: "q3",
            text: "初めて会う人が多い場では...",
            options: [
              { value: "A", text: "自分の知識や個性を発揮し、注目されたい" },
              {
                value: "B",
                text: "全体の調和を考え、聞き役に徹することが多い",
              },
            ],
          },
          {
            id: "q4",
            text: "休日の過ごし方として、より好むのは...",
            options: [
              { value: "A", text: "新しい情報やスキルを学ぶ、知的な時間" },
              {
                value: "B",
                text: "家でゆっくりと休み、エネルギーを充電する時間",
              },
            ],
          },
          {
            id: "q5",
            text: "物事を進める上で、あなたがより重視するのは...",
            options: [
              {
                value: "A",
                text: "物事の隅々まで把握し、丁寧に事を進める「浸透力」",
              },
              {
                value: "B",
                text: "一度決めたことを、最後までやり遂げる「継続力」",
              },
            ],
          },
        ];

        // 八卦アバターのデータ
        const TRIGRAM_DATA = {
          1: {
            id: 1,
            name: "乾",
            avatarName: "天翔ける龍",
            description:
              "あなたは、理想を掲げ、人々を力強く牽引していく天性のリーダーとしての側面を持っています。その圧倒的なエネルギーは、困難な状況でも道を切り開く力となります。",
          },
          2: {
            id: 2,
            name: "兌",
            avatarName: "喜びの沢",
            description:
              "あなたは、楽しいコミュニケーションを通じて、人と人を繋ぎ、場を和ませる潤滑油のような側面を持っています。あなたの周りには、自然と笑顔と活気が生まれます。",
          },
          3: {
            id: 3,
            name: "離",
            avatarName: "情熱の火",
            description:
              "あなたは、物事の本質を照らし出す知性と、人々を魅了する華やかさを持っています。その情熱的なエネルギーは、芸術的な創造や自己表現において輝きを放ちます。",
          },
          4: {
            id: 4,
            name: "震",
            avatarName: "行動の雷",
            description:
              "あなたは、停滞した状況を打ち破る、エネルギッシュな行動力を持っています。その瞬発力と決断力は、新しいことを始める際の強力なエンジンとなります。",
          },
          5: {
            id: 5,
            name: "巽",
            avatarName: "しなやかな風",
            description:
              "あなたは、相手の心に寄り添い、隅々まで意思を浸透させる調整能力に長けています。その穏やかで柔軟な影響力は、対立を和らげ、物事を円滑に進めます。",
          },
          6: {
            id: 6,
            name: "坎",
            avatarName: "探求の水",
            description:
              "あなたは、困難な状況でも動じず、物事の本質を粘り強く探求する精神的な強さを持っています。その深い洞察力は、他の人が見過ごすような真実を見つけ出します。",
          },
          7: {
            id: 7,
            name: "艮",
            avatarName: "不動の山",
            description:
              "あなたは、何事にも動じない、どっしりとした安定感を持っています。一度決めたことを着実に継続する力は、長期的なプロジェクトを成功に導く大きな武器です。",
          },
          8: {
            id: 8,
            name: "坤",
            avatarName: "受容の大地",
            description:
              "あなたは、すべてを受け入れ、育む大地のようなどこまでも深い包容力を持っています。その献身的なサポート能力は、組織やチームにとって不可欠な土台となります。",
          },
        };

        // 回答と八卦スコアの対応ロジック
        const SCORING_LOGIC = {
          q1: { A: [1, 7], B: [4, 6] },
          q2: { A: [1, 3], B: [2, 8] },
          q3: { A: [3, 4], B: [8, 5] },
          q4: { A: [6, 3], B: [7, 8] },
          q5: { A: [5, 2], B: [7, 1] },
        };

        // --- DOM要素の取得 ---
        const questionsWrapper = document.getElementById("questions-wrapper");
        const submitBtn = document.getElementById("submit-btn");
        const diagnosticContainer = document.getElementById(
          "diagnostic-container"
        );
        const resultContainer = document.getElementById("result-container");
        const resultContent = document.getElementById("result-content");

        // --- 関数の定義 ---

        // 設問を描画する関数
        function displayQuestions() {
          let html = "";
          QUESTIONS.forEach((q, index) => {
            html += `
              <div class="question-card">
                <p class="font-semibold mb-4">${index + 1}. ${q.text}</p>
                <div class="space-y-3">
                  ${q.options
                    .map(
                      (opt) => `
                    <div>
                      <input type="radio" name="${q.id}" value="${opt.value}" id="${q.id}-${opt.value}" class="hidden">
                      <label for="${q.id}-${opt.value}" class="option-label">
                        ${opt.text}
                      </label>
                    </div>
                  `
                    )
                    .join("")}
                </div>
              </div>
            `;
          });
          questionsWrapper.innerHTML = html;
        }

        // 結果を計算して表示する関数
        function calculateAndShowResult() {
          const scores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0 };
          let allAnswered = true;

          QUESTIONS.forEach((q) => {
            const selected = document.querySelector(
              `input[name="${q.id}"]:checked`
            );
            if (selected) {
              const trigrams = SCORING_LOGIC[q.id][selected.value];
              trigrams.forEach((trigramId) => {
                scores[trigramId]++;
              });
            } else {
              allAnswered = false;
            }
          });

          if (!allAnswered) {
            alert("すべての質問に回答してください。");
            return;
          }

          // 最高スコアの八卦を特定
          let maxScore = -1;
          let resultTrigramId = -1;
          for (const trigramId in scores) {
            if (scores[trigramId] > maxScore) {
              maxScore = scores[trigramId];
              resultTrigramId = parseInt(trigramId, 10);
            }
          }

          // 結果をlocalStorageに保存
          try {
            const dataToStore = { avatarTrigramId: resultTrigramId };
            localStorage.setItem(
              "haqeiQuickAnalyzerData",
              JSON.stringify(dataToStore)
            );
            console.log(
              "クイック診断データをlocalStorageに保存しました:",
              dataToStore
            );
          } catch (e) {
            console.error("クイック診断データの保存に失敗しました:", e);
          }

          // 結果を表示
          const resultData = TRIGRAM_DATA[resultTrigramId];
          resultContent.innerHTML = `
            <p class="text-gray-400 mb-2">あなたの八卦アバターは...</p>
            <h3 class="text-3xl font-bold text-amber-300 mb-1">${resultData.name}</h3>
            <p class="text-xl font-semibold text-amber-400 mb-4">【${resultData.avatarName}】</p>
            <p class="text-gray-300 leading-relaxed">${resultData.description}</p>
          `;

          // 表示を切り替え
          diagnosticContainer.classList.add("hidden");
          resultContainer.classList.remove("hidden");
        }

        // --- 初期化とイベントリスナー ---
        displayQuestions();
        submitBtn.addEventListener("click", calculateAndShowResult);
      });
    </script>
  </body>
</html>
