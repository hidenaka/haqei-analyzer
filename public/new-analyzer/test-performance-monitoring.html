<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Performance Monitoring Test - HaQei Analyzer</title>
    <style>
      body {
        font-family: "Inter", sans-serif;
        margin: 20px;
        background-color: #f5f5f5;
      }
      .test-container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
      }
      .test-section h2 {
        color: #333;
        margin-top: 0;
      }
      .test-result {
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
      }
      .test-pass {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .test-fail {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .test-info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      .metrics-display {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
        margin: 10px 0;
        font-family: monospace;
        white-space: pre-wrap;
      }
      button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background-color: #0056b3;
      }
      .progress-bar {
        width: 100%;
        height: 20px;
        background-color: #e0e0e0;
        border-radius: 10px;
        overflow: hidden;
        margin: 10px 0;
      }
      .progress-fill {
        height: 100%;
        background-color: #28a745;
        transition: width 0.3s ease;
      }
    </style>
  </head>
  <body>
    <div class="test-container">
      <h1>ğŸ”§ Performance Monitoring Test Suite</h1>
      <p>
        ã“ã®ãƒ†ã‚¹ãƒˆã¯ã€HaQei Analyzer
        ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–æ©Ÿèƒ½ã®å®Ÿè£…ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚
      </p>

      <!-- Test Progress -->
      <div class="test-section">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆé€²è¡ŒçŠ¶æ³</h2>
        <div class="progress-bar">
          <div class="progress-fill" id="test-progress" style="width: 0%"></div>
        </div>
        <div id="test-status">ãƒ†ã‚¹ãƒˆæº–å‚™ä¸­...</div>
      </div>

      <!-- Performance Monitor Initialization Test -->
      <div class="test-section">
        <h2>ğŸš€ 1. PerformanceMonitor åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ</h2>
        <div id="init-test-results"></div>
        <button onclick="runInitializationTest()">åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
      </div>

      <!-- Script Loading Time Measurement Test -->
      <div class="test-section">
        <h2>â±ï¸ 2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿æ™‚é–“æ¸¬å®šãƒ†ã‚¹ãƒˆ</h2>
        <div id="script-timing-results"></div>
        <button onclick="runScriptTimingTest()">
          ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        </button>
      </div>

      <!-- Initialization Process Timing Test -->
      <div class="test-section">
        <h2>ğŸ”„ 3. åˆæœŸåŒ–ãƒ—ãƒ­ã‚»ã‚¹æ™‚é–“æ¸¬å®šãƒ†ã‚¹ãƒˆ</h2>
        <div id="init-timing-results"></div>
        <button onclick="runInitializationTimingTest()">
          åˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        </button>
      </div>

      <!-- Memory Usage Monitoring Test -->
      <div class="test-section">
        <h2>ğŸ’¾ 4. ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–ãƒ†ã‚¹ãƒˆ</h2>
        <div id="memory-monitoring-results"></div>
        <button onclick="runMemoryMonitoringTest()">
          ãƒ¡ãƒ¢ãƒªç›£è¦–ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        </button>
      </div>

      <!-- Performance Statistics Display Test -->
      <div class="test-section">
        <h2>ğŸ“ˆ 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµ±è¨ˆè¡¨ç¤ºãƒ†ã‚¹ãƒˆ</h2>
        <div id="stats-display-results"></div>
        <button onclick="runStatsDisplayTest()">çµ±è¨ˆè¡¨ç¤ºãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
      </div>

      <!-- Integration Test -->
      <div class="test-section">
        <h2>ğŸ”— 6. çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
        <div id="integration-results"></div>
        <button onclick="runIntegrationTest()">çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
      </div>

      <!-- Run All Tests -->
      <div class="test-section">
        <h2>ğŸ¯ å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</h2>
        <button onclick="runAllTests()" style="background-color: #28a745">
          ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        </button>
        <button onclick="clearResults()" style="background-color: #6c757d">
          çµæœã‚’ã‚¯ãƒªã‚¢
        </button>
      </div>

      <!-- Performance Report Display -->
      <div class="test-section">
        <h2>ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ</h2>
        <div id="performance-report" class="metrics-display"></div>
        <button onclick="displayPerformanceReport()">ãƒ¬ãƒãƒ¼ãƒˆã‚’è¡¨ç¤º</button>
      </div>
    </div>

    <!-- Load PerformanceMonitor -->
    <script src="js/core/PerformanceMonitor.js"></script>

    <script>
      // Test state management
      let testResults = {
        initialization: false,
        scriptTiming: false,
        initTiming: false,
        memoryMonitoring: false,
        statsDisplay: false,
        integration: false,
      };

      let testPerformanceMonitor = null;
      let testProgress = 0;

      // Update test progress
      function updateTestProgress() {
        const completedTests = Object.values(testResults).filter(
          (result) => result
        ).length;
        const totalTests = Object.keys(testResults).length;
        testProgress = (completedTests / totalTests) * 100;

        document.getElementById("test-progress").style.width =
          testProgress + "%";
        document.getElementById(
          "test-status"
        ).textContent = `${completedTests}/${totalTests} ãƒ†ã‚¹ãƒˆå®Œäº† (${Math.round(
          testProgress
        )}%)`;
      }

      // Helper function to display test results
      function displayTestResult(
        containerId,
        testName,
        passed,
        message,
        details = null
      ) {
        const container = document.getElementById(containerId);
        const resultDiv = document.createElement("div");
        resultDiv.className = `test-result ${
          passed ? "test-pass" : "test-fail"
        }`;

        let content = `${passed ? "âœ…" : "âŒ"} ${testName}: ${message}`;
        if (details) {
          content += `\n\nè©³ç´°:\n${details}`;
        }

        resultDiv.textContent = content;
        container.appendChild(resultDiv);
      }

      // Test 1: PerformanceMonitor Initialization
      function runInitializationTest() {
        const container = document.getElementById("init-test-results");
        container.innerHTML = "";

        try {
          // Test PerformanceMonitor class availability
          if (typeof PerformanceMonitor === "undefined") {
            displayTestResult(
              "init-test-results",
              "ã‚¯ãƒ©ã‚¹å®šç¾©ç¢ºèª",
              false,
              "PerformanceMonitor ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“"
            );
            return;
          }

          // Test PerformanceMonitor instantiation
          testPerformanceMonitor = new PerformanceMonitor({
            enableScriptTiming: true,
            enableMemoryMonitoring: true,
            enableDetailedLogging: true,
            reportingInterval: 500,
            maxHistorySize: 50,
          });

          displayTestResult(
            "init-test-results",
            "ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ",
            true,
            "PerformanceMonitor ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ"
          );

          // Test initial properties
          const hasRequiredProperties =
            testPerformanceMonitor.metrics &&
            testPerformanceMonitor.statistics &&
            testPerformanceMonitor.options;

          displayTestResult(
            "init-test-results",
            "ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¢ºèª",
            hasRequiredProperties,
            hasRequiredProperties
              ? "å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ã¾ã™"
              : "å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒä¸è¶³ã—ã¦ã„ã¾ã™"
          );

          // Test Performance API availability
          const hasPerformanceAPI =
            typeof performance !== "undefined" && performance.now;
          displayTestResult(
            "init-test-results",
            "Performance API",
            hasPerformanceAPI,
            hasPerformanceAPI
              ? "Performance API ãŒåˆ©ç”¨å¯èƒ½ã§ã™"
              : "Performance API ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"
          );

          testResults.initialization =
            hasRequiredProperties && hasPerformanceAPI;
          updateTestProgress();
        } catch (error) {
          displayTestResult(
            "init-test-results",
            "åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Test 2: Script Loading Time Measurement
      function runScriptTimingTest() {
        const container = document.getElementById("script-timing-results");
        container.innerHTML = "";

        if (!testPerformanceMonitor) {
          displayTestResult(
            "script-timing-results",
            "ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°",
            false,
            "PerformanceMonitor ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"
          );
          return;
        }

        try {
          // Test script timing start
          testPerformanceMonitor.startScriptTiming("test-script.js");

          // Simulate script loading delay
          setTimeout(() => {
            testPerformanceMonitor.endScriptTiming("test-script.js", true);

            // Check if timing was recorded
            const scriptTiming =
              testPerformanceMonitor.metrics.scriptLoadTimes.get(
                "test-script.js"
              );
            const hasValidTiming =
              scriptTiming &&
              scriptTiming.duration !== null &&
              scriptTiming.status === "loaded";

            displayTestResult(
              "script-timing-results",
              "ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿æ™‚é–“æ¸¬å®š",
              hasValidTiming,
              hasValidTiming
                ? `æ¸¬å®šæˆåŠŸ: ${scriptTiming.duration.toFixed(2)}ms`
                : "æ¸¬å®šã«å¤±æ•—ã—ã¾ã—ãŸ",
              hasValidTiming ? JSON.stringify(scriptTiming, null, 2) : null
            );

            testResults.scriptTiming = hasValidTiming;
            updateTestProgress();
          }, 100);
        } catch (error) {
          displayTestResult(
            "script-timing-results",
            "ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Test 3: Initialization Process Timing
      function runInitializationTimingTest() {
        const container = document.getElementById("init-timing-results");
        container.innerHTML = "";

        if (!testPerformanceMonitor) {
          displayTestResult(
            "init-timing-results",
            "åˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°",
            false,
            "PerformanceMonitor ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"
          );
          return;
        }

        try {
          // Test initialization phase timing
          testPerformanceMonitor.startInitializationPhase("test-phase");

          // Simulate initialization work
          setTimeout(() => {
            testPerformanceMonitor.endInitializationPhase("test-phase", true);

            // Check if phase timing was recorded
            const phaseTiming =
              testPerformanceMonitor.metrics.initializationPhases.get(
                "test-phase"
              );
            const hasValidTiming =
              phaseTiming &&
              phaseTiming.duration !== null &&
              phaseTiming.status === "completed";

            displayTestResult(
              "init-timing-results",
              "åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚ºæ™‚é–“æ¸¬å®š",
              hasValidTiming,
              hasValidTiming
                ? `æ¸¬å®šæˆåŠŸ: ${phaseTiming.duration.toFixed(2)}ms`
                : "æ¸¬å®šã«å¤±æ•—ã—ã¾ã—ãŸ",
              hasValidTiming ? JSON.stringify(phaseTiming, null, 2) : null
            );

            testResults.initTiming = hasValidTiming;
            updateTestProgress();
          }, 150);
        } catch (error) {
          displayTestResult(
            "init-timing-results",
            "åˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Test 4: Memory Usage Monitoring
      function runMemoryMonitoringTest() {
        const container = document.getElementById("memory-monitoring-results");
        container.innerHTML = "";

        if (!testPerformanceMonitor) {
          displayTestResult(
            "memory-monitoring-results",
            "ãƒ¡ãƒ¢ãƒªç›£è¦–",
            false,
            "PerformanceMonitor ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"
          );
          return;
        }

        try {
          // Test memory snapshot
          const snapshot =
            testPerformanceMonitor.takeMemorySnapshot("test-snapshot");

          if (performance.memory) {
            const hasValidSnapshot =
              snapshot &&
              snapshot.usedJSHeapSize !== undefined &&
              snapshot.usedMB !== undefined;

            displayTestResult(
              "memory-monitoring-results",
              "ãƒ¡ãƒ¢ãƒªã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ",
              hasValidSnapshot,
              hasValidSnapshot
                ? `ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæˆåŠŸ: ${snapshot.usedMB}MB`
                : "ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ",
              hasValidSnapshot ? JSON.stringify(snapshot, null, 2) : null
            );

            // Test memory monitoring start/stop
            testPerformanceMonitor.startMemoryMonitoring();

            setTimeout(() => {
              testPerformanceMonitor.stopMemoryMonitoring();

              const hasMultipleSnapshots =
                testPerformanceMonitor.metrics.memorySnapshots.length > 1;
              displayTestResult(
                "memory-monitoring-results",
                "ãƒ¡ãƒ¢ãƒªç›£è¦–æ©Ÿèƒ½",
                hasMultipleSnapshots,
                hasMultipleSnapshots
                  ? `ç›£è¦–æˆåŠŸ: ${testPerformanceMonitor.metrics.memorySnapshots.length}å€‹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ`
                  : "ç›£è¦–ã«å¤±æ•—ã—ã¾ã—ãŸ"
              );

              testResults.memoryMonitoring =
                hasValidSnapshot && hasMultipleSnapshots;
              updateTestProgress();
            }, 1200);
          } else {
            displayTestResult(
              "memory-monitoring-results",
              "ãƒ¡ãƒ¢ãƒªç›£è¦–",
              false,
              "performance.memory API ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ï¼ˆä¸€éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯åˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ï¼‰"
            );
            testResults.memoryMonitoring = true; // APIåˆ¶é™ã¯æ­£å¸¸ã¨ã¿ãªã™
            updateTestProgress();
          }
        } catch (error) {
          displayTestResult(
            "memory-monitoring-results",
            "ãƒ¡ãƒ¢ãƒªç›£è¦–",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Test 5: Performance Statistics Display
      function runStatsDisplayTest() {
        const container = document.getElementById("stats-display-results");
        container.innerHTML = "";

        if (!testPerformanceMonitor) {
          displayTestResult(
            "stats-display-results",
            "çµ±è¨ˆè¡¨ç¤º",
            false,
            "PerformanceMonitor ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"
          );
          return;
        }

        try {
          // Generate detailed report
          const report = testPerformanceMonitor.generateDetailedReport();

          const hasValidReport =
            report &&
            report.summary &&
            report.scriptTiming &&
            report.initializationPhases;

          displayTestResult(
            "stats-display-results",
            "è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ",
            hasValidReport,
            hasValidReport
              ? "ãƒ¬ãƒãƒ¼ãƒˆãŒæ­£å¸¸ã«ç”Ÿæˆã•ã‚Œã¾ã—ãŸ"
              : "ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ",
            hasValidReport ? JSON.stringify(report.summary, null, 2) : null
          );

          // Test performance rating calculation
          const rating = testPerformanceMonitor.calculatePerformanceRating();
          const hasValidRating = ["excellent", "good", "fair", "poor"].includes(
            rating
          );

          displayTestResult(
            "stats-display-results",
            "ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡",
            hasValidRating,
            hasValidRating ? `è©•ä¾¡: ${rating}` : "è©•ä¾¡ã®è¨ˆç®—ã«å¤±æ•—ã—ã¾ã—ãŸ"
          );

          // Test recommendations generation
          const recommendations =
            testPerformanceMonitor.generateRecommendations();
          const hasRecommendations = Array.isArray(recommendations);

          displayTestResult(
            "stats-display-results",
            "æ¨å¥¨äº‹é …ç”Ÿæˆ",
            hasRecommendations,
            hasRecommendations
              ? `${recommendations.length}å€‹ã®æ¨å¥¨äº‹é …ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ`
              : "æ¨å¥¨äº‹é …ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ"
          );

          testResults.statsDisplay =
            hasValidReport && hasValidRating && hasRecommendations;
          updateTestProgress();
        } catch (error) {
          displayTestResult(
            "stats-display-results",
            "çµ±è¨ˆè¡¨ç¤º",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Test 6: Integration Test
      function runIntegrationTest() {
        const container = document.getElementById("integration-results");
        container.innerHTML = "";

        try {
          // Test full workflow
          const integrationMonitor = new PerformanceMonitor({
            enableScriptTiming: true,
            enableMemoryMonitoring: true,
            enableDetailedLogging: false, // Reduce noise
            reportingInterval: 500,
          });

          // Simulate complete initialization workflow
          integrationMonitor.startInitializationPhase("integration-test");
          integrationMonitor.startScriptTiming("integration-script-1.js");
          integrationMonitor.startScriptTiming("integration-script-2.js");

          setTimeout(() => {
            integrationMonitor.endScriptTiming("integration-script-1.js", true);
            integrationMonitor.endScriptTiming("integration-script-2.js", true);
            integrationMonitor.endInitializationPhase("integration-test", true);

            // Generate final report
            const finalReport = integrationMonitor.finalize();

            const integrationSuccess =
              finalReport &&
              finalReport.summary &&
              finalReport.scriptTiming.details.length === 2 &&
              finalReport.initializationPhases.length === 1;

            displayTestResult(
              "integration-results",
              "çµ±åˆãƒ†ã‚¹ãƒˆ",
              integrationSuccess,
              integrationSuccess
                ? "å…¨æ©Ÿèƒ½ãŒæ­£å¸¸ã«é€£æºã—ã¦ã„ã¾ã™"
                : "çµ±åˆãƒ†ã‚¹ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ",
              integrationSuccess
                ? `ç·èª­ã¿è¾¼ã¿æ™‚é–“: ${finalReport.summary.totalLoadTime.toFixed(
                    2
                  )}ms\n` +
                    `ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ•°: ${finalReport.scriptTiming.details.length}\n` +
                    `åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚ºæ•°: ${finalReport.initializationPhases.length}`
                : null
            );

            testResults.integration = integrationSuccess;
            updateTestProgress();
          }, 200);
        } catch (error) {
          displayTestResult(
            "integration-results",
            "çµ±åˆãƒ†ã‚¹ãƒˆ",
            false,
            `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`
          );
        }
      }

      // Run all tests
      function runAllTests() {
        clearResults();

        runInitializationTest();

        setTimeout(() => runScriptTimingTest(), 200);
        setTimeout(() => runInitializationTimingTest(), 400);
        setTimeout(() => runMemoryMonitoringTest(), 600);
        setTimeout(() => runStatsDisplayTest(), 2000);
        setTimeout(() => runIntegrationTest(), 2500);
      }

      // Clear all results
      function clearResults() {
        const containers = [
          "init-test-results",
          "script-timing-results",
          "init-timing-results",
          "memory-monitoring-results",
          "stats-display-results",
          "integration-results",
          "performance-report",
        ];

        containers.forEach((id) => {
          const container = document.getElementById(id);
          if (container) container.innerHTML = "";
        });

        testResults = {
          initialization: false,
          scriptTiming: false,
          initTiming: false,
          memoryMonitoring: false,
          statsDisplay: false,
          integration: false,
        };

        updateTestProgress();
      }

      // Display performance report
      function displayPerformanceReport() {
        const container = document.getElementById("performance-report");

        if (!testPerformanceMonitor) {
          container.textContent = "PerformanceMonitor ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“";
          return;
        }

        try {
          const report = testPerformanceMonitor.generateDetailedReport();
          container.textContent = JSON.stringify(report, null, 2);
        } catch (error) {
          container.textContent = `ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`;
        }
      }

      // Initialize test page
      document.addEventListener("DOMContentLoaded", function () {
        updateTestProgress();

        // Display info about the test
        const infoDiv = document.createElement("div");
        infoDiv.className = "test-result test-info";
        infoDiv.textContent =
          "ğŸ’¡ ã“ã®ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¯ã€ã‚¿ã‚¹ã‚¯8ã€Œãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–æ©Ÿèƒ½ã®å®Ÿè£…ã€ã®æ¤œè¨¼ã‚’è¡Œã„ã¾ã™ã€‚å„ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ©Ÿèƒ½ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";

        const firstSection = document.querySelector(".test-section");
        firstSection.appendChild(infoDiv);
      });
    </script>
  </body>
</html>
