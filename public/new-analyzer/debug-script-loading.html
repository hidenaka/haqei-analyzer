<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Script Loading Debug</title>
  </head>
  <body>
    <h1>Script Loading Debug</h1>
    <div id="debug-output"></div>

    <script>
      console.log("=== Script Loading Debug Started ===");

      function logToPage(message) {
        const output = document.getElementById("debug-output");
        output.innerHTML += "<p>" + message + "</p>";
        console.log(message);
      }

      // データファイルの読み込み
      logToPage("Loading data files...");
    </script>

    <!-- データファイル -->
    <script src="../js/data/data_box.js"></script>
    <script src="../js/data/questions.js"></script>
    <script src="../js/data/vectors.js"></script>
    <script src="../js/data/hexagrams.js"></script>
    <script src="../js/data/hexagram_details.js"></script>
    <script src="../js/data/compatibility_definition.js"></script>
    <script src="../js/data/compatibility_matrix.js"></script>
    <script src="../js/data/action_plans.js"></script>

    <script>
      logToPage("Data files loaded. Checking data availability:");
      logToPage(
        "HAQEI_DATA: " +
          (typeof window.HAQEI_DATA !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "WORLDVIEW_QUESTIONS: " +
          (typeof window.WORLDVIEW_QUESTIONS !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "H64_8D_VECTORS: " +
          (typeof window.H64_8D_VECTORS !== "undefined" ? "OK" : "MISSING")
      );

      logToPage("Loading core classes...");
    </script>

    <!-- コアクラス -->
    <script src="js/utils/validators.js"></script>
    <script src="js/utils/animations.js"></script>
    <script src="js/core/BaseComponent.js"></script>
    <script src="js/core/StorageManager.js"></script>
    <script src="js/core/DataManager.js"></script>
    <script src="js/core/Calculator.js"></script>
    <script src="js/core/CompatibilityDataLoader.js"></script>
    <script src="js/core/Engine.js"></script>
    <script src="js/core/TripleOSEngine.js"></script>

    <script>
      logToPage("Core classes loaded. Checking class availability:");
      logToPage(
        "BaseComponent: " +
          (typeof BaseComponent !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "DataManager: " +
          (typeof DataManager !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "Calculator: " + (typeof Calculator !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "TripleOSEngine: " +
          (typeof TripleOSEngine !== "undefined" ? "OK" : "MISSING")
      );

      logToPage("Loading components...");
    </script>

    <!-- コンポーネント -->
    <script src="js/components/WelcomeScreen.js"></script>
    <script src="js/components/QuestionFlow.js"></script>
    <script src="js/components/AnalysisView.js"></script>
    <script src="js/components/ResultsView.js"></script>
    <script src="js/components/TripleOSResultsView.js"></script>
    <script src="js/components/InsightPanel.js"></script>

    <script>
      logToPage("Components loaded. Checking component availability:");
      logToPage(
        "WelcomeScreen: " +
          (typeof WelcomeScreen !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "QuestionFlow: " +
          (typeof QuestionFlow !== "undefined" ? "OK" : "MISSING")
      );
      logToPage(
        "TripleOSResultsView: " +
          (typeof TripleOSResultsView !== "undefined" ? "OK" : "MISSING")
      );

      logToPage("=== Script Loading Debug Complete ===");

      // 簡単な初期化テスト
      try {
        logToPage("Testing DataManager initialization...");
        const dataManager = new DataManager();
        logToPage("DataManager: SUCCESS");

        logToPage("Testing WelcomeScreen initialization...");
        const welcomeScreen = new WelcomeScreen(document.body);
        logToPage("WelcomeScreen: SUCCESS");
      } catch (error) {
        logToPage("ERROR: " + error.message);
        console.error("Initialization error:", error);
      }
    </script>
  </body>
</html>
