<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HaQei Analyzer - ç°¡å˜èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f0f2f5;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .warning {
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      .loading {
        background: #e2e3e5;
        color: #383d41;
        border: 1px solid #d6d8db;
      }
      h1 {
        color: #333;
        text-align: center;
      }
      h2 {
        color: #666;
        border-bottom: 2px solid #007bff;
        padding-bottom: 10px;
      }
      .summary {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .counter {
        font-size: 18px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ§ª HaQei Analyzer - ç°¡å˜èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h1>

      <div class="summary">
        <div class="counter">
          âœ… æˆåŠŸ: <span id="success-count">0</span> | âŒ å¤±æ•—:
          <span id="error-count">0</span> | âš ï¸ è­¦å‘Š:
          <span id="warning-count">0</span>
        </div>
      </div>

      <div id="test-results">
        <div class="status loading">ğŸ”„ ãƒ†ã‚¹ãƒˆé–‹å§‹ä¸­...</div>
      </div>
    </div>

    <!-- analyzer.htmlã¨åŒã˜é †åºã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èª­ã¿è¾¼ã¿ -->
    <script src="js/utils/validators.js"></script>
    <script src="js/utils/animations.js"></script>
    <script src="../js/data/data_box.js"></script>
    <script src="../js/data/questions.js"></script>
    <script src="../js/data/vectors.js"></script>
    <script src="../js/data/hexagrams.js"></script>
    <script src="../js/data/hexagram_details.js"></script>
    <script src="../js/data/compatibility_definition.js"></script>
    <script src="../js/data/compatibility_matrix.js"></script>
    <script src="../js/data/action_plans.js"></script>
    <script src="js/core/BaseComponent.js"></script>
    <script src="js/core/DataManager.js"></script>
    <script src="js/core/Calculator.js"></script>
    <script src="js/core/StorageManager.js"></script>
    <script src="js/core/Engine.js"></script>
    <script src="js/core/TripleOSEngine.js"></script>
    <script src="js/core/EightDimensionAnalysisEngine.js"></script>
    <script src="js/core/RelationshipVisualizationEngine.js"></script>
    <script src="js/core/CompatibilityDataLoader.js"></script>
    <script src="js/components/WelcomeScreen.js"></script>
    <script src="js/components/QuestionFlow.js"></script>
    <script src="js/components/AnalysisView.js"></script>
    <script src="js/components/ResultsView.js"></script>
    <script src="js/components/TripleOSResultsView.js"></script>
    <script src="js/components/InsightPanel.js"></script>

    <script>
      let successCount = 0;
      let errorCount = 0;
      let warningCount = 0;

      function addResult(message, type) {
        const resultsDiv = document.getElementById("test-results");
        const div = document.createElement("div");
        div.className = `status ${type}`;
        div.innerHTML = message;
        resultsDiv.appendChild(div);

        // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ›´æ–°
        if (type === "success") successCount++;
        else if (type === "error") errorCount++;
        else if (type === "warning") warningCount++;

        document.getElementById("success-count").textContent = successCount;
        document.getElementById("error-count").textContent = errorCount;
        document.getElementById("warning-count").textContent = warningCount;
      }

      function runSimpleTest() {
        // æœ€åˆã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
        document.getElementById("test-results").innerHTML = "";

        addResult("<h2>ğŸ“ ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ç¢ºèª</h2>", "info");

        // é‡è¦ãªãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
        const criticalData = [
          { name: "HAQEI_DATA", var: window.HAQEI_DATA },
          { name: "WORLDVIEW_QUESTIONS", var: window.WORLDVIEW_QUESTIONS },
          { name: "SCENARIO_QUESTIONS", var: window.SCENARIO_QUESTIONS },
          { name: "H64_8D_VECTORS", var: window.H64_8D_VECTORS },
        ];

        criticalData.forEach((data) => {
          if (typeof data.var !== "undefined") {
            addResult(`âœ… ${data.name} æ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ`, "success");
          } else {
            addResult(`âŒ ${data.name} ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“`, "error");
          }
        });

        addResult("<h2>ğŸ”§ ã‚¯ãƒ©ã‚¹å®šç¾©ç¢ºèª</h2>", "info");

        // é‡è¦ãªã‚¯ãƒ©ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
        const criticalClasses = [
          "BaseComponent",
          "DataManager",
          "Calculator",
          "TripleOSEngine",
          "WelcomeScreen",
          "QuestionFlow",
        ];

        criticalClasses.forEach((className) => {
          if (typeof window[className] !== "undefined") {
            addResult(`âœ… ${className} ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™`, "success");
          } else {
            addResult(`âŒ ${className} ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“`, "error");
          }
        });

        // ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãªã‚¯ãƒ©ã‚¹ã‚‚ãƒã‚§ãƒƒã‚¯
        const optionalClasses = [
          "Engine",
          "StorageManager",
          "CompatibilityDataLoader",
        ];

        optionalClasses.forEach((className) => {
          if (typeof window[className] !== "undefined") {
            addResult(
              `âœ… ${className} ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰`,
              "success"
            );
          } else {
            addResult(
              `âš ï¸ ${className} ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰`,
              "warning"
            );
          }
        });

        // æœ€çµ‚çµæœ
        addResult("<h2>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼</h2>", "info");

        const total = successCount + errorCount + warningCount;
        const successRate =
          total > 0 ? Math.round((successCount / total) * 100) : 0;

        if (errorCount === 0) {
          addResult(
            `ğŸ‰ ã™ã¹ã¦ã®é‡è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸï¼ (æˆåŠŸç‡: ${successRate}%)`,
            "success"
          );
        } else if (errorCount <= 2) {
          addResult(
            `âš ï¸ ä¸€éƒ¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å•é¡ŒãŒã‚ã‚Šã¾ã™ãŒã€åŸºæœ¬æ©Ÿèƒ½ã¯å‹•ä½œã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ (æˆåŠŸç‡: ${successRate}%)`,
            "warning"
          );
        } else {
          addResult(
            `âŒ å¤šãã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ (æˆåŠŸç‡: ${successRate}%)`,
            "error"
          );
        }

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æƒ…å ±
        if (performance.memory) {
          const memoryMB = Math.round(
            performance.memory.usedJSHeapSize / 1024 / 1024
          );
          addResult(`ğŸ’¾ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ${memoryMB}MB`, "info");
        }
      }

      // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(runSimpleTest, 500); // å°‘ã—é…å»¶ã•ã›ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ã‚’å¾…ã¤
      });
    </script>
  </body>
</html>
