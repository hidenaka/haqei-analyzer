<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Data Setup - HAQEI</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        button { padding: 10px 20px; margin: 5px; background: #007cba; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #005a87; }
        .data-display { background: #f5f5f5; padding: 10px; margin-top: 10px; border-radius: 3px; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>🧪 HAQEI テストデータセットアップ</h1>
    
    <div class="section">
        <h2>1. テストデータの挿入</h2>
        <p>仮想人格プラットフォームのテスト用データを localStorage に挿入します。</p>
        <button onclick="setupTestData()">テストデータを挿入</button>
        <button onclick="clearTestData()">テストデータをクリア</button>
        <div id="setup-status"></div>
    </div>
    
    <div class="section">
        <h2>2. 現在の localStorage データ確認</h2>
        <button onclick="checkCurrentData()">データを確認</button>
        <div id="current-data"></div>
    </div>
    
    <div class="section">
        <h2>3. テストページへのリンク</h2>
        <p>データ挿入後、以下のページでテストを実行できます：</p>
        <ul>
            <li><a href="results.html" target="_blank">results.html - メインテストページ</a></li>
            <li><a href="debug-results.html" target="_blank">debug-results.html - デバッグページ</a></li>
        </ul>
    </div>

    <script>
        /**
         * テストデータ挿入機能
         * 
         * 目的：
         * - 仮想人格プラットフォームのテスト用データをlocalStorageに挿入
         * - Triple OSの各データを含む包括的なテストケース作成
         */
        
        function setupTestData() {
            const statusDiv = document.getElementById('setup-status');
            statusDiv.innerHTML = '<div class="info">📝 テストデータを作成中...</div>';
            
            try {
                // Triple OS 診断結果データ
                const analysisResult = {
                    timestamp: new Date().toISOString(),
                    version: "test-1.0.0",
                    
                    // Engine OS (価値観システム)
                    engineOS: {
                        osName: "Creative Engine OS",
                        score: 0.78,
                        activation: 0.82,
                        hexagram: {
                            number: 1,
                            name: "乾",
                            meaning: "創造・天の力",
                            description: "強力な創造性と革新的思考を示します"
                        },
                        characteristics: {
                            primary_traits: ["創造性", "独立性", "リーダーシップ", "革新性"],
                            secondary_traits: ["直感力", "ビジョン", "決断力"],
                            challenges: ["完璧主義", "他者との協調"],
                            strengths: ["問題解決能力", "新しいアイデア創出"]
                        },
                        socialAdaptability: 0.65,
                        defensiveness: 0.45,
                        integration: 0.72,
                        flexibility: 0.85,
                        growthPotential: 0.90
                    },
                    
                    // Interface OS (社会的システム)
                    interfaceOS: {
                        osName: "Harmony Interface OS",
                        score: 0.68,
                        activation: 0.75,
                        hexagram: {
                            number: 2,
                            name: "坤",
                            meaning: "受容・大地の力",
                            description: "他者への配慮と調和的な関係性を重視します"
                        },
                        characteristics: {
                            primary_traits: ["協調性", "共感力", "適応性", "社交性"],
                            secondary_traits: ["柔軟性", "包容力", "チームワーク"],
                            challenges: ["自己主張", "境界設定"],
                            strengths: ["人間関係構築", "コミュニケーション"]
                        },
                        socialAdaptability: 0.88,
                        defensiveness: 0.35,
                        integration: 0.70,
                        flexibility: 0.75,
                        growthPotential: 0.68
                    },
                    
                    // SafeMode OS (防御システム)
                    safeModeOS: {
                        osName: "Analytical SafeMode OS",
                        score: 0.58,
                        activation: 0.62,
                        hexagram: {
                            number: 3,
                            name: "屯",
                            meaning: "困難の克服",
                            description: "慎重な分析と安全性を最優先に考えます"
                        },
                        characteristics: {
                            primary_traits: ["慎重性", "分析力", "計画性", "安定性"],
                            secondary_traits: ["リスク管理", "論理思考", "持続性"],
                            challenges: ["柔軟性不足", "過度な心配"],
                            strengths: ["問題予測", "品質管理"]
                        },
                        socialAdaptability: 0.45,
                        defensiveness: 0.85,
                        integration: 0.55,
                        flexibility: 0.40,
                        growthPotential: 0.50
                    },
                    
                    // 統合レベル情報
                    integrationLevel: {
                        overall: 0.68,
                        engineInterface: 0.72,
                        interfaceSafeMode: 0.65,
                        safeModeEngine: 0.58,
                        harmony: 0.70,
                        tension: 0.32
                    },
                    
                    // ユーザー回答データ（サンプル）
                    userAnswers: {
                        q1: 4, q2: 3, q3: 4, q4: 2, q5: 5,
                        q6: 3, q7: 4, q8: 3, q9: 4, q10: 3,
                        // ... 他の回答も含める
                    },
                    
                    // メタデータ
                    metadata: {
                        processingTime: 2.3,
                        questionCount: 30,
                        completionRate: 1.0,
                        testVersion: "comprehensive-v1"
                    }
                };
                
                // 洞察データ
                const insights = {
                    summary: "創造性豊かなリーダータイプでありながら、他者との調和も大切にするバランス型人格です。",
                    keyStrengths: [
                        "高い創造性と革新的思考",
                        "優れたコミュニケーション能力",
                        "バランスの取れた意思決定"
                    ],
                    growthAreas: [
                        "SafeModeとの統合強化",
                        "完璧主義の調整",
                        "柔軟性の向上"
                    ],
                    recommendations: [
                        "定期的な内部対話の実践",
                        "創造性と慎重性のバランス調整",
                        "他者フィードバックの積極的な活用"
                    ],
                    metaphor: {
                        story: "あなたは創造の風と大地の安定性、そして慎重な山の智恵を併せ持つ存在です。",
                        elements: ["風（創造）", "大地（調和）", "山（慎重）"],
                        integration: "3つの力が調和することで、独特な価値創造が可能になります。"
                    }
                };
                
                // データをlocalStorageに保存
                localStorage.setItem('haqei_analysis_result', JSON.stringify(analysisResult));
                localStorage.setItem('haqei_insights', JSON.stringify(insights));
                localStorage.setItem('haqei_test_mode', 'true');
                localStorage.setItem('haqei_test_timestamp', new Date().toISOString());
                
                statusDiv.innerHTML = `
                    <div class="success">✅ テストデータの挿入が完了しました！</div>
                    <div class="info">📊 Engine OS: ${(analysisResult.engineOS.score * 100).toFixed(1)}%</div>
                    <div class="info">🤝 Interface OS: ${(analysisResult.interfaceOS.score * 100).toFixed(1)}%</div>
                    <div class="info">🛡️ SafeMode OS: ${(analysisResult.safeModeOS.score * 100).toFixed(1)}%</div>
                    <div class="info">⚖️ 統合レベル: ${(analysisResult.integrationLevel.overall * 100).toFixed(1)}%</div>
                `;
                
                console.log('✅ Test data setup completed:', {
                    analysisResult,
                    insights
                });
                
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">❌ エラー: ${error.message}</div>`;
                console.error('❌ Test data setup failed:', error);
            }
        }
        
        function clearTestData() {
            const statusDiv = document.getElementById('setup-status');
            
            try {
                localStorage.removeItem('haqei_analysis_result');
                localStorage.removeItem('haqei_insights');
                localStorage.removeItem('haqei_test_mode');
                localStorage.removeItem('haqei_test_timestamp');
                
                statusDiv.innerHTML = '<div class="success">✅ テストデータをクリアしました</div>';
                console.log('✅ Test data cleared');
                
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">❌ エラー: ${error.message}</div>`;
                console.error('❌ Test data clear failed:', error);
            }
        }
        
        function checkCurrentData() {
            const dataDiv = document.getElementById('current-data');
            
            try {
                const analysisResult = localStorage.getItem('haqei_analysis_result');
                const insights = localStorage.getItem('haqei_insights');
                const testMode = localStorage.getItem('haqei_test_mode');
                const timestamp = localStorage.getItem('haqei_test_timestamp');
                
                let dataDisplay = '';
                
                if (analysisResult) {
                    const parsed = JSON.parse(analysisResult);
                    dataDisplay += `<h4>診断結果データ:</h4>`;
                    dataDisplay += `<div class="data-display">${JSON.stringify(parsed, null, 2)}</div>`;
                }
                
                if (insights) {
                    const parsed = JSON.parse(insights);
                    dataDisplay += `<h4>洞察データ:</h4>`;
                    dataDisplay += `<div class="data-display">${JSON.stringify(parsed, null, 2)}</div>`;
                }
                
                if (testMode) {
                    dataDisplay += `<h4>テストモード:</h4>`;
                    dataDisplay += `<div class="data-display">有効 (${timestamp})</div>`;
                }
                
                if (!dataDisplay) {
                    dataDisplay = '<div class="info">📋 localStorage にデータが見つかりません</div>';
                }
                
                dataDiv.innerHTML = dataDisplay;
                
            } catch (error) {
                dataDiv.innerHTML = `<div class="error">❌ エラー: ${error.message}</div>`;
                console.error('❌ Data check failed:', error);
            }
        }
        
        // ページ読み込み時に現在のデータ状況を表示
        window.addEventListener('load', () => {
            checkCurrentData();
        });
    </script>
</body>
</html>