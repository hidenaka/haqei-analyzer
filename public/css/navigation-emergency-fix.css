/**
 * Navigation Emergency Fix - ナビゲーションボタンの緊急修正
 * 他のCSSより優先度を上げて、確実に画面下部に固定
 */

/* ========================================
   最優先でナビゲーションを固定
   ======================================== */

/* VirtualQuestionFlow用 - 最高優先度 */
.navigation-controls {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  top: auto !important;
  
  /* 確実に表示 */
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  
  /* z-indexを最大に */
  z-index: 99999 !important;
  
  /* 背景とデザイン */
  background: rgba(17, 24, 39, 0.98) !important;
  backdrop-filter: blur(12px) !important;
  border-top: 2px solid rgba(99, 102, 241, 0.3) !important;
  box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.4) !important;
  
  /* レイアウト */
  justify-content: center !important;
  align-items: center !important;
  gap: 1.5rem !important;
  padding: 1.25rem !important;
  margin: 0 !important;
  
  /* safe area対応 */
  padding-bottom: calc(1.25rem + env(safe-area-inset-bottom)) !important;
  
  /* 変形を無効化 */
  transform: none !important;
  
  /* 幅と高さ */
  width: 100% !important;
  height: auto !important;
  min-height: 70px !important;
  
  /* フレックスボックスの子要素配置 */
  flex-direction: row !important;
  flex-wrap: nowrap !important;
}

/* 通常のQuestionFlow用 */
.navigation-buttons {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  top: auto !important;
  
  /* 確実に表示 */
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  
  /* z-indexを最大に */
  z-index: 99999 !important;
  
  /* 背景とデザイン */
  background: rgba(17, 24, 39, 0.98) !important;
  backdrop-filter: blur(12px) !important;
  border-top: 2px solid rgba(99, 102, 241, 0.3) !important;
  box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.4) !important;
  
  /* レイアウト */
  justify-content: center !important;
  align-items: center !important;
  gap: 1.5rem !important;
  padding: 1.25rem !important;
  margin: 0 !important;
  
  /* safe area対応 */
  padding-bottom: calc(1.25rem + env(safe-area-inset-bottom)) !important;
  
  /* 変形を無効化 */
  transform: none !important;
  
  /* 幅と高さ */
  width: 100% !important;
  height: auto !important;
  min-height: 70px !important;
}

/* ボタンスタイルの強制適用 */
.navigation-controls .nav-button,
.navigation-buttons .btn,
.navigation-controls button,
.navigation-buttons button {
  /* 確実に表示 */
  display: inline-flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  
  /* サイズ */
  min-width: 140px !important;
  height: 48px !important;
  
  /* 配置 */
  justify-content: center !important;
  align-items: center !important;
  
  /* パディングとマージン */
  padding: 0 1.5rem !important;
  margin: 0 !important;
  
  /* テキスト */
  font-size: 16px !important;
  font-weight: 600 !important;
  color: white !important;
  white-space: nowrap !important;
  text-align: center !important;
  
  /* 背景 */
  background: linear-gradient(135deg, #6366f1, #8b5cf6) !important;
  border: none !important;
  border-radius: 12px !important;
  
  /* カーソル */
  cursor: pointer !important;
  
  /* トランジション */
  transition: all 0.2s ease !important;
  
  /* z-index */
  z-index: 100000 !important;
  position: relative !important;
  
  /* ボックスシャドウ */
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3) !important;
}

/* 前へボタンの特別スタイル */
.navigation-controls .prev-button,
.navigation-buttons .btn-secondary {
  background: linear-gradient(135deg, #475569, #64748b) !important;
  box-shadow: 0 2px 8px rgba(71, 85, 105, 0.3) !important;
}

/* ホバー状態 */
.navigation-controls .nav-button:hover:not(:disabled),
.navigation-buttons .btn:hover:not(:disabled) {
  background: linear-gradient(135deg, #7c3aed, #a855f7) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 16px rgba(139, 92, 246, 0.4) !important;
}

/* 無効化状態 */
.navigation-controls .nav-button:disabled,
.navigation-buttons .btn:disabled {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
  background: #4b5563 !important;
  transform: none !important;
  box-shadow: none !important;
}

/* コンテンツエリアの調整 */
.virtual-question-flow,
.question-flow-container,
#question-container {
  /* ナビゲーションボタンと重ならないように */
  padding-bottom: 100px !important;
  margin-bottom: 0 !important;
}

/* ========================================
   モバイル対応（緊急修正）
   ======================================== */

@media (max-width: 640px) {
  .navigation-controls,
  .navigation-buttons {
    /* モバイルでは横並びを維持 */
    flex-direction: row !important;
    gap: 1rem !important;
    padding: 1rem !important;
    min-height: 60px !important;
  }
  
  .navigation-controls .nav-button,
  .navigation-buttons .btn {
    /* ボタンを小さく */
    min-width: 110px !important;
    height: 42px !important;
    font-size: 14px !important;
    padding: 0 1rem !important;
  }
  
  .virtual-question-flow,
  .question-flow-container,
  #question-container {
    padding-bottom: 80px !important;
  }
}

/* ========================================
   プログレスバーがある場合の調整
   ======================================== */

.progress-container {
  /* プログレスバーはナビゲーションの上に */
  position: fixed !important;
  bottom: 70px !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 99998 !important;
  background: rgba(17, 24, 39, 0.9) !important;
  padding: 0.5rem 1rem !important;
}

@media (max-width: 640px) {
  .progress-container {
    bottom: 60px !important;
  }
}

/* ========================================
   デバッグ用の視覚的確認
   ======================================== */

/* 開発時のみ：ナビゲーションの境界を表示 */
.debug-mode .navigation-controls,
.debug-mode .navigation-buttons {
  border: 3px solid red !important;
}

.debug-mode .navigation-controls .nav-button,
.debug-mode .navigation-buttons .btn {
  border: 2px solid yellow !important;
}