// h384-neutralizer.js
// H384_DATAã®ã€Œç¾ä»£è§£é‡ˆã®è¦ç´„ã€ã‚’åŠ©è¨€èª¿â†’çŠ¶æ³èª¬æ˜èª¿ã«æ­£è¦åŒ–ï¼ˆèµ·å‹•æ™‚ä¸€å›ï¼‰
(function(global){
  'use strict';
  function toNeutral(text){
    try {
      let t = String(text||'').trim();
      if (!t) return t;
      const pairs = [
        [/ã—ã¾ã—ã‚‡ã†(?=ã€‚|$)/g, 'ã™ã‚‹å±€é¢ã§ã™'],
        [/ã™ã¹ã(?=ã€‚|$)/g, 'ãŒæ±‚ã‚ã‚‰ã‚Œã‚„ã™ã„å±€é¢ã§ã™'],
        [/ã—ãŸã»ã†ãŒã„ã„|ã—ãŸæ–¹ãŒã„ã„/g, 'ã—ã‚„ã™ã„å±€é¢ã§ã™'],
        [/ã™ã‚‹ã®ãŒã‚ˆã„|ã™ã‚‹ã®ãŒè‰¯ã„/g, 'ã¨ãªã‚Šã‚„ã™ã„ã§ã™'],
        [/ã®ãŒã‚ˆã„|ã®ãŒè‰¯ã„/g, 'ã§ã‚ã‚‹ã“ã¨ãŒå¤šã„ã§ã™'],
        [/ãŠã™ã™ã‚ã§ã™/g, 'é¸ã°ã‚ŒãŒã¡ã§ã™'],
        [/æ¨å¥¨ã•ã‚Œã¾ã™/g, 'é©åˆã—ã‚„ã™ã„ã§ã™'],
        [/æœ›ã¾ã—ã„ã§ã—ã‚‡ã†/g, 'æœ›ã¾ã—ã„å‚¾å‘ãŒã‚ã‚Šã¾ã™'],
        [/ãŒè‰¯ã„ã§ã—ã‚‡ã†/g, 'ãŒé©ã—ã¦ã„ã‚‹å‚¾å‘ã§ã™'],
        [/ã—ã¾ã†ã¨è‰¯ã„/g, 'ã—ã‚„ã™ã„'],
        [/å¿ƒãŒã‘ã¾ã—ã‚‡ã†/g, 'å¿ƒãŒã‘ã‚‹å±€é¢ã§ã™'],
        [/ãŒæœ›ã¾ã—ã„/g, 'ãŒæœ›ã¾ã‚Œã‚‹å‚¾å‘ã§ã™'],
        [/ã—ã¦ã„ã‘ã°è‰¯ã„ã§ã™|ã—ã¦ã„ã‘ã°ã‚ˆã„ã§ã™/g, 'ã—ã¦ã„ãã‚„ã™ã„å±€é¢ã§ã™'],
        [/ã™ã‚Œã°è‰¯ã„ã§ã™|ã™ã‚Œã°ã‚ˆã„ã§ã™/g, 'ã™ã‚‹å±€é¢ã§ã™'],
        [/é€²ã‚ã°è‰¯ã„ã§ã™|é€²ã‚ã°ã‚ˆã„ã§ã™/g, 'é€²ã‚€å±€é¢ã§ã™'],
        [/è¦‹ç›´ã›ã°è‰¯ã„ã§ã™|è¦‹ç›´ã›ã°ã‚ˆã„ã§ã™/g, 'è¦‹ç›´ã—ãŒç„¦ç‚¹ã«ãªã‚Šã‚„ã™ã„å±€é¢ã§ã™'],
        [/æ•´ãˆã‚Œã°è‰¯ã„ã§ã™|æ•´ãˆã‚Œã°ã‚ˆã„ã§ã™/g, 'æ•´ãˆã‚‹å±€é¢ã§ã™'],
        [/èª¿æ•´ã™ã‚Œã°è‰¯ã„ã§ã™|èª¿æ•´ã™ã‚Œã°ã‚ˆã„ã§ã™/g, 'èª¿æ•´ãŒç„¦ç‚¹ã«ãªã‚Šã‚„ã™ã„å±€é¢ã§ã™'],
      ];
      pairs.forEach(([re, rep]) => { t = t.replace(re, rep); });
      t = t.replace(/ãã ã•ã„(?=ã€‚|$)/g, 'ã™ã‚‹å±€é¢ã§ã™');
      t = t.replace(/å¿…ãš/g, 'åŸºæœ¬çš„ã«');
      return t;
    } catch { return String(text||''); }
  }

  try {
    if (Array.isArray(global.H384_DATA)) {
      let changed = 0;
      global.H384_DATA.forEach((e)=>{
        if (e && typeof e['ç¾ä»£è§£é‡ˆã®è¦ç´„'] === 'string') {
          const before = e['ç¾ä»£è§£é‡ˆã®è¦ç´„'];
          const after = toNeutral(before);
          if (after !== before) { e['ç¾ä»£è§£é‡ˆã®è¦ç´„'] = after; changed++; }
        }
      });
      try { console.log(`ğŸ“ H384 neutralized summaries: ${changed}`); } catch {}
    } else {
      try { console.warn('H384 neutralizer: H384_DATA not array'); } catch {}
    }
  } catch (e) { try { console.warn('H384 neutralizer error:', e?.message||e); } catch {} }
})(typeof window !== 'undefined' ? window : globalThis);

