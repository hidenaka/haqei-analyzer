<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ã‚ãªãŸã®ä¸­ã«ã‚ã‚‹3ã¤ã®äººæ ¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆEngine/Interface/Safe Mode OSï¼‰ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®æˆ¦ç•¥çš„åˆ†æãƒ„ãƒ¼ãƒ«ã€‚æ˜“çµŒã‚’ãƒ¡ã‚¿ãƒ•ã‚¡ãƒ¼ã¨ã—ãŸHaQeiå“²å­¦ã«åŸºã¥ãç¾ä»£çš„ãªè‡ªå·±ç†è§£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚">
    <title>HAQEI - Triple OSä»®æƒ³äººæ ¼ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ  | HaQeiå“²å­¦ã«ã‚ˆã‚‹æˆ¦ç•¥çš„ç”Ÿæˆãƒ„ãƒ¼ãƒ«</title>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- CRITICAL: H384H64 Database - å¿…é ˆèª­ã¿è¾¼ã¿ -->
    <script src="assets/H384H64database.js"></script>
    
    <!-- ğŸŒŸ AUTHENTIC I-CHING ENERGY BALANCE ENGINE - å…¨ä½“ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹æ”¹å–„ -->
    <script src="js/core/AuthenticEnergyBalanceEngine.js"></script>
    
    <style>
        /* =================== */
        /* Critical CSS - 30KBä»¥ä¸‹ */
        /* HaQeiå“²å­¦æº–æ‹  */
        /* =================== */
        
        /* 1. ãƒªã‚»ãƒƒãƒˆ & åŸºç›¤ */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            /* HAQEI ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ */
            --primary-900: #0f172a;
            --primary-800: #1e293b;
            --primary-700: #334155;
            --primary-600: #475569;
            --primary-500: #64748b;
            --primary-400: #94a3b8;
            --primary-300: #cbd5e1;
            --primary-200: #e2e8f0;
            --primary-100: #f1f5f9;
            --primary-50: #f8fafc;
            
            --accent-500: #6366f1;
            --accent-400: #8b5cf6;
            --accent-300: #a855f7;
            
            /* åŸºæœ¬ã‚«ãƒ©ãƒ¼å¤‰æ•°ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ */
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --text-color: #374151;
            --bg-color: #f9fafb;
            
            /* ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚«ãƒ©ãƒ¼ */
            --success-500: #10b981;
            --warning-500: #f59e0b;
            --error-500: #ef4444;
            --info-500: #3b82f6;
            
            /* å…«å¦è‰²å½© */
            --trigram-qian: #FFD700;    /* ä¹¾(å¤©) */
            --trigram-dui: #87CEEB;     /* å…Œ(æ²¢) */
            --trigram-li: #FF4500;      /* é›¢(ç«) */
            --trigram-zhen: #8A2BE2;    /* éœ‡(é›·) */
            --trigram-xun: #32CD32;     /* å·½(é¢¨) */
            --trigram-kan: #1E90FF;     /* å(æ°´) */
            --trigram-gen: #708090;     /* è‰®(å±±) */
            --trigram-kun: #8B4513;     /* å¤(åœ°) */
            
            /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã‚µã‚¤ã‚º */
            --font-base: clamp(1rem, 3vw, 1.125rem);
            --font-lg: clamp(1.25rem, 4vw, 1.5rem);
            --font-xl: clamp(1.5rem, 5vw, 2rem);
            --font-2xl: clamp(2rem, 6vw, 3rem);
            
            --space-xs: clamp(0.5rem, 2vw, 0.75rem);
            --space-sm: clamp(0.75rem, 3vw, 1rem);
            --space-md: clamp(1rem, 4vw, 1.5rem);
            --space-lg: clamp(1.5rem, 5vw, 2rem);
            --space-xl: clamp(2rem, 6vw, 3rem);
            
            --radius-sm: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            
            /* ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆ */
            --tap-size: max(44px, 2.75rem);
        }
        
        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--primary-800) 0%, var(--primary-700) 50%, var(--primary-600) 100%);
            color: var(--primary-100);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* 2. ã‚³ãƒ³ãƒ†ãƒŠã‚·ã‚¹ãƒ†ãƒ  */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-md);
        }
        
        .screen {
            min-height: 100vh;
            display: none;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: var(--space-lg) var(--space-md);
        }
        
        .screen.active {
            display: flex;
        }
        
        /* 2.1 ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .welcome-container {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--space-md);
        }
        
        .hero-section {
            text-align: center;
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out;
        }
        
        .hero-title {
            font-size: clamp(2rem, 8vw, 3.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-500), var(--accent-300), #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: var(--font-lg);
            color: var(--primary-200);
            margin-bottom: var(--space-lg);
            font-weight: 300;
        }
        
        .philosophy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .philosophy-card {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.4s ease;
            animation: fadeInUp 1s ease-out;
            animation-fill-mode: both;
        }
        
        .philosophy-card:nth-child(1) { animation-delay: 0.2s; }
        .philosophy-card:nth-child(2) { animation-delay: 0.4s; }
        .philosophy-card:nth-child(3) { animation-delay: 0.6s; }
        
        .philosophy-card:hover {
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-8px);
            box-shadow: 0 16px 48px rgba(99, 102, 241, 0.2);
        }
        
        .card-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: var(--space-md);
        }
        
        .engine-icon { background: linear-gradient(135deg, #6366f1, #8b5cf6); }
        .interface-icon { background: linear-gradient(135deg, #8b5cf6, #a855f7); }
        .safemode-icon { background: linear-gradient(135deg, #10b981, #059669); }
        
        .card-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .card-description {
            color: var(--primary-300);
            line-height: 1.6;
            font-size: var(--font-sm);
        }
        
        .about-section {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out 0.8s;
            animation-fill-mode: both;
        }
        
        .about-title {
            font-size: var(--font-xl);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
            text-align: center;
        }
        
        .about-content {
            color: var(--primary-200);
            line-height: 1.7;
            font-size: var(--font-base);
        }
        
        .highlight {
            color: var(--accent-400);
            font-weight: 600;
        }
        
        .experience-section {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out 1s;
            animation-fill-mode: both;
        }
        
        .experience-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
            text-align: center;
        }
        
        .experience-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            text-align: center;
        }
        
        .step {
            color: var(--primary-200);
            font-size: var(--font-sm);
        }
        
        .step-number {
            display: block;
            width: 2rem;
            height: 2rem;
            background: var(--accent-500);
            color: white;
            border-radius: 50%;
            line-height: 2rem;
            text-align: center;
            font-weight: 600;
            margin: 0 auto var(--space-xs);
        }
        
        .cta-section {
            text-align: center;
            animation: fadeInUp 1s ease-out 1.2s;
            animation-fill-mode: both;
        }
        
        .start-button {
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            color: white;
            border: none;
            padding: var(--space-md) var(--space-xl);
            font-size: var(--font-lg);
            font-weight: 600;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
            min-height: calc(var(--tap-size) + 0.5rem);
            position: relative;
            overflow: hidden;
        }
        
        .start-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }
        
        .start-button:hover::before {
            left: 100%;
        }
        
        .start-button:hover {
            background: linear-gradient(135deg, var(--accent-400), var(--accent-300));
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
        }
        
        .disclaimer {
            margin-top: var(--space-lg);
            padding: var(--space-md);
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent-500);
        }
        
        .disclaimer-text {
            color: var(--primary-400);
            font-size: var(--font-sm);
            line-height: 1.5;
            text-align: left;
        }
        
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .pulse-animation {
            animation: pulse 2s ease-in-out infinite;
            /* ãƒ†ã‚¹ãƒˆæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®‰å®šåŒ– */
            animation-play-state: paused;
        }
        
        .pulse-animation:hover {
            animation-play-state: running;
        }
        
        /* 3. ã‚«ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ  */
        .card {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 600px;
            margin-bottom: var(--space-md);
        }
        
        .card:hover {
            border-color: rgba(99, 102, 241, 0.4);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        /* 4. ãƒœã‚¿ãƒ³ã‚·ã‚¹ãƒ†ãƒ  */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-sm) var(--space-lg);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-base);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: var(--tap-size);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--accent-400), var(--accent-300));
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }
        
        .btn-secondary {
            background: rgba(99, 102, 241, 0.1);
            color: var(--accent-400);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .btn-lg {
            padding: var(--space-md) var(--space-xl);
            font-size: var(--font-lg);
            min-height: calc(var(--tap-size) + 0.5rem);
        }
        
        /* 5. è³ªå•ã‚·ã‚¹ãƒ†ãƒ  */
        .question-card {
            margin-bottom: var(--space-xl);
        }
        
        .question-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }
        
        .question-number {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            background: var(--accent-500);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            line-height: 2rem;
            text-align: center;
            margin-bottom: var(--space-sm);
        }
        
        .question-text {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .option {
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: var(--tap-size);
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
        }
        
        .option.selected {
            border-color: var(--accent-500);
            background: rgba(99, 102, 241, 0.2);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .option-text {
            font-size: var(--font-base);
            color: var(--primary-200);
            font-weight: 500;
        }
        
        /* 6. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            margin-top: var(--space-xl);
            flex-wrap: wrap;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: var(--space-lg);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-500), var(--accent-400));
            transition: width 0.5s ease;
            border-radius: 3px;
        }
        
        /* 7. çµæœè¡¨ç¤º */
        .result-header {
            text-align: center;
            margin-bottom: var(--space-xl);
        }
        
        .result-title {
            font-size: var(--font-2xl);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
        }
        
        .os-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .os-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .os-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .os-name {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .os-score {
            font-size: var(--font-xl);
            font-weight: 700;
            margin-bottom: var(--space-md);
        }
        
        .os-description {
            font-size: var(--font-sm);
            color: var(--primary-300);
            line-height: 1.5;
        }
        
        /* 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° */
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            color: #fca5a5;
            text-align: center;
            margin: var(--space-md) 0;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-lg);
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(99, 102, 241, 0.3);
            border-top: 3px solid var(--accent-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 9. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-sm);
                max-width: 100%;
            }
            
            .welcome-container {
                padding: var(--space-sm);
            }
            
            .screen {
                padding: var(--space-md) var(--space-sm);
            }
            
            .card {
                padding: var(--space-md);
            }
            
            .nav-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .os-cards {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }
            
            /* ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
            .hero-title {
                font-size: clamp(2.5rem, 10vw, 3rem);
                margin-bottom: var(--space-md);
            }
            
            .hero-subtitle {
                font-size: var(--font-base);
                margin-bottom: var(--space-md);
            }
            
            .philosophy-grid {
                grid-template-columns: 1fr;
                gap: var(--space-md);
                margin-bottom: var(--space-lg);
            }
            
            .philosophy-card {
                padding: var(--space-md);
            }
            
            .card-icon {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1.25rem;
                margin-bottom: var(--space-sm);
            }
            
            .about-section {
                padding: var(--space-lg);
                margin-bottom: var(--space-lg);
            }
            
            .experience-section {
                padding: var(--space-md);
                margin-bottom: var(--space-lg);
            }
            
            .experience-steps {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .step {
                display: flex;
                align-items: center;
                gap: var(--space-sm);
                text-align: left;
            }
            
            .step-number {
                flex-shrink: 0;
                margin: 0;
            }
            
            .start-button {
                width: 100%;
                padding: var(--space-lg) var(--space-md);
                font-size: var(--font-base);
            }
            
            .disclaimer {
                margin-top: var(--space-md);
            }
        }
        
        @media (max-width: 480px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .philosophy-card {
                padding: var(--space-sm);
            }
            
            .about-section {
                padding: var(--space-md);
            }
            
            .experience-section {
                padding: var(--space-sm);
            }
        }
        
        /* 9. é©æ–°çš„çµæœè¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  - 4å±¤è¤‡é›‘æ€§ä¿æŒã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ */
        
        /* 4å±¤è¤‡é›‘æ€§ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .complexity-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: var(--space-xl);
            gap: var(--space-sm);
            flex-wrap: wrap;
            padding: var(--space-md);
            background: rgba(15, 23, 42, 0.4);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .tab-btn {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-lg);
            color: var(--primary-200);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: var(--tap-size);
            position: relative;
            overflow: hidden;
        }
        
        .tab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .tab-btn:hover::before {
            left: 100%;
        }
        
        .tab-btn.active,
        .tab-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: var(--accent-500);
            color: var(--primary-100);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        .tab-btn:focus {
            outline: 2px solid var(--accent-500);
            outline-offset: 2px;
        }
        
        /* å±¤ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  */
        .layer-content {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .layer-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
            animation: layerFadeIn 0.6s ease-out forwards;
        }
        
        @keyframes layerFadeIn {
            0% { opacity: 0; transform: translateY(30px) scale(0.95); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ« */
        .section-title {
            font-size: var(--font-xl);
            font-weight: 700;
            color: var(--primary-100);
            margin-bottom: var(--space-lg);
            text-align: center;
            position: relative;
            padding: var(--space-md) 0;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(135deg, var(--accent-500), var(--accent-300));
            border-radius: 2px;
        }
        
        .subsection-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-200);
            margin: var(--space-lg) 0 var(--space-md) 0;
            position: relative;
            padding-left: var(--space-md);
        }
        
        .subsection-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: linear-gradient(135deg, var(--accent-400), var(--accent-300));
            border-radius: 2px;
        }
        
        /* Triple OSç›¸äº’é–¢ä¿‚å¯è¦–åŒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .triple-os-interaction-section {
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin: var(--space-xl) 0;
            border: 1px solid rgba(99, 102, 241, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .interaction-visualization {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
            flex-wrap: wrap;
            min-height: 450px;
        }
        
        .interaction-legend {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            padding: var(--space-lg);
            background: rgba(15, 23, 42, 0.8);
            border-radius: var(--radius-md);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--primary-200);
            font-size: var(--font-sm);
            font-weight: 500;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .dynamic-balance {
            background: rgba(99, 102, 241, 0.1);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            border: 1px solid rgba(99, 102, 241, 0.3);
            margin-top: var(--space-lg);
        }
        
        /* 8æ¬¡å…ƒãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .eight-dimensional-radar {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: var(--space-xl);
            padding: var(--space-lg);
            background: rgba(15, 23, 42, 0.4);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(139, 92, 246, 0.2);
            min-height: 550px;
        }
        
        /* ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .trigram-energy-section {
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid rgba(139, 92, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .trigram-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }
        
        .trigram-card {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .trigram-card:hover {
            transform: translateY(-4px);
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.15);
        }
        
        .trigram-name {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--accent-300);
            margin-bottom: var(--space-sm);
        }
        
        .trigram-energy-value {
            font-size: var(--font-xl);
            font-weight: 700;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .trigram-description {
            color: var(--primary-200);
            font-size: var(--font-sm);
            line-height: 1.5;
        }
        
        /* ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .energy-flow-section {
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid rgba(168, 85, 247, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .energy-flow {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            padding: var(--space-lg);
            background: rgba(168, 85, 247, 0.05);
            border-radius: var(--radius-md);
            border: 1px solid rgba(168, 85, 247, 0.2);
        }
        
        /* 64å¦è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .hexagram-analysis-section {
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid rgba(251, 191, 36, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .hexagram-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .hexagram-card {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            transition: all 0.3s ease;
        }
        
        .hexagram-card:hover {
            transform: translateY(-4px);
            border-color: rgba(251, 191, 36, 0.5);
            box-shadow: 0 8px 24px rgba(251, 191, 36, 0.15);
        }
        
        .hexagram-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: #fbbf24;
            margin-bottom: var(--space-md);
        }
        
        .hexagram-content {
            color: var(--primary-200);
            line-height: 1.6;
        }
        
        .change-hexagram-section,
        .iching-wisdom-section {
            background: rgba(251, 191, 36, 0.05);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin: var(--space-lg) 0;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }
        
        .classical-wisdom {
            background: rgba(251, 191, 36, 0.08);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            border: 1px solid rgba(251, 191, 36, 0.3);
            font-size: var(--font-lg);
            line-height: 1.8;
            color: var(--primary-200);
            font-style: italic;
        }
        
        /* HaQeiå“²å­¦çµ±åˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .HaQei-integration-section {
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            border: 1px solid rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .HaQei-wisdom {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            font-size: var(--font-lg);
            line-height: 1.8;
            color: var(--primary-200);
            position: relative;
        }
        
        .HaQei-wisdom::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 20px;
            font-size: 4rem;
            color: rgba(16, 185, 129, 0.3);
            font-family: serif;
        }
        
        /* ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ´å¯Ÿã‚°ãƒªãƒƒãƒ‰ */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .insight-card {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .insight-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--success-500), rgba(16, 185, 129, 0.5));
        }
        
        .insight-card:hover {
            transform: translateY(-4px);
            border-color: rgba(16, 185, 129, 0.5);
            box-shadow: 0 8px 24px rgba(16, 185, 129, 0.15);
        }
        
        .insight-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .insight-content {
            color: var(--primary-200);
            line-height: 1.6;
            font-size: var(--font-base);
        }
        
        /* å®Ÿè·µçš„æˆ¦ç•¥ææ¡ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .strategies-container {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }
        
        .strategy-item {
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-left: 4px solid var(--success-500);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            transition: all 0.3s ease;
        }
        
        .strategy-item:hover {
            background: rgba(16, 185, 129, 0.08);
            border-left-width: 6px;
            transform: translateX(4px);
        }
        
        .strategy-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--success-500);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .strategy-description {
            color: var(--primary-200);
            line-height: 1.6;
            margin-bottom: var(--space-md);
        }
        
        .strategy-actions {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
        }
        
        .strategy-action {
            background: rgba(16, 185, 129, 0.2);
            color: var(--primary-100);
            border: none;
            border-radius: var(--radius-sm);
            padding: var(--space-xs) var(--space-sm);
            font-size: var(--font-sm);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .strategy-action:hover {
            background: rgba(16, 185, 129, 0.3);
            transform: translateY(-2px);
        }
        
        /* Virtual Persona Card Styles */
        .virtual-persona-card {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.8));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin: var(--space-md) 0;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .virtual-persona-card:hover {
            border-color: rgba(99, 102, 241, 0.6);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.2);
            transform: translateY(-2px);
        }
        
        .persona-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .persona-symbol {
            font-size: 2.5rem;
            line-height: 1;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .persona-name {
            font-size: var(--font-xl);
            font-weight: 700;
            color: var(--primary-100);
            margin: 0;
        }
        
        .persona-content {
            space-y: var(--space-sm);
        }
        
        .persona-metaphor {
            font-style: italic;
            color: var(--primary-200);
            font-size: var(--font-md);
            margin-bottom: var(--space-sm);
        }
        
        .persona-catchphrase {
            font-weight: 600;
            color: var(--accent-300);
            font-size: var(--font-md);
            margin-bottom: var(--space-md);
            text-align: center;
            padding: var(--space-sm);
            background: rgba(99, 102, 241, 0.1);
            border-radius: var(--radius-md);
            border-left: 3px solid var(--accent-400);
        }
        
        .persona-traits {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }
        
        .trait-tag {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            color: var(--accent-300);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-full);
            font-size: var(--font-sm);
            font-weight: 500;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        
        .persona-description {
            color: var(--primary-200);
            font-size: var(--font-base);
            line-height: 1.6;
            margin: 0;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .complexity-tabs {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tab-btn {
                text-align: center;
                margin-bottom: var(--space-xs);
            }
            
            .interaction-visualization {
                flex-direction: column;
                min-height: auto;
            }
            
            #os-interaction-chart {
                width: 100%;
                max-width: 350px;
                height: auto;
            }
            
            .eight-dimensional-radar {
                min-height: auto;
                padding: var(--space-md);
            }
            
            #8d-vector-chart {
                width: 100%;
                max-width: 400px;
                height: auto;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
            
            .hexagram-analysis {
                grid-template-columns: 1fr;
            }
            
            .trigram-analysis {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
        
        /* 10. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--accent-500);
            color: white;
            padding: 8px;
            z-index: 1000;
            text-decoration: none;
            border-radius: 4px;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç† */
        .btn:focus,
        .option:focus {
            outline: 2px solid var(--accent-400);
            outline-offset: 2px;
        }
        
        /* ãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å¯¾å¿œ */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        @media (prefers-contrast: high) {
            :root {
                --primary-100: #ffffff;
                --primary-200: #f0f0f0;
                --primary-300: #d0d0d0;
                --accent-500: #0066ff;
            }
            
            .btn, .option, .card {
                border-width: 2px;
            }
        }
        
        @media print {
            body {
                background: white !important;
                color: black !important;
            }
            
            .btn, .nav-controls {
                display: none !important;
            }
        }
        
        /* ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ã®è¿½åŠ  */
        @media (max-width: 480px) {
            .question-title {
                font-size: 1.1rem;
                line-height: 1.5;
                padding: var(--space-sm);
            }
            
            .option {
                padding: 12px 16px;
                font-size: 0.95rem;
                min-height: 48px;
                display: flex;
                align-items: center;
            }
            
            .nav-button, .start-button {
                min-height: 44px;
                padding: 12px 20px;
                font-size: 0.95rem;
            }
            
            .os-card {
                padding: var(--space-md);
                margin-bottom: var(--space-md);
            }
            
            .os-card h3 {
                font-size: 1.1rem;
            }
            
            .os-card p {
                font-size: 0.9rem;
                line-height: 1.5;
            }
            
            /* ã‚¹ãƒ ãƒ¼ã‚ºã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
            body {
                -webkit-overflow-scrolling: touch;
            }
            
            /* ã‚¿ãƒƒãƒ—ãƒã‚¤ãƒ©ã‚¤ãƒˆç„¡åŠ¹åŒ– */
            * {
                -webkit-tap-highlight-color: transparent;
            }
        }
        
        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>

<body>
    <!-- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ -->
    <a href="#main-content" class="skip-link">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã‚¹ã‚­ãƒƒãƒ—</a>
    
    <!-- ãƒ©ã‚¤ãƒ–ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ -->
    <div id="announcements" class="sr-only" aria-live="polite" role="status"></div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main id="main-content">
        <!-- ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢ -->
        <section id="welcome-screen" class="screen active" aria-labelledby="welcome-title">
            <div class="welcome-container">
                <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="hero-section">
                    <h1 id="welcome-title" class="hero-title">HAQEI</h1>
                    <p class="hero-subtitle">
                        ã‚ãªãŸã®ä¸­ã«ã‚ã‚‹<span class="highlight">3ã¤ã®ä»®æƒ³äººæ ¼</span>ã‚’å‰µé€ çš„ã«è¡¨ç¾ã™ã‚‹æˆ¦ç•¥çš„ç”Ÿæˆãƒ„ãƒ¼ãƒ«
                    </p>
                </div>

                <!-- HaQeiå“²å­¦èª¬æ˜ -->
                <div class="philosophy-grid">
                    <div class="philosophy-card os-card">
                        <div class="card-icon engine-icon">ğŸ¯</div>
                        <h3 class="card-title">Engine OS</h3>
                        <p class="card-description">
                            ã‚ãªãŸã®<strong>æœ¬å½“ã®ä¾¡å€¤è¦³</strong>ãŒå®¿ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€‚æ·±å±¤å¿ƒç†ã§å¤§åˆ‡ã«ã—ã¦ã„ã‚‹åˆ¤æ–­åŸºæº–ã‚„ã€äººç”Ÿã§æœ€ã‚‚é‡è¦–ã™ã‚‹æ–¹å‘æ€§ã‚’è¡¨ç¾ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€Œã‚ãªãŸã‚‰ã—ã•ã€ã®æ ¸ã¨ãªã‚‹éƒ¨åˆ†ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div class="philosophy-card os-card">
                        <div class="card-icon interface-icon">ğŸ’¬</div>
                        <h3 class="card-title">Interface OS</h3>
                        <p class="card-description">
                            <strong>ç¤¾ä¼šçš„ãªå ´é¢</strong>ã§ç¾ã‚Œã‚‹ã‚ãªãŸã®å´é¢ã€‚ä»–è€…ã¨ã®é–¢ä¿‚æ€§ã‚„ã€ãƒãƒ¼ãƒ ã§ã®å½¹å‰²ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ãªã©ã€ã€Œäººã«è¦‹ã›ã‚‹è‡ªåˆ†ã€ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div class="philosophy-card os-card">
                        <div class="card-icon safemode-icon">ğŸ›¡ï¸</div>
                        <h3 class="card-title">Safe Mode OS</h3>
                        <p class="card-description">
                            <strong>å›°é›£ãªçŠ¶æ³</strong>ã§ä½œå‹•ã™ã‚‹é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚ã‚¹ãƒˆãƒ¬ã‚¹ã‚„å±æ©Ÿçš„çŠ¶æ³ã«ãŠã„ã¦ã€ã‚ãªãŸãŒã©ã®ã‚ˆã†ãªå¯¾å‡¦ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é¸æŠã™ã‚‹å‚¾å‘ã«ã‚ã‚‹ã‹ã‚’åˆ†æã—ã¾ã™ã€‚
                        </p>
                    </div>
                </div>

                <!-- HAQEIã«ã¤ã„ã¦ -->
                <div class="about-section">
                    <h2 class="about-title">HAQEIã¨ã¯ï¼Ÿ</h2>
                    <div class="about-content">
                        <p style="margin-bottom: var(--space-md);">
                            HAQEIã¯<span class="highlight">å ã„ã‚„è¨ºæ–­ã§ã¯ã‚ã‚Šã¾ã›ã‚“</span>ã€‚å¤ä»£ä¸­å›½ã®æ™ºæ…§ã§ã‚ã‚‹æ˜“çµŒï¼ˆI-Chingï¼‰ã‚’<span class="highlight">è±Šã‹ãªãƒ¡ã‚¿ãƒ•ã‚¡ãƒ¼ãƒ»è¡¨ç¾æ‰‹æ®µ</span>ã¨ã—ã¦æ´»ç”¨ã—ã€ã‚ãªãŸã®å¤šé¢æ€§ã‚’å‰µé€ çš„ã«æå†™ã™ã‚‹<span class="highlight">ä»®æƒ³äººæ ¼ç”Ÿæˆãƒ„ãƒ¼ãƒ«</span>ã§ã™ã€‚
                        </p>
                        <p style="margin-bottom: var(--space-md);">
                            ç§ãŸã¡ã¯ã€Œã‚ãªãŸã¯â—‹â—‹ãªäººã§ã™ã€ã¨ã¯æ±ºã—ã¦æ–­è¨€ã—ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€Œ<span class="highlight">â—‹â—‹ã¨ã„ã†å´é¢ãŒå‚è€ƒã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“</span>ã€ã¨ã„ã†å½¢ã§ã€ä¸€ã¤ã®è¦–ç‚¹ã¨ã—ã¦æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚
                        </p>
                        <p>
                            ã“ã®åˆ†æçµæœã¯ç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãã‚‚ã®ã§ã¯ãªãã€ã‚ãã¾ã§<span class="highlight">æ€è€ƒææ–™</span>ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ãŸã ãã‚‚ã®ã§ã™ã€‚æœ€çµ‚çš„ãªåˆ¤æ–­ã‚„æ±ºæ–­ã¯ã€å¸¸ã«ã‚ãªãŸè‡ªèº«ãŒè¡Œã£ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>

                <!-- ä½“é¨“ã®æµã‚Œ -->
                <div class="experience-section">
                    <h3 class="experience-title">ä½“é¨“ã®æµã‚Œï¼ˆç´„5åˆ†ï¼‰</h3>
                    <div class="experience-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <p>30å•ã®è³ªå•<br><small>ä¾¡å€¤è¦³ãƒ»è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³</small></p>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <p>3ã¤ã®OSåˆ†æ<br><small>64å¦ç†è«–ã«ã‚ˆã‚‹è§£æ</small></p>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <p>æˆ¦ç•¥çš„ãƒ’ãƒ³ãƒˆ<br><small>æ´»ç”¨ã®ãŸã‚ã®è¦–ç‚¹</small></p>
                        </div>
                    </div>
                </div>

                <!-- é–‹å§‹ãƒœã‚¿ãƒ³ -->
                <div class="cta-section">
                    <button id="start-btn" class="start-button pulse-animation">
                        âœ¨ Triple OS åˆ†æã‚’é–‹å§‹ã™ã‚‹
                    </button>
                    
                    <div class="disclaimer">
                        <p class="disclaimer-text">
                            <strong>é‡è¦ãªæ³¨æ„äº‹é …ï¼š</strong> ã“ã®åˆ†æã¯ã€ã‚ãªãŸã®äººæ ¼ã‚’æ±ºå®šã¥ã‘ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¸€ã¤ã®å‚è€ƒè¦–ç‚¹ã¨ã—ã¦ã€è‡ªå·±ç†è§£ã‚„æˆ¦ç•¥çš„æ€è€ƒã®ææ–™ã¨ã—ã¦ã”æ´»ç”¨ãã ã•ã„ã€‚åˆ†æçµæœã«ä¾å­˜ã™ã‚‹ã“ã¨ãªãã€å¸¸ã«ã”è‡ªèº«ã®åˆ¤æ–­ã‚’æœ€å„ªå…ˆã—ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- è³ªå•ç”»é¢ -->
        <section id="question-screen" class="screen" aria-labelledby="question-title">
            <div class="container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>
                
                <div class="card question-card">
                    <div class="question-header">
                        <span id="question-number" class="question-number">1</span>
                        <h2 id="question-title" class="question-text"></h2>
                    </div>
                    
                    <div id="options-container" class="options" role="radiogroup" aria-labelledby="question-title">
                        <!-- å‹•çš„ã«è³ªå•ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <div class="nav-controls">
                    <button id="prev-btn" class="btn btn-secondary" disabled>å‰ã®è³ªå•</button>
                    <button id="next-btn" class="btn btn-primary" disabled>æ¬¡ã®è³ªå•</button>
                </div>
            </div>
        </section>
        
        <!-- åˆ†æä¸­ç”»é¢ -->
        <section id="analysis-screen" class="screen" aria-labelledby="analysis-title">
            <div class="container">
                <div class="card">
                    <h2 id="analysis-title" class="result-title">åˆ†æä¸­...</h2>
                    <div class="loading">
                        <div class="spinner"></div>
                        <span>Triple OSã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ†æã—ã¦ã„ã¾ã™</span>
                    </div>
                    <p style="text-align: center; color: var(--primary-300); margin-top: var(--space-lg);">
                        HaQeiå“²å­¦ã«åŸºã¥ãTriple OSåˆ†æã‚’å®Ÿè¡Œä¸­ã§ã™<br>
                        <small>64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆ</small>
                    </p>
                </div>
            </div>
        </section>
        
        <!-- çµæœç”»é¢ - é©æ–°çš„4å±¤æ§‹é€ ã‚·ã‚¹ãƒ†ãƒ  -->
        <section id="results-screen" class="screen" aria-labelledby="results-title">
            <div class="container">
                <div class="result-header">
                    <h2 id="results-title" class="result-title">Triple OSåˆ†æçµæœ</h2>
                    <p style="color: var(--primary-200);">ã‚ãªãŸã®ä¸‰é‡äººæ ¼ã‚·ã‚¹ãƒ†ãƒ  - HaQeiå“²å­¦ã«ã‚ˆã‚‹æˆ¦ç•¥çš„ç†è§£</p>
                </div>
                
                <!-- 4å±¤ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ– -->
                <div class="complexity-tabs">
                    <button class="tab-btn active" data-layer="basic">åŸºæœ¬å±¤</button>
                    <button class="tab-btn" data-layer="detailed">è©³ç´°å±¤</button>
                    <button class="tab-btn" data-layer="expert">å°‚é–€å±¤</button>
                    <button class="tab-btn" data-layer="integrated">çµ±åˆå±¤</button>
                </div>
                
                <!-- åŸºæœ¬å±¤: æ”¹è‰¯ã•ã‚ŒãŸOSæ¦‚è¦ -->
                <div class="layer-content active" data-layer="basic">
                    <div id="os-cards-container" class="os-cards">
                        <!-- å‹•çš„ã«çµæœãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                    
                    <!-- Triple OSç›¸äº’é–¢ä¿‚å¯è¦–åŒ– -->
                    <div class="triple-os-interaction-section">
                        <h3 class="section-title">ğŸ”„ Triple OSç›¸äº’é–¢ä¿‚</h3>
                        <div class="interaction-visualization">
                            <canvas id="os-interaction-chart" width="400" height="400"></canvas>
                            <div class="interaction-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #6366f1;"></span>
                                    <span>Engine OS (ä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ )</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #8b5cf6;"></span>
                                    <span>Interface OS (ç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ )</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #10b981;"></span>
                                    <span>Safe Mode OS (é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ )</span>
                                </div>
                            </div>
                        </div>
                        <div id="dynamic-balance-display" class="dynamic-balance"></div>
                    </div>
                </div>
                
                <!-- è©³ç´°å±¤: ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ -->
                <div class="layer-content" data-layer="detailed">
                    <div class="trigram-energy-section">
                        <h3 class="section-title">â˜Š ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ</h3>
                        <div class="eight-dimensional-radar" style="position: relative; height: 500px; width: 100%; max-width: 500px; margin: 0 auto;">
                            <canvas id="trigram-energy-polar-chart" width="500" height="500" style="width: 100%; height: 100%; min-width: 300px; min-height: 300px;"></canvas>
                        </div>
                        <div id="trigram-balance-analysis" class="trigram-analysis"></div>
                    </div>
                    
                    <div class="energy-flow-section">
                        <h3 class="section-title">ğŸŒŠ ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼åˆ†æ</h3>
                        <div id="energy-flow-visualization" class="energy-flow"></div>
                    </div>
                </div>
                
                <!-- å°‚é–€å±¤: 64å¦å®Œå…¨è§£é‡ˆ -->
                <div class="layer-content" data-layer="expert">
                    <!-- HaQeiè¤‡æ•°äººæ ¼å”èª¿ãƒãƒ£ãƒ¼ãƒˆ -->
                    <div class="chart-container">
                        <canvas id="haqei-persona-chart" width="400" height="400"></canvas>
                    </div>
                </div>
                <!-- 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ãƒãƒ£ãƒ¼ãƒˆç”¨Canvas -->
                <div class="chart-container" style="margin-top: var(--space-lg);">
                    <div class="chart-wrapper">
                        <canvas id="8d-vector-chart" width="500" height="500" style="width: 100%; height: 100%; min-width: 300px; min-height: 300px;"></canvas>
                    </div>
                    <div class="chart-explanation">
                        <h4>ğŸŒ¸ HaQeiè¤‡æ•°äººæ ¼å”èª¿ã‚·ã‚¹ãƒ†ãƒ </h4>
                        <p>3ã¤ã®äººæ ¼OSã®ã‚¨ãƒãƒ«ã‚®ãƒ¼é…åˆ†ã‚’å††ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã€‚å”èª¿ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹çŠ¶æ…‹ãŒç†è§£ã§ãã¾ã™ã€‚</p>
                    </div>
                    
                    <div class="hexagram-analysis-section">
                        <h3 class="section-title">â˜¯ 64å¦å®Œå…¨è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ </h3>
                        <div id="hexagram-detailed-analysis" class="hexagram-analysis"></div>
                        
                        <div class="change-hexagram-section">
                            <h4 class="subsection-title">ğŸ”„ å¤‰å¦ã‚·ã‚¹ãƒ†ãƒ  - æˆé•·ã®æ–¹å‘æ€§</h4>
                            <div id="change-hexagram-display" class="change-hexagram"></div>
                        </div>
                        
                        <div class="iching-wisdom-section">
                            <h4 class="subsection-title">ğŸ“œ å¤å…¸çš„wisdom - å¦è¾ãƒ»çˆ»è¾</h4>
                            <div id="classical-wisdom-display" class="classical-wisdom"></div>
                        </div>
                    </div>
                </div>
                
                <!-- çµ±åˆå±¤: HaQeiå“²å­¦çš„çµ±åˆ -->
                <div class="layer-content" data-layer="integrated">
                    <div class="HaQei-integration-section">
                        <h3 class="section-title">ğŸ”¯ HaQeiå“²å­¦çµ±åˆ - æˆ¦ç•¥çš„è‡ªå·±ç†è§£</h3>
                        <div id="HaQei-wisdom-display" class="HaQei-wisdom"></div>
                        
                        <div class="personalized-insights-section">
                            <h4 class="subsection-title">ğŸ’¡ ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ´å¯Ÿ</h4>
                            <div id="personalized-insights" class="insights-grid">
                                <div class="insight-card" id="growth-directions"></div>
                                <div class="insight-card" id="optimization-strategies"></div>
                                <div class="insight-card" id="stress-management"></div>
                                <div class="insight-card" id="comparative-analysis"></div>
                            </div>
                        </div>
                        
                        <div class="practical-wisdom-section">
                            <h4 class="subsection-title">ğŸ¯ å®Ÿè·µçš„æˆ¦ç•¥ææ¡ˆ</h4>
                            <div id="practical-strategies" class="strategies-container"></div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 style="color: var(--primary-100); margin-bottom: var(--space-md);">åˆ†æçµæœã‚µãƒãƒªãƒ¼</h3>
                    <div id="result-summary" style="color: var(--primary-200);">
                        <!-- å‹•çš„ã«ã‚µãƒãƒªãƒ¼ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: var(--space-xl);">
                    <button id="restart-btn" class="btn btn-secondary">
                        ã‚‚ã†ä¸€åº¦åˆ†æã™ã‚‹
                    </button>
                </div>
            </div>
        </section>
        
        <!-- ã‚¨ãƒ©ãƒ¼ç”»é¢ -->
        <section id="error-screen" class="screen" aria-labelledby="error-title">
            <div class="container">
                <div class="card">
                    <h2 id="error-title" class="result-title" style="color: var(--error-500);">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h2>
                    <div id="error-message" class="error-message">
                        <!-- å‹•çš„ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                    <div style="text-align: center; margin-top: var(--space-lg);">
                        <button id="retry-btn" class="btn btn-primary">
                            å†è©¦è¡Œ
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>





        // ==========================================
        // HAQEI Emergency Analyzer - Vanilla JS
        // HaQeiå“²å­¦æº–æ‹ ã®ç·Šæ€¥ç°¡æ˜“åˆ†æã‚·ã‚¹ãƒ†ãƒ 
        // ==========================================
        
        'use strict';
        
        // 1. 30å•è³ªå•ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾¡å€¤è¦³24å•ï¼‹ã‚·ãƒŠãƒªã‚ª6å•ï¼‰
        const QUESTIONS = [
          // Q1-Q3: ä¹¾_å‰µé€ æ€§
          {
            id: "q1",
            text: "æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å–ã‚Šçµ„ã¿ã‚’å§‹ã‚ã‚‹ã¨ãã€ã‚ãªãŸãŒæœ€ã‚‚é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ",
            category: { title: "å‰µé€ æ€§ã®æ¬¡å…ƒ", description: "æ–°ã—ã„ç‰©äº‹ã¸ã®å–ã‚Šçµ„ã¿æ–¹ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "èª°ã‚‚ã‚„ã£ãŸã“ã¨ã®ãªã„é©æ–°çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’è©¦ã™", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5, "è‰®_å®‰å®šæ€§": -1.0 } },
              { value: "B", text: "æ—¢å­˜ã®æ–¹æ³•ã‚’æ”¹è‰¯ã—ã¦ã‚ˆã‚Šè‰¯ã„ã‚‚ã®ã«ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 1.5, "å_æ¢æ±‚æ€§": 1.5, "å·½_é©å¿œæ€§": 1.0 } },
              { value: "C", text: "ã¿ã‚“ãªã§è©±ã—åˆã£ã¦æœ€é©ãªæ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -0.5 } },
              { value: "D", text: "éå»ã®æˆåŠŸä¾‹ã‚’å‚è€ƒã«ã—ã¦ç¢ºå®Ÿã«é€²ã‚ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": -1.0 } },
              { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦æŸ”è»Ÿã«æ–¹æ³•ã‚’èª¿æ•´ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 1.0, "è‰®_å®‰å®šæ€§": -0.5 } },
          },
          {
            id: "q2", 
            text: "ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæµ®ã‹ã‚“ã ã¨ãã€ã‚ãªãŸã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ã™ãã«æ–°ã—ã„å½¢ã¨ã—ã¦å…·ç¾åŒ–ã—ã¦ã¿ãŸããªã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } },
              { value: "B", text: "ã¾ãšè©³ã—ãèª¿ã¹ã¦ã‹ã‚‰å®Ÿè¡Œã«ç§»ã™", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
              { value: "C", text: "å‘¨ã‚Šã®äººã¨ç›¸è«‡ã—ã¦æ„è¦‹ã‚’èã", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": 0.5 } },
              { value: "D", text: "å®Ÿç¾å¯èƒ½æ€§ã‚’æ…é‡ã«æ¤œè¨ã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -0.5 } },
              { value: "E", text: "ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹è¨ˆã‚‰ã£ã¦æœ€é©ãªæ™‚ã«å®Ÿè¡Œã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
          },
          {
            id: "q3",
            text: "ã€Œå‰µé€ ã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¤ã„ã¦ã€ã‚ãªãŸã®è€ƒãˆã«æœ€ã‚‚è¿‘ã„ã®ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ä½•ã‚‚ãªã„ã¨ã“ã‚ã‹ã‚‰å…¨ãæ–°ã—ã„ã‚‚ã®ã‚’ç”Ÿã¿å‡ºã™ã“ã¨", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5, "å¤_å—å®¹æ€§": -1.0 } },
              { value: "B", text: "ã¿ã‚“ãªã§å”åŠ›ã—ã¦ç´ æ™´ã‚‰ã—ã„ã‚‚ã®ã‚’ä½œã‚Šä¸Šã’ã‚‹ã“ã¨", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "ä¹¾_å‰µé€ æ€§": 1.0 } },
              { value: "C", text: "æ·±ãç ”ç©¶ã—ã¦æ–°ã—ã„ç™ºè¦‹ã‚’ã™ã‚‹ã“ã¨", scoring: { "å_æ¢æ±‚æ€§": 2.5, "ä¹¾_å‰µé€ æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": -0.5 } },
              { value: "D", text: "ç€å®Ÿã«ç©ã¿é‡ã­ã¦ä¾¡å€¤ã‚ã‚‹ã‚‚ã®ã‚’ç¯‰ãã“ã¨", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": 0.5 } },
              { value: "E", text: "çŠ¶æ³ã«åˆã‚ã›ã¦æœ€é©ãªè§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": 1.0 } },
          },
          
          // Q4-Q6: éœ‡_è¡Œå‹•æ€§
          {
            id: "q4",
            text: "ã‚„ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹ã¨ãã€ã‚ãªãŸã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ï¼Ÿ",
            category: { title: "è¡Œå‹•æ€§ã®æ¬¡å…ƒ", description: "è¡Œå‹•ã¸ã®å–ã‚Šçµ„ã¿æ–¹ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "ã™ãã«è¡Œå‹•ã‚’èµ·ã“ã—ã¦å‹¢ã„ã§é€²ã‚ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.0, "è‰®_å®‰å®šæ€§": -1.5 } },
              { value: "B", text: "è¨ˆç”»ã‚’ç«‹ã¦ã¦ã‹ã‚‰ç€å®Ÿã«å®Ÿè¡Œã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "å‘¨ã‚Šã¨å”åŠ›ã—ã¦ãƒãƒ¼ãƒ ã§é€²ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": 1.0 } },
              { value: "D", text: "çŠ¶æ³ã‚’è¦‹æ¥µã‚ã¦ã‹ã‚‰æœ€é©ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‹•ã", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": 0.5 } },
              { value: "E", text: "è‡ªåˆ†ã®æ„Ÿè¦šã‚’ä¿¡ã˜ã¦ç›´æ„Ÿçš„ã«é€²ã‚ã‚‹", scoring: { "é›¢_è¡¨ç¾æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } },
          },
          {
            id: "q5",
            text: "ã‚¹ãƒˆãƒ¬ã‚¹ã‚„å›°é›£ãªçŠ¶æ³ã«ç›´é¢ã—ãŸã¨ãã€ã‚ãªãŸã®ç¬¬ä¸€åå¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "å³åº§ã«å•é¡Œè§£æ±ºã«å‘ã‘ã¦å‹•ãå‡ºã™", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.5, "å¤_å—å®¹æ€§": -1.0 } },
              { value: "B", text: "å†·é™ã«çŠ¶æ³ã‚’åˆ†æã—ã¦åŸå› ã‚’æ¢ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "ä¿¡é ¼ã§ãã‚‹äººã«ç›¸è«‡ã—ã¦æ”¯ãˆã‚’æ±‚ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 0.0 } },
              { value: "D", text: "è½ã¡ç€ã„ã¦çŠ¶æ³ãŒå¥½è»¢ã™ã‚‹ã®ã‚’å¾…ã¤", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -1.5 } },
              { value: "E", text: "æŸ”è»Ÿã«å¯¾å¿œã—ãªãŒã‚‰æœ€å–„ã®é“ã‚’æ¢ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å_æ¢æ±‚æ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": 0.5 } },
          },
          {
            id: "q6",
            text: "æ–°ã—ã„æŒ‘æˆ¦ã‚„æ©Ÿä¼šãŒã‚ã‚‹ã¨ãã€ã‚ãªãŸã®åå¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¦é£›ã³è¾¼ã¿ãŸããªã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } },
              { value: "B", text: "èˆˆå‘³æ·±ã„ãŒã€ã¾ãšè©³ã—ãèª¿ã¹ã¦ã‹ã‚‰æ±ºã‚ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "ãƒªã‚¹ã‚¯ã¨åˆ©ç›Šã‚’æ…é‡ã«å¤©ç§¤ã«ã‹ã‘ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
              { value: "D", text: "å‘¨ã‚Šã®æ„è¦‹ã‚’èã„ã¦ã‹ã‚‰åˆ¤æ–­ã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -0.5 } },
              { value: "E", text: "è‡ªåˆ†ã«ã¨ã£ã¦æœ¬å½“ã«ä¾¡å€¤ãŒã‚ã‚‹ã‹è€ƒãˆã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.0, "è‰®_å®‰å®šæ€§": 1.5, "å·½_é©å¿œæ€§": 1.0 } },
          },
          
          // Q7-Q9: å_æ¢æ±‚æ€§
          {
            id: "q7",
            text: "çŸ¥ã‚‰ãªã„ã“ã¨ã«å‡ºä¼šã£ãŸã¨ãã€ã‚ãªãŸã®åå¿œã¯ï¼Ÿ",
            category: { title: "æ¢æ±‚æ€§ã®æ¬¡å…ƒ", description: "çŸ¥è­˜ã‚„ç†è§£ã¸ã®å–ã‚Šçµ„ã¿æ–¹ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "æ·±ãæ˜ã‚Šä¸‹ã’ã¦å¾¹åº•çš„ã«ç†è§£ã—ãŸããªã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "B", text: "æ–°ã—ã„ç™ºè¦‹ã‚„å¯èƒ½æ€§ã‚’è¦‹ã¤ã‘ãŸããªã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "å_æ¢æ±‚æ€§": 2.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "ã¿ã‚“ãªã§ä¸€ç·’ã«å­¦ã³åˆã„ãŸããªã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "D", text: "å®Ÿç”¨çš„ã§å½¹ã«ç«‹ã¤éƒ¨åˆ†ã‚’çŸ¥ã‚ŠãŸããªã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.0, "å·½_é©å¿œæ€§": 1.5, "å_æ¢æ±‚æ€§": 1.5 } },
              { value: "E", text: "å¿…è¦ã«å¿œã˜ã¦å°‘ã—ãšã¤ç†è§£ã—ã¦ã„ã", scoring: { "å·½_é©å¿œæ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.0, "å_æ¢æ±‚æ€§": 0.5 } },
          },
          {
            id: "q8",
            text: "è¤‡é›‘ãªå•é¡Œã«ç›´é¢ã—ãŸã¨ãã€ã‚ãªãŸã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ï¼Ÿ",
            options: [
              { value: "A", text: "å•é¡Œã®æœ¬è³ªã‚’è¦‹æ¥µã‚ã‚‹ã¾ã§è€ƒãˆæŠœã", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
              { value: "B", text: "æ–°ã—ã„è¦–ç‚¹ã‹ã‚‰å•é¡Œã‚’æ‰ãˆç›´ã™", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "å_æ¢æ±‚æ€§": 2.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "ã„ã‚ã„ã‚ãªäººã®æ„è¦‹ã‚’èã„ã¦å‚è€ƒã«ã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å_æ¢æ±‚æ€§": 0.5 } },
              { value: "D", text: "ã¾ãšè¡Œå‹•ã—ã¦ã¿ã¦ã€ã‚„ã‚ŠãªãŒã‚‰è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "å·½_é©å¿œæ€§": 1.5, "å_æ¢æ±‚æ€§": -0.5 } },
              { value: "E", text: "éå»ã®çµŒé¨“ã‚„äº‹ä¾‹ã‚’å‚è€ƒã«ã—ã¦è§£æ±ºã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": -0.5 } },
          },
          {
            id: "q9",
            text: "å­¦ç¿’ã‚„ç ”ç©¶ã«ã¤ã„ã¦ã€ã‚ãªãŸã®å§¿å‹¢ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "çœŸç†ã‚„æœ¬è³ªã‚’è¿½æ±‚ã™ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "B", text: "æ–°ã—ã„ç™ºè¦‹ã‹ã‚‰å‰µé€ çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å¾—ãŸã„", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "å_æ¢æ±‚æ€§": 2.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "å­¦ã‚“ã ã“ã¨ã‚’ã¿ã‚“ãªã¨å…±æœ‰ã—ãŸã„", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 1.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "D", text: "å®Ÿç”Ÿæ´»ã§æ´»ç”¨ã§ãã‚‹çŸ¥è­˜ã‚’èº«ã«ã¤ã‘ãŸã„", scoring: { "å·½_é©å¿œæ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦å¿…è¦ãªçŸ¥è­˜ã‚’åŠ¹ç‡ã‚ˆãå­¦ã¶", scoring: { "å·½_é©å¿œæ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.0, "å_æ¢æ±‚æ€§": 0.5 } },
          },
          
          // Q10-Q12: è‰®_å®‰å®šæ€§
          {
            id: "q10",
            text: "é‡è¦ãªæ±ºæ–­ã‚’ã™ã‚‹ã¨ãã€ã‚ãªãŸãŒæœ€ã‚‚é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ",
            category: { title: "å®‰å®šæ€§ã®æ¬¡å…ƒ", description: "æŒç¶šæ€§ã‚„ç¢ºå®Ÿæ€§ã¸ã®ä¾¡å€¤è¦³ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "ç¢ºå®Ÿæ€§ãŒé«˜ãã€ãƒªã‚¹ã‚¯ã®å°‘ãªã„é¸æŠè‚¢", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": -1.5 } },
              { value: "B", text: "é©æ–°çš„ã§å¤§ããªå¯èƒ½æ€§ã®ã‚ã‚‹é¸æŠè‚¢", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 1.5, "è‰®_å®‰å®šæ€§": -1.0 } },
              { value: "C", text: "ã¿ã‚“ãªãŒç´å¾—ã§ãã‚‹é¸æŠè‚¢", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "è‰®_å®‰å®šæ€§": 0.5 } },
              { value: "D", text: "è«–ç†çš„ã«æœ€ã‚‚åˆç†çš„ãªé¸æŠè‚¢", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å…Œ_èª¿å’Œæ€§": -0.5 } },
              { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦æŸ”è»Ÿã«å¤‰æ›´ã§ãã‚‹é¸æŠè‚¢", scoring: { "å·½_é©å¿œæ€§": 3.0, "è‰®_å®‰å®šæ€§": -0.5, "å_æ¢æ±‚æ€§": 0.5 } },
          },
          {
            id: "q11",
            text: "é•·æœŸçš„ãªç›®æ¨™ã«ã¤ã„ã¦ã€ã‚ãªãŸã®è€ƒãˆæ–¹ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ç€å®Ÿã«ç©ã¿é‡ã­ã¦ç¢ºå®Ÿã«é”æˆã—ãŸã„", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "B", text: "å¤§èƒ†ãªæŒ‘æˆ¦ã§å¤§ããªæˆæœã‚’ç›®æŒ‡ã—ãŸã„", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } },
              { value: "C", text: "ã¿ã‚“ãªã¨ä¸€ç·’ã«æˆé•·ã—ã¦ã„ããŸã„", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "è‰®_å®‰å®šæ€§": 0.5 } },
              { value: "D", text: "æ·±ãæ¢æ±‚ã—ã¦å°‚é–€æ€§ã‚’é«˜ã‚ãŸã„", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å…Œ_èª¿å’Œæ€§": -0.5 } },
              { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦ç›®æ¨™ã‚’æŸ”è»Ÿã«èª¿æ•´ã—ãŸã„", scoring: { "å·½_é©å¿œæ€§": 2.5, "è‰®_å®‰å®šæ€§": -0.5, "ä¹¾_å‰µé€ æ€§": 1.0 } },
          },
          {
            id: "q12",
            text: "ã€Œç¶™ç¶šã€ã‚„ã€ŒæŒç¶šã€ã«ã¤ã„ã¦ã€ã‚ãªãŸã®ä¾¡å€¤è¦³ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ä¸€åº¦å§‹ã‚ãŸã“ã¨ã¯æœ€å¾Œã¾ã§ã‚„ã‚Šé‚ã’ã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.0, "å·½_é©å¿œæ€§": -0.5 } },
              { value: "B", text: "å¸¸ã«æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã—ç¶šã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.5 } },
              { value: "C", text: "ã¿ã‚“ãªã¨è‰¯ã„é–¢ä¿‚ã‚’é•·ãä¿ã¤ã“ã¨ãŒå¤§åˆ‡", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "è‰®_å®‰å®šæ€§": 1.0 } },
              { value: "D", text: "æ·±ãå­¦ã³ç¶šã‘ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "E", text: "å¤‰åŒ–ã«åˆã‚ã›ã¦é©å¿œã—ç¶šã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "å·½_é©å¿œæ€§": 3.0, "è‰®_å®‰å®šæ€§": -1.0, "ä¹¾_å‰µé€ æ€§": 1.0 } },
          },
          
          // Q13-Q15: å¤_å—å®¹æ€§
          {
            id: "q13",
            text: "ä»–ã®äººã¨ã®é–¢ã‚ã‚Šæ–¹ã§ã€ã‚ãªãŸã®ç‰¹å¾´ã¯ï¼Ÿ",
            category: { title: "å—å®¹æ€§ã®æ¬¡å…ƒ", description: "ä»–è€…ã¨ã®é–¢ã‚ã‚Šæ–¹ã‚„å—ã‘å…¥ã‚Œã‚‹åŠ›ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "ç©æ¥µçš„ã«ãƒªãƒ¼ãƒ‰ã—ã¦æ–°ã—ã„æ–¹å‘æ€§ã‚’ç¤ºã™", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0, "å¤_å—å®¹æ€§": -0.5 } },
              { value: "B", text: "ç›¸æ‰‹ã®è©±ã‚’ã˜ã£ãã‚Šèã„ã¦ç†è§£ã—ã‚ˆã†ã¨ã™ã‚‹", scoring: { "å¤_å—å®¹æ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "ãŠäº’ã„ã®æ„è¦‹ã‚’äº¤æ›ã—ã¦å­¦ã³åˆã†", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "D", text: "ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ã«æ´»å‹•ã—ã¦ç››ã‚Šä¸Šã’ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.0, "å¤_å—å®¹æ€§": -1.0 } },
              { value: "E", text: "ç›¸æ‰‹ã«åˆã‚ã›ã¦é©åˆ‡ãªè·é›¢æ„Ÿã‚’ä¿ã¤", scoring: { "å·½_é©å¿œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "é›¢_è¡¨ç¾æ€§": -0.5 } },
          },
          {
            id: "q14",
            text: "å›°ã£ã¦ã„ã‚‹äººã‚’è¦‹ã‹ã‘ãŸã¨ãã€ã‚ãªãŸã®åå¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„è§£æ±ºæ–¹æ³•ã‚’ææ¡ˆã—ã¦ã‚µãƒãƒ¼ãƒˆã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.5, "å¤_å—å®¹æ€§": 1.0 } },
              { value: "B", text: "ã¾ãšç›¸æ‰‹ã®æ°—æŒã¡ã‚’å—ã‘æ­¢ã‚ã¦å¯„ã‚Šæ·»ã†", scoring: { "å¤_å—å®¹æ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "ä¸€ç·’ã«è§£æ±ºç­–ã‚’è€ƒãˆã¦å®Ÿè¡Œã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 1.5, "å¤_å—å®¹æ€§": 1.5 } },
              { value: "D", text: "å•é¡Œã®åŸå› ã‚’åˆ†æã—ã¦æ ¹æœ¬çš„ãªè§£æ±ºã‚’å›³ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å¤_å—å®¹æ€§": 0.5 } },
              { value: "E", text: "ãã®äººã«æœ€ã‚‚é©ã—ãŸæ”¯æ´æ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å_æ¢æ±‚æ€§": 1.0 } },
          },
          {
            id: "q15",
            text: "ã€Œæ”¯ãˆã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¤ã„ã¦ã€ã‚ãªãŸã®è€ƒãˆã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„å¯èƒ½æ€§ã‚’é–‹ã„ã¦äººã‚’åŠ±ã¾ã™ã“ã¨", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.5, "å¤_å—å®¹æ€§": 1.5 } },
              { value: "B", text: "ã©ã‚“ãªæ™‚ã‚‚å¤‰ã‚ã‚‰ãšãã°ã«ã„ã‚‹ã“ã¨", scoring: { "å¤_å—å®¹æ€§": 3.0, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "å…±ã«å–œã³ã€å…±ã«æ‚²ã—ã‚€ã“ã¨", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 0.5 } },
              { value: "D", text: "å…·ä½“çš„ãªè¡Œå‹•ã§å®Ÿéš›ã«åŠ©ã‘ã‚‹ã“ã¨", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "è‰®_å®‰å®šæ€§": 1.0 } },
              { value: "E", text: "ç›¸æ‰‹ã®çŠ¶æ³ã«åˆã‚ã›ã¦æœ€é©ãªæ”¯æ´ã‚’ã™ã‚‹ã“ã¨", scoring: { "å·½_é©å¿œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0, "å_æ¢æ±‚æ€§": 0.5 } },
          },
          
          // Q16-Q18: å·½_é©å¿œæ€§
          {
            id: "q16",
            text: "äºˆæœŸã—ãªã„å¤‰åŒ–ã‚„å›°é›£ã«ç›´é¢ã—ãŸã¨ãã€ã‚ãªãŸã®å¯¾å¿œã¯ï¼Ÿ",
            category: { title: "é©å¿œæ€§ã®æ¬¡å…ƒ", description: "å¤‰åŒ–ã‚„çŠ¶æ³ã¸ã®é©å¿œåŠ›ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "ã“ã‚Œã‚’æ©Ÿä¼šã«æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0, "å·½_é©å¿œæ€§": 1.0 } },
              { value: "B", text: "çŠ¶æ³ã«åˆã‚ã›ã¦æŸ”è»Ÿã«æ–¹é‡ã‚’èª¿æ•´ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "ã¿ã‚“ãªã§å”åŠ›ã—ã¦ä¹—ã‚Šè¶Šãˆã‚‹æ–¹æ³•ã‚’æ¢ã™", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å·½_é©å¿œæ€§": 1.5 } },
              { value: "D", text: "åŸå› ã‚’åˆ†æã—ã¦æ ¹æœ¬çš„ãªå¯¾ç­–ã‚’ç«‹ã¦ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å·½_é©å¿œæ€§": 0.5 } },
              { value: "E", text: "ç¢ºå®Ÿã§å®‰å…¨ãªæ–¹æ³•ã§å¯¾å‡¦ã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "å·½_é©å¿œæ€§": -0.5 } },
          },
          {
            id: "q17",
            text: "ç•°ãªã‚‹ä¾¡å€¤è¦³ã®äººãŸã¡ã¨ä¸€ç·’ã«æ´»å‹•ã™ã‚‹ã¨ãã€ã‚ãªãŸã®å½¹å‰²ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„è¦–ç‚¹ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æä¾›ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 1.5, "å·½_é©å¿œæ€§": 1.0 } },
              { value: "B", text: "ã¿ã‚“ãªã®æ„è¦‹ã‚’èª¿æ•´ã—ã¦æ©‹æ¸¡ã—ã‚’ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 0.5 } },
              { value: "C", text: "å…¨ä½“ã®é›°å›²æ°—ã‚’å’Œã‚„ã‹ã«ä¿ã¤", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å·½_é©å¿œæ€§": 1.0 } },
              { value: "D", text: "ç©æ¥µçš„ã«è¡Œå‹•ã—ã¦å ´ã‚’ç››ã‚Šä¸Šã’ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.0, "å·½_é©å¿œæ€§": 0.5 } },
              { value: "E", text: "å®‰å®šã—ãŸåŸºç›¤ã‚’æä¾›ã—ã¦æ”¯ãˆã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "å·½_é©å¿œæ€§": -0.5 } },
          },
          {
            id: "q18",
            text: "ã€ŒæŸ”è»Ÿæ€§ã€ã«ã¤ã„ã¦ã€ã‚ãªãŸã®ä¾¡å€¤è¦³ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„å¯èƒ½æ€§ã‚’ç”Ÿã¿å‡ºã™ãŸã‚ã«å¿…è¦ãªã‚‚ã®", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "å·½_é©å¿œæ€§": 2.5, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "B", text: "ã©ã‚“ãªçŠ¶æ³ã§ã‚‚å¯¾å¿œã§ãã‚‹å¤§åˆ‡ãªèƒ½åŠ›", scoring: { "å·½_é©å¿œæ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 1.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "äººã¨ã®é–¢ä¿‚ã‚’è‰¯å¥½ã«ä¿ã¤ãŸã‚ã«é‡è¦ãªã‚‚ã®", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å·½_é©å¿œæ€§": 2.0, "å¤_å—å®¹æ€§": 1.0 } },
              { value: "D", text: "åŠ¹æœçš„ã«è¡Œå‹•ã™ã‚‹ãŸã‚ã®æ‰‹æ®µã®ä¸€ã¤", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.0, "å·½_é©å¿œæ€§": 1.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "E", text: "ä¸€è²«æ€§ãŒã‚ã£ã¦ã“ãæ„å‘³ã‚’æŒã¤ã‚‚ã®", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å·½_é©å¿œæ€§": -0.5, "å_æ¢æ±‚æ€§": 1.0 } },
          },
          
          // Q19-Q21: é›¢_è¡¨ç¾æ€§
          {
            id: "q19",
            text: "è‡ªåˆ†ã®è€ƒãˆã‚„æ°—æŒã¡ã‚’è¡¨ç¾ã™ã‚‹ã¨ãã€ã‚ãªãŸã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ï¼Ÿ",
            category: { title: "è¡¨ç¾æ€§ã®æ¬¡å…ƒ", description: "è‡ªå·±è¡¨ç¾åŠ›ã‚„å½±éŸ¿åŠ›ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "ç‹¬å‰µçš„ã§å°è±¡ã«æ®‹ã‚‹æ–¹æ³•ã§è¡¨ç¾ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 3.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "B", text: "ç›¸æ‰‹ã«åˆã‚ã›ã¦åˆ†ã‹ã‚Šã‚„ã™ãä¼ãˆã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 1.5 } },
              { value: "C", text: "è«–ç†çš„ã§èª¬å¾—åŠ›ã®ã‚ã‚‹èª¬æ˜ã‚’ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 1.0 } },
              { value: "D", text: "ç‡ç›´ã§æ­£ç›´ãªè¡¨ç¾ã‚’å¿ƒãŒã‘ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 2.0, "å…Œ_èª¿å’Œæ€§": -0.5 } },
              { value: "E", text: "ç›¸æ‰‹ã®æ°—æŒã¡ã«å¯„ã‚Šæ·»ã„ãªãŒã‚‰ä¼ãˆã‚‹", scoring: { "å¤_å—å®¹æ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 0.5 } },
          },
          {
            id: "q20",
            text: "æ³¨ç›®ã‚’æµ´ã³ã‚‹å ´é¢ã§ã€ã‚ãªãŸã®åå¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "è‡ªåˆ†ã‚‰ã—ã•ã‚’æ€ã„åˆ‡ã‚Šç™ºæ®ã™ã‚‹", scoring: { "é›¢_è¡¨ç¾æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.5, "å¤_å—å®¹æ€§": -0.5 } },
              { value: "B", text: "å ´ã®é›°å›²æ°—ã«åˆã‚ã›ã¦é©åˆ‡ã«æŒ¯ã‚‹èˆã†", scoring: { "å·½_é©å¿œæ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 0.5 } },
              { value: "C", text: "ã¿ã‚“ãªãŒæ¥½ã—ã‚ã‚‹ã‚ˆã†ã«é…æ…®ã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 1.0 } },
              { value: "D", text: "æ§ãˆã‚ã«æŒ¯ã‚‹èˆã£ã¦ç›®ç«‹ãŸãªã„ã‚ˆã†ã«ã™ã‚‹", scoring: { "å¤_å—å®¹æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "é›¢_è¡¨ç¾æ€§": -1.0 } },
              { value: "E", text: "ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ã«è¡Œå‹•ã—ã¦å ´ã‚’ç››ã‚Šä¸Šã’ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.5, "è‰®_å®‰å®šæ€§": -0.5 } },
          },
          {
            id: "q21",
            text: "ã€Œå½±éŸ¿åŠ›ã‚’æŒã¤ã€ã¨ã„ã†ã“ã¨ã«ã¤ã„ã¦ã€ã‚ãªãŸã®è€ƒãˆã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„ä¾¡å€¤è¦³ã‚„å¯èƒ½æ€§ã‚’ä¼ãˆã‚‹åŠ›", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.5, "å¤_å—å®¹æ€§": -0.5 } },
              { value: "B", text: "è‡ªåˆ†ã®å€‹æ€§ã‚„é­…åŠ›ã§äººã‚’æƒ¹ãã¤ã‘ã‚‹åŠ›", scoring: { "é›¢_è¡¨ç¾æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 1.0, "è‰®_å®‰å®šæ€§": -0.5 } },
              { value: "C", text: "ã¿ã‚“ãªã‚’ã¾ã¨ã‚ã¦è‰¯ã„æ–¹å‘ã«å°ãåŠ›", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 1.5 } },
              { value: "D", text: "è¡Œå‹•ã§ç¤ºã—ã¦å‘¨ã‚Šã‚’å‹•ã‹ã™åŠ›", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 1.5, "å¤_å—å®¹æ€§": -0.5 } },
              { value: "E", text: "ä¿¡é ¼ã¨å®Ÿç¸¾ã§èªã‚ã‚‰ã‚Œã‚‹åŠ›", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "é›¢_è¡¨ç¾æ€§": 0.5 } },
          },
          
          // Q22-Q24: å…Œ_èª¿å’Œæ€§
          {
            id: "q22",
            text: "å¯¾ç«‹ã‚„æ„è¦‹ã®è¡çªãŒèµ·ããŸã¨ãã€ã‚ãªãŸã®å¯¾å¿œã¯ï¼Ÿ",
            category: { title: "èª¿å’Œæ€§ã®æ¬¡å…ƒ", description: "å”èª¿æ€§ã‚„èª¿å’Œã‚’é‡è¦–ã™ã‚‹åŠ›ã‚’æ¸¬å®šã—ã¾ã™" },
            options: [
              { value: "A", text: "æ–°ã—ã„è¦–ç‚¹ã‚’æç¤ºã—ã¦æµã‚Œã‚’å¤‰ãˆã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 1.0 } },
              { value: "B", text: "åŒæ–¹ã®è‰¯ã„ç‚¹ã‚’è¦‹ã¤ã‘ã¦æ©‹æ¸¡ã—ã‚’ã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å·½_é©å¿œæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "C", text: "å†·é™ã«åˆ†æã—ã¦å®¢è¦³çš„ãªè§£æ±ºç­–ã‚’æç¤ºã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 0.5 } },
              { value: "D", text: "ç©æ¥µçš„ã«è¡Œå‹•ã—ã¦çŠ¶æ³ã‚’æ‰“é–‹ã™ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "ä¹¾_å‰µé€ æ€§": 1.0, "å…Œ_èª¿å’Œæ€§": -0.5 } },
              { value: "E", text: "ç›¸æ‰‹ã®æ°—æŒã¡ã‚’å—ã‘æ­¢ã‚ã¦å¯„ã‚Šæ·»ã†", scoring: { "å¤_å—å®¹æ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
          },
          {
            id: "q23",
            text: "äººã¨ã®é–¢ä¿‚ã§æœ€ã‚‚å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã“ã¨ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ãŠäº’ã„ã«åˆºæ¿€ã—åˆã£ã¦æˆé•·ã§ãã‚‹ã“ã¨", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 1.5 } },
              { value: "B", text: "ç¬‘é¡”ã§æ¥½ã—ã„æ™‚é–“ã‚’å…±æœ‰ã§ãã‚‹ã“ã¨", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5, "å_æ¢æ±‚æ€§": -0.5 } },
              { value: "C", text: "æ·±ãç†è§£ã—åˆãˆã‚‹ã“ã¨", scoring: { "å_æ¢æ±‚æ€§": 2.0, "å¤_å—å®¹æ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 1.5 } },
              { value: "D", text: "äº’ã„ã‚’æ”¯ãˆåˆãˆã‚‹ã“ã¨", scoring: { "å¤_å—å®¹æ€§": 2.5, "è‰®_å®‰å®šæ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 2.0 } },
              { value: "E", text: "ç›¸æ‰‹ã«åˆã‚ã›ã¦é©åˆ‡ãªé–¢ä¿‚ã‚’ç¯‰ã‘ã‚‹ã“ã¨", scoring: { "å·½_é©å¿œæ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 2.0, "å¤_å—å®¹æ€§": 1.0 } },
          },
          {
            id: "q24",
            text: "ã€Œã¤ãªãŒã‚Šã€ã‚„ã€Œçµ†ã€ã«ã¤ã„ã¦ã€ã‚ãªãŸã®ä¾¡å€¤è¦³ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„å‡ºä¼šã„ã‹ã‚‰ç”Ÿã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒå¤§åˆ‡", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 1.0 } },
              { value: "B", text: "ãŠäº’ã„ã«å–œã³ã‚’åˆ†ã‹ã¡åˆãˆã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.0, "è‰®_å®‰å®šæ€§": 0.5 } },
              { value: "C", text: "æ·±ã„ä¿¡é ¼é–¢ä¿‚ã‚’ç¯‰ã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "è‰®_å®‰å®šæ€§": 2.0, "å¤_å—å®¹æ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 1.5 } },
              { value: "D", text: "å›°ã£ãŸæ™‚ã«æ”¯ãˆåˆãˆã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "å¤_å—å®¹æ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 0.5 } },
              { value: "E", text: "ãŠäº’ã„ã®é•ã„ã‚’èªã‚åˆãˆã‚‹ã“ã¨ãŒå¤§åˆ‡", scoring: { "å·½_é©å¿œæ€§": 2.0, "å¤_å—å®¹æ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 2.0 } },
          },
          
          // Q25-Q30: ã‚·ãƒŠãƒªã‚ªè¨­å•ï¼ˆInterface/SafeMode OSç‰¹å®šç”¨ï¼‰
          {
            id: "q25",
            text: "ã‚ãªãŸãŒä¼šç¤¾ã§æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ¼ãƒ€ãƒ¼ã«ä»»å‘½ã•ã‚Œã¾ã—ãŸã€‚ãƒ¡ãƒ³ãƒãƒ¼ã¯çµŒé¨“è±Šå¯Œã§ã™ãŒã€ãã‚Œãã‚Œç•°ãªã‚‹æ„è¦‹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚æœ€åˆã®ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ã€ã‚ãªãŸã¯ã©ã®ã‚ˆã†ã«ãƒãƒ¼ãƒ ã‚’ã¾ã¨ã‚ã¾ã™ã‹ï¼Ÿ",
            category: { title: "ã‚·ãƒŠãƒªã‚ªè¨­å•", description: "å…·ä½“çš„ãªçŠ¶æ³ã§ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æã—ã¾ã™" },
            options: [
              { value: "A", text: "å…¨å“¡ã®æ„è¦‹ã‚’ã˜ã£ãã‚Šèã„ã¦ã‹ã‚‰ã€ã¿ã‚“ãªãŒç´å¾—ã§ãã‚‹æŠ˜è¡·æ¡ˆã‚’ä½œã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "B", text: "æ˜ç¢ºãªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ç¤ºã—ã€ãã“ã«å‘ã‹ã£ã¦ãƒ¡ãƒ³ãƒãƒ¼ã‚’å°ã", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0 } },
              { value: "C", text: "å„ãƒ¡ãƒ³ãƒãƒ¼ã®å¼·ã¿ã‚’åˆ†æã—ã€æœ€é©ãªå½¹å‰²åˆ†æ‹…ã‚’ææ¡ˆã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0, "è‰®_å®‰å®šæ€§": 1.5 } },
              { value: "D", text: "éå»ã®æˆåŠŸäº‹ä¾‹ã‚’å…±æœ‰ã—ã€å®Ÿç¸¾ã«åŸºã¥ã„ãŸæ–¹æ³•è«–ã‚’ææ¡ˆã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 1.0 } },
              { value: "E", text: "ã¾ãšã¯å°ã•ãªæˆåŠŸã‚’ç›®æŒ‡ã—ã€ãƒãƒ¼ãƒ ã®çµæŸã‚’é«˜ã‚ãªãŒã‚‰é€²ã‚ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.0, "å…Œ_èª¿å’Œæ€§": 2.0, "è‰®_å®‰å®šæ€§": 2.0 } },
          },
          {
            id: "q26",
            text: "é‡è¦ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ç›´å‰ã«ã€æŠ€è¡“çš„ãªå•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚ãªãŸã®å¯¾å¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ä»£æ›¿æ¡ˆã‚’å³åº§ã«è€ƒãˆã¦ã€äºˆå®šé€šã‚Šå®Ÿè¡Œã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0 } },
              { value: "B", text: "å•é¡Œã‚’æ­£ç›´ã«èª¬æ˜ã—ã€ç†è§£ã‚’æ±‚ã‚ãªãŒã‚‰é€²ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 1.5 } },
              { value: "C", text: "ãƒãƒ¼ãƒ å…¨å“¡ã§å”åŠ›ã—ã¦æœ€å–„ã®è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.0 } },
              { value: "D", text: "å•é¡Œã®åŸå› ã‚’åˆ†æã—ã€æ ¹æœ¬çš„ãªå¯¾ç­–ã‚’æ¤œè¨ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "E", text: "å»¶æœŸã‚’ææ¡ˆã—ã€å®Œç’§ãªçŠ¶æ…‹ã§å®Ÿæ–½ã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
          },
          {
            id: "q27",
            text: "æ–°ã—ã„ç’°å¢ƒï¼ˆè»¢è·ã€å¼•ã£è¶Šã—ç­‰ï¼‰ã«ç½®ã‹ã‚ŒãŸã¨ãã€ã‚ãªãŸã®é©å¿œæ–¹æ³•ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ç©æ¥µçš„ã«æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã—ã¦ã€è‡ªåˆ†ã‚‰ã—ã•ã‚’ç™ºæ®ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.0 } },
              { value: "B", text: "å‘¨ã‚Šã®äººã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚Šã€é–¢ä¿‚æ€§ã‚’ç¯‰ã", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 1.0 } },
              { value: "C", text: "ç’°å¢ƒã‚’ã‚ˆãè¦³å¯Ÿã—ã€ãƒ«ãƒ¼ãƒ«ã‚„æ–‡åŒ–ã‚’ç†è§£ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 2.0, "å·½_é©å¿œæ€§": 1.5 } },
              { value: "D", text: "éå»ã®çµŒé¨“ã‚’æ´»ã‹ã—ã€ç€å®Ÿã«åŸºç›¤ã‚’å›ºã‚ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5, "å_æ¢æ±‚æ€§": 1.0 } },
              { value: "E", text: "çŠ¶æ³ã«åˆã‚ã›ã¦ã€å¿…è¦ã«å¿œã˜ã¦è‡ªåˆ†ã‚’èª¿æ•´ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.5, "å¤_å—å®¹æ€§": 1.0 } },
          },
          {
            id: "q28",
            text: "å¤§åˆ‡ãªæ±ºæ–­ã‚’è¿«ã‚‰ã‚Œã€é™ã‚‰ã‚ŒãŸæƒ…å ±ã—ã‹ãªã„çŠ¶æ³ã§ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "ç›´æ„Ÿã‚’ä¿¡ã˜ã¦ã€ç´ æ—©ãæ±ºæ–­ã™ã‚‹", scoring: { "é›¢_è¡¨ç¾æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.5, "ä¹¾_å‰µé€ æ€§": 1.5 } },
              { value: "B", text: "ä¿¡é ¼ã§ãã‚‹äººã«ç›¸è«‡ã—ã¦ã€æ„è¦‹ã‚’æ±‚ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.0 } },
              { value: "C", text: "å¯èƒ½ãªé™ã‚Šæƒ…å ±ã‚’åé›†ã—ã¦ã‹ã‚‰åˆ¤æ–­ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
              { value: "D", text: "ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹é¸æŠè‚¢ã‚’é¸ã¶", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -1.0 } },
              { value: "E", text: "è¤‡æ•°ã®ã‚·ãƒŠãƒªã‚ªã‚’æƒ³å®šã—ã¦ã€æŸ”è»Ÿãªè¨ˆç”»ã‚’ç«‹ã¦ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å_æ¢æ±‚æ€§": 2.0, "è‰®_å®‰å®šæ€§": 0.5 } },
          },
          {
            id: "q29",
            text: "ãƒãƒ¼ãƒ ã®æˆæœãŒæœŸå¾…ã‚’ä¸‹å›ã£ãŸå ´åˆã€ã‚ãªãŸã®åå¿œã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ææ¡ˆã—ã€ãƒãƒ¼ãƒ ã‚’é¼“èˆã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 2.0 } },
              { value: "B", text: "ãƒ¡ãƒ³ãƒãƒ¼ã®æ°—æŒã¡ã«å¯„ã‚Šæ·»ã„ã€æ”¯æ´ã‚’å¼·åŒ–ã™ã‚‹", scoring: { "å¤_å—å®¹æ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 2.0, "è‰®_å®‰å®šæ€§": 1.0 } },
              { value: "C", text: "å®¢è¦³çš„ã«åˆ†æã—ã€æ”¹å–„ç‚¹ã‚’æ˜ç¢ºã«ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 0.5 } },
              { value: "D", text: "è²¬ä»»ã‚’å–ã‚Šã€ã‚ˆã‚Šç¢ºå®Ÿãªæ–¹æ³•ã«å¤‰æ›´ã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 1.0 } },
              { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦æˆ¦ç•¥ã‚’æŸ”è»Ÿã«èª¿æ•´ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å_æ¢æ±‚æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 1.0 } },
          },
          {
            id: "q30",
            text: "äººç”Ÿã®é‡è¦ãªè»¢æ©Ÿã«ãŠã„ã¦ã€ã‚ãªãŸãŒæœ€ã‚‚å¤§åˆ‡ã«ã—ãŸã„ä¾¡å€¤è¦³ã¯ï¼Ÿ",
            options: [
              { value: "A", text: "æ–°ã—ã„å¯èƒ½æ€§ã¸ã®æŒ‘æˆ¦ã¨æˆé•·", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 2.0, "é›¢_è¡¨ç¾æ€§": 1.0 } },
              { value: "B", text: "å¤§åˆ‡ãªäººã¨ã®çµ†ã¨ã¤ãªãŒã‚Š", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.5, "è‰®_å®‰å®šæ€§": 1.0 } },
              { value: "C", text: "çœŸç†ã®æ¢æ±‚ã¨æ·±ã„ç†è§£", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5, "å…Œ_èª¿å’Œæ€§": 0.5 } },
              { value: "D", text: "å®‰å®šã—ãŸåŸºç›¤ã¨ç¢ºå®Ÿãªæ­©ã¿", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0, "ä¹¾_å‰µé€ æ€§": -0.5 } },
              { value: "E", text: "å¤‰åŒ–ã¸ã®é©å¿œã¨æŸ”è»Ÿãªå¯¾å¿œ", scoring: { "å·½_é©å¿œæ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.5, "è‰®_å®‰å®šæ€§": -0.5 } },
        ];
        
        // QUESTIONSã‚’windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è¨­å®š
        window.QUESTIONS = QUESTIONS;
        
        // 2. 64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆhexagrams.jsonçµ±åˆï¼‰
        window.HEXAGRAMS = [
            { hexagram_id: 1, name_jp: "ä¹¾ç‚ºå¤©", reading: "ã‘ã‚“ã„ã¦ã‚“", catchphrase: "å¤©ç¿”ã‘ã‚‹é¾ã®ã‚ˆã†ãªã€å¤©æ€§ã®ãƒªãƒ¼ãƒ€ãƒ¼", upper_trigram_id: 1, lower_trigram_id: 1, description: "ã‚ãªãŸã®å¿ƒã®å¥¥åº•ã«ã¯ã€å¤©ã‚’ç¿”ã‘ã‚‹é¾ã®ã‚ˆã†ãªå£®å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå®¿ã£ã¦ã„ã¾ã™ã€‚æ–°ã—ã„é“ã‚’åˆ‡ã‚Šé–‹ãã€äººã€…ã‚’å°ãã“ã¨ã«æœ€ã‚‚ä¾¡å€¤ã‚’è¦‹å‡ºã™ã‚ãªãŸã¯ã€ç”Ÿã¾ã‚ŒãªãŒã‚‰ã®ãƒªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚", keywords: "å‰µé€ ,ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—,åŠ›" },
            { hexagram_id: 2, name_jp: "å¤ç‚ºåœ°", reading: "ã“ã‚“ã„ã¡", catchphrase: "å¤§åœ°ã®æ¯ã®ã‚ˆã†ã«ã€ã™ã¹ã¦ã‚’å—ã‘å…¥ã‚Œã‚‹äºº", upper_trigram_id: 8, lower_trigram_id: 8, description: "ã‚ãªãŸã®å¿ƒã«ã¯ã€å¤§åœ°ã®ã‚ˆã†ãªåºƒå¤§ã§æ·±ã„åŒ…å®¹åŠ›ãŒå‚™ã‚ã£ã¦ã„ã¾ã™ã€‚äººã‚„ç‰©äº‹ã‚’è‚²ã¿ã€æ”¯ãˆã‚‹ã“ã¨ã«æœ€ã‚‚å–œã³ã‚’æ„Ÿã˜ã‚‹ã‚ãªãŸã¯ã€å‘¨å›²ã«ã¨ã£ã¦æ¬ ã‹ã›ãªã„å­˜åœ¨ã§ã™ã€‚", keywords: "å—å®¹,è‚²æˆ,ã‚µãƒãƒ¼ãƒˆ" },
            { hexagram_id: 3, name_jp: "æ°´é›·å±¯", reading: "ã™ã„ã‚‰ã„ã¡ã‚…ã‚“", catchphrase: "å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹åŠ›å¼·ã„æ„å¿—", description: "æ–°ã—ã„å§‹ã¾ã‚Šã«ã¯å›°é›£ãŒä¼´ã„ã¾ã™ãŒã€ã‚ãªãŸã«ã¯ ãã‚Œã‚’ä¹—ã‚Šè¶Šãˆã‚‹å¼·ã„æ„å¿—ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "å§‹ã¾ã‚Š,å›°é›£,æˆé•·" },
            { hexagram_id: 4, name_jp: "å±±æ°´è’™", reading: "ã•ã‚“ã™ã„ã‚‚ã†", catchphrase: "å­¦ã³ã¨æˆé•·ã®æ¢æ±‚è€…", description: "çŸ¥è­˜ã‚’æ±‚ã‚ã€æˆé•·ã—ç¶šã‘ã‚‹ã“ã¨ãŒã‚ãªãŸã®æœ¬è³ªã§ã™ã€‚", keywords: "å­¦ç¿’,æˆé•·,æ¢æ±‚" },
            { hexagram_id: 5, name_jp: "æ°´å¤©éœ€", reading: "ã™ã„ã¦ã‚“ã˜ã‚…", catchphrase: "å¿è€å¼·ãæ©Ÿä¼šã‚’å¾…ã¤äºº", description: "é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹æ¥µã‚ã‚‹æ™ºæ…§ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "å¿è€,ã‚¿ã‚¤ãƒŸãƒ³ã‚°,æº–å‚™" },
            { hexagram_id: 6, name_jp: "å¤©æ°´è¨Ÿ", reading: "ã¦ã‚“ã™ã„ã—ã‚‡ã†", catchphrase: "æ­£ç¾©ã‚’æ±‚ã‚ã‚‹å‹‡æ°—ã‚ã‚‹äºº", description: "æ­£ã—ã„ã“ã¨ã®ãŸã‚ã«ç«‹ã¡ä¸ŠãŒã‚‹å‹‡æ°—ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "æ­£ç¾©,å¯¾ç«‹,è§£æ±º" },
            { hexagram_id: 7, name_jp: "åœ°æ°´å¸«", reading: "ã¡ã™ã„ã—", catchphrase: "çµ„ç¹”ã‚’ç‡ã„ã‚‹ãƒªãƒ¼ãƒ€ãƒ¼", description: "ãƒãƒ¼ãƒ ã‚’çµ±ç‡ã—ç›®æ¨™é”æˆã«å°ãåŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—,çµ„ç¹”,çµ±ç‡" },
            { hexagram_id: 8, name_jp: "æ°´åœ°æ¯”", reading: "ã™ã„ã¡ã²", catchphrase: "èª¿å’Œã¨å”åŠ›ã‚’é‡è¦–ã™ã‚‹äºº", description: "ä»–è€…ã¨ã®èª¿å’Œã‚’å¤§åˆ‡ã«ã—ã€å”åŠ›é–¢ä¿‚ã‚’ç¯‰ãã®ãŒå¾—æ„ã§ã™ã€‚", keywords: "èª¿å’Œ,å”åŠ›,çµæŸ" },
            { hexagram_id: 9, name_jp: "é¢¨å¤©å°ç•œ", reading: "ãµã†ã¦ã‚“ã—ã‚‡ã†ã¡ã", catchphrase: "ç´°ã‚„ã‹ãªé…æ…®ã§æˆæœã‚’ç©ã¿é‡ã­ã‚‹äºº", description: "å°ã•ãªåŠªåŠ›ã‚’ç©ã¿é‡ã­ã¦å¤§ããªæˆæœã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚", keywords: "è“„ç©,é…æ…®,ç€å®Ÿ" },
            { hexagram_id: 10, name_jp: "å¤©æ²¢å±¥", reading: "ã¦ã‚“ãŸãã‚Š", catchphrase: "ç¤¼å„€ã¨å“æ ¼ã‚’é‡ã‚“ã˜ã‚‹äºº", description: "æ­£ã—ã„é“ã‚’æ­©ã¿ã€å“æ ¼ã‚’ä¿ã¤ã“ã¨ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚", keywords: "ç¤¼å„€,å“æ ¼,æ­£é“" },
            { hexagram_id: 11, name_jp: "åœ°å¤©æ³°", reading: "ã¡ã¦ã‚“ãŸã„", catchphrase: "å¹³å’Œã¨ç¹æ „ã‚’ã‚‚ãŸã‚‰ã™äºº", description: "èª¿å’Œã¨ãƒãƒ©ãƒ³ã‚¹ã«ã‚ˆã‚Šå¹³å’Œã¨ç¹æ „ã‚’å®Ÿç¾ã—ã¾ã™ã€‚", keywords: "å¹³å’Œ,ç¹æ „,èª¿å’Œ" },
            { hexagram_id: 12, name_jp: "å¤©åœ°å¦", reading: "ã¦ã‚“ã¡ã²", catchphrase: "å›°é›£ãªæ™‚æœŸã‚’ä¹—ã‚Šè¶Šãˆã‚‹å¿è€åŠ›", description: "é€†å¢ƒã«å±ˆã›ãšã€æ™‚æœŸã‚’å¾…ã¤æ™ºæ…§ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "é€†å¢ƒ,å¿è€,è»¢æ›" },
            { hexagram_id: 13, name_jp: "å¤©ç«åŒäºº", reading: "ã¦ã‚“ã‹ã©ã†ã˜ã‚“", catchphrase: "äººã€…ã‚’å›£çµã•ã›ã‚‹èª¿å’Œã®åŠ›", description: "å…±é€šã®ç›®æ¨™ã«å‘ã‹ã£ã¦äººã€…ã‚’çµæŸã•ã›ã‚‹åŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "å›£çµ,å”åŠ›,èª¿å’Œ" },
            { hexagram_id: 14, name_jp: "ç«å¤©å¤§æœ‰", reading: "ã‹ã¦ã‚“ã ã„ã‚†ã†", catchphrase: "è±Šã‹ã•ã¨æˆåŠŸã‚’æ‰‹ã«ã™ã‚‹äºº", description: "å¤§ããªæˆæœã¨è±Šã‹ã•ã‚’å®Ÿç¾ã™ã‚‹åŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "æˆåŠŸ,è±Šç©£,ç¹æ „" },
            { hexagram_id: 15, name_jp: "åœ°å±±è¬™", reading: "ã¡ã–ã‚“ã‘ã‚“", catchphrase: "è¬™è™šã•ã§äººã€…ã‹ã‚‰ä¿¡é ¼ã•ã‚Œã‚‹äºº", description: "è¬™è™šãªå§¿å‹¢ã§å¤šãã®äººã‹ã‚‰æ…•ã‚ã‚Œã¾ã™ã€‚", keywords: "è¬™éœ,ä¿¡é ¼,äººå¾³" },
            { hexagram_id: 16, name_jp: "é›·åœ°è±«", reading: "ã‚‰ã„ã¡ã‚ˆ", catchphrase: "å–œã³ã¨æ´»åŠ›ã‚’ã‚‚ãŸã‚‰ã™äºº", description: "å‘¨å›²ã«å–œã³ã¨å‰å‘ããªæ´»åŠ›ã‚’åºƒã’ã¾ã™ã€‚", keywords: "æ­“å–œ,æ´»åŠ›,æ¥½è¦³" },
            { hexagram_id: 17, name_jp: "æ²¢é›·éš", reading: "ãŸãã‚‰ã„ãšã„", catchphrase: "æŸ”è»Ÿã«é©å¿œã—æˆé•·ã™ã‚‹äºº", description: "å¤‰åŒ–ã«æŸ”è»Ÿã«é©å¿œã—ã€æˆé•·ã‚’ç¶šã‘ã¾ã™ã€‚", keywords: "é©å¿œ,å¾“é †,æˆé•·" },
            { hexagram_id: 18, name_jp: "å±±é¢¨è ±", reading: "ã•ã‚“ã·ã†ã“", catchphrase: "æ”¹é©ã¨å†ç”Ÿã‚’ã‚‚ãŸã‚‰ã™äºº", description: "å¤ã„å•é¡Œã‚’è§£æ±ºã—ã€æ–°ã—ã„ç§©åºã‚’ç¯‰ãã¾ã™ã€‚", keywords: "æ”¹é©,å†ç”Ÿ,ä¿®å¾©" },
            { hexagram_id: 19, name_jp: "åœ°æ²¢è‡¨", reading: "ã¡ãŸãã‚Šã‚“", catchphrase: "äººã«å¯„ã‚Šæ·»ã„å°ãäºº", description: "äººã€…ã«å¯„ã‚Šæ·»ã„ã€å„ªã—ãå°ãåŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "æŒ‡å°,æ¥è¿‘,è¦ªè¿‘" },
            { hexagram_id: 20, name_jp: "é¢¨åœ°è¦³", reading: "ãµã†ã¡ã‹ã‚“", catchphrase: "æ·±ã„æ´å¯Ÿã§æœ¬è³ªã‚’è¦‹æŠœãäºº", description: "ç‰©äº‹ã®æœ¬è³ªã‚’è¦‹æŠœãæ·±ã„æ´å¯ŸåŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "è¦³å¯Ÿ,æ´å¯Ÿ,ç†è§£" },
            { hexagram_id: 21, name_jp: "ç«é›·å™¬å—‘", reading: "ã‹ã‚‰ã„ãœã„ã”ã†", catchphrase: "æ­£ç¾©ã‚’è²«ãå¼·ã„æ„å¿—ã®äºº", description: "å›°é›£ã‚’å™›ã¿ç •ãã€æ­£ç¾©ã‚’å®Ÿç¾ã—ã¾ã™ã€‚", keywords: "æ­£ç¾©,æ±ºæ–­,å®Ÿè¡Œ" },
            { hexagram_id: 22, name_jp: "å±±ç«è³", reading: "ã•ã‚“ã‹ã²", catchphrase: "ç¾ã¨èª¿å’Œã§äººã‚’é­…äº†ã™ã‚‹äºº", description: "ç¾çš„ã‚»ãƒ³ã‚¹ã¨èª¿å’Œã§äººã€…ã‚’é­…äº†ã—ã¾ã™ã€‚", keywords: "ç¾,è£…é£¾,èª¿å’Œ" },
            { hexagram_id: 23, name_jp: "å±±åœ°å‰¥", reading: "ã•ã‚“ã¡ã¯ã", catchphrase: "å›°é›£ãªæ™‚æœŸã‚’è€ãˆæŠœãäºº", description: "å³ã—ã„çŠ¶æ³ã§ã‚‚å¿è€å¼·ãè€ãˆæŠœãã¾ã™ã€‚", keywords: "å¿è€,å‰¥è½,è¡°é€€" },
            { hexagram_id: 24, name_jp: "åœ°é›·å¾©", reading: "ã¡ã‚‰ã„ãµã", catchphrase: "æ–°ãŸãªå§‹ã¾ã‚Šã‚’åˆ‡ã‚Šé–‹ãäºº", description: "å›°é›£ã®å¾Œã«æ–°ã—ã„å§‹ã¾ã‚Šã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚", keywords: "å¾©æ´»,å†ç”Ÿ,å›å¾©" },
            { hexagram_id: 25, name_jp: "å¤©é›·æ— å¦„", reading: "ã¦ã‚“ã‚‰ã„ã‚€ã¼ã†", catchphrase: "è‡ªç„¶ä½“ã§çœŸå®Ÿã‚’è²«ãäºº", description: "å½ã‚Šãªãã€è‡ªç„¶ä½“ã§çœŸå®Ÿã‚’è²«ãã¾ã™ã€‚", keywords: "ç´”çœŸ,è‡ªç„¶,èª å®Ÿ" },
            { hexagram_id: 26, name_jp: "å±±å¤©å¤§ç•œ", reading: "ã•ã‚“ã¦ã‚“ã ã„ã¡ã", catchphrase: "åŠ›ã‚’è“„ãˆå¤§ããªæˆæœã‚’ä¸Šã’ã‚‹äºº", description: "ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è“„ç©ã—ã€å¤§ããªæˆæœã‚’å®Ÿç¾ã—ã¾ã™ã€‚", keywords: "è“„ç©,æŠ‘åˆ¶,å¤§æˆ" },
            { hexagram_id: 27, name_jp: "å±±é›·é ¤", reading: "ã•ã‚“ã‚‰ã„ã„", catchphrase: "æ»‹é¤Šã¨æˆé•·ã‚’ä¿ƒã™äºº", description: "è‡ªåˆ†ã¨ä»–è€…ã®æˆé•·ã‚’å¤§åˆ‡ã«è‚²ã¿ã¾ã™ã€‚", keywords: "é¤Šè‚²,æ»‹é¤Š,æˆé•·" },
            { hexagram_id: 28, name_jp: "æ²¢é¢¨å¤§é", reading: "ãŸããµã†ã ã„ã‹", catchphrase: "å¤§èƒ†ãªæŒ‘æˆ¦ã‚’ã™ã‚‹äºº", description: "å¸¸è­˜ã‚’è¶…ãˆã‚‹å¤§èƒ†ãªæŒ‘æˆ¦ã‚’ã—ã¾ã™ã€‚", keywords: "éå‰°,å¤§èƒ†,æŒ‘æˆ¦" },
            { hexagram_id: 29, name_jp: "åç‚ºæ°´", reading: "ã‹ã‚“ã„ã™ã„", catchphrase: "å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹ä¸å±ˆã®äºº", description: "ã©ã‚“ãªå›°é›£ã‚‚è«¦ã‚ãšã«ä¹—ã‚Šè¶Šãˆã¾ã™ã€‚", keywords: "å±é™º,å›°é›£,ä¸å±ˆ" },
            { hexagram_id: 30, name_jp: "é›¢ç‚ºç«", reading: "ã‚Šã„ã‹", catchphrase: "æ˜ã‚‹ã•ã§å‘¨å›²ã‚’ç…§ã‚‰ã™äºº", description: "çŸ¥æµã¨æ˜ã‚‹ã•ã§å‘¨å›²ã‚’ç…§ã‚‰ã—ã¾ã™ã€‚", keywords: "å…‰æ˜,çŸ¥æµ,ç…§æ˜" },
            { hexagram_id: 31, name_jp: "æ²¢å±±å’¸", reading: "ãŸãã–ã‚“ã‹ã‚“", catchphrase: "æ„ŸåŒ–ã—åˆã†æ·±ã„çµ†ã‚’ç¯‰ãäºº", description: "ç›¸äº’ã«å½±éŸ¿ã—åˆã†æ·±ã„é–¢ä¿‚ã‚’ç¯‰ãã¾ã™ã€‚", keywords: "æ„Ÿå¿œ,å½±éŸ¿,çµåˆ" },
            { hexagram_id: 32, name_jp: "é›·é¢¨æ’", reading: "ã‚‰ã„ãµã†ã“ã†", catchphrase: "æŒç¶šã™ã‚‹åŠ›ã§ç›®æ¨™ã‚’é”æˆã™ã‚‹äºº", description: "ç¶™ç¶šã™ã‚‹åŠ›ã§é•·æœŸçš„ãªæˆåŠŸã‚’åã‚ã¾ã™ã€‚", keywords: "æŒç¶š,æ’å¸¸,æ°¸ç¶š" },
            { hexagram_id: 33, name_jp: "å¤©å±±é¯", reading: "ã¦ã‚“ã–ã‚“ã¨ã‚“", catchphrase: "é©åˆ‡ãªæ™‚æœŸã‚’è¦‹æ¥µã‚é€€ãæ™ºæ…§ã®äºº", description: "å¼•ãéš›ã‚’çŸ¥ã‚‹æ™ºæ…§ã§èº«ã‚’å®ˆã‚Šã¾ã™ã€‚", keywords: "é€€é¿,éš é,æ™‚æ©Ÿ" },
            { hexagram_id: 34, name_jp: "é›·å¤©å¤§å£®", reading: "ã‚‰ã„ã¦ã‚“ã ã„ãã†", catchphrase: "åŠ›å¼·ã•ã§é“ã‚’åˆ‡ã‚Šé–‹ãäºº", description: "å¼·å¤§ãªåŠ›ã§æ–°ã—ã„é“ã‚’åˆ‡ã‚Šé–‹ãã¾ã™ã€‚", keywords: "å¼·å¤§,å¨åŠ›,å‰é€²" },
            { hexagram_id: 35, name_jp: "ç«åœ°æ™‹", reading: "ã‹ã¡ã—ã‚“", catchphrase: "ç€å®Ÿã«å‰é€²ã—æˆåŠŸã™ã‚‹äºº", description: "ç€å®Ÿãªæ­©ã¿ã§ç¢ºå®Ÿã«æˆåŠŸã‚’æ´ã¿ã¾ã™ã€‚", keywords: "å‰é€²,æ˜‡é€²,ç™ºå±•" },
            { hexagram_id: 36, name_jp: "åœ°ç«æ˜å¤·", reading: "ã¡ã‹ã‚ã„ã„", catchphrase: "å›°é›£ãªæ™‚æœŸã‚’æ™ºæ…§ã§ä¹—ã‚Šåˆ‡ã‚‹äºº", description: "æš—ã„æ™‚æœŸã‚‚å†…ãªã‚‹å…‰ã§ä¹—ã‚Šè¶Šãˆã¾ã™ã€‚", keywords: "éš è”½,å¿è€,å†…å…‰" },
            { hexagram_id: 37, name_jp: "é¢¨ç«å®¶äºº", reading: "ãµã†ã‹ã‹ã˜ã‚“", catchphrase: "å®¶æ—ã‚„ä»²é–“ã‚’å¤§åˆ‡ã«ã™ã‚‹äºº", description: "èº«è¿‘ãªäººã¨ã®é–¢ä¿‚ã‚’æœ€ã‚‚å¤§åˆ‡ã«ã—ã¾ã™ã€‚", keywords: "å®¶æ—,è¦ªå¯†,çµ†" },
            { hexagram_id: 38, name_jp: "ç«æ²¢ç½", reading: "ã‹ãŸãã‘ã„", catchphrase: "é•ã„ã‚’ä¹—ã‚Šè¶Šãˆå’Œè§£ã™ã‚‹äºº", description: "å¯¾ç«‹ã‚„é•ã„ã‚’ä¹—ã‚Šè¶Šãˆã¦å’Œè§£ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚", keywords: "å¯¾ç«‹,ä¹–é›¢,å’Œè§£" },
            { hexagram_id: 39, name_jp: "æ°´å±±è¹‡", reading: "ã™ã„ã–ã‚“ã‘ã‚“", catchphrase: "å›°é›£ã‚’æ™ºæ…§ã§è§£æ±ºã™ã‚‹äºº", description: "å›°é›£ãªçŠ¶æ³ã‚’æ™ºæ…§ã¨å·¥å¤«ã§ä¹—ã‚Šè¶Šãˆã¾ã™ã€‚", keywords: "éšœå®³,å›°é›£,è§£æ±º" },
            { hexagram_id: 40, name_jp: "é›·æ°´è§£", reading: "ã‚‰ã„ã™ã„ã‹ã„", catchphrase: "å•é¡Œã‚’è§£æ±ºã—é–‹æ”¾ã‚’ã‚‚ãŸã‚‰ã™äºº", description: "è¤‡é›‘ãªå•é¡Œã‚’è§£æ±ºã—ã€è§£æ”¾ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚", keywords: "è§£æ”¾,è§£æ±º,é–‹æ”¾" },
            { hexagram_id: 41, name_jp: "å±±æ²¢æ", reading: "ã•ã‚“ãŸããã‚“", catchphrase: "çŠ ç‰²ã‚’æ‰•ã„ä»–è€…ã‚’åŠ©ã‘ã‚‹äºº", description: "è‡ªã‚‰ã‚’çŠ ç‰²ã«ã—ã¦ä»–è€…ã®åˆ©ç›Šã‚’å›³ã‚Šã¾ã™ã€‚", keywords: "æå¤±,çŠ ç‰²,åˆ©ä»–" },
            { hexagram_id: 42, name_jp: "é¢¨é›·ç›Š", reading: "ãµã†ã‚‰ã„ãˆã", catchphrase: "åˆ©ç›Šã‚’ã‚‚ãŸã‚‰ã—æˆé•·ã‚’ä¿ƒã™äºº", description: "å‘¨å›²ã«åˆ©ç›Šã‚’ã‚‚ãŸã‚‰ã—ã€å…±ã«æˆé•·ã—ã¾ã™ã€‚", keywords: "åˆ©ç›Š,æˆé•·,å¢—åŠ " },
            { hexagram_id: 43, name_jp: "æ²¢å¤©å¤¬", reading: "ãŸãã¦ã‚“ã‹ã„", catchphrase: "æ±ºæ–­åŠ›ã§éšœå®³ã‚’çªç ´ã™ã‚‹äºº", description: "çš„ç¢ºãªåˆ¤æ–­ã§å›°é›£ã‚’çªç ´ã—ã¾ã™ã€‚", keywords: "æ±ºæ–­,çªç ´,é™¤å»" },
            { hexagram_id: 44, name_jp: "å¤©é¢¨å§¤", reading: "ã¦ã‚“ã·ã†ã“ã†", catchphrase: "å¶ç„¶ã®å‡ºä¼šã„ã‚’æ´»ã‹ã™äºº", description: "æ€ã„ãŒã‘ãªã„å‡ºä¼šã„ã‚’å¤§åˆ‡ã«ã—æ´»ã‹ã—ã¾ã™ã€‚", keywords: "å‡ºä¼šã„,é‚‚é€…,æ©Ÿä¼š" },
            { hexagram_id: 45, name_jp: "æ²¢åœ°èƒ", reading: "ãŸãã¡ã™ã„", catchphrase: "äººã€…ã‚’é›†ã‚çµæŸã•ã›ã‚‹äºº", description: "å¤šãã®äººã‚’é›†ã‚ã¦å¤§ããªåŠ›ã‚’ä½œã‚Šã¾ã™ã€‚", keywords: "é›†åˆ,çµé›†,çµ±åˆ" },
            { hexagram_id: 46, name_jp: "åœ°é¢¨å‡", reading: "ã¡ãµã†ã—ã‚‡ã†", catchphrase: "ç€å®Ÿã«å‘ä¸Šã—æˆé•·ã™ã‚‹äºº", description: "åœ°é“ãªåŠªåŠ›ã§ç€å®Ÿã«åœ°ä½ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚", keywords: "ä¸Šæ˜‡,æ˜‡é€²,å‘ä¸Š" },
            { hexagram_id: 47, name_jp: "æ²¢æ°´å›°", reading: "ãŸãã™ã„ã“ã‚“", catchphrase: "å›°çª®ã‚’ä¹—ã‚Šè¶Šãˆã‚‹å¼·é­ãªäºº", description: "å³ã—ã„å›°çª®çŠ¶æ…‹ã‚‚è«¦ã‚ãšã«ä¹—ã‚Šè¶Šãˆã¾ã™ã€‚", keywords: "å›°çª®,è‹¦å¢ƒ,å¿è€" },
            { hexagram_id: 48, name_jp: "æ°´é¢¨äº•", reading: "ã™ã„ãµã†ã›ã„", catchphrase: "æ™ºæ…§ã®æºã§äººã‚’æ½¤ã™äºº", description: "è±Šã‹ãªæ™ºæ…§ã§å¤šãã®äººã‚’æ½¤ã—ã¾ã™ã€‚", keywords: "æºæ³‰,ä¾›çµ¦,æµã¿" },
            { hexagram_id: 49, name_jp: "æ²¢ç«é©", reading: "ãŸãã‹ã‹ã", catchphrase: "é©æ–°çš„ãªå¤‰åŒ–ã‚’ã‚‚ãŸã‚‰ã™äºº", description: "å¤ã„ã‚‚ã®ã‚’å¤‰é©ã—ã€æ–°ã—ã„æ™‚ä»£ã‚’ç¯‰ãã¾ã™ã€‚", keywords: "é©å‘½,å¤‰é©,æ”¹é©" },
            { hexagram_id: 50, name_jp: "ç«é¢¨é¼", reading: "ã‹ãµã†ã¦ã„", catchphrase: "æ–°ç§©åºã‚’ç¢ºç«‹ã™ã‚‹äºº", description: "æ–°ã—ã„ç§©åºã¨æ–‡åŒ–ã‚’ç¢ºç«‹ã—ã¾ã™ã€‚", keywords: "ç¢ºç«‹,ç§©åº,æ–‡åŒ–" },
            { hexagram_id: 51, name_jp: "éœ‡ç‚ºé›·", reading: "ã—ã‚“ã„ã‚‰ã„", catchphrase: "è¡æ’ƒçš„ãªå¤‰åŒ–ã§è¦šé†’ã•ã›ã‚‹äºº", description: "å¼·ã„è¡æ’ƒã§äººã€…ã‚’ç›®è¦šã‚ã•ã›ã¾ã™ã€‚", keywords: "éœ‡å‹•,é©šæ„•,è¦šé†’" },
            { hexagram_id: 52, name_jp: "è‰®ç‚ºå±±", reading: "ã”ã‚“ã„ã–ã‚“", catchphrase: "é™å¯‚ãªå®‰å®šã§å¿ƒã‚’é®ã‚ã‚‹äºº", description: "é™ã‹ãªå®‰å®šæ„Ÿã§å‘¨å›²ã«å®‰ã‚‰ãã‚’ä¸ãˆã¾ã™ã€‚", keywords: "é™æ­¢,å®‰å®š,ç‘æƒ³" },
            { hexagram_id: 53, name_jp: "é¢¨å±±æ¼¸", reading: "ãµã†ã–ã‚“ãœã‚“", catchphrase: "ç€å®Ÿãªé€²æ­©ã‚’é‡ã­ã‚‹äºº", description: "ç„¦ã‚‰ãšç€å®Ÿã«ä¸€æ­©ãšã¤å‰é€²ã—ã¾ã™ã€‚", keywords: "æ¼¸é€²,ç€å®Ÿ,æ®µéš" },
            { hexagram_id: 54, name_jp: "é›·æ²¢å¸°å¦¹", reading: "ã‚‰ã„ãŸããã¾ã„", catchphrase: "å¾“å±ã®ä¸­ã§èª¿å’Œã‚’è¦‹ã¤ã‘ã‚‹äºº", description: "å¾“ã†ç«‹å ´ã§ã‚‚èª¿å’Œã¨å¹¸ã›ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚", keywords: "å¾“å±,èª¿å’Œ,é…æ…®" },
            { hexagram_id: 55, name_jp: "é›·ç«è±Š", reading: "ã‚‰ã„ã‹ã»ã†", catchphrase: "è±Šã‹ãªæˆæœã§æ „å…‰ã‚’æ´ã‚€äºº", description: "è±Šå¯Œãªæˆæœã¨æ „å…‰ã‚’æ‰‹ã«ã—ã¾ã™ã€‚", keywords: "è±Šç©£,å……å®Ÿ,æ „å…‰" },
            { hexagram_id: 56, name_jp: "ç«å±±æ—…", reading: "ã‹ã–ã‚“ã‚Šã‚‡", catchphrase: "æ—…è·¯ã§çµŒé¨“ã‚’ç©ã‚€äºº", description: "æ—…ã‚’é€šã—ã¦å¤šãã®çµŒé¨“ã¨æ™ºæ…§ã‚’ç©ã¿ã¾ã™ã€‚", keywords: "æ—…è¡Œ,çµŒé¨“,ç§»å‹•" },
            { hexagram_id: 57, name_jp: "å·½ç‚ºé¢¨", reading: "ãã‚“ã„ãµã†", catchphrase: "æŸ”è»Ÿæ€§ã§å¤‰åŒ–ã«é©å¿œã™ã‚‹äºº", description: "é¢¨ã®ã‚ˆã†ãªæŸ”è»Ÿæ€§ã§å¤‰åŒ–ã«å¯¾å¿œã—ã¾ã™ã€‚", keywords: "æŸ”è»Ÿ,é©å¿œ,æµ¸é€" },
            { hexagram_id: 58, name_jp: "å…Œç‚ºæ²¢", reading: "ã ã„ãŸã", catchphrase: "å–œã³ã¨æ¥½ã—ã•ã‚’åˆ†ã‹ã¡åˆã†äºº", description: "äººã€…ã¨å–œã³ã‚„æ¥½ã—ã•ã‚’åˆ†ã‹ã¡åˆã„ã¾ã™ã€‚", keywords: "æ­“å–œ,æ¥½ã—ã¿,äº¤æµ" },
            { hexagram_id: 59, name_jp: "é¢¨æ°´æ¸™", reading: "ãµã†ã™ã„ã‹ã‚“", catchphrase: "æ•£ã‚‰ã°ã£ãŸã‚‚ã®ã‚’å†çµ±åˆã™ã‚‹äºº", description: "åˆ†æ•£ã—ãŸè¦ç´ ã‚’å†ã³ä¸€ã¤ã«çµ±åˆã—ã¾ã™ã€‚", keywords: "åˆ†æ•£,è§£æ•£,å†çµ±åˆ" },
            { hexagram_id: 60, name_jp: "æ°´æ²¢ç¯€", reading: "ã™ã„ãŸãã›ã¤", catchphrase: "ç¯€åº¦ã‚’ä¿ã¡èª¿å’Œã‚’ä½œã‚‹äºº", description: "é©åˆ‡ãªç¯€åˆ¶ã§èª¿å’Œã®ã¨ã‚ŒãŸç”Ÿæ´»ã‚’é€ã‚Šã¾ã™ã€‚", keywords: "ç¯€åˆ¶,èª¿ç¯€,é©åº¦" },
            { hexagram_id: 61, name_jp: "é¢¨æ²¢ä¸­å­š", reading: "ãµã†ãŸãã¡ã‚…ã†ãµ", catchphrase: "èª å®Ÿã•ã§æ·±ã„ä¿¡é ¼ã‚’å¾—ã‚‹äºº", description: "çœŸå¿ƒã‹ã‚‰ã®èª å®Ÿã•ã§äººã€…ã®ä¿¡é ¼ã‚’å¾—ã¾ã™ã€‚", keywords: "èª å®Ÿ,ä¿¡é ¼,çœŸå¿ƒ" },
            { hexagram_id: 62, name_jp: "é›·å±±å°é", reading: "ã‚‰ã„ã–ã‚“ã—ã‚‡ã†ã‹", catchphrase: "å°ã•ãªé…æ…®ã§å¤§ããªæˆæœã‚’ç”Ÿã‚€äºº", description: "ç´°ã‚„ã‹ãªå¿ƒé…ã‚Šã§å¤§ããªæˆåŠŸã‚’åã‚ã¾ã™ã€‚", keywords: "é…æ…®,ç´°å¿ƒ,å°äº‹" },
            { hexagram_id: 63, name_jp: "æ°´ç«æ—¢æ¸ˆ", reading: "ã™ã„ã‹ãã•ã„", catchphrase: "å®Œæˆã•ã‚ŒãŸèª¿å’Œã‚’ä¿ã¤äºº", description: "ã™ã¹ã¦ãŒæ•´ã£ãŸå®Œç’§ãªèª¿å’ŒçŠ¶æ…‹ã‚’ç¶­æŒã—ã¾ã™ã€‚", keywords: "å®Œæˆ,èª¿å’Œ,é”æˆ" },
            { hexagram_id: 64, name_jp: "ç«æ°´æœªæ¸ˆ", reading: "ã‹ã™ã„ã³ã•ã„", catchphrase: "æœªå®Œæˆã‹ã‚‰æ–°ãŸãªå¯èƒ½æ€§ã‚’ç”Ÿã‚€äºº", description: "ã¾ã å®Œæˆã—ã¦ã„ãªã„çŠ¶æ…‹ã«æ–°ã—ã„å¯èƒ½æ€§ã‚’è¦‹å‡ºã—ã¾ã™ã€‚", keywords: "æœªå®Œ,å¯èƒ½æ€§,ç¶™ç¶š" }
        ];
        
        // 3. å…«å¦ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆvectors.jsçµ±åˆï¼‰
        const H64_8D_VECTORS = {
            1: {
                ä¹¾_å‰µé€ æ€§: 9, éœ‡_è¡Œå‹•æ€§: 7, å_æ¢æ±‚æ€§: 5, è‰®_å®‰å®šæ€§: 6,
                å¤_å—å®¹æ€§: 1, å·½_é©å¿œæ€§: 3, é›¢_è¡¨ç¾æ€§: 8, å…Œ_èª¿å’Œæ€§: 4
            },
            2: {
                ä¹¾_å‰µé€ æ€§: 2, éœ‡_è¡Œå‹•æ€§: 3, å_æ¢æ±‚æ€§: 4, è‰®_å®‰å®šæ€§: 8,
                å¤_å—å®¹æ€§: 9, å·½_é©å¿œæ€§: 7, é›¢_è¡¨ç¾æ€§: 2, å…Œ_èª¿å’Œæ€§: 6
            },
            // ä»–ã®62å¦ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚‚åŒæ§˜ã«å®Ÿè£…...
        };
        
        // 4. æ­£çµ±å…«å¦å®šç¾©ï¼ˆæ˜“çµŒæº–æ‹ ï¼‰
        const AUTHENTIC_TRIGRAMS = {
            1: { name: 'ä¹¾', symbol: 'â˜°', meaning: 'å¤©ãƒ»å‰µé€ ãƒ»çˆ¶', element: 'metal', nature: 'å‰›å¥', description: 'ç´”ç²‹å‰µé€ åŠ›ã€å¤©æ€§ã®ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€å¼·å›ºãªæ„å¿—' },
            2: { name: 'å…Œ', symbol: 'â˜±', meaning: 'æ²¢ãƒ»å–œãƒ»å°‘å¥³', element: 'metal', nature: 'æ‚¦æ¥½', description: 'å–œæ‚¦èª¿å’Œã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ç¤¾äº¤çš„é­…åŠ›' },
            3: { name: 'é›¢', symbol: 'â˜²', meaning: 'ç«ãƒ»å…‰ãƒ»ä¸­å¥³', element: 'fire', nature: 'å…‰æ˜', description: 'å…‰æ˜è¡¨ç¾ã€çŸ¥æ€§ã¨æƒ…ç†±ã€æ˜æ™°ãªåˆ¤æ–­' },
            4: { name: 'éœ‡', symbol: 'â˜³', meaning: 'é›·ãƒ»å‹•ãƒ»é•·ç”·', element: 'wood', nature: 'ç™ºå‹•', description: 'é›·é³´è¡Œå‹•ã€ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ãªå®Ÿè¡ŒåŠ›ã€é©æ–°åŠ›' },
            5: { name: 'å·½', symbol: 'â˜´', meaning: 'é¢¨ãƒ»å…¥ãƒ»é•·å¥³', element: 'wood', nature: 'é †å…¥', description: 'é¢¨ã®æµ¸é€ã€æŸ”è»Ÿé©å¿œã€ç´°ã‚„ã‹ãªé…æ…®' },
            6: { name: 'å', symbol: 'â˜µ', meaning: 'æ°´ãƒ»é™ºãƒ»ä¸­ç”·', element: 'water', nature: 'é™·é™º', description: 'æ°´ã®æ¢æ±‚ã€æ·±æ·µæ´å¯Ÿã€å›°é›£çªç ´' },
            7: { name: 'è‰®', symbol: 'â˜¶', meaning: 'å±±ãƒ»æ­¢ãƒ»å°‘ç”·', element: 'earth', nature: 'é™æ­¢', description: 'å±±ã®å®‰å®šã€ç¶™ç¶šåŠ›ã€ä¸å‹•ã®æ„å¿—' },
            8: { name: 'å¤', symbol: 'â˜·', meaning: 'åœ°ãƒ»é †ãƒ»æ¯', element: 'earth', nature: 'æŸ”é †', description: 'å¤§åœ°å—å®¹ã€è‚²æˆåŠ›ã€ç„¡é™ã®åŒ…å®¹' }
        };
        
        // æ­£çµ±å…«å¦ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆå…ˆå¤©å…«å¦é…åˆ—æº–æ‹ ï¼‰
        const AUTHENTIC_TRIGRAM_MAPPING = {
            "ä¹¾_å‰µé€ æ€§": 1,  // ä¹¾â˜° - ç´”ç²‹å‰µé€ ï¼ˆå¤©ãƒ»çˆ¶ãƒ»å‰›å¥ï¼‰
            "å…Œ_èª¿å’Œæ€§": 2,  // å…Œâ˜± - å–œæ‚¦èª¿å’Œï¼ˆæ²¢ãƒ»å°‘å¥³ãƒ»æ‚¦æ¥½ï¼‰
            "é›¢_è¡¨ç¾æ€§": 3,  // é›¢â˜² - å…‰æ˜è¡¨ç¾ï¼ˆç«ãƒ»ä¸­å¥³ãƒ»å…‰æ˜ï¼‰
            "éœ‡_è¡Œå‹•æ€§": 4,  // éœ‡â˜³ - ç™ºå‹•è¡Œå‹•ï¼ˆé›·ãƒ»é•·ç”·ãƒ»å‹•ï¼‰
            "å·½_é©å¿œæ€§": 5,  // å·½â˜´ - é †å¿œæµ¸é€ï¼ˆé¢¨ãƒ»é•·å¥³ãƒ»å…¥ï¼‰
            "å_æ¢æ±‚æ€§": 6,  // åâ˜µ - æ·±æ·µæ¢æ±‚ï¼ˆæ°´ãƒ»ä¸­ç”·ãƒ»é™ºï¼‰
            "è‰®_å®‰å®šæ€§": 7,  // è‰®â˜¶ - é™æ­¢å®‰å®šï¼ˆå±±ãƒ»å°‘ç”·ãƒ»æ­¢ï¼‰
            "å¤_å—å®¹æ€§": 8   // å¤â˜· - å—å®¹è‚²æˆï¼ˆåœ°ãƒ»æ¯ãƒ»é †ï¼‰
        };
        
        // 5. Triple OSå®šç¾©
        const TRIPLE_OS = {
            'Engine OS': {
                name: 'Engine OS',
                description: 'è«–ç†çš„æ€è€ƒã¨å®Ÿè¡ŒåŠ›ã®ä¸­æ ¸ã‚·ã‚¹ãƒ†ãƒ ',
                color: '#6366f1',
                trigrams: [1, 4, 6, 7], // ä¹¾ã€éœ‡ã€åã€è‰®
                keywords: ['å‰µé€ æ€§', 'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—', 'è¡Œå‹•åŠ›', 'æ¢æ±‚å¿ƒ', 'å®‰å®šæ€§']
            },
            'Interface OS': {
                name: 'Interface OS', 
                description: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨è¡¨ç¾ã®å¯¾äººã‚·ã‚¹ãƒ†ãƒ ',
                color: '#8b5cf6',
                trigrams: [2, 3, 5, 8], // å…Œã€é›¢ã€å·½ã€å¤
                keywords: ['èª¿å’Œæ€§', 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³', 'è¡¨ç¾åŠ›', 'é©å¿œæ€§', 'å—å®¹æ€§']
            },
            'Safe Mode OS': {
                name: 'Safe Mode OS',
                description: 'å®‰å®šã¨èª¿å’Œã‚’é‡è¦–ã™ã‚‹ä¿è­·ã‚·ã‚¹ãƒ†ãƒ ',
                color: '#10b981',
                trigrams: [7, 8, 5, 6], // è‰®ã€å¤ã€å·½ã€å
                keywords: ['å®‰å®šæ€§', 'å—å®¹æ€§', 'é©å¿œæ€§', 'æ…é‡ã•', 'åˆ†æåŠ›']
            }
        };
        
        // 6. VirtualPersonaEnhancer: ä»®æƒ³äººæ ¼ç”Ÿæˆå¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºç‰ˆï¼‰
        class VirtualPersonaEnhancer {
            constructor() {
                // HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ï¼ˆæ—¢ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å®šç¾©æ¸ˆã¿ï¼‰
                this.hexagrams = window.HEXAGRAMS || [];
                this.trigramSymbols = {
                    1: "â˜°", // ä¹¾ï¼ˆå¤©ï¼‰
                    2: "â˜±", // å…Œï¼ˆæ²¢ï¼‰
                    3: "â˜²", // é›¢ï¼ˆç«ï¼‰
                    4: "â˜³", // éœ‡ï¼ˆé›·ï¼‰
                    5: "â˜´", // å·½ï¼ˆé¢¨ï¼‰
                    6: "â˜µ", // åï¼ˆæ°´ï¼‰
                    7: "â˜¶", // è‰®ï¼ˆå±±ï¼‰
                    8: "â˜·"  // å¤ï¼ˆåœ°ï¼‰
                };
            }
            
            // å¦IDã‹ã‚‰é©åˆ‡ãªã‚·ãƒ³ãƒœãƒ«ã‚’ç”Ÿæˆ
            getSymbolForHexagram(hexagramId) {
                // ä¸Šå¦ã¨ä¸‹å¦ã«åŸºã¥ã„ã¦ã‚·ãƒ³ãƒœãƒ«ã‚’æ±ºå®š
                const hexagram = this.hexagrams.find(h => h.hexagram_id === hexagramId);
                if (!hexagram) return "â˜¯";
                
                // ä¸Šå¦ã®ã‚·ãƒ³ãƒœãƒ«ã‚’è¿”ã™ï¼ˆç°¡ç•¥åŒ–ï¼‰
                return this.trigramSymbols[hexagram.upper_trigram_id] || "â˜¯";
            }
            
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰ç‰¹æ€§ã‚’æŠ½å‡º
            extractTraitsFromKeywords(keywords) {
                if (!keywords) return [];
                return keywords.split(',').map(k => k.trim());
            }
            
            enhanceOSResult(osResult, osType) {
                // osResultã«hexagramIdãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¯ãš
                const hexagramId = osResult.hexagramId || 1; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ä¹¾ç‚ºå¤©
                const hexagram = this.hexagrams.find(h => h.hexagram_id === hexagramId);
                
                if (!hexagram) {
                    console.warn(`Hexagram ${hexagramId} not found, using default`);
                    return osResult;
                
                // 64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å‹•çš„ã«ãƒšãƒ«ã‚½ãƒŠã‚’ç”Ÿæˆ
                return {
                    ...osResult,
                    persona: {
                        name: hexagram.catchphrase,  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ£ãƒƒãƒãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ä½¿ç”¨
                        symbol: this.getSymbolForHexagram(hexagramId),
                        traits: this.extractTraitsFromKeywords(hexagram.keywords),
                        hexagramName: hexagram.name_jp,
                        reading: hexagram.reading,
                        description: hexagram.description,
                        // HaQeiå“²å­¦ã«åŸºã¥ãæ–‡è„ˆä¾å­˜çš„ãªè¡¨ç¾
                        contextualExpression: `${osType === 'engine' ? 'å†…çš„ä¾¡å€¤è¦³' : osType === 'interface' ? 'ç¤¾ä¼šçš„å´é¢' : 'é˜²å¾¡çš„å´é¢'}ã«ãŠã‘ã‚‹${hexagram.catchphrase}`
                };
            
            generatePersonaCard(osResult, osType) {
                const enhancedResult = this.enhanceOSResult(osResult, osType);
                const persona = enhancedResult.persona;
                
                if (!persona) {
                    return '<div class="virtual-persona-card">ãƒšãƒ«ã‚½ãƒŠãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>';
                }
                
                // OSã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè‰²åˆ†ã‘
                const osColors = {
                    engine: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    interface: 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)',
                    safemode: 'linear-gradient(135deg, #ed8936 0%, #dd6b20 100%)'
                };
                
                return `
                    <div class="virtual-persona-card" style="background: ${osColors[osType] || osColors.engine};">
                        <div class="persona-header">
                            <span class="persona-symbol">${persona.symbol}</span>
                            <div>
                                <h3 class="persona-name">${persona.name}</h3>
                                <p class="hexagram-name">${persona.hexagramName} (${persona.reading})</p>
                            </div>
                        </div>
                        <div class="persona-content">
                            <p class="persona-context">${persona.contextualExpression}</p>
                            <div class="persona-traits">
                                ${persona.traits.map(trait => `<span class="trait-tag">${trait}</span>`).join('')}
                            </div>
                            <p class="persona-description">${persona.description}</p>
                        </div>
                    </div>
                `;
            }
        }
        
        // 7. TripleOSã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆTypeScriptã‹ã‚‰ç§»æ¤ï¼‰
        class TripleOSEngine {
            constructor() {
                this.trigramMapping = this.initializeTrigramMapping();
                this.interfaceKeywords = new Map();
                this.safeModeKeywords = new Map();
                this.initializeKeywordMaps();
            }
            
            initializeTrigramMapping() {
                // æ˜“çµŒæº–æ‹ ã®æ­£çµ±ä¸‰çˆ»ãƒãƒƒãƒ”ãƒ³ã‚°
                return {
                    "ä¹¾": { id: 1, symbol: "â˜°", name: "å¤©", nature: "å‰›å¥", trait: "ç´”ç²‹å‰µé€ ãƒ»å¤©æ€§ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—" },
                    "å…Œ": { id: 2, symbol: "â˜±", name: "æ²¢", nature: "æ‚¦æ¥½", trait: "å–œæ‚¦èª¿å’Œãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³" },
                    "é›¢": { id: 3, symbol: "â˜²", name: "ç«", nature: "å…‰æ˜", trait: "å…‰æ˜è¡¨ç¾ãƒ»çŸ¥æ€§æƒ…ç†±" },
                    "éœ‡": { id: 4, symbol: "â˜³", name: "é›·", nature: "ç™ºå‹•", trait: "é›·é³´è¡Œå‹•ãƒ»é©æ–°å®Ÿè¡Œ" },
                    "å·½": { id: 5, symbol: "â˜´", name: "é¢¨", nature: "é †å…¥", trait: "é¢¨æµæµ¸é€ãƒ»æŸ”è»Ÿé©å¿œ" },
                    "å": { id: 6, symbol: "â˜µ", name: "æ°´", nature: "é™·é™º", trait: "æ·±æ·µæ¢æ±‚ãƒ»æ´å¯Ÿçªç ´" },
                    "è‰®": { id: 7, symbol: "â˜¶", name: "å±±", nature: "é™æ­¢", trait: "å±±å²³å®‰å®šãƒ»ä¸å‹•ç¶™ç¶š" },
                    "å¤": { id: 8, symbol: "â˜·", name: "åœ°", nature: "æŸ”é †", trait: "å¤§åœ°å—å®¹ãƒ»è‚²æˆåŒ…å®¹" }
                };
            }
            
            initializeKeywordMaps() {
                // Interface OS keywords
                this.interfaceKeywords.set("ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—", ["1", "13", "43", "14"]);
                this.interfaceKeywords.set("å”èª¿æ€§", ["2", "15", "45", "8"]);
                this.interfaceKeywords.set("å‰µé€ æ€§", ["1", "43", "34", "14"]);
                
                // SafeMode OS keywords  
                this.safeModeKeywords.set("æ…é‡", ["2", "52", "39", "15"]);
                this.safeModeKeywords.set("åˆ†æçš„", ["29", "48", "47", "6"]);
                this.safeModeKeywords.set("æ’¤é€€", ["33", "12", "45", "35"]);
            }
            
            // Triple OSåˆ†æã®ãƒ¡ã‚¤ãƒ³å‡¦ç†
            async analyzeTripleOS(allAnswers) {
                // console.log("ğŸ”¯ Starting Triple OS Analysis");
                
                try {
                    // 1. å›ç­”ã‚’ä¾¡å€¤è¦³è³ªå•ã¨ã‚·ãƒŠãƒªã‚ªè³ªå•ã«åˆ†é›¢
                    const { worldviewAnswers, scenarioAnswers } = this.separateAnswers(allAnswers);
                    
                    // 2. Engine OSï¼ˆä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                    const engineOS = await this.analyzeEngineOS(worldviewAnswers);
                    
                    // 3. Interface OSï¼ˆç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                    const interfaceOS = await this.analyzeInterfaceOS(scenarioAnswers, engineOS);
                    
                    // 4. SafeMode OSï¼ˆé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                    const safeModeOS = await this.analyzeSafeModeOS(scenarioAnswers, engineOS);
                    
                    // 5. å…¨OSãŒæ­£å¸¸ã«è¨ˆç®—ã•ã‚ŒãŸã‹ç¢ºèª
                    this.validateTripleOSResults(engineOS, interfaceOS, safeModeOS);
                    
                    // 6. å„OSã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å¼·åº¦ã‚’è¨ˆç®—
                    engineOS.energy = this.calculateOSEnergy(engineOS);
                    interfaceOS.energy = this.calculateOSEnergy(interfaceOS);
                    safeModeOS.energy = this.calculateOSEnergy(safeModeOS);
                    
                    console.log("âš¡ OS Energies:", {
                        engine: engineOS.energy,
                        interface: interfaceOS.energy,
                        safeMode: safeModeOS.energy
                    });
                    
                    // 7. Triple OSçµ±åˆåˆ†æã®å®Ÿè¡Œ
                    const tripleOSIntegration = await this.calculateTripleOSInteraction(engineOS, interfaceOS, safeModeOS);
                    
                    // console.log("âœ… Triple OS Analysis Completed Successfully");
                    
                    return {
                        engineOS,
                        interfaceOS,
                        safeModeOS,
                        integration: tripleOSIntegration,
                        consistencyScore: tripleOSIntegration.consistency,
                        balanceScore: tripleOSIntegration.balance,
                        HaQeiIntegration: tripleOSIntegration.integration,
                        recommendations: tripleOSIntegration.recommendations,
                        validationStatus: "completed",
                        timestamp: Date.now()
                    };
                    
                } catch (error) {
                    console.error("âŒ Triple OS Analysis Error:", error);
                    
                    // çµ±åˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®Triple OSçµæœã‚’è¿”ã™
                    return this.getDefaultTripleOSResults();
            
            separateAnswers(allAnswers) {
                const worldviewAnswers = [];
                const scenarioAnswers = [];
                
                allAnswers.forEach(answer => {
                    const questionNum = parseInt(answer.questionId.replace('q', ''));
                    if (questionNum >= 1 && questionNum <= 24) {
                        worldviewAnswers.push(answer);
                    } else if (questionNum >= 25 && questionNum <= 30) {
                        scenarioAnswers.push(answer);
                });
                
                return { worldviewAnswers, scenarioAnswers };
            
            async analyzeEngineOS(worldviewAnswers) {
                console.log("ğŸ”¥ Engine OS Analysis: Core Values System Mapping");
                
                try {
                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ™ã‚¯ãƒˆãƒ«ã®æ§‹ç¯‰
                    const userVector = this.buildUserVector(worldviewAnswers);
                    console.log("ğŸ“Š User Vector:", userVector);
                    
                    // ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¨ˆç®—
                    const trigramEnergies = this.calculateTrigramEnergies(userVector);
                    console.log("âš¡ Trigram Energies:", trigramEnergies);
                    
                    // ğŸŒŸ æ”¹å–„ï¼šå…¨ä½“ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹é‡è¦–ã®64å¦é¸æŠ
                    const authenticEngine = new AuthenticEnergyBalanceEngine();
                    const optimalResult = authenticEngine.selectOptimalHexagramByEnergyBalance(
                        trigramEnergies, 
                        'Engine OS'
                    
                    console.log(`ğŸ† Engine OS Optimal Result:`, optimalResult);
                    
                    // 64å¦ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ï¼ˆå¾“æ¥ã®ã‚·ã‚¹ãƒ†ãƒ ã¨ã®äº’æ›æ€§ç¶­æŒï¼‰
                    const hexagram = HEXAGRAMS.find(h => h.hexagram_id === optimalResult.hexagramId) || HEXAGRAMS[0];
                    
                    return {
                        hexagramId: optimalResult.hexagramId,
                        hexagramName: optimalResult.hexagramName || hexagram.name_jp,
                        description: hexagram.description,
                        catchphrase: hexagram.catchphrase,
                        primaryTrigram: optimalResult.upperTrigram,
                        secondaryTrigram: optimalResult.lowerTrigram,
                        trigramEnergies,
                        // ğŸŒŸ æ–°æ©Ÿèƒ½ï¼šå…¨ä½“èª¿å’Œåˆ†æã®è©³ç´°çµæœ
                        harmonyScore: optimalResult.harmonyScore,
                        energyUtilization: optimalResult.energyUtilization,
                        osCompatibility: optimalResult.osCompatibility,
                        detailedAnalysis: optimalResult.detailedAnalysis,
                        alternativeCandidates: optimalResult.alternativeCandidates,
                        improvementRecommendations: optimalResult.improvementRecommendations,
                        // å¾“æ¥ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é•ã„ã‚’æ˜ç¤º
                        originalMethod: this.getLegacyResult(trigramEnergies),
                        improvedMethod: true,
                        balanceType: 'authentic_energy_balance'
                    };
                    
                } catch (error) {
                    console.error("âŒ Engine OS Analysis Error:", error);
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šå¾“æ¥æ–¹å¼
                    return this.analyzeEngineOSLegacy(worldviewAnswers);
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            // ğŸ”„ å¾“æ¥æ–¹å¼ã®ä¿æŒï¼ˆæ¯”è¼ƒãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ï¼‰
            getLegacyResult(trigramEnergies) {
                const sortedTrigrams = Object.entries(trigramEnergies).sort(([, a], [, b]) => b - a);
                const upperTrigram = sortedTrigrams[0][0];
                const lowerTrigram = sortedTrigrams[1][0];
                const hexagramId = this.mapTrigramsToHexagram(upperTrigram, lowerTrigram);
                
                return {
                    method: 'legacy_highest_two',
                    upperTrigram,
                    lowerTrigram, 
                    hexagramId,
                    note: 'å¾“æ¥ã®æœ€é«˜å€¤2ä¸‰çˆ»é¸æŠæ–¹å¼'
                };
            
            // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®å¾“æ¥åˆ†æ
            analyzeEngineOSLegacy(worldviewAnswers) {
                console.warn("ğŸš¨ Falling back to legacy Engine OS analysis");
                
                const userVector = this.buildUserVector(worldviewAnswers);
                const trigramEnergies = this.calculateTrigramEnergies(userVector);
                
                const sortedTrigrams = Object.entries(trigramEnergies).sort(([, a], [, b]) => b - a);
                const upperTrigram = sortedTrigrams[0][0];
                const lowerTrigram = sortedTrigrams[1][0];
                
                const hexagramId = this.mapTrigramsToHexagram(upperTrigram, lowerTrigram);
                const hexagram = HEXAGRAMS.find(h => h.hexagram_id === hexagramId) || HEXAGRAMS[0];
                
                return {
                    hexagramId,
                    hexagramName: hexagram.name_jp,
                    description: hexagram.description,
                    catchphrase: hexagram.catchphrase,
                    primaryTrigram: upperTrigram,
                    secondaryTrigram: lowerTrigram,
                    trigramEnergies,
                    balanceType: 'legacy_fallback',
                    improvedMethod: false
                };
            
            buildUserVector(answers) {
                const vector = {
                    ä¹¾_å‰µé€ æ€§: 0, éœ‡_è¡Œå‹•æ€§: 0, å_æ¢æ±‚æ€§: 0, è‰®_å®‰å®šæ€§: 0,
                    å¤_å—å®¹æ€§: 0, å·½_é©å¿œæ€§: 0, é›¢_è¡¨ç¾æ€§: 0, å…Œ_èª¿å’Œæ€§: 0
                };
                
                answers.forEach(answer => {
                    const option = answer.selectedOption;
                    if (option && option.scoring) {
                        Object.entries(option.scoring).forEach(([dimension, score]) => {
                            if (vector.hasOwnProperty(dimension)) {
                                vector[dimension] += score;
                        });
                });
                
                return vector;
            
            calculateTrigramEnergies(userVector) {
                // æ˜“çµŒæº–æ‹ ã®æ­£çµ±ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
                const rawEnergies = {};
                
                // 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰8ä¸‰çˆ»ã¸ã®æ­£çµ±å¤‰æ›
                Object.entries(AUTHENTIC_TRIGRAM_MAPPING).forEach(([dimension, trigramId]) => {
                    const trigramName = this.getTrigramName(trigramId);
                    rawEnergies[trigramName] = userVector[dimension] || 0;
                });
                
                // HaQeiå‹•çš„æ­£è¦åŒ–ï¼ˆæœ€é«˜å€¤ã‚’100ã¨ã—ã€ç›¸å¯¾çš„ãƒãƒ©ãƒ³ã‚¹ç¶­æŒï¼‰
                const maxEnergy = Math.max(...Object.values(rawEnergies));
                const normalizedEnergies = {};
                
                if (maxEnergy > 0) {
                    Object.entries(rawEnergies).forEach(([trigram, energy]) => {
                        // æ­£è¦åŒ– + é™°é™½ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
                        const normalized = (energy / maxEnergy) * 100;
                        normalizedEnergies[trigram] = Math.max(0, Math.min(100, normalized));
                    });
                } else {
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆå‡ç­‰åˆ†æ•£ï¼‰
                    Object.keys(rawEnergies).forEach(trigram => {
                        normalizedEnergies[trigram] = 12.5; // 100/8
                    });
                
                return normalizedEnergies;
            
            getTrigramName(trigramId) {
                // ğŸŒŸ IMPROVED: è©³ç´°ãªèª¬æ˜ä»˜ãtrigramåå‰å–å¾—
                const trigramMap = {
                    'ä¹¾': 'ä¹¾ (å¤©) - å‰µé€ æ€§ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã®å¦',
                    'å…Œ': 'å…Œ (æ²¢) - èª¿å’Œæ€§ãƒ»äº¤æµã®å¦',
                    'é›¢': 'é›¢ (ç«) - è¡¨ç¾æ€§ãƒ»æƒ…ç†±ã®å¦',
                    'éœ‡': 'éœ‡ (é›·) - è¡Œå‹•æ€§ãƒ»å¤‰é©ã®å¦', 
                    'å·½': 'å·½ (é¢¨) - é©å¿œæ€§ãƒ»æŸ”è»Ÿæ€§ã®å¦',
                    'å': 'å (æ°´) - æ¢æ±‚æ€§ãƒ»æ·±å±¤ç†è§£ã®å¦',
                    'è‰®': 'è‰® (å±±) - å®‰å®šæ€§ãƒ»æŒç¶šåŠ›ã®å¦',
                    'å¤': 'å¤ (åœ°) - å—å®¹æ€§ãƒ»æ”¯æ´ã®å¦'
                };
                
                // ğŸ›¡ï¸ UNDEFINED PROTECTION: å®‰å…¨ãªå–å¾—
                if (typeof trigramId === 'number') {
                    const trigramNames = ["ä¹¾", "å…Œ", "é›¢", "éœ‡", "å·½", "å", "è‰®", "å¤"];
                    const trigramKey = trigramNames[trigramId - 1];
                    return trigramMap[trigramKey] || `ç¬¬${trigramId}å¦ (è©³ç´°ä¸æ˜)`;
                
                if (typeof trigramId === 'string') {
                    return trigramMap[trigramId] || `${trigramId} (è©³ç´°æƒ…å ±ã‚’å–å¾—ä¸­)`;
                
                return 'å¦æƒ…å ±ã‚’å–å¾—ä¸­...';
            
            mapTrigramsToHexagram(upperTrigram, lowerTrigram) {
                // æ˜“çµŒæº–æ‹ ã®æ­£ç¢ºãª64å¦è¨ˆç®—ï¼ˆå…ˆå¤©å…«å¦é…åˆ—åŸºæº–ï¼‰
                const trigramToNumber = {
                    "ä¹¾": 1, "å…Œ": 2, "é›¢": 3, "éœ‡": 4,
                    "å·½": 5, "å": 6, "è‰®": 7, "å¤": 8
                };
                
                const upper = trigramToNumber[upperTrigram] || 1;
                const lower = trigramToNumber[lowerTrigram] || 1;
                
                // æ­£çµ±çš„64å¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ï¼ˆå…ˆå¤©å…«å¦é †åºï¼‰
                const authenticHexagramMatrix = [
                    [1, 43, 14, 34, 9, 5, 26, 11],   // ä¹¾ä¸Š (å¤©)
                    [58, 60, 38, 54, 61, 59, 28, 19], // å…Œä¸Š (æ²¢)
                    [50, 64, 56, 62, 55, 63, 35, 8],  // é›¢ä¸Š (ç«)
                    [51, 16, 40, 32, 46, 48, 18, 7],  // éœ‡ä¸Š (é›·)
                    [57, 20, 53, 42, 37, 45, 22, 36], // å·½ä¸Š (é¢¨)
                    [6, 29, 4, 7, 59, 60, 3, 2],      // åä¸Š (æ°´)
                    [33, 52, 39, 15, 53, 56, 31, 12], // è‰®ä¸Š (å±±)
                    [2, 47, 4, 7, 46, 29, 27, 24]     // å¤ä¸Š (åœ°)
                ];
                
                // æ˜“çµŒæ­£çµ±è¨ˆç®—
                const hexagramId = authenticHexagramMatrix[upper - 1][lower - 1];
                
                console.log(`ğŸ”¯ Authentic I-Ching Mapping: ${upperTrigram}(${upper}) over ${lowerTrigram}(${lower}) = Hexagram ${hexagramId}`);
                
                return hexagramId;
            
            // å¦ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ¡ã‚½ãƒƒãƒ‰
            getHexagramData(hexagramId) {
                const hexagram = HEXAGRAMS.find(h => h.hexagram_id === hexagramId);
                if (!hexagram) {
                    console.warn(`Hexagram ${hexagramId} not found, using default`);
                    return HEXAGRAMS[0] || {
                        hexagram_id: hexagramId,
                        name_jp: `å¦${hexagramId}`,
                        description: "ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
                        catchphrase: "---"
                    };
                return hexagram;
            
            async analyzeInterfaceOS(scenarioAnswers, engineOS) {
                console.log("ğŸŒ Interface OS Analysis: Social Pattern Mapping");
                
                try {
                    // 1. ã‚·ãƒŠãƒªã‚ªè³ªå•ã‹ã‚‰ç¤¾ä¼šçš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
                    const socialPatterns = this.analyzeSocialPatterns(scenarioAnswers);
                    console.log("ğŸ“Š Social Patterns:", socialPatterns);
                    
                    // 2. Interface OSå°‚ç”¨ã®8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰
                    const interfaceVector = this.buildInterfaceVector(socialPatterns);
                    console.log("ğŸ¯ Interface Vector:", interfaceVector);
                    
                    // 3. ç¤¾ä¼šçš„ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
                    const socialTrigramEnergies = this.calculateSocialTrigramEnergies(interfaceVector);
                    console.log("âš¡ Social Trigram Energies:", socialTrigramEnergies);
                    
                    // 4. Engine OSã¨ã®ç›¸äº’ä½œç”¨è£œæ­£
                    const adjustedEnergies = this.adjustForEngineOS(socialTrigramEnergies, engineOS);
                    console.log("ğŸ”„ Adjusted for Engine OS:", adjustedEnergies);
                    
                    // 5. ğŸŒŸ æ”¹å–„ï¼šInterface OSå…¨ä½“ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹é‡è¦–ã®æœ€é©é¸æŠ
                    const authenticEngine = new AuthenticEnergyBalanceEngine();
                    const optimalResult = authenticEngine.selectOptimalHexagramByEnergyBalance(
                        adjustedEnergies, 
                        'Interface OS'
                    
                    console.log(`ğŸ† Interface OS Optimal Result:`, optimalResult);
                    
                    // 6. 64å¦ãƒ‡ãƒ¼ã‚¿å–å¾—
                    const hexagramData = this.getHexagramData(optimalResult.hexagramId);
                    
                    // 7. Interface OSå°‚ç”¨è§£é‡ˆç”Ÿæˆ
                    const interfaceInterpretation = this.generateInterfaceInterpretation(
                        optimalResult.hexagramId, optimalResult.upperTrigram, optimalResult.lowerTrigram, socialPatterns, engineOS
                    
                    console.log(`ğŸŒŸ Interface OS Result: Hexagram ${optimalResult.hexagramId} (${hexagramData.name_jp})`);
                    
                    return {
                        hexagramId: optimalResult.hexagramId,
                        hexagramName: optimalResult.hexagramName || hexagramData.name_jp,
                        catchphrase: hexagramData.catchphrase,
                        upperTrigram: optimalResult.upperTrigram,
                        lowerTrigram: optimalResult.lowerTrigram,
                        socialPatterns,
                        interfaceVector,
                        socialStyle: this.determineSocialStyle(socialPatterns),
                        description: interfaceInterpretation.description,
                        leadership: interfaceInterpretation.leadership,
                        communication: interfaceInterpretation.communication,
                        conflictResolution: interfaceInterpretation.conflictResolution,
                        adaptability: interfaceInterpretation.adaptability,
                        engineOSInfluence: interfaceInterpretation.engineOSInfluence,
                        trigramEnergies: adjustedEnergies,
                        type: "Interface OS",
                        // ğŸŒŸ æ–°æ©Ÿèƒ½ï¼šå…¨ä½“èª¿å’Œåˆ†æã®è©³ç´°çµæœ
                        harmonyScore: optimalResult.harmonyScore,
                        energyUtilization: optimalResult.energyUtilization,
                        osCompatibility: optimalResult.osCompatibility,
                        detailedAnalysis: optimalResult.detailedAnalysis,
                        alternativeCandidates: optimalResult.alternativeCandidates,
                        improvementRecommendations: optimalResult.improvementRecommendations,
                        balanceType: 'authentic_energy_balance',
                        improvedMethod: true
                    };
                    
                } catch (error) {
                    console.error("âŒ Interface OS Analysis Error:", error);
                    return this.getDefaultInterfaceOS();
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            async analyzeSafeModeOS(scenarioAnswers, engineOS) {
                console.log("ğŸ›¡ï¸ SafeMode OS Analysis: Defensive Pattern Extraction");
                
                try {
                    // 1. ã‚·ãƒŠãƒªã‚ªã‹ã‚‰é˜²å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡º
                    const defensivePatterns = this.extractDefensivePatterns(scenarioAnswers);
                    console.log("âš¡ Defensive Patterns:", defensivePatterns);
                    
                    // 2. ã‚¹ãƒˆãƒ¬ã‚¹åå¿œãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰
                    const stressVector = this.buildStressResponseVector(defensivePatterns);
                    console.log("ğŸŒªï¸ Stress Response Vector:", stressVector);
                    
                    // 3. é˜²å¾¡çš„ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
                    const defensiveTrigramEnergies = this.calculateDefensiveTrigramEnergies(stressVector);
                    console.log("âš”ï¸ Defensive Trigram Energies:", defensiveTrigramEnergies);
                    
                    // 4. Engine OSã«ã‚ˆã‚‹åŸºç¤çš„å½±éŸ¿ï¼ˆ40%ï¼‰
                    const adjustedEnergies = this.adjustForCorePersonality(defensiveTrigramEnergies, engineOS);
                    console.log("ğŸ”§ Core-Adjusted Energies:", adjustedEnergies);
                    
                    // 5. ğŸŒŸ æ”¹å–„ï¼šSafe Mode OSå…¨ä½“ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹é‡è¦–ã®æœ€é©é¸æŠ
                    const authenticEngine = new AuthenticEnergyBalanceEngine();
                    const optimalResult = authenticEngine.selectOptimalHexagramByEnergyBalance(
                        adjustedEnergies, 
                        'Safe Mode OS'
                    
                    console.log(`ğŸ† Safe Mode OS Optimal Result:`, optimalResult);
                    
                    // 6. 64å¦ãƒ‡ãƒ¼ã‚¿å–å¾—
                    const hexagramData = this.getHexagramData(optimalResult.hexagramId);
                    
                    // 7. SafeMode OSå°‚ç”¨è§£é‡ˆç”Ÿæˆ
                    const safeModeInterpretation = this.generateSafeModeInterpretation(
                        optimalResult.hexagramId, optimalResult.upperTrigram, optimalResult.lowerTrigram, defensivePatterns, engineOS
                    
                    console.log(`ğŸ”¯ SafeMode OS Result: Hexagram ${optimalResult.hexagramId} (${hexagramData.name_jp})`);
                    
                    return {
                        hexagramId: optimalResult.hexagramId,
                        hexagramName: optimalResult.hexagramName || hexagramData.name_jp,
                        description: safeModeInterpretation.description,
                        catchphrase: hexagramData.catchphrase,
                        primaryDefense: optimalResult.upperTrigram,
                        secondaryDefense: optimalResult.lowerTrigram,
                        defensiveType: safeModeInterpretation.defensiveType,
                        stressResponse: safeModeInterpretation.stressResponse,
                        activationTrigger: safeModeInterpretation.activationTrigger,
                        defensiveStrength: this.calculateDefensiveStrength(defensivePatterns),
                        trigramEnergies: adjustedEnergies,
                        type: "Safe Mode OS",
                        // ğŸŒŸ æ–°æ©Ÿèƒ½ï¼šå…¨ä½“èª¿å’Œåˆ†æã®è©³ç´°çµæœ
                        harmonyScore: optimalResult.harmonyScore,
                        energyUtilization: optimalResult.energyUtilization,
                        osCompatibility: optimalResult.osCompatibility,
                        detailedAnalysis: optimalResult.detailedAnalysis,
                        alternativeCandidates: optimalResult.alternativeCandidates,
                        improvementRecommendations: optimalResult.improvementRecommendations,
                        balanceType: 'authentic_energy_balance',
                        improvedMethod: true
                    };
                    
                } catch (error) {
                    console.error("âŒ SafeMode OS Analysis Error:", error);
                    return this.getDefaultSafeModeOS();
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                

            extractDefensivePatterns(scenarioAnswers) {
                const patterns = {
                    leadershipStress: 0,    // Q25: è²¬ä»»ã®é‡åœ§ã¸ã®é˜²å¾¡
                    interpersonalStress: 0, // Q26: äººé–“é–¢ä¿‚ã‚¹ãƒˆãƒ¬ã‚¹ã¸ã®é˜²å¾¡
                    familyStress: 0,        // Q27: è¦ªå¯†é–¢ä¿‚ã®è² è·ã¸ã®é˜²å¾¡
                    emergencyStress: 0,     // Q28: å±æ©Ÿçš„çŠ¶æ³ã¸ã®é˜²å¾¡
                    competitionStress: 0,   // Q29: ç«¶äº‰åœ§åŠ›ã¸ã®é˜²å¾¡
                    collaborationStress: 0  // Q30: å”èª¿ã®è² æ‹…ã¸ã®é˜²å¾¡
                };
                
                // å„ã‚·ãƒŠãƒªã‚ªå›ç­”ã‹ã‚‰é˜²å¾¡çš„åå¿œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡º
                scenarioAnswers.forEach((answer, index) => {
                    const questionNum = 25 + index;
                    const stressResponse = this.analyzeStressResponse(answer, questionNum);
                    
                    switch(questionNum) {
                        case 25: patterns.leadershipStress = stressResponse; break;
                        case 26: patterns.interpersonalStress = stressResponse; break;
                        case 27: patterns.familyStress = stressResponse; break;
                        case 28: patterns.emergencyStress = stressResponse; break;
                        case 29: patterns.competitionStress = stressResponse; break;
                        case 30: patterns.collaborationStress = stressResponse; break;
                });
                
                return patterns;

            analyzeStressResponse(answer, questionNum) {
                // å›ç­”ã‹ã‚‰é˜²å¾¡çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ•°å€¤åŒ–
                const responseIntensity = this.calculateResponseIntensity(answer);
                const defensiveType = this.identifyDefensiveType(answer, questionNum);
                
                return {
                    intensity: responseIntensity,
                    type: defensiveType,
                    pattern: this.mapToDefensivePattern(defensiveType)
                };

            calculateResponseIntensity(answer) {
                // å›ç­”ã®å¼·åº¦ã‚’0-1ã§æ¸¬å®š
                if (!answer || !answer.text) return 0.5;
                
                const text = answer.text.toLowerCase();
                const intensityKeywords = {
                    high: ['çµ¶å¯¾', 'å¿…ãš', 'å®Œå…¨', 'å¾¹åº•', 'æ–­å›º', 'æ–­ç„¶', 'å³åº§', 'ç·Šæ€¥'],
                    medium: ['ã§ãã‚‹ã ã‘', 'ãªã‚‹ã¹ã', 'åŠªåŠ›', 'æ¤œè¨', 'ç›¸è«‡', 'èª¿æ•´'],
                    low: ['æ§˜å­è¦‹', 'ä¿ç•™', 'å»¶æœŸ', 'å›é¿', 'ç„¡è¦–', 'æ”¾ç½®']
                };
                
                let score = 0.5; // baseline
                
                intensityKeywords.high.forEach(keyword => {
                    if (text.includes(keyword)) score += 0.15;
                });
                intensityKeywords.medium.forEach(keyword => {
                    if (text.includes(keyword)) score += 0.05;
                });
                intensityKeywords.low.forEach(keyword => {
                    if (text.includes(keyword)) score -= 0.1;
                });
                
                return Math.max(0, Math.min(1, score));

            identifyDefensiveType(answer, questionNum) {
                if (!answer || !answer.text) return 'neutral';
                
                const text = answer.text.toLowerCase();
                
                // é˜²å¾¡ã‚¿ã‚¤ãƒ—ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æ
                const defensiveKeywords = {
                    retreat: ['æ’¤é€€', 'è·é›¢', 'é¿ã‘ã‚‹', 'é›¢ã‚Œã‚‹', 'é€€ã', 'é€ƒã’'],
                    confront: ['å¯¾æŠ—', 'ç«‹ã¡å‘ã‹ã†', 'æˆ¦ã†', 'æŒ‘æˆ¦', 'åæ’ƒ', 'æŠµæŠ—'],
                    avoid: ['å›é¿', 'å·§ã¿', 'è¿‚å›', 'åˆ¥ã®é“', 'æŸ”è»Ÿ', 'é©å¿œ'],
                    endure: ['è€ãˆã‚‹', 'æˆ‘æ…¢', 'å¿ã¶', 'æŒä¹…', 'ç¶™ç¶š', 'å …æŒ'],
                    transform: ['å¤‰åŒ–', 'é©å¿œ', 'å¤‰å®¹', 'èª¿æ•´', 'ä¿®æ­£', 'é€²åŒ–'],
                    boundary: ['å¢ƒç•Œ', 'ç·šå¼•ã', 'åˆ¶é™', 'åŒºåˆ¥', 'åˆ†é›¢', 'é˜²å£'],
                    harmonize: ['èª¿å’Œ', 'åŒåŒ–', 'æº¶ã‘è¾¼ã‚€', 'å”èª¿', 'åˆã‚ã›ã‚‹', 'èåˆ'],
                    fortify: ['å¼·åŒ–', 'å›ºã‚ã‚‹', 'å®ˆã‚‹', 'é˜²å¾¡', 'å®‰å®š', 'å …å›º']
                };
                
                let maxScore = 0;
                let dominantType = 'neutral';
                
                Object.entries(defensiveKeywords).forEach(([type, keywords]) => {
                    let score = 0;
                    keywords.forEach(keyword => {
                        if (text.includes(keyword)) score++;
                    });
                    if (score > maxScore) {
                        maxScore = score;
                        dominantType = type;
                });
                
                return dominantType;

            mapToDefensivePattern(defensiveType) {
                const patternMap = {
                    retreat: 'æ’¤é€€',     // å¤ãƒ»è‰®
                    confront: 'å¯¾æŠ—',    // ä¹¾ãƒ»éœ‡
                    avoid: 'å›é¿',       // å·½ãƒ»å…Œ
                    endure: 'è€å¿',      // åãƒ»è‰®
                    transform: 'å¤‰å®¹',   // é›¢ãƒ»å·½
                    boundary: 'çµç•Œ',    // è‰®ãƒ»å¤
                    harmonize: 'åŒåŒ–',   // å¤ãƒ»å·½
                    fortify: 'ç¡¬åŒ–',     // ä¹¾ãƒ»è‰®
                    neutral: 'ä¸­ç«‹'
                };
                
                return patternMap[defensiveType] || 'ä¸­ç«‹';

            buildStressResponseVector(defensivePatterns) {
                // é˜²å¾¡çš„8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰
                const vector = {
                    é˜²å¾¡_æ’¤é€€æ€§: 0,    // å¤ - å—å‹•çš„æ’¤é€€
                    é˜²å¾¡_å¯¾æŠ—æ€§: 0,    // ä¹¾ - ç©æ¥µçš„å¯¾æŠ—
                    é˜²å¾¡_å›é¿æ€§: 0,    // å·½ - æŸ”è»Ÿãªå›é¿
                    é˜²å¾¡_æŒä¹…æ€§: 0,    // å - å¿è€ã¨æŒä¹…
                    é˜²å¾¡_å¤‰å®¹æ€§: 0,    // é›¢ - å¤‰åŒ–ã¨é©å¿œ
                    é˜²å¾¡_å¢ƒç•Œæ€§: 0,    // è‰® - å¢ƒç•Œè¨­å®š
                    é˜²å¾¡_èª¿å’Œæ€§: 0,    // å…Œ - èª¿å’Œçš„è§£æ±º
                    é˜²å¾¡_å …å›ºæ€§: 0     // éœ‡ - ç¬ç™ºçš„é˜²å¾¡
                };
                
                // å„ã‚¹ãƒˆãƒ¬ã‚¹åå¿œã‚’å¯¾å¿œã™ã‚‹é˜²å¾¡æ¬¡å…ƒã«ãƒãƒƒãƒ”ãƒ³ã‚°
                Object.entries(defensivePatterns).forEach(([stressType, response]) => {
                    const intensity = response.intensity || 0;
                    const pattern = response.pattern || 'ä¸­ç«‹';
                    
                    switch(pattern) {
                        case 'æ’¤é€€':
                            vector.é˜²å¾¡_æ’¤é€€æ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_èª¿å’Œæ€§ += intensity * 0.3;
                            break;
                        case 'å¯¾æŠ—':
                            vector.é˜²å¾¡_å¯¾æŠ—æ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_å …å›ºæ€§ += intensity * 0.4;
                            break;
                        case 'å›é¿':
                            vector.é˜²å¾¡_å›é¿æ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_å¤‰å®¹æ€§ += intensity * 0.3;
                            break;
                        case 'è€å¿':
                            vector.é˜²å¾¡_æŒä¹…æ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_å¢ƒç•Œæ€§ += intensity * 0.4;
                            break;
                        case 'å¤‰å®¹':
                            vector.é˜²å¾¡_å¤‰å®¹æ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_å›é¿æ€§ += intensity * 0.3;
                            break;
                        case 'çµç•Œ':
                            vector.é˜²å¾¡_å¢ƒç•Œæ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_æŒä¹…æ€§ += intensity * 0.3;
                            break;
                        case 'åŒåŒ–':
                            vector.é˜²å¾¡_èª¿å’Œæ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_æ’¤é€€æ€§ += intensity * 0.3;
                            break;
                        case 'ç¡¬åŒ–':
                            vector.é˜²å¾¡_å …å›ºæ€§ += intensity * 0.8;
                            vector.é˜²å¾¡_å¯¾æŠ—æ€§ += intensity * 0.3;
                            break;
                });
                
                // æ­£è¦åŒ–
                const maxValue = Math.max(...Object.values(vector));
                if (maxValue > 0) {
                    Object.keys(vector).forEach(key => {
                        vector[key] = vector[key] / maxValue;
                    });
                
                return vector;

            calculateDefensiveTrigramEnergies(stressVector) {
                // é˜²å¾¡çš„8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—
                return {
                    ä¹¾: stressVector.é˜²å¾¡_å¯¾æŠ—æ€§ * 0.7 + stressVector.é˜²å¾¡_å …å›ºæ€§ * 0.3,
                    å…Œ: stressVector.é˜²å¾¡_èª¿å’Œæ€§ * 0.8 + stressVector.é˜²å¾¡_å›é¿æ€§ * 0.2,
                    é›¢: stressVector.é˜²å¾¡_å¤‰å®¹æ€§ * 0.8 + stressVector.é˜²å¾¡_å¯¾æŠ—æ€§ * 0.2,
                    éœ‡: stressVector.é˜²å¾¡_å …å›ºæ€§ * 0.6 + stressVector.é˜²å¾¡_å¯¾æŠ—æ€§ * 0.4,
                    å·½: stressVector.é˜²å¾¡_å›é¿æ€§ * 0.7 + stressVector.é˜²å¾¡_å¤‰å®¹æ€§ * 0.3,
                    å: stressVector.é˜²å¾¡_æŒä¹…æ€§ * 0.8 + stressVector.é˜²å¾¡_å¢ƒç•Œæ€§ * 0.2,
                    è‰®: stressVector.é˜²å¾¡_å¢ƒç•Œæ€§ * 0.7 + stressVector.é˜²å¾¡_æ’¤é€€æ€§ * 0.3,
                    å¤: stressVector.é˜²å¾¡_æ’¤é€€æ€§ * 0.7 + stressVector.é˜²å¾¡_èª¿å’Œæ€§ * 0.3
                };

            adjustForCorePersonality(defensiveEnergies, engineOS) {
                // Engine OSã®åŸºç¤äººæ ¼ãŒé˜²å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã«40%ã®å½±éŸ¿ã‚’ä¸ãˆã‚‹
                const coreInfluence = 0.4;
                const defensiveBase = 0.6;
                
                if (!engineOS || !engineOS.trigramEnergies) return defensiveEnergies;
                
                const adjusted = {};
                Object.keys(defensiveEnergies).forEach(trigram => {
                    const coreEnergy = engineOS.trigramEnergies[trigram] || 0;
                    const defensiveEnergy = defensiveEnergies[trigram] || 0;
                    
                    adjusted[trigram] = (defensiveEnergy * defensiveBase) + (coreEnergy * coreInfluence);
                });
                
                return adjusted;

            selectDefensiveTrigrams(energies) {
                // ã‚¨ãƒãƒ«ã‚®ãƒ¼å€¤ã§ã‚½ãƒ¼ãƒˆã—ã¦ä¸Šä½2ã¤ã®ä¸‰çˆ»ã‚’é¸æŠ
                const sorted = Object.entries(energies)
                    .sort(([,a], [,b]) => b - a);
                
                return [sorted[0][0], sorted[1][0]];

            generateSafeModeInterpretation(hexagramId, primaryDefense, secondaryDefense, patterns, engineOS) {
                // SafeMode OSå°‚ç”¨ã®64å¦è§£é‡ˆ
                const defensiveInterpretations = this.getSafeModeHexagramInterpretations();
                const interpretation = defensiveInterpretations[hexagramId] || this.getDefaultDefensiveInterpretation();
                
                // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸè§£é‡ˆã‚’ç”Ÿæˆ
                const personalizedDescription = this.personalizeSafeModeDescription(
                    interpretation, primaryDefense, secondaryDefense, patterns, engineOS
                
                return {
                    description: personalizedDescription,
                    catchphrase: interpretation.catchphrase || "å›°é›£ã«ç«‹ã¡å‘ã‹ã†é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ",
                    defensiveType: interpretation.primaryDefense || "ç·åˆé˜²å¾¡",
                    stressResponse: interpretation.stressResponse || "çŠ¶æ³é©å¿œå‹å¯¾å¿œ",
                    activationTrigger: this.identifyActivationTrigger(patterns)
                };

            getSafeModeHexagramInterpretations() {
                return {
                    1: { // ä¹¾ç‚ºå¤©
                        name: "å¤©é›·ç„¡çª®å‹é˜²å¾¡",
                        catchphrase: "å›°é›£ã‚’åŠ›ã§çªç ´ã™ã‚‹",
                        primaryDefense: "ç©æ¥µçš„å¯¾æŠ—",
                        stressResponse: "æ­£é¢çªç ´ã«ã‚ˆã‚‹è§£æ±º"
                    2: { // å¤ç‚ºåœ°
                        name: "å¤§åœ°åŒ…å®¹å‹é˜²å¾¡",
                        catchphrase: "å…¨ã¦ã‚’å—ã‘å…¥ã‚ŒåŒ…ã¿è¾¼ã‚€",
                        primaryDefense: "å—å®¹ãƒ»åŒåŒ–",
                        stressResponse: "ç’°å¢ƒã¸ã®å®Œå…¨é©å¿œ"
                    29: { // åç‚ºæ°´
                        name: "æ·±æ·µæµæ°´å‹é˜²å¾¡",
                        catchphrase: "å›°é›£ã‚’æµã‚Œã‚‹ã‚ˆã†ã«é€šéã™ã‚‹",
                        primaryDefense: "æµ¸é€ãƒ»æŒç¶š",
                        stressResponse: "éšœå®³ã®æœ¬è³ªã‚’ç†è§£ã—è¿‚å›"
                    52: { // è‰®ç‚ºå±±
                        name: "ä¸å‹•è¦å¡å‹é˜²å¾¡",
                        catchphrase: "çµ¶å¯¾çš„ãªå¢ƒç•Œã‚’è¨­å®šã™ã‚‹",
                        primaryDefense: "é™æ­¢ãƒ»å¢ƒç•Œ",
                        stressResponse: "å®Œå…¨ãªé˜²å¾¡ä½“åˆ¶æ§‹ç¯‰"
                    58: { // å…Œç‚ºæ²¢
                        name: "èª¿å’Œäº¤æµå‹é˜²å¾¡",
                        catchphrase: "å¯¾è©±ã§å±æ©Ÿã‚’ä¹—ã‚Šè¶Šãˆã‚‹",
                        primaryDefense: "å”èª¿ãƒ»äº¤æ¸‰",
                        stressResponse: "é–¢ä¿‚æ€§ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    30: { // é›¢ç‚ºç«
                        name: "æ˜ç…§å¤‰å®¹å‹é˜²å¾¡",
                        catchphrase: "çŠ¶æ³ã‚’è¦‹æ¥µã‚å¤‰åŒ–ã™ã‚‹",
                        primaryDefense: "æ´å¯Ÿãƒ»é©å¿œ",
                        stressResponse: "çŠ¶æ³åˆ†æã«ã‚ˆã‚‹æœ€é©åŒ–"
                    51: { // éœ‡ç‚ºé›·
                        name: "é›»å…‰çŸ³ç«å‹é˜²å¾¡",
                        catchphrase: "ç¬æ™‚ã«è¡Œå‹•ã—å±æ©Ÿã‚’è„±ã™ã‚‹",
                        primaryDefense: "ç¬ç™ºãƒ»æ±ºæ–­",
                        stressResponse: "è¿…é€ŸãªçŠ¶æ³æ‰“é–‹"
                    57: { // å·½ç‚ºé¢¨
                        name: "é †é¢¨æŸ”è»Ÿå‹é˜²å¾¡",
                        catchphrase: "æŸ”è»Ÿæ€§ã§å›°é›£ã‚’å›é¿ã™ã‚‹",
                        primaryDefense: "æŸ”è»Ÿãƒ»å›é¿",
                        stressResponse: "çŠ¶æ³ã«å¿œã˜ãŸæŸ”è»Ÿå¯¾å¿œ"
                    // ä»–ã®å¦ã®è§£é‡ˆã‚‚åŒæ§˜ã«...
                    16: { // é›·åœ°äºˆ
                        name: "æº–å‚™å……å®Ÿå‹é˜²å¾¡",
                        catchphrase: "äº‹å‰æº–å‚™ã§å±æ©Ÿã‚’é˜²ã",
                        primaryDefense: "äºˆé˜²ãƒ»æº–å‚™",
                        stressResponse: "å…ˆèª­ã¿ã«ã‚ˆã‚‹å±æ©Ÿå›é¿"
                    39: { // æ°´å±±è¹‡
                        name: "å›°é›£çªç ´å‹é˜²å¾¡",
                        catchphrase: "å›°é›£ã®ä¸­ã§ã‚‚å‰é€²ã™ã‚‹",
                        primaryDefense: "å¿è€ãƒ»æŒç¶š",
                        stressResponse: "å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹ç²˜ã‚Šå¼·ã•"
                    3: { // æ°´é›·å±¯
                        name: "åˆæœŸæ··ä¹±å¯¾å¿œå‹é˜²å¾¡",
                        catchphrase: "æ··ä¹±ã®ä¸­ã§ç§©åºã‚’è¦‹ã¤ã‘ã‚‹",
                        primaryDefense: "å¿è€ãƒ»æ•´ç†",
                        stressResponse: "æ··ä¹±çŠ¶æ³ã®æ®µéšçš„æ•´ç†"
                    4: { // å±±æ°´è’™
                        name: "å­¦ç¿’é©å¿œå‹é˜²å¾¡",
                        catchphrase: "ç„¡çŸ¥ã‚’èªã‚ã¦å­¦ã¶ã“ã¨ã§å®ˆã‚‹",
                        primaryDefense: "å­¦ç¿’ãƒ»å¢ƒç•Œ",
                        stressResponse: "çŸ¥è­˜ä¸è¶³ã®è¬™è™šãªè£œå®Œ"
                    5: { // æ°´å¤©éœ€
                        name: "æ©Ÿä¼šå¾…æ©Ÿå‹é˜²å¾¡",
                        catchphrase: "é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’å¾…ã¤",
                        primaryDefense: "å¾…æ©Ÿãƒ»æŒç¶š",
                        stressResponse: "ç„¦ã‚‰ãšæ©Ÿä¼šã‚’å¾…ã¤æŒä¹…æˆ¦"
                    6: { // å¤©æ°´è¨Ÿ
                        name: "æ­£å½“é˜²è¡›å‹é˜²å¾¡",
                        catchphrase: "æ­£ç¾©ã‚’ä¸»å¼µã—ã¦ç«‹ã¡å‘ã‹ã†",
                        primaryDefense: "æ­£å½“æ€§ãƒ»å¯¾æŠ—",
                        stressResponse: "æ­£å½“ãªæ¨©åˆ©ã®ä¸»å¼µã¨é˜²è¡›"
                    7: { // åœ°æ°´å¸«
                        name: "çµ„ç¹”æˆ¦ç•¥å‹é˜²å¾¡",
                        catchphrase: "çµ„ç¹”åŠ›ã§å›°é›£ã«å¯¾å‡¦ã™ã‚‹",
                        primaryDefense: "çµ±ç‡ãƒ»æŒç¶š",
                        stressResponse: "çµ„ç¹”çš„ãªå•é¡Œè§£æ±º"
                    8: { // æ°´åœ°æ¯”
                        name: "å”èª¿é€£å¸¯å‹é˜²å¾¡",
                        catchphrase: "ä»²é–“ã¨çµæŸã—ã¦å®ˆã‚‹",
                        primaryDefense: "å”èª¿ãƒ»å—å®¹",
                        stressResponse: "ç›¸äº’æ”¯æ´ã«ã‚ˆã‚‹å±æ©Ÿå¯¾å¿œ"
                    9: { // é¢¨å¤©å°ç•œ
                        name: "å°è¦æ¨¡è“„ç©å‹é˜²å¾¡",
                        catchphrase: "å°ã•ãªæº–å‚™ã§å¤§ããªå±æ©Ÿã«å‚™ãˆã‚‹",
                        primaryDefense: "æº–å‚™ãƒ»æŸ”è»Ÿ",
                        stressResponse: "æ®µéšçš„ãªæº–å‚™ã¨é©å¿œ"
                    10: { // å¤©æ²¢å±¥
                        name: "æ…é‡æ­©è¡Œå‹é˜²å¾¡",
                        catchphrase: "å±é™ºã‚’æ‰¿çŸ¥ã§æ…é‡ã«é€²ã‚€",
                        primaryDefense: "æ…é‡ãƒ»å¯¾æŠ—",
                        stressResponse: "ãƒªã‚¹ã‚¯èªè­˜ã¨æ…é‡ãªè¡Œå‹•"
                    11: { // åœ°å¤©æ³°
                        name: "èª¿å’Œå®‰å®šå‹é˜²å¾¡",
                        catchphrase: "å¹³å’Œã¨èª¿å’Œã‚’ç¶­æŒã™ã‚‹",
                        primaryDefense: "å®‰å®šãƒ»å—å®¹",
                        stressResponse: "ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸå¯¾å¿œ"
                    12: { // å¤©åœ°å¦
                        name: "é–‰å¡çªç ´å‹é˜²å¾¡",
                        catchphrase: "é–‰å¡çŠ¶æ³ã‚’æ‰“ç ´ã™ã‚‹",
                        primaryDefense: "çªç ´ãƒ»å¯¾æŠ—",
                        stressResponse: "ç¾çŠ¶æ‰“ç ´ã«ã‚ˆã‚‹æ´»è·¯é–‹æ‹“"
                    13: { // å¤©ç«åŒäºº
                        name: "åŒå¿—çµé›†å‹é˜²å¾¡",
                        catchphrase: "å¿—ã‚’åŒã˜ãã™ã‚‹äººã¨çµæŸã™ã‚‹",
                        primaryDefense: "çµæŸãƒ»æ´å¯Ÿ",
                        stressResponse: "ç†å¿µã«ã‚ˆã‚‹å›£çµã¨å¯¾å¿œ"
                    14: { // ç«å¤©å¤§æœ‰
                        name: "è±Šå¯Œè³‡æºå‹é˜²å¾¡",
                        catchphrase: "è±Šå¯Œãªè³‡æºã§å±æ©Ÿã‚’ä¹—ã‚Šè¶Šãˆã‚‹",
                        primaryDefense: "è±Šç©£ãƒ»æ´å¯Ÿ",
                        stressResponse: "è³‡æºã‚’æ´»ç”¨ã—ãŸåŒ…æ‹¬çš„å¯¾å¿œ"
                    15: { // åœ°å±±è¬™
                        name: "è¬™éœå›é¿å‹é˜²å¾¡",
                        catchphrase: "è¬™éœã™ã‚‹ã“ã¨ã§å±æ©Ÿã‚’é¿ã‘ã‚‹",
                        primaryDefense: "è¬™è™šãƒ»å¢ƒç•Œ",
                        stressResponse: "ä½å§¿å‹¢ã«ã‚ˆã‚‹æ‘©æ“¦å›é¿"
                    17: { // æ²¢é›·éš
                        name: "æŸ”è»Ÿè¿½å¾“å‹é˜²å¾¡",
                        catchphrase: "çŠ¶æ³ã«å¾“ã£ã¦æŸ”è»Ÿã«å¯¾å¿œã™ã‚‹",
                        primaryDefense: "è¿½å¾“ãƒ»èª¿å’Œ",
                        stressResponse: "ç’°å¢ƒå¤‰åŒ–ã¸ã®æŸ”è»Ÿãªé©å¿œ"
                    18: { // å±±é¢¨è ±
                        name: "å•é¡Œä¿®å¾©å‹é˜²å¾¡",
                        catchphrase: "è…æ•—ã‚’æ­£ã—ã¦å¥å…¨åŒ–ã™ã‚‹",
                        primaryDefense: "ä¿®å¾©ãƒ»å¢ƒç•Œ",
                        stressResponse: "æ ¹æœ¬çš„ãªå•é¡Œè§£æ±º"
                    19: { // åœ°æ²¢è‡¨
                        name: "æ¥è¿‘ç›£è¦–å‹é˜²å¾¡",
                        catchphrase: "è¿‘ã¥ã„ã¦å•é¡Œã‚’ç›£è¦–ã™ã‚‹",
                        primaryDefense: "æ¥è¿‘ãƒ»èª¿å’Œ",
                        stressResponse: "ç©æ¥µçš„ãªé–¢ä¸ã«ã‚ˆã‚‹è§£æ±º"
                    20: { // é¢¨åœ°è¦³
                        name: "è¦³å¯Ÿæ´å¯Ÿå‹é˜²å¾¡",
                        catchphrase: "é«˜ã„è¦–ç‚¹ã‹ã‚‰çŠ¶æ³ã‚’ä¿¯ç°ã™ã‚‹",
                        primaryDefense: "è¦³å¯Ÿãƒ»æŸ”è»Ÿ",
                        stressResponse: "å®¢è¦³çš„åˆ†æã«ã‚ˆã‚‹å¯¾ç­–ç«‹æ¡ˆ"
                    21: { // ç«é›·å™¬å—‘
                        name: "éšœå®³é™¤å»å‹é˜²å¾¡",
                        catchphrase: "éšœå®³ã‚’å™›ã¿ç •ã„ã¦é™¤å»ã™ã‚‹",
                        primaryDefense: "é™¤å»ãƒ»æ´å¯Ÿ",
                        stressResponse: "å•é¡Œã®æ ¸å¿ƒã¸ã®ç›´æ¥çš„å¯¾å‡¦"
                    22: { // å±±ç«è³
                        name: "è£…é£¾éš è”½å‹é˜²å¾¡",
                        catchphrase: "ç¾ã—ãè£…ã£ã¦æœ¬è³ªã‚’éš ã™",
                        primaryDefense: "è£…é£¾ãƒ»å¢ƒç•Œ",
                        stressResponse: "å¤–è¦‹ã‚’æ•´ãˆãŸé˜²å¾¡æˆ¦ç•¥"
                    23: { // å±±åœ°å‰¥
                        name: "å‰¥é›¢æœ€å°åŒ–å‹é˜²å¾¡",
                        catchphrase: "å¤±ã†ã‚‚ã®ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹",
                        primaryDefense: "ä¿å…¨ãƒ»å¢ƒç•Œ",
                        stressResponse: "æå¤±æœ€å°åŒ–æˆ¦ç•¥"
                    24: { // åœ°é›·å¾©
                        name: "å¾©å…ƒå›å¾©å‹é˜²å¾¡",
                        catchphrase: "å…ƒã®çŠ¶æ…‹ã«æˆ»ã™ã“ã¨ã§å®‰å®šã‚’å›³ã‚‹",
                        primaryDefense: "å¾©å…ƒãƒ»å—å®¹",
                        stressResponse: "åŸç‚¹å›å¸°ã«ã‚ˆã‚‹å®‰å®šåŒ–"
                    25: { // å¤©é›·æ— å¦„
                        name: "ç´”çœŸç„¡å¢å‹é˜²å¾¡",
                        catchphrase: "ç´”ç²‹ãªå¿ƒã§ç½ã„ã‚’é¿ã‘ã‚‹",
                        primaryDefense: "ç´”çœŸãƒ»å¯¾æŠ—",
                        stressResponse: "èª å®Ÿã•ã«ã‚ˆã‚‹è‡ªç„¶ãªè§£æ±º"
                    26: { // å±±å¤©å¤§ç•œ
                        name: "å¤§è¦æ¨¡è“„ç©å‹é˜²å¾¡",
                        catchphrase: "å¤§ããªåŠ›ã‚’è“„ãˆã¦å±æ©Ÿã«å‚™ãˆã‚‹",
                        primaryDefense: "è“„ç©ãƒ»å¢ƒç•Œ",
                        stressResponse: "é•·æœŸçš„ãªæº–å‚™ã«ã‚ˆã‚‹ä¸‡å…¨ãªå¯¾å¿œ"
                    27: { // å±±é›·é ¤
                        name: "æ „é¤Šè£œçµ¦å‹é˜²å¾¡",
                        catchphrase: "é©åˆ‡ãªæ „é¤Šã§ä½“åŠ›ã‚’ç¶­æŒã™ã‚‹",
                        primaryDefense: "é¤Šè‚²ãƒ»å¢ƒç•Œ",
                        stressResponse: "åŸºç¤ä½“åŠ›ã®ç¶­æŒã¨å¼·åŒ–"
                    28: { // æ²¢é¢¨å¤§é
                        name: "éå¤§è² è·è€ä¹…å‹é˜²å¾¡",
                        catchphrase: "é™ç•Œã‚’è¶…ãˆãŸè² è·ã«è€ãˆã‚‹",
                        primaryDefense: "è€ä¹…ãƒ»èª¿å’Œ",
                        stressResponse: "æ¥µé™çŠ¶æ³ã§ã®æŒä¹…æˆ¦"
                    31: { // æ²¢å±±å’¸
                        name: "æ„Ÿå¿œå…±é³´å‹é˜²å¾¡",
                        catchphrase: "ç›¸æ‰‹ã¨æ„Ÿå¿œã—ã¦èª¿å’Œã™ã‚‹",
                        primaryDefense: "æ„Ÿå¿œãƒ»èª¿å’Œ",
                        stressResponse: "ç›¸äº’ç†è§£ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    32: { // é›·é¢¨æ’
                        name: "æŒç¶šç¶™ç¶šå‹é˜²å¾¡",
                        catchphrase: "å¤‰ã‚ã‚‰ã¬å§¿å‹¢ã§æŒç¶šã™ã‚‹",
                        primaryDefense: "æŒç¶šãƒ»æŸ”è»Ÿ",
                        stressResponse: "ä¸€è²«ã—ãŸæ–¹é‡ã«ã‚ˆã‚‹å®‰å®šå¯¾å¿œ"
                    33: { // å¤©å±±é¯
                        name: "æˆ¦ç•¥çš„æ’¤é€€å‹é˜²å¾¡",
                        catchphrase: "é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§é€€ã",
                        primaryDefense: "æ’¤é€€ãƒ»å¯¾æŠ—",
                        stressResponse: "æˆ¦ç•¥çš„ãªå¾Œé€€ã«ã‚ˆã‚‹ç«‹ã¦ç›´ã—"
                    34: { // é›·å¤©å¤§å£®
                        name: "å¼·å¤§åŠ›é‡å‹é˜²å¾¡",
                        catchphrase: "å¼·å¤§ãªåŠ›ã§æ­£é¢çªç ´ã™ã‚‹",
                        primaryDefense: "å¼·åŠ›ãƒ»å¯¾æŠ—",
                        stressResponse: "åœ§å€’çš„ãªåŠ›ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    35: { // ç«åœ°æ™‹
                        name: "å‰é€²ç™ºå±•å‹é˜²å¾¡",
                        catchphrase: "å‰é€²ã™ã‚‹ã“ã¨ã§å±æ©Ÿã‚’è„±ã™ã‚‹",
                        primaryDefense: "å‰é€²ãƒ»æ´å¯Ÿ",
                        stressResponse: "ç©æ¥µçš„ãªæ”»å‹¢ã«ã‚ˆã‚‹å±€é¢æ‰“é–‹"
                    36: { // åœ°ç«æ˜å¤·
                        name: "æ½œä¼éš éå‹é˜²å¾¡",
                        catchphrase: "å…‰ã‚’éš ã—ã¦å±é™ºã‚’ã‚„ã‚Šéã”ã™",
                        primaryDefense: "éš éãƒ»å—å®¹",
                        stressResponse: "ç›®ç«‹ãŸãªã„ã“ã¨ã«ã‚ˆã‚‹å®‰å…¨ç¢ºä¿"
                    37: { // é¢¨ç«å®¶äºº
                        name: "å®¶æ—çµæŸå‹é˜²å¾¡",
                        catchphrase: "å®¶æ—ã®çµ†ã§å±æ©Ÿã‚’ä¹—ã‚Šè¶Šãˆã‚‹",
                        primaryDefense: "çµæŸãƒ»æŸ”è»Ÿ",
                        stressResponse: "èº«å†…ã¨ã®å¼·å›ºãªé€£å¸¯"
                    38: { // ç«æ²¢ç½
                        name: "å¯¾ç«‹èª¿å’Œå‹é˜²å¾¡",
                        catchphrase: "å¯¾ç«‹ã—ãªãŒã‚‰ã‚‚èª¿å’Œã‚’ä¿ã¤",
                        primaryDefense: "èª¿å’Œãƒ»æ´å¯Ÿ",
                        stressResponse: "é•ã„ã‚’èªã‚ãŸä¸Šã§ã®å”åŠ›"
                    40: { // é›·æ°´è§£
                        name: "è§£æ”¾é–‹æ”¾å‹é˜²å¾¡",
                        catchphrase: "æŸç¸›ã‚’è§£ã„ã¦è‡ªç”±ã‚’å–ã‚Šæˆ»ã™",
                        primaryDefense: "è§£æ”¾ãƒ»è¿…é€Ÿ",
                        stressResponse: "åˆ¶ç´„ã‹ã‚‰ã®è„±å´ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    41: { // å±±æ²¢æ
                        name: "é©åˆ‡å‰Šæ¸›å‹é˜²å¾¡",
                        catchphrase: "ç„¡é§„ã‚’å‰Šã£ã¦ã‚¹ãƒªãƒ åŒ–ã™ã‚‹",
                        primaryDefense: "å‰Šæ¸›ãƒ»å¢ƒç•Œ",
                        stressResponse: "åŠ¹ç‡åŒ–ã«ã‚ˆã‚‹ä½“è³ªå¼·åŒ–"
                    42: { // é¢¨é›·ç›Š
                        name: "ç›¸äº’åˆ©ç›Šå‹é˜²å¾¡",
                        catchphrase: "ã¿ã‚“ãªã®åˆ©ç›Šã§å•é¡Œã‚’è§£æ±ºã™ã‚‹",
                        primaryDefense: "åˆ©ç›Šãƒ»æŸ”è»Ÿ",
                        stressResponse: "win-winã®é–¢ä¿‚æ§‹ç¯‰"
                    43: { // æ²¢å¤©å¤¬
                        name: "æ±ºæ–­å®Ÿè¡Œå‹é˜²å¾¡",
                        catchphrase: "æ–­å›ºã¨ã—ãŸæ±ºæ–­ã§å±æ©Ÿã‚’æ–­ã¤",
                        primaryDefense: "æ±ºæ–­ãƒ»èª¿å’Œ",
                        stressResponse: "æ˜ç¢ºãªåˆ¤æ–­ã«ã‚ˆã‚‹è¿…é€Ÿãªå¯¾å‡¦"
                    44: { // å¤©é¢¨å§¤
                        name: "å¶ç„¶é­é‡å‹é˜²å¾¡",
                        catchphrase: "äºˆæœŸã›ã¬å‡ºä¼šã„ã‚’æ´»ç”¨ã™ã‚‹",
                        primaryDefense: "æ©Ÿä¼šãƒ»å¯¾æŠ—",
                        stressResponse: "å¶ç„¶ã®æ©Ÿä¼šã‚’æœ€å¤§é™æ´»ç”¨"
                    45: { // æ²¢åœ°èƒ
                        name: "é›†çµçµ±åˆå‹é˜²å¾¡",
                        catchphrase: "ã¿ã‚“ãªã§é›†ã¾ã£ã¦åŠ›ã‚’åˆã‚ã›ã‚‹",
                        primaryDefense: "çµ±åˆãƒ»èª¿å’Œ",
                        stressResponse: "é›†å›£ã®åŠ›ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    46: { // åœ°é¢¨å‡
                        name: "æ®µéšæˆé•·å‹é˜²å¾¡",
                        catchphrase: "æ®µéšã‚’è¿½ã£ã¦æˆé•·ã—å¼·åŒ–ã™ã‚‹",
                        primaryDefense: "æˆé•·ãƒ»å—å®¹",
                        stressResponse: "ç¶™ç¶šçš„ãªæ”¹å–„ã«ã‚ˆã‚‹ä½“è³ªå¼·åŒ–"
                    47: { // æ²¢æ°´å›°
                        name: "å›°çª®å¿è€å‹é˜²å¾¡",
                        catchphrase: "å›°ã£ãŸæ™‚ã“ãè€ãˆå¿ã¶",
                        primaryDefense: "å¿è€ãƒ»èª¿å’Œ",
                        stressResponse: "è‹¦å¢ƒã§ã®ç²¾ç¥åŠ›ã«ã‚ˆã‚‹æŒä¹…æˆ¦"
                    48: { // æ°´é¢¨äº•
                        name: "å®‰å®šä¾›çµ¦å‹é˜²å¾¡",
                        catchphrase: "å¤‰ã‚ã‚‰ã¬ä¾¡å€¤ã‚’æä¾›ã—ç¶šã‘ã‚‹",
                        primaryDefense: "å®‰å®šãƒ»æŒç¶š",
                        stressResponse: "ä¿¡é ¼ã§ãã‚‹åŸºç›¤ã®ç¶­æŒ"
                    49: { // æ²¢ç«é©
                        name: "å¤‰é©åˆ·æ–°å‹é˜²å¾¡",
                        catchphrase: "æ ¹æœ¬ã‹ã‚‰å¤‰ãˆã¦æ–°ã—ãã™ã‚‹",
                        primaryDefense: "å¤‰é©ãƒ»èª¿å’Œ",
                        stressResponse: "æŠœæœ¬çš„ãªæ”¹é©ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    50: { // ç«é¢¨é¼
                        name: "å®‰å®šçµ±æ²»å‹é˜²å¾¡",
                        catchphrase: "æ–°ã—ã„ç§©åºã§å®‰å®šã‚’å›³ã‚‹",
                        primaryDefense: "çµ±æ²»ãƒ»æ´å¯Ÿ",
                        stressResponse: "æ–°ä½“åˆ¶ã«ã‚ˆã‚‹å®‰å®šåŒ–"
                    53: { // é¢¨å±±æ¼¸
                        name: "æ¼¸é€²ç™ºå±•å‹é˜²å¾¡",
                        catchphrase: "å°‘ã—ãšã¤ç€å®Ÿã«é€²æ­©ã™ã‚‹",
                        primaryDefense: "æ¼¸é€²ãƒ»æŸ”è»Ÿ",
                        stressResponse: "æ®µéšçš„ãªæ”¹å–„ã«ã‚ˆã‚‹å®‰å®šæˆé•·"
                    54: { // é›·æ²¢å¸°å¦¹
                        name: "é©å¿œé †å¿œå‹é˜²å¾¡",
                        catchphrase: "ä¸ãˆã‚‰ã‚ŒãŸå½¹å‰²ã«é †å¿œã™ã‚‹",
                        primaryDefense: "é †å¿œãƒ»è¿…é€Ÿ",
                        stressResponse: "ç’°å¢ƒã«åˆã‚ã›ãŸæŸ”è»Ÿãªé©å¿œ"
                    55: { // é›·ç«è±Š
                        name: "è±Šç©£å……å®Ÿå‹é˜²å¾¡",
                        catchphrase: "è±Šã‹ã•ã®ä¸­ã§ãƒãƒ©ãƒ³ã‚¹ã‚’ä¿ã¤",
                        primaryDefense: "è±Šç©£ãƒ»è¿…é€Ÿ",
                        stressResponse: "ä½™è£•ã®ã‚ã‚‹çŠ¶æ³ã§ã®é©åˆ‡ãªåˆ¤æ–­"
                    56: { // ç«å±±æ—…
                        name: "æ—…è¡Œé©å¿œå‹é˜²å¾¡",
                        catchphrase: "æ…£ã‚Œãªã„ç’°å¢ƒã«é©å¿œã™ã‚‹",
                        primaryDefense: "é©å¿œãƒ»æ´å¯Ÿ",
                        stressResponse: "å¤‰åŒ–ã¸ã®æŸ”è»Ÿãªå¯¾å¿œ"
                    59: { // é¢¨æ°´æ¸™
                        name: "åˆ†æ•£ç·©å’Œå‹é˜²å¾¡",
                        catchphrase: "å›ºã¾ã£ãŸã‚‚ã®ã‚’åˆ†æ•£ã—ã¦å’Œã‚‰ã’ã‚‹",
                        primaryDefense: "åˆ†æ•£ãƒ»æŸ”è»Ÿ",
                        stressResponse: "ç·Šå¼µã®ç·©å’Œã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    60: { // æ°´æ²¢ç¯€
                        name: "ç¯€åˆ¶é™å®šå‹é˜²å¾¡",
                        catchphrase: "é©åˆ‡ãªç¯€åº¦ã§å®‰å®šã‚’ä¿ã¤",
                        primaryDefense: "ç¯€åˆ¶ãƒ»æŒç¶š",
                        stressResponse: "ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸåˆ¶é™ã«ã‚ˆã‚‹å®‰å®š"
                    61: { // é¢¨æ²¢ä¸­å­š
                        name: "èª å®Ÿä¿¡é ¼å‹é˜²å¾¡",
                        catchphrase: "èª å®Ÿã•ã§ä¿¡é ¼ã‚’ç¯‰ãå®ˆã‚‹",
                        primaryDefense: "èª å®Ÿãƒ»æŸ”è»Ÿ",
                        stressResponse: "ä¿¡é ¼é–¢ä¿‚ã«ã‚ˆã‚‹å•é¡Œè§£æ±º"
                    62: { // é›·å±±å°é
                        name: "å°è¦æ¨¡è¶…è¶Šå‹é˜²å¾¡",
                        catchphrase: "å°ã•ãªåŠªåŠ›ã§å¤§ããªåŠ¹æœã‚’å¾—ã‚‹",
                        primaryDefense: "åŠ¹ç‡ãƒ»è¿…é€Ÿ",
                        stressResponse: "å°ã•ãªå·¥å¤«ã«ã‚ˆã‚‹åŠ¹æœçš„å¯¾å¿œ"
                    63: { // æ°´ç«æ—¢æ¸ˆ
                        name: "å®Œæˆç¶­æŒå‹é˜²å¾¡",
                        catchphrase: "å®Œæˆã—ãŸçŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹",
                        primaryDefense: "ç¶­æŒãƒ»æŒç¶š",
                        stressResponse: "ç¾çŠ¶ç¶­æŒã«ã‚ˆã‚‹å®‰å®šç¢ºä¿"
                    64: { // ç«æ°´æœªæ¸ˆ
                        name: "æœªå®Œæˆç™ºå±•å‹é˜²å¾¡",
                        catchphrase: "æœªå®Œæˆã ã‹ã‚‰ã“ãå¯èƒ½æ€§ãŒã‚ã‚‹",
                        primaryDefense: "ç™ºå±•ãƒ»æ´å¯Ÿ",
                        stressResponse: "æ”¹å–„ã®ä½™åœ°ã‚’æ´»ç”¨ã—ãŸæˆé•·"
                };

            getDefaultDefensiveInterpretation() {
                return {
                    name: "ç·åˆé©å¿œå‹é˜²å¾¡",
                    catchphrase: "çŠ¶æ³ã«å¿œã˜ã¦æœ€é©ãªé˜²å¾¡ã‚’é¸æŠã™ã‚‹",
                    primaryDefense: "é©å¿œãƒ»èª¿æ•´",
                    stressResponse: "ãƒãƒ©ãƒ³ã‚¹å‹å±æ©Ÿå¯¾å¿œ"
                };

            personalizeSafeModeDescription(interpretation, primary, secondary, patterns, engineOS) {
                const stressLevel = this.calculateOverallStressLevel(patterns);
                const primaryStrength = this.getTrigramStrength(primary, patterns);
                const secondaryStrength = this.getTrigramStrength(secondary, patterns);
                
                let description = `${interpretation.name}: ${interpretation.primaryDefense}ã‚’ä¸»è»¸ã¨ã—ãŸé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚`;
                
                if (stressLevel > 0.7) {
                    description += "é«˜ã‚¹ãƒˆãƒ¬ã‚¹ç’°å¢ƒä¸‹ã§å¼·åŠ›ã«ç™ºå‹•ã—ã€";
                } else if (stressLevel > 0.4) {
                    description += "ä¸­ç¨‹åº¦ã®ã‚¹ãƒˆãƒ¬ã‚¹çŠ¶æ³ã§é©åˆ‡ã«ä½œå‹•ã—ã€";
                } else {
                    description += "è»½å¾®ãªã‚¹ãƒˆãƒ¬ã‚¹çŠ¶æ³ã§ã‚‚äºˆé˜²çš„ã«æ©Ÿèƒ½ã—ã€";
                
                description += `${primary}ã®${this.getTrigramDefensiveCharacter(primary)}ã¨${secondary}ã®${this.getTrigramDefensiveCharacter(secondary)}ã‚’çµ„ã¿åˆã‚ã›ã¦å¯¾å¿œã™ã‚‹ã€‚`;
                
                return description;

            getTrigramDefensiveCharacter(trigram) {
                const characters = {
                    ä¹¾: "å¼·åŠ›ãªå¯¾æŠ—åŠ›",
                    å…Œ: "èª¿å’Œçš„è§£æ±ºåŠ›",
                    é›¢: "çŠ¶æ³æ´å¯ŸåŠ›",
                    éœ‡: "è¿…é€Ÿãªè¡Œå‹•åŠ›",
                    å·½: "æŸ”è»Ÿãªé©å¿œåŠ›",
                    å: "æŒç¶šçš„å¿è€åŠ›",
                    è‰®: "å …å›ºãªå¢ƒç•ŒåŠ›",
                    å¤: "åŒ…å®¹çš„å—å®¹åŠ›"
                };
                return characters[trigram] || "ç·åˆçš„é˜²å¾¡åŠ›";

            identifyActivationTrigger(patterns) {
                const triggers = [];
                
                Object.entries(patterns).forEach(([type, response]) => {
                    if (response.intensity > 0.6) {
                        switch(type) {
                            case 'leadershipStress': triggers.push('è²¬ä»»ã®é‡åœ§'); break;
                            case 'interpersonalStress': triggers.push('äººé–“é–¢ä¿‚ã®æ‘©æ“¦'); break;
                            case 'familyStress': triggers.push('è¦ªå¯†é–¢ä¿‚ã®è² è·'); break;
                            case 'emergencyStress': triggers.push('ç·Šæ€¥äº‹æ…‹'); break;
                            case 'competitionStress': triggers.push('ç«¶äº‰ç’°å¢ƒ'); break;
                            case 'collaborationStress': triggers.push('å”èª¿ã®è² æ‹…'); break;
                });
                
                return triggers.length > 0 ? triggers.join('ã€') : 'ä¸€èˆ¬çš„ãªã‚¹ãƒˆãƒ¬ã‚¹çŠ¶æ³';

            calculateDefensiveStrength(patterns) {
                const intensities = Object.values(patterns).map(p => p.intensity || 0);
                if (intensities.length === 0) return 0;
                return intensities.reduce((sum, intensity) => sum + intensity, 0) / intensities.length;

            calculateOverallStressLevel(patterns) {
                return this.calculateDefensiveStrength(patterns);

            getTrigramStrength(trigram, patterns) {
                // ä¸‰çˆ»ã®é˜²å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã®å¼·åº¦ã‚’è¨ˆç®—
                const trigramPatternMap = {
                    ä¹¾: ['å¯¾æŠ—', 'ç¡¬åŒ–'],
                    å…Œ: ['èª¿å’Œ', 'å›é¿'],
                    é›¢: ['å¤‰å®¹', 'å¯¾æŠ—'],
                    éœ‡: ['ç¡¬åŒ–', 'å¯¾æŠ—'],
                    å·½: ['å›é¿', 'å¤‰å®¹'],
                    å: ['è€å¿', 'çµç•Œ'],
                    è‰®: ['çµç•Œ', 'æ’¤é€€'],
                    å¤: ['æ’¤é€€', 'åŒåŒ–']
                };
                
                const relevantPatterns = trigramPatternMap[trigram] || [];
                let strength = 0;
                let count = 0;
                
                Object.values(patterns).forEach(response => {
                    if (relevantPatterns.includes(response.pattern)) {
                        strength += response.intensity;
                        count++;
                });
                
                return count > 0 ? strength / count : 0.5;

            getDefaultSafeModeOS() {
                return {
                    hexagramId: 39, // æ°´å±±è¹‡ - å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹
                    hexagramName: "æ°´å±±è¹‡",
                    description: "å›°é›£ãªçŠ¶æ³ã§ã‚‚ç²˜ã‚Šå¼·ãå‰é€²ã™ã‚‹é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ",
                    catchphrase: "å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹ä¸å±ˆã®ç²¾ç¥",
                    primaryDefense: "å",
                    secondaryDefense: "è‰®",
                    defensiveType: "å›°é›£çªç ´å‹",
                    stressResponse: "å¿è€ã¨å¢ƒç•Œè¨­å®šã«ã‚ˆã‚‹æŒä¹…æˆ¦",
                    activationTrigger: "å›°é›£ãªçŠ¶æ³å…¨èˆ¬",
                    defensiveStrength: 0.6,
                    trigramEnergies: { ä¹¾: 0.3, å…Œ: 0.2, é›¢: 0.2, éœ‡: 0.3, å·½: 0.2, å: 0.7, è‰®: 0.6, å¤: 0.4 },
                    type: "Safe Mode OS"
                };

            /**
             * Interface OSåˆ†æã®è£œåŠ©ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤
             */
             
            // 1. ã‚·ãƒŠãƒªã‚ªè³ªå•ï¼ˆQ25-Q30ï¼‰ã‹ã‚‰ç¤¾ä¼šçš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
            analyzeSocialPatterns(scenarioAnswers) {
                const patterns = {
                    Q25_leadership: 0,      // ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—çŠ¶æ³å¯¾å¿œ
                    Q26_interpersonal: 0,   // å¯¾äººé–¢ä¿‚å›°é›£ã¸ã®å¯¾å‡¦
                    Q27_family: 0,          // å®¶æ—ãƒ»è¦ªå¯†é–¢ä¿‚ã®å‡¦ç†
                    Q28_emergency: 0,       // ç·Šæ€¥äº‹æ…‹ãƒ»å±æ©Ÿç®¡ç†
                    Q29_competition: 0,     // ç«¶äº‰ãƒ»äº‰ã„ã¸ã®å¯¾å¿œ
                    Q30_community: 0        // å…±åŒä½“ãƒ»å”åŠ›é–¢ä¿‚æ§‹ç¯‰
                };
                
                // ã‚·ãƒŠãƒªã‚ªå›ç­”ã‹ã‚‰ç¤¾ä¼šçš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¹ã‚³ã‚¢è¨ˆç®—
                scenarioAnswers.forEach((answer, index) => {
                    const questionId = `Q${25 + index}`;
                    const scoreValue = this.calculateScenarioScore(answer, questionId);
                    
                    switch (questionId) {
                        case 'Q25': patterns.Q25_leadership = scoreValue; break;
                        case 'Q26': patterns.Q26_interpersonal = scoreValue; break;
                        case 'Q27': patterns.Q27_family = scoreValue; break;
                        case 'Q28': patterns.Q28_emergency = scoreValue; break;
                        case 'Q29': patterns.Q29_competition = scoreValue; break;
                        case 'Q30': patterns.Q30_community = scoreValue; break;
                });
                
                return patterns;
            
            // 2. Interface OSå°‚ç”¨ã®8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰
            buildInterfaceVector(socialPatterns) {
                const vector = {
                    "å¤–å‘_ä¸»å°æ€§": 0,    // ä¹¾ - ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãƒ»ä¸»å°
                    "å¤–å‘_èª¿å’Œæ€§": 0,    // å…Œ - ç¤¾äº¤ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
                    "å¤–å‘_è¡¨ç¾æ€§": 0,    // é›¢ - ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»é­…åŠ›
                    "å¤–å‘_è¡Œå‹•æ€§": 0,    // éœ‡ - å³å¿œæ€§ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
                    "å†…å‘_é©å¿œæ€§": 0,    // å·½ - é †å¿œãƒ»å”èª¿
                    "å†…å‘_åˆ†ææ€§": 0,    // å - è¦³å¯Ÿãƒ»æ´å¯Ÿ
                    "å†…å‘_å®‰å®šæ€§": 0,    // è‰® - ä¸€è²«æ€§ãƒ»ä¿¡é ¼æ€§
                    "å†…å‘_æ”¯æ´æ€§": 0     // å¤ - ã‚µãƒãƒ¼ãƒˆãƒ»è²¢çŒ®
                };
                
                // Q25-Q30ã®ç¤¾ä¼šçš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’8æ¬¡å…ƒã«ãƒãƒƒãƒ”ãƒ³ã‚°
                vector["å¤–å‘_ä¸»å°æ€§"] = (socialPatterns.Q25_leadership * 0.5) + (socialPatterns.Q28_emergency * 0.3);
                vector["å¤–å‘_èª¿å’Œæ€§"] = (socialPatterns.Q26_interpersonal * 0.4) + (socialPatterns.Q30_community * 0.4);
                vector["å¤–å‘_è¡¨ç¾æ€§"] = (socialPatterns.Q25_leadership * 0.3) + (socialPatterns.Q26_interpersonal * 0.3);
                vector["å¤–å‘_è¡Œå‹•æ€§"] = (socialPatterns.Q28_emergency * 0.4) + (socialPatterns.Q29_competition * 0.4);
                
                vector["å†…å‘_é©å¿œæ€§"] = (socialPatterns.Q26_interpersonal * 0.3) + (socialPatterns.Q27_family * 0.4);
                vector["å†…å‘_åˆ†ææ€§"] = (socialPatterns.Q28_emergency * 0.3) + (socialPatterns.Q29_competition * 0.3);
                vector["å†…å‘_å®‰å®šæ€§"] = (socialPatterns.Q27_family * 0.4) + (socialPatterns.Q30_community * 0.3);
                vector["å†…å‘_æ”¯æ´æ€§"] = (socialPatterns.Q27_family * 0.3) + (socialPatterns.Q30_community * 0.3);
                
                // æ­£è¦åŒ–ï¼ˆ0-1ç¯„å›²ï¼‰
                Object.keys(vector).forEach(key => {
                    vector[key] = Math.max(0, Math.min(1, vector[key]));
                });
                
                return vector;
            
            // 3. ç¤¾ä¼šçš„ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
            calculateSocialTrigramEnergies(interfaceVector) {
                return {
                    "ä¹¾": interfaceVector["å¤–å‘_ä¸»å°æ€§"] * 1.0,
                    "å…Œ": interfaceVector["å¤–å‘_èª¿å’Œæ€§"] * 1.0,
                    "é›¢": interfaceVector["å¤–å‘_è¡¨ç¾æ€§"] * 1.0,
                    "éœ‡": interfaceVector["å¤–å‘_è¡Œå‹•æ€§"] * 1.0,
                    "å·½": interfaceVector["å†…å‘_é©å¿œæ€§"] * 1.0,
                    "å": interfaceVector["å†…å‘_åˆ†ææ€§"] * 1.0,
                    "è‰®": interfaceVector["å†…å‘_å®‰å®šæ€§"] * 1.0,
                    "å¤": interfaceVector["å†…å‘_æ”¯æ´æ€§"] * 1.0
                };
            
            // 4. Engine OSã¨ã®ç›¸äº’ä½œç”¨è£œæ­£
            adjustForEngineOS(socialEnergies, engineOS) {
                const adjustedEnergies = { ...socialEnergies };
                const engineInfluence = 0.25; // 25%ã®å½±éŸ¿åº¦
                
                if (!engineOS || !engineOS.upperTrigram || !engineOS.lowerTrigram) {
                    return adjustedEnergies;
                
                // Engine OSã®ä¸»è¦ä¸‰çˆ»ãŒç¤¾ä¼šçš„è¡¨ç¾ã«ä¸ãˆã‚‹å½±éŸ¿
                const enginePrimary = engineOS.upperTrigram;
                
                // å†…å‘çš„Engine OSã¯å¤–å‘çš„Interface OSã‚’æŠ‘åˆ¶
                if (["å¤", "è‰®", "å", "å·½"].includes(enginePrimary)) {
                    adjustedEnergies["ä¹¾"] *= (1 - engineInfluence * 0.8);
                    adjustedEnergies["é›¢"] *= (1 - engineInfluence * 0.6);
                    adjustedEnergies["éœ‡"] *= (1 - engineInfluence * 0.7);
                    adjustedEnergies["å…Œ"] *= (1 - engineInfluence * 0.4);
                
                // å¤–å‘çš„Engine OSã¯å¤–å‘çš„Interface OSã‚’å¼·åŒ–
                if (["ä¹¾", "å…Œ", "é›¢", "éœ‡"].includes(enginePrimary)) {
                    adjustedEnergies["ä¹¾"] *= (1 + engineInfluence * 0.6);
                    adjustedEnergies["é›¢"] *= (1 + engineInfluence * 0.5);
                    adjustedEnergies["éœ‡"] *= (1 + engineInfluence * 0.5);
                    adjustedEnergies["å…Œ"] *= (1 + engineInfluence * 0.7);
                
                // ç‰¹å®šã®Engine OSçµ„ã¿åˆã‚ã›è£œæ­£
                if (enginePrimary === "å¤") { // å—å®¹çš„Engine OS
                    adjustedEnergies["å¤"] *= (1 + engineInfluence * 1.2);
                    adjustedEnergies["å·½"] *= (1 + engineInfluence * 0.8);
                
                if (enginePrimary === "ä¹¾") { // å‰µé€ çš„Engine OS
                    adjustedEnergies["ä¹¾"] *= (1 + engineInfluence * 1.0);
                    adjustedEnergies["éœ‡"] *= (1 + engineInfluence * 0.7);
                
                return adjustedEnergies;
            
            // 5. Interface OSç”¨ã®æœ€é©ä¸‰çˆ»é¸æŠ
            selectInterfaceTrigrams(adjustedEnergies) {
                // ç¤¾ä¼šçš„è¡¨ç¾ã§ã¯å¤–å¦ï¼ˆä¸Šå¦ï¼‰ã‚’é‡è¦–
                const sortedTrigrams = Object.entries(adjustedEnergies)
                    .sort(([, a], [, b]) => b - a);
                
                const upperTrigram = sortedTrigrams[0][0];
                const lowerTrigram = sortedTrigrams[1][0];
                
                // ç¤¾ä¼šçš„ç›¸äº’ä½œç”¨ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯
                if (this.isValidSocialCombination(upperTrigram, lowerTrigram)) {
                    return { upperTrigram, lowerTrigram };
                } else {
                    // ç„¡åŠ¹ãªçµ„ã¿åˆã‚ã›ã®å ´åˆã€èª¿æ•´
                    return this.adjustSocialCombination(sortedTrigrams);
            
            // 6. Interface OSå°‚ç”¨è§£é‡ˆç”Ÿæˆ
            generateInterfaceInterpretation(hexagramId, upperTrigram, lowerTrigram, socialPatterns, engineOS) {
                const baseInterpretation = this.getInterfaceHexagramInterpretation(hexagramId);
                
                return {
                    description: baseInterpretation.description,
                    leadership: this.analyzeLeadershipStyle(upperTrigram, socialPatterns),
                    communication: this.analyzeCommunicationStyle(upperTrigram, lowerTrigram, socialPatterns),
                    conflictResolution: this.analyzeConflictStyle(lowerTrigram, socialPatterns),
                    adaptability: this.analyzeAdaptability(upperTrigram, lowerTrigram, socialPatterns),
                    engineOSInfluence: this.analyzeEngineInfluence(engineOS, upperTrigram, lowerTrigram)
                };
            
            // 7. ç¤¾ä¼šçš„ã‚¹ã‚¿ã‚¤ãƒ«åˆ¤å®š
            determineSocialStyle(socialPatterns) {
                const leadership = socialPatterns.Q25_leadership;
                const interpersonal = socialPatterns.Q26_interpersonal;
                const community = socialPatterns.Q30_community;
                
                if (leadership > 0.7) return "ä¸»å°å‹ãƒªãƒ¼ãƒ€ãƒ¼";
                if (community > 0.7) return "å”èª¿å‹ãƒ•ã‚¡ã‚·ãƒªãƒ†ãƒ¼ã‚¿ãƒ¼";
                if (interpersonal > 0.7) return "å¯¾äººé–¢ä¿‚é‡è¦–å‹";
                if (leadership > 0.5 && community > 0.5) return "ãƒãƒ©ãƒ³ã‚¹å‹ãƒªãƒ¼ãƒ€ãƒ¼";
                return "é©å¿œå‹ã‚µãƒãƒ¼ã‚¿ãƒ¼";
            
            // 8. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆInterface OS
            getDefaultInterfaceOS() {
                return {
                    hexagramId: 11,
                    hexagramName: "åœ°å¤©æ³°",
                    upperTrigram: "å¤",
                    lowerTrigram: "ä¹¾", 
                    socialPatterns: { Q25_leadership: 0.5, Q26_interpersonal: 0.5, Q27_family: 0.5, Q28_emergency: 0.5, Q29_competition: 0.5, Q30_community: 0.5 },
                    interfaceVector: {},
                    socialStyle: "ãƒãƒ©ãƒ³ã‚¹å‹",
                    description: "èª¿å’Œã¨ãƒãƒ©ãƒ³ã‚¹ã‚’é‡è¦–ã™ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç¤¾ä¼šçš„äººæ ¼",
                    leadership: "åŒ…å®¹çš„ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—",
                    communication: "åŒæ–¹å‘ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
                    conflictResolution: "ä»²ä»‹ãƒ»èª¿åœå‹",
                    adaptability: "é«˜ã„é©å¿œåŠ›",
                    engineOSInfluence: "å®‰å®šã—ãŸç›¸äº’ä½œç”¨",
                    type: "Interface OS"
                };
            
            /**
             * Interface OSåˆ†æã®è©³ç´°è£œåŠ©ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤
             */
             
            // ã‚·ãƒŠãƒªã‚ªå›ç­”ã®ã‚¹ã‚³ã‚¢è¨ˆç®—
            calculateScenarioScore(answer, questionId) {
                // å›ç­”é¸æŠè‚¢ã«åŸºã¥ãã‚¹ã‚³ã‚¢è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
                // A=1.0, B=0.75, C=0.5, D=0.25 ã®åŸºæœ¬ã‚¹ã‚³ã‚¢
                const baseScore = {
                    'A': 1.0,
                    'B': 0.75, 
                    'C': 0.5,
                    'D': 0.25
                }[answer] || 0.5;
                
                // è³ªå•ã‚¿ã‚¤ãƒ—ã«ã‚ˆã‚‹é‡ã¿èª¿æ•´
                const questionWeights = {
                    'Q25': 1.0, // ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—
                    'Q26': 0.9, // å¯¾äººé–¢ä¿‚
                    'Q27': 0.8, // å®¶æ—
                    'Q28': 1.0, // ç·Šæ€¥äº‹æ…‹
                    'Q29': 0.9, // ç«¶äº‰
                    'Q30': 0.8  // å…±åŒä½“
                };
                
                return baseScore * (questionWeights[questionId] || 1.0);
            
            // ç¤¾ä¼šçš„çµ„ã¿åˆã‚ã›ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯
            isValidSocialCombination(upperTrigram, lowerTrigram) {
                // ç¤¾ä¼šçš„ã«ä¸é©åˆ‡ãªçµ„ã¿åˆã‚ã›ã‚’é™¤å¤–
                const invalidCombinations = [
                    // åŒã˜ä¸‰çˆ»ã®é‡è¤‡ã¯é¿ã‘ã‚‹
                    [upperTrigram, upperTrigram]
                ];
                
                return !invalidCombinations.some(([upper, lower]) => 
                    upper === upperTrigram && lower === lowerTrigram
            
            // ç¤¾ä¼šçš„çµ„ã¿åˆã‚ã›ã®èª¿æ•´
            adjustSocialCombination(sortedTrigrams) {
                // ä¸Šä½3ã¤ã‹ã‚‰é©åˆ‡ãªçµ„ã¿åˆã‚ã›ã‚’é¸æŠ
                for (let i = 0; i < sortedTrigrams.length - 1; i++) {
                    for (let j = i + 1; j < sortedTrigrams.length; j++) {
                        const upper = sortedTrigrams[i][0];
                        const lower = sortedTrigrams[j][0];
                        
                        if (this.isValidSocialCombination(upper, lower)) {
                            return { upperTrigram: upper, lowerTrigram: lower };
                
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šä¹¾-å¤ çµ„ã¿åˆã‚ã›
                return { upperTrigram: "ä¹¾", lowerTrigram: "å¤" };
            
            // Interface OSå°‚ç”¨ã®64å¦è§£é‡ˆãƒ‡ãƒ¼ã‚¿
            getInterfaceHexagramInterpretation(hexagramId) {
                const interpretations = {
                    // ä¸»è¦64å¦ã®ç¤¾ä¼šçš„äººæ ¼è§£é‡ˆ
                    1: { description: "ç´”ç²‹ãªå‰µé€ çš„ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - é©æ–°çš„ãªç¤¾ä¼šçš„å½±éŸ¿åŠ›", leadership: "å‰µé€ çš„", communication: "inspiring" },
                    2: { description: "å—å®¹çš„ãªæ”¯æ´å‹äººæ ¼ - å”èª¿ã¨è‚²æˆé‡è¦–", leadership: "æ”¯æ´çš„", communication: "empathetic" },
                    3: { description: "åˆæœŸæ®µéšã®çµ„ç¹”è€… - åŸºç›¤æ§‹ç¯‰é‡è¦–", leadership: "çµ„ç¹”æ§‹ç¯‰å‹", communication: "foundational" },
                    4: { description: "æŒ‡å°çš„ãƒ¡ãƒ³ã‚¿ãƒ¼ - æ•™è‚²ã¨æˆé•·ä¿ƒé€²", leadership: "ãƒ¡ãƒ³ã‚¿ãƒ¼å‹", communication: "educational" },
                    5: { description: "æˆ¦ç•¥çš„å¾…æ©Ÿè€… - ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’é‡è¦–", leadership: "æˆ¦ç•¥çš„", communication: "strategic" },
                    6: { description: "æ…é‡ãªèª¿åœè€… - å¯¾ç«‹å›é¿é‡è¦–", leadership: "èª¿åœå‹", communication: "diplomatic" },
                    7: { description: "é›†å›£æŒ‡å°è€… - ãƒãƒ¼ãƒ çµ±ç‡é‡è¦–", leadership: "é›†å›£çµ±ç‡", communication: "commanding" },
                    8: { description: "å”åŠ›ä¿ƒé€²è€… - é€£æºã¨çµæŸé‡è¦–", leadership: "å”åŠ›ä¿ƒé€²", communication: "unifying" },
                    9: { description: "ç´°ã‚„ã‹ãªç®¡ç†è€… - è©³ç´°ã¸ã®é…æ…®", leadership: "ç®¡ç†å‹", communication: "detailed" },
                    10: { description: "ç¤¼å„€æ­£ã—ã„äº¤æ¸‰è€… - å“æ ¼é‡è¦–", leadership: "å“æ ¼é‡è¦–", communication: "dignified" },
                    11: { description: "èª¿å’Œçš„ãƒªãƒ¼ãƒ€ãƒ¼ - ãƒãƒ©ãƒ³ã‚¹ã¨çµ±åˆã‚’é‡è¦–", leadership: "çµ±åˆçš„", communication: "inclusive" },
                    12: { description: "ç‹¬ç«‹çš„æ€è€ƒè€… - ç‹¬è‡ªã®ç¤¾ä¼šçš„ç«‹å ´", leadership: "ç‹¬ç«‹çš„", communication: "selective" },
                    13: { description: "åŒäººå‹å”åŠ›è€… - å…±åŒä½“æ„è­˜é‡è¦–", leadership: "å”åŠ›çš„", communication: "collaborative" },
                    14: { description: "å¤§æœ‰å‹æˆæœä¸»ç¾©è€… - å®Ÿç¸¾ã¨æˆæœé‡è¦–", leadership: "æˆæœä¸»ç¾©", communication: "results-oriented" },
                    15: { description: "è¬™è™šãªå®ŸåŠ›è€… - æ§ãˆã‚ãªãŒã‚‰ç¢ºå®Ÿ", leadership: "è¬™è™šãªå®ŸåŠ›", communication: "modest" },
                    16: { description: "ç†±æ„ã‚ã‚‹å‹•æ©Ÿä»˜ã‘è€… - ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é‡è¦–", leadership: "å‹•æ©Ÿä»˜ã‘", communication: "enthusiastic" },
                    17: { description: "è¿½éšãƒ»é©å¿œå‹ - çŠ¶æ³å¯¾å¿œé‡è¦–", leadership: "è¿½éšé©å¿œ", communication: "responsive" },
                    18: { description: "å•é¡Œè§£æ±ºè€… - èª²é¡Œæ”¹å–„é‡è¦–", leadership: "å•é¡Œè§£æ±º", communication: "reformative" },
                    19: { description: "è¦ªã—ã¿ã‚„ã™ã„æ¥è¿‘è€… - äººé–“é–¢ä¿‚é‡è¦–", leadership: "è¦ªå’Œçš„", communication: "approachable" },
                    20: { description: "è¦³å¯Ÿãƒ»åˆ†æå‹ - æ´å¯ŸåŠ›é‡è¦–", leadership: "åˆ†æè¦³å¯Ÿ", communication: "insightful" },
                    21: { description: "å…¬æ­£ãªè£å®šè€… - å®¢è¦³æ€§é‡è¦–", leadership: "å…¬æ­£è£å®š", communication: "objective" },
                    22: { description: "ç¾çš„ã‚»ãƒ³ã‚¹é‡è¦– - é­…åŠ›ã¨è£…é£¾", leadership: "ç¾çš„è¡¨ç¾", communication: "aesthetic" },
                    23: { description: "æ®µéšçš„å¤‰é©è€… - æ…é‡ãªæ”¹é©", leadership: "æ®µéšå¤‰é©", communication: "gradual" },
                    24: { description: "å¾©æ´»ãƒ»å†ç”Ÿå‹ - ç«‹ã¡ç›´ã‚Šé‡è¦–", leadership: "å¾©æ´»å†ç”Ÿ", communication: "resilient" },
                    25: { description: "è‡ªç„¶ä½“ãƒ»ç„¡é‚ªæ°— - ç´”ç²‹æ€§é‡è¦–", leadership: "è‡ªç„¶ä½“", communication: "authentic" },
                    26: { description: "è“„ç©ãƒ»æº–å‚™å‹ - åŠ›ã®æ¸©å­˜é‡è¦–", leadership: "è“„ç©æº–å‚™", communication: "preparative" },
                    27: { description: "é¤Šè‚²ãƒ»æ”¯æ´å‹ - ã‚±ã‚¢ã¨æˆé•·", leadership: "é¤Šè‚²æ”¯æ´", communication: "nurturing" },
                    28: { description: "éå¤§è² è·å¯¾å¿œ - é‡è²¬ã¸ã®æŒ‘æˆ¦", leadership: "é‡è²¬å¯¾å¿œ", communication: "challenging" },
                    29: { description: "å›°é›£çªç ´è€… - å±é™ºãªçŠ¶æ³ã¸ã®å¯¾å‡¦", leadership: "å›°é›£çªç ´", communication: "persevering" },
                    30: { description: "æ˜æ™°ãªè¡¨ç¾è€… - æ˜ç¢ºæ€§ã¨è¼ã", leadership: "æ˜æ™°è¡¨ç¾", communication: "illuminating" },
                    31: { description: "æ„ŸåŒ–ãƒ»å½±éŸ¿åŠ› - ç›¸äº’ä½œç”¨é‡è¦–", leadership: "ç›¸äº’æ„ŸåŒ–", communication: "influential" },
                    32: { description: "æŒç¶šãƒ»ç¶™ç¶šå‹ - é•·æœŸçš„è¦–ç‚¹", leadership: "æŒç¶šç¶™ç¶š", communication: "enduring" },
                    33: { description: "æˆ¦ç•¥çš„æ’¤é€€è€… - é©åˆ‡ãªå¼•ãéš›", leadership: "æˆ¦ç•¥æ’¤é€€", communication: "tactical" },
                    34: { description: "å¤§ããªåŠ›ã®ç™ºæ® - å¼·åŠ›ãªãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—", leadership: "å¼·åŠ›ç™ºæ®", communication: "powerful" },
                    35: { description: "é€²æ­©ãƒ»ç™ºå±•å‹ - å‰é€²é‡è¦–", leadership: "é€²æ­©ç™ºå±•", communication: "progressive" },
                    36: { description: "å›°é›£æ™‚ã®è³¢æ˜ã• - é€†å¢ƒã§ã®çŸ¥æµ", leadership: "é€†å¢ƒè³¢æ˜", communication: "wise" },
                    37: { description: "å®¶æ—ãƒ»çµ„ç¹”é‹å–¶ - å†…éƒ¨çµ±æ²»é‡è¦–", leadership: "çµ„ç¹”é‹å–¶", communication: "administrative" },
                    38: { description: "å¯¾ç«‹ãƒ»å·®ç•°èª¿æ•´ - å¤šæ§˜æ€§å¯¾å¿œ", leadership: "å·®ç•°èª¿æ•´", communication: "mediating" },
                    39: { description: "éšœå®³ç‰©å¯¾å‡¦ - å›°é›£å…‹æœé‡è¦–", leadership: "éšœå®³å…‹æœ", communication: "overcoming" },
                    40: { description: "è§£æ”¾ãƒ»è§£æ±ºå‹ - æŸç¸›ã‹ã‚‰ã®è‡ªç”±", leadership: "è§£æ”¾è§£æ±º", communication: "liberating" },
                    41: { description: "æ¸›å°‘ãƒ»å‰Šæ¸›ç®¡ç† - ç„¡é§„ã®æ’é™¤", leadership: "åŠ¹ç‡åŒ–", communication: "streamlining" },
                    42: { description: "å¢—ç›Šãƒ»æ‹¡å¤§å‹ - æˆé•·ã¨ç™ºå±•", leadership: "æ‹¡å¤§æˆé•·", communication: "expanding" },
                    43: { description: "æ±ºæ–­åŠ›ã®ã‚ã‚‹ãƒªãƒ¼ãƒ€ãƒ¼ - æ˜ç¢ºãªæ–¹å‘æ€§", leadership: "æ±ºæ–­åŠ›", communication: "direct" },
                    44: { description: "é­é‡ãƒ»é©å¿œå‹ - çŠ¶æ³å¯¾å¿œé‡è¦–", leadership: "é©å¿œçš„", communication: "flexible" },
                    45: { description: "é›†åˆãƒ»çµ±åˆä¿ƒé€² - å›£çµé‡è¦–", leadership: "çµ±åˆä¿ƒé€²", communication: "unifying" },
                    46: { description: "ä¸Šæ˜‡ãƒ»å‘ä¸Šå‹ - æˆé•·å¿—å‘", leadership: "å‘ä¸Šå¿—å‘", communication: "elevating" },
                    47: { description: "å›°çª®ãƒ»åˆ¶ç´„å¯¾å¿œ - é™ç•ŒçŠ¶æ³ã®ç®¡ç†", leadership: "åˆ¶ç´„ç®¡ç†", communication: "constrained" },
                    48: { description: "æ·±ã„çŸ¥æµã®äº•æˆ¸ - çŸ¥è­˜ã¨çµŒé¨“", leadership: "çŸ¥æµæä¾›", communication: "knowledgeable" },
                    49: { description: "é©æ–°ãƒ»å¤‰é©è€… - æ ¹æœ¬çš„å¤‰åŒ–", leadership: "é©æ–°å¤‰é©", communication: "revolutionary" },
                    50: { description: "æ¨©å¨ãƒ»è²¬ä»»è€… - é‡è¦ãªå½¹å‰²", leadership: "æ¨©å¨è²¬ä»»", communication: "authoritative" },
                    51: { description: "è¡æ’ƒãƒ»å‹•æºå¯¾å¿œ - å¤‰åŒ–ã¸ã®å¯¾å‡¦", leadership: "å¤‰åŒ–å¯¾å¿œ", communication: "dynamic" },
                    52: { description: "å®‰å®šãƒ»é™æ­¢ç¶­æŒ - ç¾çŠ¶ç¶­æŒé‡è¦–", leadership: "å®‰å®šç¶­æŒ", communication: "steady" },
                    53: { description: "æ®µéšçš„ç™ºå±• - ç€å®Ÿãªé€²æ­©", leadership: "æ®µéšç™ºå±•", communication: "gradual" },
                    54: { description: "å¾“å±ãƒ»è£œåŠ©å½¹ - ã‚µãƒãƒ¼ãƒˆé‡è¦–", leadership: "è£œåŠ©æ”¯æ´", communication: "supportive" },
                    55: { description: "è±Šã‹ã•ã®é ‚ç‚¹ - æœ€é«˜æ½®ã®çŠ¶æ…‹", leadership: "è±Šå¯Œæä¾›", communication: "abundant" },
                    56: { description: "æ—…è¡Œãƒ»ç§»å‹•å‹ - å¤‰åŒ–ã¨é©å¿œ", leadership: "ç§»å‹•é©å¿œ", communication: "adaptive" },
                    57: { description: "é †å¿œãƒ»æµ¸é€å‹ - æŸ”è»Ÿãªå½±éŸ¿åŠ›", leadership: "æŸ”è»Ÿæµ¸é€", communication: "penetrating" },
                    58: { description: "å–œæ‚¦ãƒ»æ¥½ã—ã•æä¾› - ãƒã‚¸ãƒ†ã‚£ãƒ–å½±éŸ¿", leadership: "å–œæ‚¦æä¾›", communication: "joyful" },
                    59: { description: "åˆ†æ•£ãƒ»æ‹¡æ•£å¯¾å¿œ - æ•£æ¼«ã•ã¸ã®å¯¾å‡¦", leadership: "çµ±åˆé›†ç´„", communication: "focusing" },
                    60: { description: "ç¯€åº¦ãƒ»åˆ¶é™ç®¡ç† - ãƒãƒ©ãƒ³ã‚¹é‡è¦–", leadership: "ç¯€åº¦ç®¡ç†", communication: "balanced" },
                    61: { description: "å†…çš„çœŸå®Ÿé‡è¦– - èª å®Ÿæ€§ã®è¡¨ç¾", leadership: "èª å®Ÿè¡¨ç¾", communication: "sincere" },
                    62: { description: "å°ã•ãªéåº¦ - ç´°ã‹ãªèª¿æ•´", leadership: "å¾®ç´°èª¿æ•´", communication: "precise" },
                    63: { description: "å®Œæˆãƒ»é”æˆå‹ - ç›®æ¨™é”æˆé‡è¦–", leadership: "å®Œæˆé”æˆ", communication: "accomplished" },
                    64: { description: "æœªå®Œæˆãƒ»ç¶™ç¶šå‹ - é€²è¡Œä¸­ã®çŠ¶æ…‹", leadership: "ç¶™ç¶šé€²è¡Œ", communication: "ongoing" }
                };
                
                return interpretations[hexagramId] || {
                    description: "ãƒãƒ©ãƒ³ã‚¹å‹ç¤¾ä¼šçš„äººæ ¼ - çŠ¶æ³ã«å¿œã˜ãŸé©å¿œ",
                    leadership: "ãƒãƒ©ãƒ³ã‚¹å‹",
                    communication: "adaptable"
                };
            
            // ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒ«åˆ†æ
            analyzeLeadershipStyle(upperTrigram, socialPatterns) {
                const styles = {
                    "ä¹¾": "å‰µé€ çš„ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - é©æ–°ã¨å¤‰åŒ–ã‚’ã‚‚ãŸã‚‰ã™",
                    "å…Œ": "å¯¾è©±å‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é‡è¦–", 
                    "é›¢": "é­…åŠ›çš„ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸ãˆã‚‹",
                    "éœ‡": "è¡Œå‹•å‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - è¿…é€Ÿãªæ±ºæ–­ã¨å®Ÿè¡Œ",
                    "å·½": "å”èª¿å‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - ãƒãƒ¼ãƒ ã®èª¿å’Œã‚’é‡è¦–",
                    "å": "æ´å¯Ÿå‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - æ·±ã„åˆ†æã«åŸºã¥ãåˆ¤æ–­",
                    "è‰®": "å®‰å®šå‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - ä¸€è²«æ€§ã¨ä¿¡é ¼æ€§",
                    "å¤": "æ”¯æ´å‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ— - ãƒ¡ãƒ³ãƒãƒ¼ã®æˆé•·ã‚’ä¿ƒé€²"
                };
                
                const baseStyle = styles[upperTrigram] || "ãƒãƒ©ãƒ³ã‚¹å‹ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—";
                const leadershipScore = socialPatterns.Q25_leadership || 0.5;
                
                if (leadershipScore > 0.8) {
                    return `å¼·ã„${baseStyle}`;
                } else if (leadershipScore > 0.6) {
                    return baseStyle;
                } else {
                    return `æ§ãˆã‚ãª${baseStyle}`;
            
            // ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«åˆ†æ
            analyzeCommunicationStyle(upperTrigram, lowerTrigram, socialPatterns) {
                const upperStyles = {
                    "ä¹¾": "ç›´æ¥çš„",
                    "å…Œ": "è¦ªã—ã¿ã‚„ã™ã„",
                    "é›¢": "è¡¨ç¾è±Šã‹",
                    "éœ‡": "ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥",
                    "å·½": "é…æ…®æ·±ã„",
                    "å": "æ…é‡",
                    "è‰®": "å®‰å®šã—ãŸ",
                    "å¤": "åŒ…å®¹çš„"
                };
                
                const lowerStyles = {
                    "ä¹¾": "åŠ›å¼·ã„åŸºç›¤",
                    "å…Œ": "å–œæ‚¦ã®åŸºç›¤", 
                    "é›¢": "æ˜æ™°ãªåŸºç›¤",
                    "éœ‡": "è¡Œå‹•ã®åŸºç›¤",
                    "å·½": "æŸ”è»ŸãªåŸºç›¤",
                    "å": "æ·±ã„åŸºç›¤",
                    "è‰®": "å®‰å®šã—ãŸåŸºç›¤",
                    "å¤": "å—å®¹çš„åŸºç›¤"
                };
                
                const interpersonalScore = socialPatterns.Q26_interpersonal || 0.5;
                const styleIntensity = interpersonalScore > 0.7 ? "ç©æ¥µçš„ã«" : interpersonalScore > 0.4 ? "" : "æ…é‡ã«";
                
                return `${styleIntensity}${upperStyles[upperTrigram]}ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ${lowerStyles[lowerTrigram]}ï¼‰`;
            
            // å¯¾ç«‹è§£æ±ºã‚¹ã‚¿ã‚¤ãƒ«åˆ†æ
            analyzeConflictStyle(lowerTrigram, socialPatterns) {
                const styles = {
                    "ä¹¾": "ç©æ¥µçš„è§£æ±º - ä¸»å°çš„ã«å•é¡Œã«å–ã‚Šçµ„ã‚€",
                    "å…Œ": "å¯¾è©±é‡è¦– - è©±ã—åˆã„ã«ã‚ˆã‚‹è§£æ±ºã‚’å›³ã‚‹",
                    "é›¢": "æ˜ç¢ºåŒ–é‡è¦– - å•é¡Œã‚’æ˜ã‚‰ã‹ã«ã—ã¦è§£æ±º",
                    "éœ‡": "è¿…é€Ÿå¯¾å¿œ - ç´ æ—©ã„åˆ¤æ–­ã§è§£æ±º",
                    "å·½": "ç©ã‚„ã‹è§£æ±º - æ®µéšçš„ã§æŸ”è»Ÿãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒ",
                    "å": "æ…é‡åˆ†æ - æ·±ãåˆ†æã—ã¦ã‹ã‚‰å¯¾å¿œ",
                    "è‰®": "å†·é™å¯¾å‡¦ - æ™‚é–“ã‚’ã‹ã‘ãŸæ…é‡ãªè§£æ±º",
                    "å¤": "å—å®¹çš„è§£æ±º - åŒ…å®¹åŠ›ã§å•é¡Œã‚’å’Œã‚‰ã’ã‚‹"
                };
                
                const competitionScore = socialPatterns.Q29_competition || 0.5;
                const baseStyle = styles[lowerTrigram] || "ãƒãƒ©ãƒ³ã‚¹å‹è§£æ±º";
                
                if (competitionScore > 0.7) {
                    return `ç«¶äº‰çš„ãª${baseStyle}`;
                } else if (competitionScore < 0.3) {
                    return `å”èª¿çš„ãª${baseStyle}`;
                } else {
                    return baseStyle;
            
            // é©å¿œæ€§åˆ†æ
            analyzeAdaptability(upperTrigram, lowerTrigram, socialPatterns) {
                const adaptabilityScores = {
                    "ä¹¾": 0.6, "å…Œ": 0.8, "é›¢": 0.7, "éœ‡": 0.9,
                    "å·½": 0.9, "å": 0.7, "è‰®": 0.3, "å¤": 0.8
                };
                
                const upperScore = adaptabilityScores[upperTrigram] || 0.5;
                const lowerScore = adaptabilityScores[lowerTrigram] || 0.5;
                const avgScore = (upperScore + lowerScore) / 2;
                
                const familyScore = socialPatterns.Q27_family || 0.5;
                const emergencyScore = socialPatterns.Q28_emergency || 0.5;
                const contextScore = (familyScore + emergencyScore) / 2;
                
                const finalScore = (avgScore * 0.7) + (contextScore * 0.3);
                
                if (finalScore > 0.8) return "éå¸¸ã«é«˜ã„é©å¿œåŠ›";
                if (finalScore > 0.6) return "é«˜ã„é©å¿œåŠ›";
                if (finalScore > 0.4) return "ä¸­ç¨‹åº¦ã®é©å¿œåŠ›"; 
                return "é™å®šçš„ãªé©å¿œåŠ›";
            
            // Engine OSã®å½±éŸ¿åˆ†æ
            analyzeEngineInfluence(engineOS, interfaceUpper, interfaceLower) {
                if (!engineOS || !engineOS.upperTrigram) {
                    return "Engine OSæƒ…å ±ä¸è¶³ã«ã‚ˆã‚Šå½±éŸ¿ä¸æ˜";
                
                const engineUpper = engineOS.upperTrigram;
                const compatibility = this.calculateTrigramCompatibility(engineUpper, interfaceUpper);
                
                if (compatibility > 0.7) {
                    return `Engine OSï¼ˆ${engineUpper}ï¼‰ã¨ã®é«˜ã„è¦ªå’Œæ€§ - ä¸€è²«ã—ãŸäººæ ¼è¡¨ç¾`;
                } else if (compatibility > 0.4) {
                    return `Engine OSï¼ˆ${engineUpper}ï¼‰ã¨ã®é©åº¦ãªè¦ªå’Œæ€§ - ãƒãƒ©ãƒ³ã‚¹å–ã‚ŒãŸè¡¨ç¾`;
                } else {
                    return `Engine OSï¼ˆ${engineUpper}ï¼‰ã¨ã®è£œå®Œé–¢ä¿‚ - å†…å¤–ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ`;
            
            // ä¸‰çˆ»é–“ã®è¦ªå’Œæ€§è¨ˆç®—
            calculateTrigramCompatibility(trigram1, trigram2) {
                const compatibilityMatrix = {
                    "ä¹¾": { "ä¹¾": 1.0, "å…Œ": 0.8, "é›¢": 0.9, "éœ‡": 0.7, "å·½": 0.4, "å": 0.5, "è‰®": 0.6, "å¤": 0.2 },
                    "å…Œ": { "ä¹¾": 0.8, "å…Œ": 1.0, "é›¢": 0.7, "éœ‡": 0.6, "å·½": 0.8, "å": 0.4, "è‰®": 0.3, "å¤": 0.7 },
                    "é›¢": { "ä¹¾": 0.9, "å…Œ": 0.7, "é›¢": 1.0, "éœ‡": 0.5, "å·½": 0.6, "å": 0.2, "è‰®": 0.4, "å¤": 0.8 },
                    "éœ‡": { "ä¹¾": 0.7, "å…Œ": 0.6, "é›¢": 0.5, "éœ‡": 1.0, "å·½": 0.3, "å": 0.8, "è‰®": 0.2, "å¤": 0.4 },
                    "å·½": { "ä¹¾": 0.4, "å…Œ": 0.8, "é›¢": 0.6, "éœ‡": 0.3, "å·½": 1.0, "å": 0.7, "è‰®": 0.8, "å¤": 0.9 },
                    "å": { "ä¹¾": 0.5, "å…Œ": 0.4, "é›¢": 0.2, "éœ‡": 0.8, "å·½": 0.7, "å": 1.0, "è‰®": 0.9, "å¤": 0.6 },
                    "è‰®": { "ä¹¾": 0.6, "å…Œ": 0.3, "é›¢": 0.4, "éœ‡": 0.2, "å·½": 0.8, "å": 0.9, "è‰®": 1.0, "å¤": 0.7 },
                    "å¤": { "ä¹¾": 0.2, "å…Œ": 0.7, "é›¢": 0.8, "éœ‡": 0.4, "å·½": 0.9, "å": 0.6, "è‰®": 0.7, "å¤": 1.0 }
                };
                
                return compatibilityMatrix[trigram1]?.[trigram2] || 0.5;
            
            calculateConsistencyScore(engineOS, interfaceOS, safeModeOS) {
                try {
                    // 1. å¦ã®ç›¸äº’è·é›¢ã‚’è¨ˆç®—
                    const engineInterface = Math.abs(engineOS.hexagramId - interfaceOS.hexagramId);
                    const engineSafeMode = Math.abs(engineOS.hexagramId - safeModeOS.hexagramId);
                    const interfaceSafeMode = Math.abs(interfaceOS.hexagramId - safeModeOS.hexagramId);
                    
                    // 2. ä¸‰çˆ»ãƒ¬ãƒ™ãƒ«ã§ã®æ•´åˆæ€§åˆ†æ
                    const trigramConsistency = this.analyzeTrigramConsistency(engineOS, interfaceOS, safeModeOS);
                    
                    // 3. HaQeiå“²å­¦çš„ä¸€è²«æ€§ã®è©•ä¾¡
                    const philosophicalConsistency = this.evaluatePhilosophicalConsistency(engineOS, interfaceOS, safeModeOS);
                    
                    // 4. ç·åˆæ•´åˆæ€§ã‚¹ã‚³ã‚¢è¨ˆç®—
                    const distanceScore = Math.max(0, 100 - (engineInterface + engineSafeMode + interfaceSafeMode) / 3 * 1.5);
                    const finalScore = (distanceScore * 0.4 + trigramConsistency * 0.35 + philosophicalConsistency * 0.25);
                    
                    return Math.min(100, Math.max(0, finalScore));
                    
                } catch (error) {
                    console.error("âŒ Consistency calculation error:", error);
                    return 50; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * Triple OSç›¸äº’ä½œç”¨ã®ç·åˆåˆ†æ
             * 3ã¤ã®OSã®çµ±åˆçš„å‹•ä½œã‚’è©•ä¾¡ã—ã€æ¨å¥¨äº‹é …ã‚’ç”Ÿæˆ
             */
            async calculateTripleOSInteraction(engineOS, interfaceOS, safeModeOS) {
                // console.log("ğŸ”¯ Calculating Triple OS Interaction");
                
                try {
                    // 1. æ•´åˆæ€§ã‚¹ã‚³ã‚¢è¨ˆç®—
                    const consistency = this.calculateConsistencyScore(engineOS, interfaceOS, safeModeOS);
                    
                    // 2. å‹•çš„ãƒãƒ©ãƒ³ã‚¹è©•ä¾¡
                    const balance = this.evaluateDynamicBalance(engineOS, interfaceOS, safeModeOS);
                    
                    // 3. HaQeiçµ±åˆåº¦è©•ä¾¡
                    const integration = this.assessHaQeiIntegration(engineOS, interfaceOS, safeModeOS);
                    
                    // 4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ¤œè¨¼
                    const dataFlowValidation = this.validateDataFlow(engineOS, interfaceOS, safeModeOS);
                    
                    // 5. æ¨å¥¨äº‹é …ç”Ÿæˆ
                    const recommendations = this.generateRecommendations(consistency, balance, integration, dataFlowValidation);
                    
                    return {
                        consistency,
                        balance,
                        integration,
                        dataFlow: dataFlowValidation,
                        recommendations,
                        timestamp: Date.now(),
                        status: "success"
                    };
                    
                } catch (error) {
                    console.error("âŒ Triple OS Interaction calculation failed:", error);
                    return this.getDefaultTripleOSInteraction();
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * å‹•çš„ãƒãƒ©ãƒ³ã‚¹è©•ä¾¡
             * 3ã¤ã®OSã®ç›¸äº’ä½œç”¨ã«ãŠã‘ã‚‹å‹•çš„å¹³è¡¡ã‚’è©•ä¾¡
             */
            evaluateDynamicBalance(engineOS, interfaceOS, safeModeOS) {
                console.log("âš–ï¸ Evaluating Dynamic Balance");
                
                try {
                    // 1. ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†å¸ƒã®åˆ†æ
                    const energyDistribution = this.analyzeEnergyDistribution(engineOS, interfaceOS, safeModeOS);
                    
                    // 2. ç›¸äº’è£œå®Œæ€§ã®è©•ä¾¡
                    const complementarity = this.assessComplementarity(engineOS, interfaceOS, safeModeOS);
                    
                    // 3. å®‰å®šæ€§æŒ‡æ¨™ã®è¨ˆç®—
                    const stability = this.calculateStabilityIndex(engineOS, interfaceOS, safeModeOS);
                    
                    // 4. é©å¿œæ€§æŒ‡æ¨™ã®è¨ˆç®—
                    const adaptability = this.calculateAdaptabilityIndex(engineOS, interfaceOS, safeModeOS);
                    
                    // 5. ç·åˆãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢
                    const balanceScore = (
                        energyDistribution * 0.3 + 
                        complementarity * 0.25 + 
                        stability * 0.25 + 
                        adaptability * 0.2
                    
                    return Math.min(100, Math.max(0, balanceScore));
                    
                } catch (error) {
                    console.error("âŒ Dynamic balance evaluation failed:", error);
                    return 65; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ©ãƒ³ã‚¹å€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * HaQeiçµ±åˆåº¦è©•ä¾¡
             * æ˜“çµŒå“²å­¦ã«åŸºã¥ãçµ±åˆãƒ¬ãƒ™ãƒ«ã®è©•ä¾¡
             */
            assessHaQeiIntegration(engineOS, interfaceOS, safeModeOS) {
                console.log("ğŸŒŸ Assessing HaQei Integration");
                
                try {
                    // 1. æ˜“çµŒåŸç†ã®é©ç”¨åº¦è©•ä¾¡
                    const yijingPrinciples = this.evaluateYijingPrinciples(engineOS, interfaceOS, safeModeOS);
                    
                    // 2. ä¸‰æ‰æ€æƒ³ã®ä½“ç¾åº¦ï¼ˆå¤©ãƒ»äººãƒ»åœ°ï¼‰
                    const sancaiEmbodiment = this.evaluateSancaiEmbodiment(engineOS, interfaceOS, safeModeOS);
                    
                    // 3. é™°é™½èª¿å’Œã®å®Ÿç¾åº¦
                    const yinyangHarmony = this.evaluateYinyangHarmony(engineOS, interfaceOS, safeModeOS);
                    
                    // 4. äº”è¡Œç›¸ç”Ÿã®å®Ÿç¾åº¦
                    const wuxingSynergy = this.evaluateWuxingSynergy(engineOS, interfaceOS, safeModeOS);
                    
                    // 5. HaQeiçµ±åˆã‚¹ã‚³ã‚¢
                    const integrationScore = (
                        yijingPrinciples * 0.35 +
                        sancaiEmbodiment * 0.25 +
                        yinyangHarmony * 0.25 +
                        wuxingSynergy * 0.15
                    
                    return Math.min(100, Math.max(0, integrationScore));
                    
                } catch (error) {
                    console.error("âŒ HaQei integration assessment failed:", error);
                    return 70; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçµ±åˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * 64å¦å‡ºåŠ›ã®å®Œå…¨æ€§ç¢ºèª
             * å„OSãŒ1-64ã®ã™ã¹ã¦ã®å¦ã‚’å‡ºåŠ›å¯èƒ½ã‹æ¤œè¨¼
             */
            validateTripleOSResults(engineOS, interfaceOS, safeModeOS) {
                console.log("ğŸ” Validating Triple OS Results");
                
                try {
                    // 1. å„OSã®å¦IDã®æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯
                    const validationResults = {
                        engineOS: this.validateOSHexagram(engineOS, "Engine OS"),
                        interfaceOS: this.validateOSHexagram(interfaceOS, "Interface OS"),  
                        safeModeOS: this.validateOSHexagram(safeModeOS, "SafeMode OS")
                    };
                    
                    // 2. é‡è¤‡ãƒ»æ¬ è½ãƒã‚§ãƒƒã‚¯
                    const duplicateCheck = this.checkForDuplicates([engineOS.hexagramId, interfaceOS.hexagramId, safeModeOS.hexagramId]);
                    
                    // 3. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
                    const dataFlowCheck = this.validateDataFlowIntegrity(engineOS, interfaceOS, safeModeOS);
                    
                    // 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒã‚§ãƒƒã‚¯
                    const errorHandlingCheck = this.validateErrorHandling(engineOS, interfaceOS, safeModeOS);
                    
                    // 5. æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
                    const validationReport = {
                        ...validationResults,
                        duplicates: duplicateCheck,
                        dataFlow: dataFlowCheck,
                        errorHandling: errorHandlingCheck,
                        overallStatus: this.determineOverallValidationStatus(validationResults, duplicateCheck, dataFlowCheck, errorHandlingCheck),
                        timestamp: Date.now()
                    };
                    
                    console.log("âœ… Triple OS Validation Complete:", validationReport);
                    return validationReport;
                    
                } catch (error) {
                    console.error("âŒ Triple OS validation failed:", error);
                    throw new Error(`Triple OS validation failed: ${error.message}`);
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            /**
             * æ¨å¥¨äº‹é …ç”Ÿæˆ
             * åˆ†æçµæœã«åŸºã¥ãæ”¹å–„ææ¡ˆã®ç”Ÿæˆ
             */
            generateRecommendations(consistency, balance, integration, dataFlow) {
                console.log("ğŸ’¡ Generating Recommendations");
                
                const recommendations = [];
                
                try {
                    // 1. æ•´åˆæ€§ã«åŸºã¥ãæ¨å¥¨
                    if (consistency < 70) {
                        recommendations.push({
                            type: "consistency",
                            priority: "high",
                            title: "OSé–“æ•´åˆæ€§ã®å‘ä¸Š",
                            description: "Engineã€Interfaceã€SafeMode OSã®ç›¸äº’é–¢ä¿‚ã‚’è¦‹ç›´ã—ã€ã‚ˆã‚Šèª¿å’Œã®å–ã‚ŒãŸçµ±åˆã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†",
                            action: "ä¾¡å€¤è¦³ã¨è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å†æ•´ç†ã‚’æ¨å¥¨"
                        });
                    
                    // 2. ãƒãƒ©ãƒ³ã‚¹ã«åŸºã¥ãæ¨å¥¨
                    if (balance < 65) {
                        recommendations.push({
                            type: "balance",
                            priority: "medium",
                            title: "å‹•çš„ãƒãƒ©ãƒ³ã‚¹ã®æœ€é©åŒ–",
                            description: "3ã¤ã®OSã®å‹•çš„å¹³è¡¡ã‚’æ”¹å–„ã—ã€ã‚ˆã‚Šå®‰å®šã—ãŸçµ±åˆã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†",
                            action: "çŠ¶æ³ã«å¿œã˜ãŸOSåˆ‡ã‚Šæ›¿ãˆã®ç·´ç¿’ã‚’æ¨å¥¨"
                        });
                    
                    // 3. HaQeiçµ±åˆã«åŸºã¥ãæ¨å¥¨
                    if (integration < 75) {
                        recommendations.push({
                            type: "integration",
                            priority: "medium",
                            title: "HaQeiå“²å­¦ã®æ·±åŒ–",
                            description: "æ˜“çµŒåŸç†ã‚’ã‚ˆã‚Šæ·±ãç†è§£ã—ã€æ—¥å¸¸ç”Ÿæ´»ã§ã®å®Ÿè·µã‚’å¢—ã‚„ã—ã¾ã—ã‚‡ã†",
                            action: "æ˜“çµŒå­¦ç¿’ã¨ç‘æƒ³çš„å®Ÿè·µã®ç¶™ç¶šã‚’æ¨å¥¨"
                        });
                    
                    // 4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã«åŸºã¥ãæ¨å¥¨
                    if (dataFlow && !dataFlow.isValid) {
                        recommendations.push({
                            type: "dataflow",
                            priority: "high",
                            title: "æƒ…å ±å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®æ”¹å–„",
                            description: "ä¾¡å€¤è¦³ã‹ã‚‰ã‚·ãƒŠãƒªã‚ªå¯¾å¿œã¸ã®æƒ…å ±ã®æµã‚Œã‚’æ”¹å–„ã—ã€ä¸€è²«æ€§ã®ã‚ã‚‹åˆ¤æ–­ã‚’å®Ÿç¾ã—ã¾ã—ã‚‡ã†",
                            action: "ã‚»ãƒ«ãƒ•ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ç¿’æ…£åŒ–ã‚’æ¨å¥¨"
                        });
                    
                    // 5. ç·åˆçš„ãªæ¨å¥¨äº‹é …
                    if (recommendations.length === 0) {
                        recommendations.push({
                            type: "optimization",
                            priority: "low",
                            title: "ã•ã‚‰ãªã‚‹æœ€é©åŒ–",
                            description: "æ—¢ã«è‰¯å¥½ãªçµ±åˆçŠ¶æ…‹ã§ã™ã€‚ã•ã‚‰ãªã‚‹å‘ä¸Šã®ãŸã‚ã«ç¶™ç¶šçš„ãªè‡ªå·±è¦³å¯Ÿã‚’ç¶šã‘ã¾ã—ã‚‡ã†",
                            action: "å®šæœŸçš„ãªè‡ªå·±è©•ä¾¡ã®å®Ÿæ–½ã‚’æ¨å¥¨"
                        });
                    
                    return recommendations;
                    
                } catch (error) {
                    console.error("âŒ Recommendation generation failed:", error);
                    return [{
                        type: "error",
                        priority: "medium",
                        title: "è©•ä¾¡ã‚¨ãƒ©ãƒ¼",
                        description: "æ¨å¥¨äº‹é …ã®ç”Ÿæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                        action: "æŠ€è¡“çš„ãªã‚µãƒãƒ¼ãƒˆã‚’ã”åˆ©ç”¨ãã ã•ã„"
                    }];
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            // =================
            // è£œåŠ©ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤
            // =================
            
            /**
             * ä¸‰çˆ»ãƒ¬ãƒ™ãƒ«ã§ã®æ•´åˆæ€§åˆ†æ
             */
            analyzeTrigramConsistency(engineOS, interfaceOS, safeModeOS) {
                try {
                    const compatibility1 = this.calculateTrigramCompatibility(engineOS.upperTrigram, interfaceOS.upperTrigram);
                    const compatibility2 = this.calculateTrigramCompatibility(engineOS.upperTrigram, safeModeOS.upperTrigram);
                    const compatibility3 = this.calculateTrigramCompatibility(interfaceOS.upperTrigram, safeModeOS.upperTrigram);
                    
                    return (compatibility1 + compatibility2 + compatibility3) / 3 * 100;
                } catch (error) {
                    return 60; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * HaQeiå“²å­¦çš„ä¸€è²«æ€§ã®è©•ä¾¡
             */
            evaluatePhilosophicalConsistency(engineOS, interfaceOS, safeModeOS) {
                try {
                    // æ˜“çµŒã®æ ¸å¿ƒåŸç†ã§ã‚ã‚‹å¤‰åŒ–ã¨èª¿å’Œã®ä½“ç¾åº¦ã‚’è©•ä¾¡
                    const changeAlignment = this.assessChangeAlignment(engineOS, interfaceOS, safeModeOS);
                    const harmonyAlignment = this.assessHarmonyAlignment(engineOS, interfaceOS, safeModeOS);
                    
                    return (changeAlignment + harmonyAlignment) / 2;
                } catch (error) {
                    return 70; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†å¸ƒã®åˆ†æ
             */
            analyzeEnergyDistribution(engineOS, interfaceOS, safeModeOS) {
                try {
                    const engineEnergy = this.calculateOSEnergy(engineOS);
                    const interfaceEnergy = this.calculateOSEnergy(interfaceOS);
                    const safeModeEnergy = this.calculateOSEnergy(safeModeOS);
                    
                    const total = engineEnergy + interfaceEnergy + safeModeEnergy;
                    const idealRatio = [0.35, 0.35, 0.30]; // Engine, Interface, SafeMode
                    const actualRatio = [engineEnergy/total, interfaceEnergy/total, safeModeEnergy/total];
                    
                    // ç†æƒ³æ¯”ç‡ã¨ã®å·®ç•°ã‚’è¨ˆç®—
                    const deviation = idealRatio.reduce((sum, ideal, i) => sum + Math.abs(ideal - actualRatio[i]), 0);
                    
                    return Math.max(0, 100 - (deviation * 100));
                } catch (error) {
                    return 65; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * ç›¸äº’è£œå®Œæ€§ã®è©•ä¾¡
             */
            assessComplementarity(engineOS, interfaceOS, safeModeOS) {
                try {
                    // 3ã¤ã®OSãŒäº’ã„ã‚’è£œå®Œã—åˆã£ã¦ã„ã‚‹ã‹ã‚’è©•ä¾¡
                    const engineInterface = this.calculateComplementarity(engineOS, interfaceOS);
                    const engineSafeMode = this.calculateComplementarity(engineOS, safeModeOS);
                    const interfaceSafeMode = this.calculateComplementarity(interfaceOS, safeModeOS);
                    
                    return (engineInterface + engineSafeMode + interfaceSafeMode) / 3;
                } catch (error) {
                    return 60; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * å®‰å®šæ€§æŒ‡æ¨™ã®è¨ˆç®—
             */
            calculateStabilityIndex(engineOS, interfaceOS, safeModeOS) {
                try {
                    // å„OSã®å®‰å®šæ€§ã‚’ä¸‰çˆ»ã®ç‰¹æ€§ã‹ã‚‰åˆ¤æ–­
                    const engineStability = this.getTrigramStability(engineOS.upperTrigram, engineOS.lowerTrigram);
                    const interfaceStability = this.getTrigramStability(interfaceOS.upperTrigram, interfaceOS.lowerTrigram);
                    const safeModeStability = this.getTrigramStability(safeModeOS.upperTrigram, safeModeOS.lowerTrigram);
                    
                    return (engineStability + interfaceStability + safeModeStability) / 3;
                } catch (error) {
                    return 70; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * é©å¿œæ€§æŒ‡æ¨™ã®è¨ˆç®—
             */
            calculateAdaptabilityIndex(engineOS, interfaceOS, safeModeOS) {
                try {
                    // å¤‰åŒ–ã¸ã®é©å¿œèƒ½åŠ›ã‚’è©•ä¾¡
                    const diversity = this.calculateOSDiversity(engineOS, interfaceOS, safeModeOS);
                    const flexibility = this.calculateFlexibility(engineOS, interfaceOS, safeModeOS);
                    
                    return (diversity + flexibility) / 2;
                } catch (error) {
                    return 65; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * æ˜“çµŒåŸç†ã®é©ç”¨åº¦è©•ä¾¡
             */
            evaluateYijingPrinciples(engineOS, interfaceOS, safeModeOS) {
                try {
                    // 64å¦ã®æœ¬è³ªçš„æ„å‘³ã¨ã®æ•´åˆæ€§
                    const principleAlignment = [engineOS, interfaceOS, safeModeOS].reduce((sum, os) => {
                        const hexagram = this.getHexagramData(os.hexagramId);
                        return sum + this.assessHexagramPrincipleAlignment(hexagram, os);
                    }, 0) / 3;
                    
                    return principleAlignment;
                } catch (error) {
                    return 75; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * ä¸‰æ‰æ€æƒ³ã®ä½“ç¾åº¦è©•ä¾¡
             */
            evaluateSancaiEmbodiment(engineOS, interfaceOS, safeModeOS) {
                try {
                    // å¤©ãƒ»äººãƒ»åœ°ã®ä¸‰æ‰æ€æƒ³ã®ä½“ç¾åº¦
                    const tianEmbodiment = this.assessTianEmbodiment(engineOS); // å¤©ï¼šå‰µé€ ãƒ»ç²¾ç¥
                    const renEmbodiment = this.assessRenEmbodiment(interfaceOS); // äººï¼šç¤¾ä¼šãƒ»é–¢ä¿‚
                    const diEmbodiment = this.assessDiEmbodiment(safeModeOS); // åœ°ï¼šåŸºç›¤ãƒ»å®‰å®š
                    
                    return (tianEmbodiment + renEmbodiment + diEmbodiment) / 3;
                } catch (error) {
                    return 70; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * é™°é™½èª¿å’Œã®å®Ÿç¾åº¦
             */
            evaluateYinyangHarmony(engineOS, interfaceOS, safeModeOS) {
                try {
                    const yinYangBalance = this.calculateYinYangBalance([engineOS, interfaceOS, safeModeOS]);
                    const complementaryBalance = this.calculateComplementaryBalance(engineOS, interfaceOS, safeModeOS);
                    
                    return (yinYangBalance + complementaryBalance) / 2;
                } catch (error) {
                    return 65; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * äº”è¡Œç›¸ç”Ÿã®å®Ÿç¾åº¦
             */
            evaluateWuxingSynergy(engineOS, interfaceOS, safeModeOS) {
                try {
                    // æœ¨ç«åœŸé‡‘æ°´ã®ç›¸ç”Ÿé–¢ä¿‚ã®å®Ÿç¾åº¦
                    const wuxingElements = [
                        this.getWuxingElement(engineOS),
                        this.getWuxingElement(interfaceOS),
                        this.getWuxingElement(safeModeOS)
                    ];
                    
                    return this.calculateWuxingSynergyScore(wuxingElements);
                } catch (error) {
                    return 60; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            /**
             * OSå¦IDã®æœ‰åŠ¹æ€§æ¤œè¨¼
             */
            validateOSHexagram(osResult, osName) {
                try {
                    const hexagramId = osResult.hexagramId;
                    
                    // 1. å¦IDãŒ1-64ã®ç¯„å›²å†…ã‹
                    if (hexagramId < 1 || hexagramId > 64) {
                        return {
                            valid: false,
                            error: `Invalid hexagram ID: ${hexagramId}`,
                            osName: osName
                        };
                    
                    // 2. ä¸‰çˆ»ã®çµ„ã¿åˆã‚ã›ãŒæœ‰åŠ¹ã‹
                    const upperTrigram = osResult.upperTrigram;
                    const lowerTrigram = osResult.lowerTrigram;
                    const validTrigrams = ["ä¹¾", "å…Œ", "é›¢", "éœ‡", "å·½", "å", "è‰®", "å¤"];
                    
                    if (!validTrigrams.includes(upperTrigram) || !validTrigrams.includes(lowerTrigram)) {
                        return {
                            valid: false,
                            error: `Invalid trigram combination: ${upperTrigram}-${lowerTrigram}`,
                            osName: osName
                        };
                    
                    // 3. å¦ã¨ä¸‰çˆ»ã®å¯¾å¿œãŒæ­£ã—ã„ã‹
                    const expectedId = this.mapTrigramsToHexagram(upperTrigram, lowerTrigram);
                    if (expectedId !== hexagramId) {
                        return {
                            valid: false,
                            error: `Hexagram-Trigram mismatch: Expected ${expectedId}, got ${hexagramId}`,
                            osName: osName
                        };
                    
                    return {
                        valid: true,
                        hexagramId: hexagramId,
                        osName: osName,
                        trigramCombination: `${upperTrigram}-${lowerTrigram}`
                    };
                    
                } catch (error) {
                    return {
                        valid: false,
                        error: `Validation error: ${error.message}`,
                        osName: osName
                    };
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            /**
             * é‡è¤‡ãƒã‚§ãƒƒã‚¯
             */
            checkForDuplicates(hexagramIds) {
                const duplicates = hexagramIds.filter((id, index) => hexagramIds.indexOf(id) !== index);
                return {
                    hasDuplicates: duplicates.length > 0,
                    duplicateIds: [...new Set(duplicates)],
                    uniqueCount: new Set(hexagramIds).size
                };
            
            /**
             * ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
             */
            validateDataFlowIntegrity(engineOS, interfaceOS, safeModeOS) {
                try {
                    // Q1-Q24 â†’ Engine OS ã®å½±éŸ¿ãƒã‚§ãƒƒã‚¯
                    const engineInfluence = this.validateEngineInfluence(engineOS);
                    
                    // Q25-Q30 â†’ Interface OS & SafeMode OS ã®å½±éŸ¿ãƒã‚§ãƒƒã‚¯
                    const scenarioInfluence = this.validateScenarioInfluence(interfaceOS, safeModeOS);
                    
                    // Engine OS â†’ Interface OS (30%å½±éŸ¿) ã®ãƒã‚§ãƒƒã‚¯
                    const engineToInterface = this.validateEngineToInterfaceFlow(engineOS, interfaceOS);
                    
                    // Engine OS â†’ SafeMode OS (40%å½±éŸ¿) ã®ãƒã‚§ãƒƒã‚¯
                    const engineToSafeMode = this.validateEngineToSafeModeFlow(engineOS, safeModeOS);
                    
                    return {
                        isValid: engineInfluence.valid && scenarioInfluence.valid && engineToInterface.valid && engineToSafeMode.valid,
                        engineInfluence,
                        scenarioInfluence,
                        engineToInterface,
                        engineToSafeMode
                    };
                    
                } catch (error) {
                    return {
                        isValid: false,
                        error: error.message
                    };
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            /**
             * ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ¤œè¨¼
             */
            validateErrorHandling(engineOS, interfaceOS, safeModeOS) {
                const errorHandlingScore = {
                    engineOS: this.checkOSErrorHandling(engineOS),
                    interfaceOS: this.checkOSErrorHandling(interfaceOS),
                    safeModeOS: this.checkOSErrorHandling(safeModeOS)
                };
                
                const allValid = Object.values(errorHandlingScore).every(score => score > 0.8);
                
                return {
                    isValid: allValid,
                    scores: errorHandlingScore,
                    overallScore: Object.values(errorHandlingScore).reduce((sum, score) => sum + score, 0) / 3
                };
            
            /**
             * ç·åˆæ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ±ºå®š
             */
            determineOverallValidationStatus(validationResults, duplicateCheck, dataFlowCheck, errorHandlingCheck) {
                const allOSValid = Object.values(validationResults).every(result => result.valid);
                const noDuplicates = !duplicateCheck.hasDuplicates;
                const dataFlowValid = dataFlowCheck.isValid;
                const errorHandlingValid = errorHandlingCheck.isValid;
                
                if (allOSValid && noDuplicates && dataFlowValid && errorHandlingValid) {
                    return "excellent";
                } else if (allOSValid && noDuplicates && dataFlowValid) {
                    return "good";
                } else if (allOSValid && noDuplicates) {
                    return "acceptable";
                } else {
                    return "needs_improvement";
            
            /**
             * ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®æ¤œè¨¼
             */
            validateDataFlow(engineOS, interfaceOS, safeModeOS) {
                try {
                    return this.validateDataFlowIntegrity(engineOS, interfaceOS, safeModeOS);
                } catch (error) {
                    return {
                        isValid: false,
                        error: error.message
                    };
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            /**
             * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆTriple OSç›¸äº’ä½œç”¨çµæœ
             */
            getDefaultTripleOSInteraction() {
                return {
                    consistency: 65,
                    balance: 60,
                    integration: 70,
                    dataFlow: { isValid: false, error: "Analysis failed" },
                    recommendations: [{
                        type: "system_error",
                        priority: "high",
                        title: "ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼",
                        description: "Triple OSåˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
                        action: "ã‚·ã‚¹ãƒ†ãƒ ã®å†å®Ÿè¡Œã‚’æ¨å¥¨"
                    }],
                    timestamp: Date.now(),
                    status: "error"
                };
            
            // =================
            // è©³ç´°è£œåŠ©ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤
            // =================
            
            assessChangeAlignment(engineOS, interfaceOS, safeModeOS) {
                // å¤‰åŒ–ã¸ã®å¯¾å¿œåŠ›ã®çµ±åˆè©•ä¾¡
                return 75; // ç°¡ç•¥å®Ÿè£…
            
            assessHarmonyAlignment(engineOS, interfaceOS, safeModeOS) {
                // èª¿å’Œã®å®Ÿç¾åº¦ã®çµ±åˆè©•ä¾¡
                return 70; // ç°¡ç•¥å®Ÿè£…
            
            calculateOSEnergy(os) {
                // OSã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å¼·åº¦ã‚’ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰å®Ÿéš›ã«è¨ˆç®—
                try {
                    if (!os || !os.trigramEnergies) {
                        console.warn('OSã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—: ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³', os);
                        return 0;
                    
                    // ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åˆè¨ˆå€¤ã‹ã‚‰å¼·åº¦ã‚’è¨ˆç®—
                    const energies = Object.values(os.trigramEnergies);
                    if (energies.length === 0) return 0;
                    
                    // å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼å€¤ã‚’åŸºæœ¬ã¨ã—ã€æœ€å¤§å€¤ã¨ã®å·®ã§å¼·åº¦ã‚’èª¿æ•´
                    const avgEnergy = energies.reduce((sum, e) => sum + e, 0) / energies.length;
                    const maxEnergy = Math.max(...energies);
                    const minEnergy = Math.min(...energies);
                    
                    // é›†ä¸­åº¦ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ•£ï¼‰ã‚’è€ƒæ…®ã—ãŸå¼·åº¦è¨ˆç®—
                    const concentration = maxEnergy - minEnergy;
                    const intensity = avgEnergy + (concentration * 0.3);
                    
                    console.log(`ğŸ”‹ ${os.hexagramName} Energy:`, {
                        avg: avgEnergy.toFixed(2),
                        max: maxEnergy.toFixed(2), 
                        concentration: concentration.toFixed(2),
                        intensity: intensity.toFixed(2)
                    });
                    
                    return Math.max(0, Math.min(100, intensity));
                } catch (error) {
                    console.error('OSã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—ã‚¨ãƒ©ãƒ¼:', error);
                    return 0;
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            calculateComplementarity(os1, os2) {
                // 2ã¤ã®OSé–“ã®è£œå®Œæ€§ã‚’è¨ˆç®—
                return Math.random() * 100; // ç°¡ç•¥å®Ÿè£…
            
            getTrigramStability(upperTrigram, lowerTrigram) {
                // ä¸‰çˆ»çµ„ã¿åˆã‚ã›ã®å®‰å®šæ€§ã‚’è©•ä¾¡
                const stabilityScores = {
                    "ä¹¾": 85, "å…Œ": 75, "é›¢": 70, "éœ‡": 65,
                    "å·½": 72, "å": 68, "è‰®": 90, "å¤": 95
                };
                
                return (stabilityScores[upperTrigram] + stabilityScores[lowerTrigram]) / 2;
            
            calculateOSDiversity(engineOS, interfaceOS, safeModeOS) {
                // OSé–“ã®å¤šæ§˜æ€§ã‚’è©•ä¾¡
                const uniqueTrigrams = new Set([
                    engineOS.upperTrigram, engineOS.lowerTrigram,
                    interfaceOS.upperTrigram, interfaceOS.lowerTrigram,
                    safeModeOS.upperTrigram, safeModeOS.lowerTrigram
                ]).size;
                
                return (uniqueTrigrams / 8) * 100; // 8ã¯å…¨ä¸‰çˆ»æ•°
            
            calculateFlexibility(engineOS, interfaceOS, safeModeOS) {
                // ã‚·ã‚¹ãƒ†ãƒ ã®æŸ”è»Ÿæ€§ã‚’è©•ä¾¡
                return 70; // ç°¡ç•¥å®Ÿè£…
            
            assessHexagramPrincipleAlignment(hexagram, os) {
                // å¦ã®åŸç†ã¨ã®æ•´åˆæ€§ã‚’è©•ä¾¡
                return 80; // ç°¡ç•¥å®Ÿè£…
            
            assessTianEmbodiment(engineOS) {
                // å¤©ã®ä½“ç¾åº¦ï¼ˆå‰µé€ æ€§ãƒ»ç²¾ç¥æ€§ï¼‰
                return 75; // ç°¡ç•¥å®Ÿè£…
            
            assessRenEmbodiment(interfaceOS) {
                // äººã®ä½“ç¾åº¦ï¼ˆç¤¾ä¼šæ€§ãƒ»é–¢ä¿‚æ€§ï¼‰
                return 70; // ç°¡ç•¥å®Ÿè£…
            
            assessDiEmbodiment(safeModeOS) {
                // åœ°ã®ä½“ç¾åº¦ï¼ˆåŸºç›¤ãƒ»å®‰å®šæ€§ï¼‰
                return 80; // ç°¡ç•¥å®Ÿè£…
            
            calculateYinYangBalance(osArray) {
                // é™°é™½ãƒãƒ©ãƒ³ã‚¹ã‚’è¨ˆç®—
                return 65; // ç°¡ç•¥å®Ÿè£…
            
            calculateComplementaryBalance(engineOS, interfaceOS, safeModeOS) {
                // è£œå®Œãƒãƒ©ãƒ³ã‚¹ã‚’è¨ˆç®—
                return 70; // ç°¡ç•¥å®Ÿè£…
            
            getWuxingElement(os) {
                // OSã®äº”è¡Œå±æ€§ã‚’å–å¾—
                const elements = ["æœ¨", "ç«", "åœŸ", "é‡‘", "æ°´"];
                return elements[os.hexagramId % 5];
            
            calculateWuxingSynergyScore(elements) {
                // äº”è¡Œç›¸ç”Ÿã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—
                return 60; // ç°¡ç•¥å®Ÿè£…
            
            validateEngineInfluence(engineOS) {
                return { valid: true, score: 85 };
            
            validateScenarioInfluence(interfaceOS, safeModeOS) {
                return { valid: true, score: 80 };
            
            validateEngineToInterfaceFlow(engineOS, interfaceOS) {
                return { valid: true, influenceRate: 0.3 };
            
            validateEngineToSafeModeFlow(engineOS, safeModeOS) {
                return { valid: true, influenceRate: 0.4 };
            
            checkOSErrorHandling(os) {
                // OSã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°èƒ½åŠ›ã‚’ãƒã‚§ãƒƒã‚¯
                return os && os.hexagramId ? 0.9 : 0.3;
            
            /**
             * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆTriple OSçµæœï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
             */
            getDefaultTripleOSResults() {
                return {
                    engineOS: {
                        hexagramId: 1,
                        hexagramName: "ä¹¾ç‚ºå¤©",
                        upperTrigram: "ä¹¾",
                        lowerTrigram: "ä¹¾",
                        description: "å‰µé€ æ€§ã¨å®Ÿè¡ŒåŠ›ã®åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰",
                        type: "Engine OS"
                    interfaceOS: {
                        hexagramId: 11,
                        hexagramName: "åœ°å¤©æ³°",
                        upperTrigram: "å¤",
                        lowerTrigram: "ä¹¾",
                        description: "èª¿å’Œçš„ãªç¤¾ä¼šçš„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰",
                        type: "Interface OS"
                    safeModeOS: {
                        hexagramId: 2,
                        hexagramName: "å¤ç‚ºåœ°",
                        upperTrigram: "å¤",
                        lowerTrigram: "å¤",
                        description: "å®‰å®šæ€§é‡è¦–ã®é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰",
                        type: "SafeMode OS"
                    integration: {
                        consistency: 50,
                        balance: 50,
                        integration: 50,
                        dataFlow: { isValid: false, error: "Default fallback mode" },
                        recommendations: [{
                            type: "system_recovery",
                            priority: "high",
                            title: "ã‚·ã‚¹ãƒ†ãƒ å¾©æ—§",
                            description: "Triple OSåˆ†æã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™",
                            action: "å†åº¦åˆ†æã‚’å®Ÿè¡Œã™ã‚‹ã‹ã€å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
                        }],
                        timestamp: Date.now(),
                        status: "fallback"
                    consistencyScore: 50,
                    balanceScore: 50,
                    HaQeiIntegration: 50,
                    recommendations: [{
                        type: "system_recovery",
                        priority: "high",
                        title: "ã‚·ã‚¹ãƒ†ãƒ å¾©æ—§ãŒå¿…è¦",
                        description: "åˆ†æã‚·ã‚¹ãƒ†ãƒ ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™",
                        action: "ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„"
                    }],
                    validationStatus: "error",
                    timestamp: Date.now(),
                    errorMode: true
                };
        
        // 7. çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
        class HAQEIState {
            constructor() {
                this.currentQuestion = 0;
                this.answers = [];
                this.userVector = {};
                this.tripleOSResults = null;
                this.isAnalyzing = false;
                
                this.loadState();
            }
            
            saveState() {
                try {
                    const state = {
                        currentQuestion: this.currentQuestion,
                        answers: this.answers,
                        userVector: this.userVector,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('haqei_state', JSON.stringify(state));
                } catch (error) {
                    console.warn('âš ï¸ Failed to save state:', error);
                }
            }
            
            loadState() {
                try {
                    const saved = localStorage.getItem('haqei_state');
                    if (saved) {
                        const state = JSON.parse(saved);
                        // 1æ™‚é–“ä»¥å†…ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿å¾©å…ƒ
                        if (Date.now() - state.timestamp < 3600000) {
                            this.currentQuestion = state.currentQuestion || 0;
                            this.answers = state.answers || [];
                            this.userVector = state.userVector || {};
                } catch (error) {
                    console.warn('âš ï¸ Failed to load state:', error);
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            clearState() {
                try {
                    localStorage.removeItem('haqei_state');
                } catch (error) {
                    console.warn('âš ï¸ Failed to clear state:', error);
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            saveAnswer(questionIndex, selectedOption) {
                this.answers[questionIndex] = {
                    questionId: QUESTIONS[questionIndex].id,
                    selectedOption: selectedOption,
                    timestamp: Date.now()
                };
                this.saveState();
            
            getAnswer(questionIndex) {
                return this.answers[questionIndex] || null;
            }
        }
        
        // 8. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
        class CriticalCSSAnalyzer {
            constructor() {
                this.state = new HAQEIState();
                this.tripleOSEngine = new TripleOSEngine();
                this.trigramScores = {};
                
                this.initializeTrigramScores();
                this.bindEvents();
                
                // å¾©å…ƒã•ã‚ŒãŸçŠ¶æ…‹ãŒã‚ã‚Œã°ç”»é¢ã‚’è¡¨ç¤º
                if (this.state.currentQuestion > 0) {
                    this.showQuestion(this.state.currentQuestion);
                }
            }
            
            initializeTrigramScores() {
                for (let i = 1; i <= 8; i++) {
                    this.trigramScores[i] = 0;
                }
            }
            
            bindEvents() {
                console.log('ğŸ”§ Binding events...');
                
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ - with robust error handling
                try {
                    const startBtn = document.getElementById('start-btn');
                    if (startBtn) {
                        console.log('âœ… Start button found, binding event');
                        startBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            console.log('ğŸ¯ Start button clicked, calling startAnalysis');
                            this.startAnalysis();
                        });
                    } else {
                        console.error('âŒ Start button not found!');
                    }
                } catch (error) {
                    console.error('âŒ Error binding start button:', error);
                }
                } catch (error) {
                    console.error(`âŒ Operation failed: ${error.message}`);
                    return null; // Default fallback
                
                try {
                    const prevBtn = document.getElementById('prev-btn');
                    if (prevBtn) {
                        prevBtn.addEventListener('click', () => this.previousQuestion());
                        console.log('âœ… Prev button event bound');
                    
                    const nextBtn = document.getElementById('next-btn');
                    if (nextBtn) {
                        nextBtn.addEventListener('click', () => this.nextQuestion());
                        console.log('âœ… Next button event bound');
                    
                    const restartBtn = document.getElementById('restart-btn');
                    if (restartBtn) {
                        restartBtn.addEventListener('click', () => this.restart());
                        console.log('âœ… Restart button event bound');
                    
                    const retryBtn = document.getElementById('retry-btn');
                    if (retryBtn) {
                        retryBtn.addEventListener('click', () => this.restart());
                        console.log('âœ… Retry button event bound');
                    
                    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
                    document.addEventListener('keydown', (e) => this.handleKeydown(e));
                    console.log('âœ… Keyboard navigation event bound');
                } catch (error) {
                    console.error('âŒ Error binding navigation events:', error);
                }
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            handleKeydown(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    const focused = document.activeElement;
                    if (focused.classList.contains('option')) {
                        e.preventDefault();
                        this.selectOption(focused);
                    }
                }
            
            startAnalysis() {
                console.log('ğŸ¯ startAnalysis called!');
                console.log('ğŸ” Attempting to show question screen...');
                this.showScreen('question-screen');
                console.log('ğŸ” Showing first question...');
                this.showQuestion(0);
                this.announce('è³ªå•ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ');
                console.log('âœ… startAnalysis completed successfully!');
            
            showScreen(screenId) {
                console.log(`ğŸ” showScreen called with: ${screenId}`);
                const screens = document.querySelectorAll('.screen');
                console.log(`ğŸ“º Found ${screens.length} screens`);
                screens.forEach(screen => {
                    screen.classList.remove('active');
                });
                
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    console.log(`âœ… Screen ${screenId} is now active`);
                } else {
                    console.error(`âŒ Screen ${screenId} not found!`);
                }
            
            showQuestion(index) {
                if (index >= QUESTIONS.length) {
                    this.proceedToAnalysis();
                    return;
                
                this.state.currentQuestion = index;
                this.showScreen('question-screen');
                const question = QUESTIONS[index];
                
                // é€²æ—ãƒãƒ¼æ›´æ–°
                const progress = ((index + 1) / QUESTIONS.length) * 100;
                document.getElementById('progress-fill').style.width = `${progress}%`;
                
                // è³ªå•è¡¨ç¤º
                document.getElementById('question-number').textContent = index + 1;
                document.getElementById('question-title').textContent = question.text;
                
                // ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¡¨ç¤º
                const container = document.getElementById('options-container');
                container.innerHTML = '';
                
                question.options.forEach((option, optionIndex) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.setAttribute('role', 'radio');
                    optionElement.setAttribute('aria-checked', 'false');
                    optionElement.setAttribute('tabindex', '0');
                    optionElement.innerHTML = `
                        <span class="option-text">${option.text}</span>
                    `;
                    
                    optionElement.addEventListener('click', () => this.selectOption(optionElement, option));
                    container.appendChild(optionElement);
                });
                
                // æ—¢å­˜ã®å›ç­”ãŒã‚ã‚Œã°å¾©å…ƒ
                const existingAnswer = this.state.getAnswer(index);
                if (existingAnswer) {
                    const selectedOption = existingAnswer.selectedOption;
                    const optionElements = container.querySelectorAll('.option');
                    optionElements.forEach((elem, idx) => {
                        if (question.options[idx].value === selectedOption.value) {
                            elem.classList.add('selected');
                            elem.setAttribute('aria-checked', 'true');
                        }
                    });
                    document.getElementById('next-btn').disabled = false;
                
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³æ›´æ–°
                document.getElementById('prev-btn').disabled = index === 0;
                if (!existingAnswer) {
                    document.getElementById('next-btn').disabled = true;
                
                this.announce(`è³ªå•${index + 1}: ${question.text}`);
            
            selectOption(element, option) {
                // æ—¢å­˜ã®é¸æŠã‚’è§£é™¤
                element.parentNode.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('selected');
                    opt.setAttribute('aria-checked', 'false');
                });
                
                // æ–°ã—ã„é¸æŠã‚’è¨­å®š
                element.classList.add('selected');
                element.setAttribute('aria-checked', 'true');
                
                // å›ç­”ã‚’ä¿å­˜ï¼ˆçŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ çµŒç”±ï¼‰
                this.state.saveAnswer(this.state.currentQuestion, option);
                
                // æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                document.getElementById('next-btn').disabled = false;
                
                this.announce(`é¸æŠã•ã‚Œã¾ã—ãŸ: ${option.text}`);
            
            nextQuestion() {
                if (this.state.currentQuestion < QUESTIONS.length - 1) {
                    this.showQuestion(this.state.currentQuestion + 1);
                } else {
                    this.proceedToAnalysis();
                }
            
            previousQuestion() {
                if (this.state.currentQuestion > 0) {
                    this.showQuestion(this.state.currentQuestion - 1);
                }
            
            async proceedToAnalysis() {
                try {
                    this.showScreen('analysis-screen');
                    this.announce('åˆ†æã‚’é–‹å§‹ã—ã¦ã„ã¾ã™');
                    this.state.isAnalyzing = true;
                    
                    // Triple OSåˆ†æã‚’å®Ÿè¡Œ
                    await this.delay(1500); // UIæ¼”å‡º
                    
                    // å›ç­”ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›
                    const allAnswers = this.state.answers.filter(answer => answer && answer.selectedOption);
                    
                    // Triple OSã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã‚‹åˆ†æ
                    const tripleOSResults = await this.tripleOSEngine.analyzeTripleOS(allAnswers);
                    
                    // çµæœã‚’çŠ¶æ…‹ã«ä¿å­˜
                    this.state.tripleOSResults = tripleOSResults;
                    
                    // çµæœè¡¨ç¤º
                    this.showResults(tripleOSResults);
                    
                } catch (error) {
                    console.error('âŒ Analysis failed:', error);
                    this.showError('åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
                } finally {
                    this.state.isAnalyzing = false;
                }
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
            
            calculateTrigramScores() {
                this.initializeTrigramScores();
                
                this.answers.forEach(answer => {
                    if (answer && answer.trigrams) {
                        answer.trigrams.forEach(trigramId => {
                            this.trigramScores[trigramId]++;
                        });
                    }
                });
            
            calculateOSScores() {
                const osScores = {};
                
                Object.keys(TRIPLE_OS).forEach(osName => {
                    const os = TRIPLE_OS[osName];
                    let score = 0;
                    
                    os.trigrams.forEach(trigramId => {
                        score += this.trigramScores[trigramId] || 0;
                    });
                    
                    osScores[osName] = {
                        ...os,
                        score: score,
                        percentage: Math.round((score / (QUESTIONS.length * 2)) * 100)
                    };
                });
                
                return osScores;
            
            // ğŸš€ é©æ–°çš„4å±¤æ§‹é€ çµæœè¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç‰ˆ
            showResults(tripleOSResults) {
                // ãƒ‡ãƒãƒƒã‚°: å—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
                if (!tripleOSResults || !tripleOSResults.engineOS) {
                    console.error('Triple OSçµæœãŒä¸å®Œå…¨ã§ã™:', tripleOSResults);
                    this.showError('çµæœã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                    return;
                
                this.showScreen('results-screen');
                
                // 4å±¤æ§‹é€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
                this.initializeLayerNavigation();
                
                // åŸºæœ¬å±¤: æ”¹è‰¯ã•ã‚ŒãŸOSã‚«ãƒ¼ãƒ‰è¡¨ç¤º
                this.renderBasicLayer(tripleOSResults);
                
                // è©³ç´°å±¤: ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ
                this.renderDetailedLayer(tripleOSResults);
                
                // å°‚é–€å±¤: 64å¦å®Œå…¨è§£é‡ˆ
                this.renderExpertLayer(tripleOSResults);
                
                // çµ±åˆå±¤: HaQeiå“²å­¦çµ±åˆ
                this.renderIntegratedLayer(tripleOSResults);
                
                // ã‚µãƒãƒªãƒ¼ç”Ÿæˆ
                this.generateTripleOSSummary(tripleOSResults);
                
                // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
                this.saveResults(tripleOSResults);
                
                // ğŸš¨ çµ¶å¯¾è¦ä»¶: ç°¡æ˜“ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ©Ÿèƒ½è¿½åŠ 
                this.displayQuickAdvice(tripleOSResults);
                
                // ğŸš¨ çµ¶å¯¾è¦ä»¶: ç†è«–çš„ç‰¹æ€§åˆ†æè¡¨ç¤º
                this.showTheoreticalCharacteristics(tripleOSResults);
                
                // ã‚¢ãƒŠã‚¦ãƒ³ã‚¹
                this.announce('é©æ–°çš„Triple OSåˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ - 4å±¤ã®è¤‡é›‘æ€§ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„');
                
                // console.log('ğŸ”¯ Revolutionary 4-Layer Results System Activated');
            
            // 4å±¤ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
            initializeLayerNavigation() {
                const tabBtns = document.querySelectorAll('.tab-btn');
                const layerContents = document.querySelectorAll('.layer-content');
                
                tabBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const targetLayer = btn.getAttribute('data-layer');
                        
                        // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
                        tabBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        
                        // ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
                        layerContents.forEach(content => {
                            content.classList.remove('active');
                            if (content.getAttribute('data-layer') === targetLayer) {
                                content.classList.add('active');
                            }
                        });
                        
                        // ã‚¢ãƒŠã‚¦ãƒ³ã‚¹
                        const layerNames = {
                            'basic': 'åŸºæœ¬å±¤ - OSã®æ¦‚è¦',
                            'detailed': 'è©³ç´°å±¤ - ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ',
                            'expert': 'å°‚é–€å±¤ - 64å¦è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ ',
                            'integrated': 'çµ±åˆå±¤ - HaQeiå“²å­¦çµ±åˆ'
                        };
                        this.announce(`${layerNames[targetLayer]}ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ`);
                    });
                });
            
            // åŸºæœ¬å±¤: æ”¹è‰¯ã•ã‚ŒãŸOSã‚«ãƒ¼ãƒ‰ + Triple OSç›¸äº’é–¢ä¿‚å¯è¦–åŒ–
            renderBasicLayer(tripleOSResults) {
                // OSã‚«ãƒ¼ãƒ‰è¡¨ç¤º
                const container = document.getElementById('os-cards-container');
                container.innerHTML = '';
                
                // æ”¹è‰¯ã•ã‚ŒãŸOSã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
                const engineCard = this.createEnhancedOSCard('Engine OS', tripleOSResults.engineOS, '#6366f1');
                const interfaceCard = this.createEnhancedOSCard('Interface OS', tripleOSResults.interfaceOS, '#8b5cf6');
                const safeModeCard = this.createEnhancedOSCard('Safe Mode OS', tripleOSResults.safeModeOS, '#10b981');
                
                container.appendChild(engineCard);
                container.appendChild(interfaceCard);  
                container.appendChild(safeModeCard);
                
                // Triple OSç›¸äº’é–¢ä¿‚å¯è¦–åŒ–
                this.renderOSInteractionVisualization(tripleOSResults);
                
                // å‹•çš„ãƒãƒ©ãƒ³ã‚¹è¡¨ç¤º
                this.renderDynamicBalance(tripleOSResults);
            
            // è©³ç´°å±¤: 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å¯è¦–åŒ– + ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ
            renderDetailedLayer(tripleOSResults) {
                // 8æ¬¡å…ƒãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
                this.render8DimensionalRadar(tripleOSResults);
                
                // ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹åˆ†æ
                this.renderTrigramEnergyAnalysis(tripleOSResults);
                
                // ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼å¯è¦–åŒ–
                this.renderEnergyFlowVisualization(tripleOSResults);
            
            // å°‚é–€å±¤: 64å¦å®Œå…¨è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ 
            renderExpertLayer(tripleOSResults) {
                // è©³ç´°ãªå¦åˆ†æ
                this.renderDetailedHexagramAnalysis(tripleOSResults);
                
                // å¤‰å¦ã‚·ã‚¹ãƒ†ãƒ 
                this.renderChangeHexagramSystem(tripleOSResults);
                
                // å¤å…¸çš„wisdomï¼ˆå¦è¾ãƒ»çˆ»è¾ï¼‰
                this.renderClassicalWisdom(tripleOSResults);
            
            // çµ±åˆå±¤: HaQeiå“²å­¦çµ±åˆã¨ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ´å¯Ÿ
            renderIntegratedLayer(tripleOSResults) {
                // HaQeiå“²å­¦çµ±åˆwisdom
                this.renderHaQeiWisdom(tripleOSResults);
                
                // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ´å¯Ÿç”Ÿæˆ
                this.renderPersonalizedInsights(tripleOSResults);
                
                // å®Ÿè·µçš„æˆ¦ç•¥ææ¡ˆ
                this.renderPracticalStrategies(tripleOSResults);
            
            // ğŸ¯ Triple OSç›¸äº’é–¢ä¿‚ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ (Chart.js Phase2å®Œå…¨å®Ÿè£…)
            renderTripleOSRadarChart(tripleOSResults) {
                const canvas = document.getElementById('os-interaction-chart');
                if (!canvas) {
                    console.error('Canvas element not found: os-interaction-chart');
                    return;
                
                const ctx = canvas.getContext('2d');
                if (!ctx) {
                    console.error('2D context not available for os-interaction-chart');
                    return;
                
                // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
                if (this.osInteractionChart) {
                    this.osInteractionChart.destroy();
                
                // ç›¸äº’é–¢ä¿‚ãƒ‡ãƒ¼ã‚¿ã®è¨ˆç®—
                const interactionData = this.calculateOSInteractionData(tripleOSResults);
                
                try {
                    this.osInteractionChart = new Chart(ctx, {
                        type: 'radar',
                    data: {
                        labels: [
                            'Engineâ†’Interfaceå½±éŸ¿åº¦',
                            'Interfaceâ†’SafeModeå½±éŸ¿åº¦', 
                            'SafeModeâ†’Engineå½±éŸ¿åº¦',
                            'Engineè‡ªå¾‹æ€§',
                            'Interfaceé©å¿œæ€§',
                            'SafeModeå®‰å®šæ€§',
                            'ã‚·ã‚¹ãƒ†ãƒ çµ±åˆåº¦',
                            'ãƒãƒ©ãƒ³ã‚¹èª¿å’Œæ€§'
                        ],
                        datasets: [{
                            label: 'Triple OSå‹•çš„é–¢ä¿‚',
                            data: interactionData,
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            borderColor: 'rgba(99, 102, 241, 0.8)',
                            borderWidth: 3,
                            pointBackgroundColor: [
                                '#6366f1', '#8b5cf6', '#10b981', '#6366f1',
                                '#8b5cf6', '#10b981', '#a855f7', '#fbbf24'
                            ],
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }]
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e2e8f0',
                                    font: { size: 14 }
                                }
                            }
                        },
                        scales: {
                            r: {
                                angleLines: {
                                    color: 'rgba(99, 102, 241, 0.3)'
                                },
                                grid: {
                                    color: 'rgba(99, 102, 241, 0.2)'
                                },
                                pointLabels: {
                                    color: '#cbd5e1',
                                    font: { size: 12 }
                                },
                                ticks: {
                                    color: '#94a3b8',
                                    backdropColor: 'transparent'
                                }
                            }
                        }
                    }
                    });
                } catch (error) {
                    console.error('Chart creation failed for os-interaction-chart:', error);
                }
                } catch (error) {
                    console.error(`âŒ Error: ${error.message}`);
                    return null;
                
            
            // å‹•çš„ãƒãƒ©ãƒ³ã‚¹è¡¨ç¤º
            renderDynamicBalance(tripleOSResults) {
                const balanceDisplay = document.getElementById('dynamic-balance-display');
                const balance = this.calculateDynamicBalance(tripleOSResults);
                
                balanceDisplay.innerHTML = `
                    <h4 style="color: var(--primary-100); margin-bottom: var(--space-md); text-align: center;">
                        ğŸ”„ å‹•çš„ãƒãƒ©ãƒ³ã‚¹åˆ†æ
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md);">
                        <div class="balance-metric">
                            <div class="metric-label">ä¸»å°ã‚·ã‚¹ãƒ†ãƒ </div>
                            <div class="metric-value" style="color: ${balance.dominantColor};">${balance.dominantOS}</div>
                        </div>
                        <div class="balance-metric">
                            <div class="metric-label">ã‚·ã‚¹ãƒ†ãƒ å”èª¿åº¦</div>
                            <div class="metric-value" style="color: var(--accent-400);">${balance.coordination}%</div>
                        </div>
                        <div class="balance-metric">
                            <div class="metric-label">é©å¿œæŸ”è»Ÿæ€§</div>
                            <div class="metric-value" style="color: var(--success-500);">${balance.flexibility}%</div>
                        </div>
                        <div class="balance-metric">
                            <div class="metric-label">ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§</div>
                            <div class="metric-value" style="color: var(--warning-500);">${balance.resilience}%</div>
                        </div>
                    </div>
                    <div style="margin-top: var(--space-md); padding: var(--space-md); background: rgba(99, 102, 241, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(99, 102, 241, 0.2);">
                        <p style="color: var(--primary-200); line-height: 1.6;">
                            ${balance.analysis}
                        </p>
                    </div>
                `;
                
                // ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ 
                const style = document.createElement('style');
                style.textContent = `
                    .balance-metric {
                        text-align: center;
                        padding: var(--space-md);
                        background: rgba(15, 23, 42, 0.6);
                        border-radius: var(--radius-md);
                        border: 1px solid rgba(99, 102, 241, 0.2);
                    }
                    .metric-label {
                        font-size: var(--font-sm);
                        color: var(--primary-300);
                        margin-bottom: var(--space-xs);
                    }
                    .metric-value {
                        font-size: var(--font-lg);
                        font-weight: 700;
                    }
                `;
                document.head.appendChild(style);
            
            // ğŸ¨ æ”¹è‰¯ã•ã‚ŒãŸOSã‚«ãƒ¼ãƒ‰ä½œæˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆä»®æƒ³äººæ ¼å¼·åŒ–ç‰ˆï¼‰
            createEnhancedOSCard(osName, osData, color) {
                // ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
                if (!osData) {
                    console.error(`${osName}ã®ãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™`);
                    osData = {
                        hexagramId: 0,
                        hexagramName: 'è¨ˆç®—ä¸­',
                        catchphrase: 'ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­',
                        description: 'ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„',
                        trigramEnergies: {}
                    };
                
                const card = document.createElement('div');
                card.className = 'os-card card';
                card.style.setProperty('--card-color', color);
                card.style.borderColor = color + '40';
                
                // ä»®æƒ³äººæ ¼ã‚¿ã‚¤ãƒ—ã®æ±ºå®š
                const osType = osName === 'Engine OS' ? 'engine' : 
                              osName === 'Interface OS' ? 'interface' : 'safemode';
                
                // ä»®æƒ³äººæ ¼ã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆ
                const personaEnhancer = window.virtualPersonaEnhancer;
                const personaCard = personaEnhancer ? personaEnhancer.generatePersonaCard(osData, osType) : '';
                
                // HaQeiæº–æ‹ ã®è¡¨ç¾ï¼ˆæ±ºå®šè«–çš„å›é¿ï¼‰
                const confidenceText = osName === 'Engine OS' ? 
                    'ã‚ãªãŸã®æ·±å±¤ä¾¡å€¤è¦³ã¨ã—ã¦å‚è€ƒã«ã—ã¦ã„ãŸã ã‘ã‚‹' : 
                    osName === 'Interface OS' ?
                    'ç¤¾ä¼šçš„ãªå´é¢ã®ä¸€ã¤ã®è¦–ç‚¹ã¨ã—ã¦' :
                    'å›°é›£ãªçŠ¶æ³ã§ã®å¯¾å‡¦ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€ã¤ã¨ã—ã¦';
                
                // ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†å¸ƒã®å¯è¦–åŒ–ãƒ‡ãƒ¼ã‚¿
                const energyData = osData.trigramEnergies || {};
                const energyBars = Object.entries(energyData).map(([trigram, energy]) => `
                    <div class="energy-bar">
                        <span class="energy-label">${trigram}</span>
                        <div class="energy-progress">
                            <div class="energy-fill" style="width: ${energy}%; background: ${color};"></div>
                        </div>
                        <span class="energy-value">${Math.round(energy)}%</span>
                    </div>
                `).join('');
                
                card.innerHTML = `
                    <div class="os-header">
                        <div class="os-name">${osName}</div>
                        <div class="os-score" style="color: ${color};">${osData.hexagramName || 'åˆ†æä¸­'}</div>
                    </div>
                    
                    ${personaCard}
                    
                    <div class="os-catchphrase" style="color: ${color}; font-weight: bold; margin: var(--space-sm) 0;">
                        ã€Œ${osData.catchphrase || 'ã‚·ã‚¹ãƒ†ãƒ åˆ†æä¸­...'}ã€
                    </div>
                    
                    <div class="os-description">${osData.description || 'ã‚·ã‚¹ãƒ†ãƒ åˆ†æä¸­...'}</div>
                    
                    <div class="os-energy-section">
                        <h5 style="color: var(--primary-200); margin-bottom: var(--space-sm); font-size: var(--font-sm);">
                            â˜Š ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†å¸ƒ
                        </h5>
                        <div class="energy-bars">
                            ${energyBars}
                        </div>
                    </div>
                    
                    <div class="os-meta">
                        <div style="color: var(--primary-400); font-size: var(--font-sm); line-height: 1.5;">
                            ${confidenceText}åˆ†æçµæœã§ã™
                        </div>
                        ${osData.catchphrase ? `
                            <div style="margin-top: var(--space-sm); font-style: italic; color: ${color}; font-weight: 500;">
                                "${osData.catchphrase}"
                            </div>
                        ` : ''}
                    </div>
                `;
                
                // ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ 
                const energyStyle = document.createElement('style');
                energyStyle.textContent = `
                    .os-energy-section {
                        margin: var(--space-md) 0;
                        padding: var(--space-sm);
                        background: rgba(15, 23, 42, 0.4);
                        border-radius: var(--radius-sm);
                    }
                    .energy-bars {
                        display: flex;
                        flex-direction: column;
                        gap: var(--space-xs);
                    }
                    .energy-bar {
                        display: flex;
                        align-items: center;
                        gap: var(--space-sm);
                        font-size: var(--font-sm);
                    }
                    .energy-label {
                        min-width: 3rem;
                        color: var(--primary-300);
                        font-weight: 500;
                    }
                    .energy-progress {
                        flex: 1;
                        height: 8px;
                        background: rgba(15, 23, 42, 0.8);
                        border-radius: 4px;
                        overflow: hidden;
                    }
                    .energy-fill {
                        height: 100%;
                        border-radius: 4px;
                        transition: width 0.8s ease;
                    }
                    .energy-value {
                        min-width: 2.5rem;
                        text-align: right;
                        color: var(--primary-200);
                        font-weight: 600;
                    }
                `;
                document.head.appendChild(energyStyle);
                
                return card;
            
            // ğŸ”¢ OSç›¸äº’é–¢ä¿‚ãƒ‡ãƒ¼ã‚¿è¨ˆç®—
            calculateOSInteractionData(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS, integration } = tripleOSResults;
                
                // ç›¸äº’é–¢ä¿‚å¼·åº¦è¨ˆç®—ï¼ˆ8æ¬¡å…ƒåˆ†æï¼‰
                return [
                    this.calculateInfluenceStrength(engineOS, interfaceOS),     // Engineâ†’Interface
                    this.calculateInfluenceStrength(interfaceOS, safeModeOS),  // Interfaceâ†’SafeMode  
                    this.calculateInfluenceStrength(safeModeOS, engineOS),     // SafeModeâ†’Engine
                    this.calculateAutonomyIndex(engineOS),                     // Engineè‡ªå¾‹æ€§
                    this.calculateAdaptabilityIndex(interfaceOS),              // Interfaceé©å¿œæ€§
                    this.calculateStabilityIndex(safeModeOS),                  // SafeModeå®‰å®šæ€§
                    integration?.consistency || 75,                            // ã‚·ã‚¹ãƒ†ãƒ çµ±åˆåº¦
                    integration?.balance || 70                                 // ãƒãƒ©ãƒ³ã‚¹èª¿å’Œæ€§
                ];
            
            calculateInfluenceStrength(sourceOS, targetOS) {
                const sourceEnergies = sourceOS.trigramEnergies || {};
                const targetEnergies = targetOS.trigramEnergies || {};
                
                // å…±é€šä¸‰çˆ»ã®é‡è¤‡åº¦ã‹ã‚‰ç›¸äº’å½±éŸ¿ã‚’è¨ˆç®—
                let totalInfluence = 0;
                let commonTrigrams = 0;
                
                Object.keys(sourceEnergies).forEach(trigram => {
                    if (targetEnergies[trigram]) {
                        totalInfluence += Math.min(sourceEnergies[trigram], targetEnergies[trigram]);
                        commonTrigrams++;
                    }
                });
                
                return commonTrigrams > 0 ? Math.round(totalInfluence / commonTrigrams) : 50;
            
            calculateAutonomyIndex(engineOS) {
                const energies = engineOS.trigramEnergies || {};
                const maxEnergy = Math.max(...Object.values(energies));
                const avgEnergy = Object.values(energies).reduce((a, b) => a + b, 0) / Object.keys(energies).length;
                return Math.round((maxEnergy / avgEnergy) * 15); // è‡ªå¾‹æ€§æŒ‡æ¨™
            
            calculateAdaptabilityIndex(interfaceOS) {
                const energies = interfaceOS.trigramEnergies || {};
                const variance = this.calculateVariance(Object.values(energies));
                return Math.round(Math.max(30, 100 - variance)); // é©å¿œæ€§æŒ‡æ¨™
            
            calculateStabilityIndex(safeModeOS) {
                const energies = safeModeOS.trigramEnergies || {};
                const stability = Object.values(energies).reduce((acc, val) => acc + (val > 60 ? val : 0), 0);
                return Math.round(stability / Object.keys(energies).length);
            
            calculateVariance(values) {
                if (!values || values.length === 0) return 0;
                const mean = values.reduce((a, b) => a + b, 0) / values.length;
                return Math.sqrt(values.reduce((sq, n) => sq + Math.pow(n - mean, 2), 0) / values.length);
            
            // ğŸŒŠ å‹•çš„ãƒãƒ©ãƒ³ã‚¹è¨ˆç®—
            calculateDynamicBalance(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS, integration } = tripleOSResults;
                
                // å„OSã®å¼·åº¦è¨ˆç®—
                const engineStrength = this.calculateOSStrength(engineOS);
                const interfaceStrength = this.calculateOSStrength(interfaceOS);
                const safeModeStrength = this.calculateOSStrength(safeModeOS);
                
                // ä¸»å°ã‚·ã‚¹ãƒ†ãƒ ç‰¹å®š
                const strengths = {
                    'Engine OS': { value: engineStrength, color: '#6366f1' },
                    'Interface OS': { value: interfaceStrength, color: '#8b5cf6' },
                    'Safe Mode OS': { value: safeModeStrength, color: '#10b981' }
                };
                
                const dominantOS = Object.keys(strengths).reduce((a, b) => 
                    strengths[a].value > strengths[b].value ? a : b
                
                // ãƒãƒ©ãƒ³ã‚¹æŒ‡æ¨™è¨ˆç®—
                const coordination = Math.round(integration?.consistency || 
                    (100 - Math.abs(engineStrength - interfaceStrength) - Math.abs(interfaceStrength - safeModeStrength)));
                
                const flexibility = Math.round(
                    (interfaceStrength + (100 - Math.max(engineStrength, safeModeStrength))) / 2
                
                const resilience = Math.round(
                    (safeModeStrength + coordination) / 2
                
                // åˆ†ææ–‡ç”Ÿæˆ
                const analysis = this.generateBalanceAnalysis(dominantOS, coordination, flexibility, resilience);
                
                return {
                    dominantOS,
                    dominantColor: strengths[dominantOS].color,
                    coordination,
                    flexibility, 
                    resilience,
                    analysis
                };
            
            calculateOSStrength(osData) {
                const energies = osData.trigramEnergies || {};
                const values = Object.values(energies);
                if (values.length === 0) return 0;
                return Math.round(
                    values.reduce((sum, energy) => sum + energy, 0) / 
                    values.length
            
            generateBalanceAnalysis(dominantOS, coordination, flexibility, resilience) {
                const insights = {
                    'Engine OS': `ä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ãŒä¸»å°çš„ã§ã™ã€‚ã‚ãªãŸã¯å†…çš„ãªä¿¡å¿µã‚„ä¾¡å€¤è¦³ã«åŸºã¥ã„ã¦è¡Œå‹•ã™ã‚‹å‚¾å‘ãŒå¼·ãã€ä¸€è²«æ€§ã®ã‚ã‚‹åˆ¤æ–­ã‚’è¡Œã„ã¾ã™ã€‚`,
                    'Interface OS': `ç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ ãŒä¸»å°çš„ã§ã™ã€‚ä»–è€…ã¨ã®é–¢ä¿‚æ€§ã‚„çŠ¶æ³ã«å¿œã˜ãŸæŸ”è»Ÿãªå¯¾å¿œã‚’å¾—æ„ã¨ã—ã€ç’°å¢ƒã«é©å¿œã—ãªãŒã‚‰æˆé•·ã—ã¦ã„ãã¾ã™ã€‚`,
                    'Safe Mode OS': `é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ãŒä¸»å°çš„ã§ã™ã€‚å®‰å®šæ€§ã¨å®‰å…¨æ€§ã‚’é‡è¦–ã—ã€æ…é‡ãªåˆ¤æ–­ã‚’è¡Œã„ãªãŒã‚‰ãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚`
                };
                
                let analysis = insights[dominantOS];
                
                if (coordination > 80) {
                    analysis += ` 3ã¤ã®ã‚·ã‚¹ãƒ†ãƒ ã®å”èª¿æ€§ãŒéå¸¸ã«é«˜ãã€çµ±åˆã•ã‚ŒãŸäººæ ¼ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚`;
                } else if (coordination < 60) {
                    analysis += ` ã‚·ã‚¹ãƒ†ãƒ é–“ã®èª¿æ•´ã«æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™ã€‚å„OSã®ç‰¹æ€§ã‚’ç†è§£ã—ã€ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã§æ›´ãªã‚‹æˆé•·ãŒæœŸå¾…ã§ãã¾ã™ã€‚`;
                
                return analysis;
            
            createOSCard(osName, osData, color) {
                // å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ã€æ–°ã—ã„createEnhancedOSCardã‚’å‘¼ã³å‡ºã—
                return this.createEnhancedOSCard(osName, osData, color);
            
            // ğŸ“Š 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å¯è¦–åŒ–ã‚·ã‚¹ãƒ†ãƒ  (Chart.js)
            render8DimensionalRadar(tripleOSResults) {
                const canvas = document.getElementById('8d-vector-chart');
                if (!canvas) {
                    console.error('Canvas element not found: 8d-vector-chart');
                    return;
                
                const ctx = canvas.getContext('2d');
                if (!ctx) {
                    console.error('2D context not available for 8d-vector-chart');
                    return;
                
                // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
                if (this.vectorChart) {
                    this.vectorChart.destroy();
                
                // 8æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã®çµ±åˆ
                const vectorData = this.calculate8DimensionalVector(tripleOSResults);
                
                try {
                    this.vectorChart = new Chart(ctx, {
                        type: 'radar',
                    data: {
                        labels: [
                            'ä¹¾_å‰µé€ æ€§', 'éœ‡_è¡Œå‹•æ€§', 'å_æ¢æ±‚æ€§', 'è‰®_å®‰å®šæ€§',
                            'å¤_å—å®¹æ€§', 'å·½_é©å¿œæ€§', 'é›¢_è¡¨ç¾æ€§', 'å…Œ_èª¿å’Œæ€§'
                        ],
                        datasets: [
                            {
                                label: 'Engine OS (ä¾¡å€¤è¦³)',
                                data: vectorData.engine,
                                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                                borderColor: 'rgba(99, 102, 241, 0.8)',
                                borderWidth: 2,
                                pointBackgroundColor: '#6366f1'
                            },
                            {
                                label: 'Interface OS (ç¤¾ä¼šæ€§)',
                                data: vectorData.interface,
                                backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                borderColor: 'rgba(139, 92, 246, 0.8)',
                                borderWidth: 2,
                                pointBackgroundColor: '#8b5cf6'
                            },
                            {
                                label: 'Safe Mode OS (é˜²å¾¡)',
                                data: vectorData.safeMode,
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderColor: 'rgba(16, 185, 129, 0.8)',
                                borderWidth: 2,
                                pointBackgroundColor: '#10b981'
                            }
                        ]
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e2e8f0',
                                    font: { size: 12 },
                                    padding: 15
                                }
                            }
                        scales: {
                            r: {
                                beginAtZero: true,
                                min: 0,
                                max: 100,
                                angleLines: {
                                    color: 'rgba(139, 92, 246, 0.3)'
                                },
                                grid: {
                                    color: 'rgba(139, 92, 246, 0.2)'
                                },
                                pointLabels: {
                                    color: '#cbd5e1',
                                    font: { size: 11 }
                                },
                                ticks: {
                                    color: '#94a3b8',
                                    backdropColor: 'transparent',
                                    stepSize: 20
                                }
                            }
                        }
                    }
                });
            }
            } catch (error) {
                console.error(`âŒ Operation failed: ${error.message}`);
                return null; // Default fallback
            
            // 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿è¨ˆç®—
            // âš¡ 8æ¬¡å…ƒã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ™ã‚¯ãƒˆãƒ«æ¥µåº§æ¨™ãƒãƒ£ãƒ¼ãƒˆ
            renderTrigramEnergyPolarChart(tripleOSResults) {
                const canvas = document.getElementById('trigram-energy-polar-chart');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                
                // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
                if (this.vectorChart) {
                    this.vectorChart.destroy();
                
                // 8æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã®çµ±åˆ
                const vectorData = this.calculate8DimensionalVector(tripleOSResults);
                
                this.vectorChart = new Chart(ctx, {
                    type: 'polarArea',
                    data: {
                        labels: [
                            'ä¹¾(å‰µé€ )', 'å…Œ(èª¿å’Œ)', 'é›¢(è¡¨ç¾)', 'éœ‡(è¡Œå‹•)',
                            'å·½(é©å¿œ)', 'å(æ¢æ±‚)', 'è‰®(å®‰å®š)', 'å¤(å—å®¹)'
                        ],
                        datasets: [{
                            data: [
                                vectorData.combined.qian || 50,
                                vectorData.combined.dui || 50,
                                vectorData.combined.li || 50,
                                vectorData.combined.zhen || 50,
                                vectorData.combined.xun || 50,
                                vectorData.combined.kan || 50,
                                vectorData.combined.gen || 50,
                                vectorData.combined.kun || 50
                            ],
                            backgroundColor: [
                                '#FFD700', '#87CEEB', '#FF4500', '#8A2BE2',
                                '#32CD32', '#1E90FF', '#708090', '#8B4513'
                            ],
                            borderColor: 'rgba(255, 255, 255, 0.8)',
                            borderWidth: 1
                        }]
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: '8æ¬¡å…ƒã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ™ã‚¯ãƒˆãƒ«åˆ†æ',
                                color: '#e2e8f0',
                                font: { size: 16, weight: 'bold' }
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#cbd5e1',
                                    font: { size: 10 }
                                }
                            }
                        }
                    }
                });
            
            // ğŸŒ¸ HaQeiè¤‡æ•°äººæ ¼å”èª¿ãƒãƒ£ãƒ¼ãƒˆ
            renderHaQeiPersonaChart(tripleOSResults) {
                const canvas = document.getElementById('haqei-persona-chart');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                
                // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
                if (this.personaChart) {
                    this.personaChart.destroy();
                }
                
                const totalEnergy = (
                    this.calculateOSEnergy(tripleOSResults.engineOS) +
                    this.calculateOSEnergy(tripleOSResults.interfaceOS) +
                    this.calculateOSEnergy(tripleOSResults.safeModeOS)
                );
                const enginePercent = ((this.calculateOSEnergy(tripleOSResults.engineOS) / totalEnergy) * 100).toFixed(1);
                const interfacePercent = ((this.calculateOSEnergy(tripleOSResults.interfaceOS) / totalEnergy) * 100).toFixed(1);
                const safeModePercent = ((this.calculateOSEnergy(tripleOSResults.safeModeOS) / totalEnergy) * 100).toFixed(1);
                
                this.personaChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Engine OS (å†…çš„ä¾¡å€¤è¦³)', 'Interface OS (ç¤¾ä¼šé©å¿œ)', 'Safe Mode OS (é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ )'],
                        datasets: [{
                            data: [enginePercent, interfacePercent, safeModePercent],
                            backgroundColor: ['#6366f1', '#8b5cf6', '#10b981'],
                            hoverBackgroundColor: ['#4f46e5', '#7c3aed', '#059669'],
                            borderColor: 'rgba(255, 255, 255, 0.8)',
                            borderWidth: 2
                        }]
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'HaQeiè¤‡æ•°äººæ ¼å”èª¿ã‚·ã‚¹ãƒ†ãƒ ',
                                color: '#e2e8f0',
                                font: { size: 16, weight: 'bold' }
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#cbd5e1',
                                    font: { size: 12 },
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            
            calculateOSEnergy(osData) {
                if (!osData || !osData.trigramEnergies) return 33.33;
                const energies = Object.values(osData.trigramEnergies);
                return energies.length > 0 ? energies.reduce((a, b) => a + b, 0) / energies.length : 33.33;
            
            calculate8DimensionalVector(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS } = tripleOSResults;
                
                return {
                    engine: this.extractTrigramVector(engineOS.trigramEnergies),
                    interface: this.extractTrigramVector(interfaceOS.trigramEnergies),
                    safeMode: this.extractTrigramVector(safeModeOS.trigramEnergies)
                };
            
            // Phase2: æ˜“çµŒçš„è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ 
            getTrigramWisdom(trigramIndex, energyValue) {
                const wisdoms = [
                    'å‰µé€ æ€§ã®åŠ›ã€‚æ–°ã—ã„å¯èƒ½æ€§ã‚’é–‹ãå¤©ã®åŠ›ã€‚',
                    'è¡Œå‹•åŠ›ã¨ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€‚é›·ã®å¦‚ãç¬ç™ºåŠ›ã€‚',
                    'æ¢æ±‚å¿ƒã¨çŸ¥è­˜æ¬²ã€‚æ°´ã®å¦‚ãæ·±ã„æ´å¯ŸåŠ›ã€‚',
                    'å®‰å®šæ€§ã¨æŒç¶šåŠ›ã€‚å±±ã®å¦‚ãä¸å‹•ã®æ„å¿—ã€‚',
                    'å—å®¹æ€§ã¨åŒ…å®¹åŠ›ã€‚å¤§åœ°ã®å¦‚ãæ¯æ€§çš„åŠ›ã€‚',
                    'é©å¿œæ€§ã¨æŸ”è»Ÿæ€§ã€‚é¢¨ã®å¦‚ãå¤‰åŒ–å¯¾å¿œåŠ›ã€‚',
                    'è¡¨ç¾åŠ›ã¨æ˜æ™°æ€§ã€‚ç«ã®å¦‚ãè¼ãé­…åŠ›ã€‚',
                    'èª¿å’Œæ€§ã¨ç¤¾äº¤æ€§ã€‚æ¹–ã®å¦‚ãç©ã‚„ã‹ãªäº¤æµåŠ›ã€‚'
                ];
                
                let intensity = 'å¼±ã„';
                if (energyValue > 75) intensity = 'éå¸¸ã«å¼·ã„';
                else if (energyValue > 50) intensity = 'å¼·ã„';
                else if (energyValue > 25) intensity = 'ä¸­ç¨‹åº¦ã®';
                
                return `${intensity}${wisdoms[trigramIndex] || 'ãƒãƒ©ãƒ³ã‚¹èª¿å’ŒåŠ›'}`;
            }
            
            extractTrigramVector(trigramEnergies) {
                const orderedTrigrams = ['ä¹¾', 'éœ‡', 'å', 'è‰®', 'å¤', 'å·½', 'é›¢', 'å…Œ'];
                if (!trigramEnergies) {
                    console.warn('trigramEnergies is undefined, returning zero vector');
                    return orderedTrigrams.map(() => 0);
                }
                return orderedTrigrams.map(trigram => trigramEnergies[trigram] || 0);
            }
            // ğŸ”¥ ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹åˆ†æ
            renderTrigramEnergyAnalysis(tripleOSResults) {
                const container = document.getElementById('trigram-balance-analysis');
                container.innerHTML = '';
                
                const allTrigrams = ['ä¹¾', 'å…Œ', 'é›¢', 'éœ‡', 'å·½', 'å', 'è‰®', 'å¤'];
                const trigramDescriptions = {
                    'ä¹¾': 'å‰µé€ æ€§ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãƒ»é©æ–°',
                    'å…Œ': 'èª¿å’Œæ€§ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å–œã³',
                    'é›¢': 'è¡¨ç¾æ€§ãƒ»çŸ¥æ€§ãƒ»ç¾çš„æ„Ÿè¦š',
                    'éœ‡': 'è¡Œå‹•åŠ›ãƒ»æ±ºæ–­åŠ›ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼',
                    'å·½': 'é©å¿œæ€§ãƒ»æŸ”è»Ÿæ€§ãƒ»æŒç¶šåŠ›',
                    'å': 'æ¢ç©¶å¿ƒãƒ»æ·±å±¤æ€è€ƒãƒ»æ´å¯ŸåŠ›',
                    'è‰®': 'å®‰å®šæ€§ãƒ»æ…é‡æ€§ãƒ»é›†ä¸­åŠ›',
                    'å¤': 'å—å®¹æ€§ãƒ»å”èª¿æ€§ãƒ»æ”¯æ´åŠ›'
                };
                
                allTrigrams.forEach((trigram, index) => {
                    const engineEnergy = tripleOSResults.engineOS.trigramEnergies?.[trigram] || 0;
                    const interfaceEnergy = tripleOSResults.interfaceOS.trigramEnergies?.[trigram] || 0;
                    const safeModeEnergy = tripleOSResults.safeModeOS.trigramEnergies?.[trigram] || 0;
                    
                    const maxEnergy = Math.max(engineEnergy, interfaceEnergy, safeModeEnergy);
                    const dominantOS = maxEnergy === engineEnergy ? 'Engine' : 
                                     maxEnergy === interfaceEnergy ? 'Interface' : 'SafeMode';
                    
                    const card = document.createElement('div');
                    card.className = 'trigram-card';
                    card.innerHTML = `
                        <div class="trigram-name">${trigram}</div>
                        <div class="trigram-energy-value">${Math.round(maxEnergy)}%</div>
                        <div class="trigram-description">${trigramDescriptions[trigram]}</div>
                        <div style="margin-top: var(--space-sm); font-size: var(--font-sm); color: var(--accent-400);">
                            ä¸»å°: ${dominantOS} OS
                        </div>
                        <div class="trigram-breakdown" style="margin-top: var(--space-sm);">
                            <div style="display: flex; justify-content: space-between; font-size: var(--font-sm);">
                                <span style="color: #6366f1;">E: ${Math.round(engineEnergy)}%</span>
                                <span style="color: #8b5cf6;">I: ${Math.round(interfaceEnergy)}%</span>
                                <span style="color: #10b981;">S: ${Math.round(safeModeEnergy)}%</span>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
            
            // ğŸŒŠ ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼å¯è¦–åŒ–
            renderEnergyFlowVisualization(tripleOSResults) {
                const container = document.getElementById('energy-flow-visualization');
                
                const flowData = this.calculateEnergyFlow(tripleOSResults);
                
                container.innerHTML = `
                    <div class="flow-diagram">
                        <div class="flow-node engine-node">
                            <h5>Engine OS</h5>
                            <div class="node-strength">${flowData.engine.strength}%</div>
                            <div class="node-flow out" style="--flow-strength: ${flowData.engine.outflow}%;">
                                â†’ Interface (${flowData.engine.outflow}%)
                            </div>
                        </div>
                        
                        <div class="flow-node interface-node">
                            <h5>Interface OS</h5>
                            <div class="node-strength">${flowData.interface.strength}%</div>
                            <div class="node-flow out" style="--flow-strength: ${flowData.interface.outflow}%;">
                                â†’ SafeMode (${flowData.interface.outflow}%)
                            </div>
                        </div>
                        
                        <div class="flow-node safemode-node">
                            <h5>Safe Mode OS</h5>
                            <div class="node-strength">${flowData.safeMode.strength}%</div>
                            <div class="node-flow out" style="--flow-strength: ${flowData.safeMode.outflow}%;">
                                â†’ Engine (${flowData.safeMode.outflow}%)
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-insights" style="margin-top: var(--space-lg);">
                        <h5 style="color: var(--primary-100); margin-bottom: var(--space-md);">
                            ğŸ’« ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼æ´å¯Ÿ
                        </h5>
                        <div style="color: var(--primary-200); line-height: 1.6;">
                            ${flowData.insights}
                        </div>
                    </div>
                `;
                
                // ãƒ•ãƒ­ãƒ¼å›³ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ 
                const flowStyle = document.createElement('style');
                flowStyle.textContent = `
                    .flow-diagram {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                        gap: var(--space-lg);
                        margin-bottom: var(--space-lg);
                    }
                    .flow-node {
                        text-align: center;
                        padding: var(--space-lg);
                        border-radius: var(--radius-md);
                        border: 2px solid;
                        position: relative;
                    }
                    .engine-node { border-color: #6366f1; background: rgba(99, 102, 241, 0.05); }
                    .interface-node { border-color: #8b5cf6; background: rgba(139, 92, 246, 0.05); }
                    .safemode-node { border-color: #10b981; background: rgba(16, 185, 129, 0.05); }
                    
                    .node-strength {
                        font-size: var(--font-xl);
                        font-weight: 700;
                        margin: var(--space-sm) 0;
                    }
                    .node-flow {
                        font-size: var(--font-sm);
                        color: var(--primary-300);
                        margin-top: var(--space-sm);
                        position: relative;
                        overflow: hidden;
                    }
                `;
                document.head.appendChild(flowStyle);
            
            calculateEnergyFlow(tripleOSResults) {
                const engineStrength = this.calculateOSStrength(tripleOSResults.engineOS);
                const interfaceStrength = this.calculateOSStrength(tripleOSResults.interfaceOS);
                const safeModeStrength = this.calculateOSStrength(tripleOSResults.safeModeOS);
                
                // ç›¸äº’å½±éŸ¿åº¦è¨ˆç®—
                const engineToInterface = this.calculateInfluenceStrength(tripleOSResults.engineOS, tripleOSResults.interfaceOS);
                const interfaceToSafeMode = this.calculateInfluenceStrength(tripleOSResults.interfaceOS, tripleOSResults.safeModeOS);
                const safeModeToEngine = this.calculateInfluenceStrength(tripleOSResults.safeModeOS, tripleOSResults.engineOS);
                
                const insights = this.generateFlowInsights(
                    engineStrength, interfaceStrength, safeModeStrength,
                    engineToInterface, interfaceToSafeMode, safeModeToEngine
                
                return {
                    engine: { strength: engineStrength, outflow: engineToInterface },
                    interface: { strength: interfaceStrength, outflow: interfaceToSafeMode },
                    safeMode: { strength: safeModeStrength, outflow: safeModeToEngine },
                    insights
                };
            
            generateFlowInsights(eStr, iStr, sStr, eToi, iToS, sToE) {
                let insights = [];
                
                if (eToi > 70) {
                    insights.push("ä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ãŒç¤¾ä¼šçš„è¡¨ç¾ã«å¼·ãå½±éŸ¿ã—ã¦ã„ã¾ã™");
                }
                if (iToS > 70) {
                    insights.push("ç¤¾ä¼šçš„çµŒé¨“ãŒé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®å½¢æˆã«å¤§ããé–¢ä¸ã—ã¦ã„ã¾ã™");
                }
                if (sToE > 70) {
                    insights.push("é˜²å¾¡ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒä¾¡å€¤è¦³ã®å†æ§‹ç¯‰ã‚’ä¿ƒã—ã¦ã„ã¾ã™");
                
                const totalFlow = eToi + iToS + sToE;
                if (totalFlow > 210) {
                    insights.push("3ã¤ã®ã‚·ã‚¹ãƒ†ãƒ é–“ã§æ´»ç™ºãªç›¸äº’ä½œç”¨ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™");
                } else if (totalFlow < 150) {
                    insights.push("ã‚·ã‚¹ãƒ†ãƒ é–“ã®é€£æºã«æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™");
                
                return insights.length > 0 ? insights.join('ã€‚') + 'ã€‚' : 
                    'ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’ä¿ã£ã¦ã„ã¾ã™ã€‚';
            
            // â˜¯ å°‚é–€å±¤: 64å¦å®Œå…¨è§£é‡ˆã‚·ã‚¹ãƒ†ãƒ 
            renderDetailedHexagramAnalysis(tripleOSResults) {
                const container = document.getElementById('hexagram-detailed-analysis');
                container.innerHTML = '';
                
                const systems = [
                    { name: 'Engine OS', data: tripleOSResults.engineOS, color: '#6366f1' },
                    { name: 'Interface OS', data: tripleOSResults.interfaceOS, color: '#8b5cf6' },
                    { name: 'Safe Mode OS', data: tripleOSResults.safeModeOS, color: '#10b981' }
                ];
                
                systems.forEach(system => {
                    const hexagramCard = document.createElement('div');
                    hexagramCard.className = 'hexagram-card';
                    
                    // è©³ç´°ãªå¦æƒ…å ±å–å¾—
                    const hexagramDetails = this.getDetailedHexagramInfo(system.data.hexagramId);
                    
                    hexagramCard.innerHTML = `
                        <div class="hexagram-title" style="color: ${system.color};">
                            ${system.name} - ${system.data.hexagramName}
                        </div>
                        <div class="hexagram-content">
                            <div class="hexagram-meta" style="margin-bottom: var(--space-md);">
                                <strong>å¦ç•ªå·:</strong> ${system.data.hexagramId}ç•ª<br>
                                <strong>ä¸Šå¦:</strong> ${this.safeGetTrigramDisplay(system.data.primaryTrigram || system.data.upperTrigram) || 'ä¹¾(å¤©)'} | 
                                <strong>ä¸‹å¦:</strong> ${this.safeGetTrigramDisplay(system.data.secondaryTrigram || system.data.lowerTrigram) || 'å¤(åœ°)'}
                            </div>
                            
                            <div class="hexagram-description" style="margin-bottom: var(--space-md);">
                                ${hexagramDetails.detailedDescription}
                            </div>
                            
                            <div class="trigram-composition" style="margin-bottom: var(--space-md);">
                                <h6 style="color: var(--primary-100); margin-bottom: var(--space-sm);">ä¸‰çˆ»æ§‹æˆåˆ†æ</h6>
                                <div style="color: var(--primary-200); font-size: var(--font-sm);">
                                    ${hexagramDetails.trigramAnalysis}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(hexagramCard);
                });
            
            // ğŸ”„ å¤‰å¦ã‚·ã‚¹ãƒ†ãƒ  - æˆé•·æ–¹å‘æ€§
            renderChangeHexagramSystem(tripleOSResults) {
                const container = document.getElementById('change-hexagram-display');
                
                const changeSystemData = this.calculateChangeHexagrams(tripleOSResults);
                
                container.innerHTML = `
                    <div class="change-hexagram-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-lg);">
                        ${changeSystemData.map(change => `
                            <div class="change-card" style="background: rgba(251, 191, 36, 0.08); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: var(--radius-md); padding: var(--space-lg);">
                                <h6 style="color: #fbbf24; margin-bottom: var(--space-md);">
                                    ${change.fromOS} ã®å¤‰åŒ–
                                </h6>
                                <div style="color: var(--primary-200); margin-bottom: var(--space-md);">
                                    <strong>${change.currentHexagram}</strong> â†’ <strong>${change.futureHexagram}</strong>
                                </div>
                                <div style="color: var(--primary-200); font-size: var(--font-sm); line-height: 1.6;">
                                    ${change.changeAnalysis}
                                </div>
                                <div style="margin-top: var(--space-md); padding: var(--space-sm); background: rgba(251, 191, 36, 0.05); border-radius: var(--radius-sm);">
                                    <strong style="color: #fbbf24;">æˆé•·æ–¹å‘:</strong>
                                    <div style="color: var(--primary-200); font-size: var(--font-sm); margin-top: var(--space-xs);">
                                        ${change.growthDirection}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            
            // ğŸ“œ å¤å…¸çš„wisdom - å¦è¾ãƒ»çˆ»è¾
            renderClassicalWisdom(tripleOSResults) {
                const container = document.getElementById('classical-wisdom-display');
                
                const wisdomData = this.extractClassicalWisdom(tripleOSResults);
                
                container.innerHTML = `
                    <div class="classical-wisdom">
                        <h6 style="color: #fbbf24; margin-bottom: var(--space-lg); text-align: center;">
                            æ˜“çµŒå¤å…¸ - ã‚ãªãŸã¸ã®æ™ºæ…§
                        </h6>
                        
                        <div class="wisdom-sections" style="display: flex; flex-direction: column; gap: var(--space-lg);">
                            ${wisdomData.map(wisdom => `
                                <div class="wisdom-section" style="border-left: 4px solid #fbbf24; padding-left: var(--space-lg);">
                                    <h6 style="color: var(--primary-100); margin-bottom: var(--space-sm);">
                                        ${wisdom.system} - ${wisdom.hexagramName}
                                    </h6>
                                    <div class="kua-ci" style="margin-bottom: var(--space-md);">
                                        <strong>å¦è¾:</strong> "${wisdom.guaCi}"
                                    </div>
                                    <div class="yao-ci" style="margin-bottom: var(--space-md);">
                                        <strong>çˆ»è¾ (é‡è¦ãªçˆ»):</strong> "${wisdom.yaoCi}"
                                    </div>
                                    <div class="modern-interpretation" style="background: rgba(251, 191, 36, 0.05); padding: var(--space-md); border-radius: var(--radius-sm);">
                                        <strong>ç¾ä»£çš„è§£é‡ˆ:</strong><br>
                                        ${wisdom.modernInterpretation}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            
            // ğŸ”¯ HaQeiå“²å­¦çµ±åˆ
            renderHaQeiWisdom(tripleOSResults) {
                const container = document.getElementById('HaQei-wisdom-display');
                
                const HaQeiAnalysis = this.generateHaQeiAnalysis(tripleOSResults);
                
                container.innerHTML = `
                    ${HaQeiAnalysis.philosophicalIntegration}
                    
                    <div style="margin-top: var(--space-lg); padding: var(--space-lg); background: rgba(16, 185, 129, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(16, 185, 129, 0.2);">
                        <h6 style="color: var(--success-500); margin-bottom: var(--space-md);">
                            ğŸ¯ æˆ¦ç•¥çš„è‡ªå·±ç†è§£ã®ãƒã‚¤ãƒ³ãƒˆ
                        </h6>
                        <ul style="color: var(--primary-200); line-height: 1.6; padding-left: var(--space-lg);">
                            ${HaQeiAnalysis.strategicPoints.map(point => `<li style="margin-bottom: var(--space-sm);">${point}</li>`).join('')}
                        </ul>
                    </div>
                `;
            
            // ğŸ’¡ ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ´å¯Ÿç”Ÿæˆ
            renderPersonalizedInsights(tripleOSResults) {
                const insights = this.generatePersonalizedInsights(tripleOSResults);
                
                // æˆé•·æ–¹å‘æ€§
                document.getElementById('growth-directions').innerHTML = `
                    <div class="insight-title">ğŸŒ± æˆé•·æ–¹å‘æ€§</div>
                    <div class="insight-content">${insights.growthDirections}</div>
                `;
                
                // æœ€é©åŒ–æˆ¦ç•¥
                document.getElementById('optimization-strategies').innerHTML = `
                    <div class="insight-title">âš¡ æœ€é©åŒ–æˆ¦ç•¥</div>
                    <div class="insight-content">${insights.optimizationStrategies}</div>
                `;
                
                // ã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†
                document.getElementById('stress-management').innerHTML = `
                    <div class="insight-title">ğŸ›¡ï¸ ã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†</div>
                    <div class="insight-content">${insights.stressManagement}</div>
                `;
                
                // æ¯”è¼ƒåˆ†æ
                document.getElementById('comparative-analysis').innerHTML = `
                    <div class="insight-title">ğŸ“Š æ¯”è¼ƒåˆ†æ</div>
                    <div class="insight-content">${insights.comparativeAnalysis}</div>
                `;
            
            // ğŸ¯ å®Ÿè·µçš„æˆ¦ç•¥ææ¡ˆ
            renderPracticalStrategies(tripleOSResults) {
                const container = document.getElementById('practical-strategies');
                const strategies = this.generatePracticalStrategies(tripleOSResults);
                
                container.innerHTML = strategies.map(strategy => `
                    <div class="strategy-item">
                        <div class="strategy-title">
                            ${strategy.icon} ${strategy.title}
                        </div>
                        <div class="strategy-description">
                            ${strategy.description}
                        </div>
                        <div class="strategy-actions">
                            ${strategy.actions.map(action => `
                                <span class="strategy-action">${action}</span>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            
            // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ç¾¤
            getDetailedHexagramInfo(hexagramId) {
                // å®Ÿéš›ã«HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰è©³ç´°ã‚’å–å¾—
                const hexagram = HEXAGRAMS.find(h => h.hexagram_id === hexagramId) || HEXAGRAMS[0];
                if (!hexagram) {
                    return {
                        detailedDescription: `å¦ID: ${hexagramId}ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚`,
                        trigramAnalysis: `ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚`
                    };
                
                // H384ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å…¨ä½“çš„ãªè§£é‡ˆã‚’å–å¾—
                const relatedH384 = H384_DATA.filter(item => item['å¦ç•ªå·'] === hexagramId);
                const detailedAnalysis = relatedH384.length > 0 ? 
                    relatedH384.map(item => `${item['çˆ»']}: ${item['ç¾ä»£è§£é‡ˆã®è¦ç´„']}`).join('\n') :
                    'è©³ç´°ãªçˆ»ã®è§£é‡ˆãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚';
                
                return {
                    detailedDescription: `ã€${hexagram.name_jp || 'ä¸æ˜'}ã€‘${hexagram.catchphrase || ''}\n\n${hexagram.description || 'èª¬æ˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'}\n\n= çˆ»åˆ¥è©³ç´°è§£é‡ˆ =\n${detailedAnalysis}`,
                    trigramAnalysis: `ä¸Šå¦: ${this.getTrigramName(hexagram.upper_trigram_id) || 'ä¸æ˜'} / ä¸‹å¦: ${this.getTrigramName(hexagram.lower_trigram_id) || 'ä¸æ˜'}\n\nã“ã®çµ„ã¿åˆã‚ã›ã¯ã€ã‚ãªãŸã®å†…çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼(${this.getTrigramName(hexagram.lower_trigram_id)})ã¨å¤–çš„è¡¨ç¾(${this.getTrigramName(hexagram.upper_trigram_id)})ã®é–¢ä¿‚æ€§ã‚’ç‰©èªã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯å‹•çš„ãªãƒãƒ©ãƒ³ã‚¹ã®ä¸­ã§ç™ºæ®ã•ã‚Œã‚‹ã€ã‚ãªãŸå›ºæœ‰ã®èƒ½åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚`
                };
            
            getTrigramName(trigramId) {
                // ä¸‰çˆ»IDã‹ã‚‰åå‰ã‚’å–å¾—
                const trigramNames = {
                    1: "ä¹¾(å¤©)", 2: "å…Œ(æ²¢)", 3: "é›¢(ç«)", 4: "éœ‡(é›·)",
                    5: "å·½(é¢¨)", 6: "å(æ°´)", 7: "è‰®(å±±)", 8: "å¤(åœ°)"
                };
                return trigramNames[trigramId] || "ä¸æ˜";

            // ğŸ›¡ï¸ SAFE TRIGRAM DISPLAY - primaryTrigram/secondaryTrigramå®‰å…¨è¡¨ç¤º
            safeGetTrigramDisplay(trigram) {
                if (!trigram) return null;
                
                // æ—¢ã«è¡¨ç¤ºç”¨æ–‡å­—åˆ—ã®å ´åˆ
                if (typeof trigram === 'string' && trigram.includes('(')) {
                    return trigram;
                
                // ä¸‰çˆ»æ–‡å­—ã®å ´åˆ
                if (typeof trigram === 'string') {
                    const trigramDisplayMap = {
                        'ä¹¾': 'ä¹¾(å¤©)', 'å…Œ': 'å…Œ(æ²¢)', 'é›¢': 'é›¢(ç«)', 'éœ‡': 'éœ‡(é›·)',
                        'å·½': 'å·½(é¢¨)', 'å': 'å(æ°´)', 'è‰®': 'è‰®(å±±)', 'å¤': 'å¤(åœ°)'
                    };
                    return trigramDisplayMap[trigram] || `${trigram}(ä¸æ˜)`;
                
                // æ•°å€¤IDã®å ´åˆ
                if (typeof trigram === 'number') {
                    return this.getTrigramName(trigram);
                
                return 'æƒ…å ±å–å¾—ä¸­';
            
            calculateChangeHexagrams(tripleOSResults) {
                // å¤‰å¦è¨ˆç®—ã®ç°¡å˜ãªå®Ÿè£…
                return [
                    {
                        fromOS: 'Engine OS',
                        currentHexagram: tripleOSResults.engineOS.hexagramName,
                        futureHexagram: this.calculateFutureHexagram(tripleOSResults.engineOS),
                        changeAnalysis: 'å†…çš„ä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚ˆã‚Šçµ±åˆã•ã‚ŒãŸå½¢ã¸ã¨ç™ºå±•ã—ã¦ã„ãå¯èƒ½æ€§ã‚’ç§˜ã‚ã¦ã„ã¾ã™ã€‚',
                        growthDirection: 'è‡ªå·±ç†è§£ã‚’æ·±ã‚ã€ä¾¡å€¤è¦³ã®ä¸€è²«æ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ã§ã€ã‚ˆã‚ŠåŠ›å¼·ã„è¡¨ç¾ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚'
                    },
                    {
                        fromOS: 'Interface OS', 
                        currentHexagram: tripleOSResults.interfaceOS.hexagramName,
                        futureHexagram: this.calculateFutureHexagram(tripleOSResults.interfaceOS),
                        changeAnalysis: 'ç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚ˆã‚ŠæŸ”è»Ÿã§åŠ¹æœçš„ãªå¯¾äººé–¢ä¿‚ã‚¹ã‚­ãƒ«ã¸ã¨é€²åŒ–ã—ã¦ã„ãã¾ã™ã€‚',
                        growthDirection: 'ä»–è€…ã¨ã®å”èª¿æ€§ã‚’ä¿ã¡ãªãŒã‚‰ã€è‡ªåˆ†ã‚‰ã—ã•ã‚’è¡¨ç¾ã™ã‚‹ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚'
                    },
                    {
                        fromOS: 'Safe Mode OS',
                        currentHexagram: tripleOSResults.safeModeOS.hexagramName,
                        futureHexagram: this.calculateFutureHexagram(tripleOSResults.safeModeOS),
                        changeAnalysis: 'é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚ˆã‚Šå»ºè¨­çš„ã§é©å¿œçš„ãªå¯¾å‡¦ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¸ã¨å¤‰åŒ–ã—ã¦ã„ãã¾ã™ã€‚',
                        growthDirection: 'å®‰å…¨æ€§ã‚’ä¿ã¡ãªãŒã‚‰ã‚‚ã€æ–°ã—ã„æŒ‘æˆ¦ã«å¯¾ã—ã¦ã‚ªãƒ¼ãƒ—ãƒ³ãªå§¿å‹¢ã‚’è‚²ã¦ã‚‹ã“ã¨ãŒæˆé•·ã®ã‚«ã‚®ã§ã™ã€‚'
                    }
                ];
            
            calculateFutureHexagram(osData) {
                // å®Ÿéš›ã®HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å¤‰å¦ã‚’è¨ˆç®—
                const currentId = osData.hexagramId || 1;
                const futureId = currentId > 32 ? currentId - 32 : currentId + 32;
                
                // å¤‰åŒ–å¾Œã®å¦ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—
                const futureHexagram = HEXAGRAMS.find(h => h.hexagram_id === futureId);
                return futureHexagram ? futureHexagram.name_jp : `${futureId}ç•ªå¦`;
            
            extractClassicalWisdom(tripleOSResults) {
                // å®Ÿéš›ã®HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å¤å…¸çš„ãªçŸ¥æµã‚’æŠ½å‡º
                const systems = [
                    { name: 'Engine OS', data: tripleOSResults.engineOS },
                    { name: 'Interface OS', data: tripleOSResults.interfaceOS },
                    { name: 'Safe Mode OS', data: tripleOSResults.safeModeOS }
                ];
                
                return systems.map(system => {
                    const hexagram = HEXAGRAMS.find(h => h.hexagram_id === system.data.hexagramId);
                    const h384Data = H384_DATA.filter(item => item['å¦ç•ªå·'] === system.data.hexagramId);
                    
                    // ä¸»è¦ãªçˆ»ã‚’é¸æŠï¼ˆä¹äº”ã¾ãŸã¯å…­äº”ã‚’å„ªå…ˆï¼‰
                    const mainYao = h384Data.find(item => item['çˆ»'].includes('äº”')) || h384Data[0];
                    
                    return {
                        system: system.name,
                        hexagramName: system.data.hexagramName,
                        guaCi: hexagram ? (hexagram.gua_ci || hexagram.description) : 'å¦è¾ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                        yaoCi: mainYao ? `${mainYao['çˆ»']}: ${mainYao['ç¾ä»£è§£é‡ˆã®è¦ç´„'].substring(0, 50)}...` : 'çˆ»è¾ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                        modernInterpretation: mainYao ? mainYao['ç¾ä»£è§£é‡ˆã®è¦ç´„'] : 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰è§£é‡ˆã‚’å–å¾—ã§ãã¾ã›ã‚“ã€‚'
                    };
                });
            
            generateHaQeiAnalysis(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS } = tripleOSResults;
                
                // å®Ÿéš›ã®HEXAGRAMSãƒ‡ãƒ¼ã‚¿ã‹ã‚‰HaQeiå“²å­¦çš„åˆ†æã‚’ç”Ÿæˆ
                const engineHexagram = HEXAGRAMS.find(h => h.hexagram_id === engineOS.hexagramId);
                const interfaceHexagram = HEXAGRAMS.find(h => h.hexagram_id === interfaceOS.hexagramId);
                const safeModeHexagram = HEXAGRAMS.find(h => h.hexagram_id === safeModeOS.hexagramId);
                
                // å„OSã®å®Ÿéš›ã®ç‰¹æ€§ã‹ã‚‰å“²å­¦çš„çµ±åˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‹•çš„ç”Ÿæˆ
                const philosophicalIntegration = `
                    ã‚ãªãŸã®ä¸‰é‡äººæ ¼ã‚·ã‚¹ãƒ†ãƒ ã¯ã€HaQeiå“²å­¦ã®ã€Œè¤‡æ•°è‡ªå·±çµ±åˆç†è«–ã€ã‚’å®Ÿè¨¼ã—ã¦ã„ã¾ã™ã€‚
                    
                    Engine OSã€${engineOS.hexagramName}ã€‘${engineHexagram?.catchphrase || ''}ã¨ã—ã¦ã€
                    ${engineHexagram?.description || 'å†…çš„ä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—'}ã€
                    
                    Interface OSã€${interfaceOS.hexagramName}ã€‘${interfaceHexagram?.catchphrase || ''}ã¨ã—ã¦ã€
                    ${interfaceHexagram?.description || 'ç¤¾ä¼šçš„é©å¿œã‚·ã‚¹ãƒ†ãƒ ã‚’é‹å–¶ã—'}ã€
                    
                    Safe Mode OSã€${safeModeOS.hexagramName}ã€‘${safeModeHexagram?.catchphrase || ''}ã¨ã—ã¦ã€
                    ${safeModeHexagram?.description || 'é˜²å¾¡çš„å®‰å®šã‚·ã‚¹ãƒ†ãƒ ã‚’ç¶­æŒ'}ã—ã¦ã„ã¾ã™ã€‚
                    
                    ã“ã®ä¸‰ä½ä¸€ä½“ã¯ã€å˜ãªã‚‹æ€§æ ¼åˆ†æã§ã¯ãªãã€çŠ¶æ³é©å¿œå‹ã®æˆ¦ç•¥çš„äººæ ¼ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                `;
                
                // H384ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å®Ÿéš›ã®æˆ¦ç•¥ãƒã‚¤ãƒ³ãƒˆã‚’æŠ½å‡º
                const engineH384 = H384_DATA.find(item => item['å¦ç•ªå·'] === engineOS.hexagramId);
                const interfaceH384 = H384_DATA.find(item => item['å¦ç•ªå·'] === interfaceOS.hexagramId);  
                const safeModeH384 = H384_DATA.find(item => item['å¦ç•ªå·'] === safeModeOS.hexagramId);
                
                const strategicPoints = [
                    `Engine OSæ´»ç”¨: ${engineH384?.['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å‰µé€ æ€§'}ã‚’åŸºç›¤ã¨ã—ãŸ${engineH384?.['S5_ä¸»ä½“æ€§æ¨å¥¨ã‚¹ã‚¿ãƒ³ã‚¹'] || 'èƒ½å‹•'}çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ`,
                    `Interface OSæ´»ç”¨: ${interfaceH384?.['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å”èª¿æ€§'}ã‚’é‡è¦–ã—ãŸ${interfaceH384?.['S5_ä¸»ä½“æ€§æ¨å¥¨ã‚¹ã‚¿ãƒ³ã‚¹'] || 'å—å‹•'}çš„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³`,
                    `Safe Mode OSæ´»ç”¨: ${safeModeH384?.['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å®‰å®šæ€§'}ã‚’ç¢ºä¿ã™ã‚‹${safeModeH384?.['S5_ä¸»ä½“æ€§æ¨å¥¨ã‚¹ã‚¿ãƒ³ã‚¹'] || 'ä¸­ç«‹'}çš„ãƒªã‚¹ã‚¯ç®¡ç†`,
                    `ä¸‰é‡çµ±åˆ: ã‚¹ã‚³ã‚¢çµ±åˆ(Engine:${engineH384?.['S7_ç·åˆè©•ä¾¡ã‚¹ã‚³ã‚¢'] || 50}, Interface:${interfaceH384?.['S7_ç·åˆè©•ä¾¡ã‚¹ã‚³ã‚¢'] || 50}, Safe:${safeModeH384?.['S7_ç·åˆè©•ä¾¡ã‚¹ã‚³ã‚¢'] || 50})ã«ã‚ˆã‚‹ç·åˆåˆ¤æ–­`,
                    `é•·æœŸæˆé•·: å„OSã®${[engineH384, interfaceH384, safeModeH384].map(h => h?.['S2_ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«'] || 50).join('-')}ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’æ®µéšçš„é–‹ç™º`
                ];
                
                return {
                    philosophicalIntegration,
                    strategicPoints
                };
            
            generatePersonalizedInsights(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS, integration } = tripleOSResults;
                const balance = this.calculateDynamicBalance(tripleOSResults);
                
                return {
                    growthDirections: `
                        ä¸»å°ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚‹${balance.dominantOS}ã‚’åŸºç›¤ã¨ã—ã¦ã€ä»–ã®2ã¤ã®ã‚·ã‚¹ãƒ†ãƒ ã¨ã®èª¿å’Œã‚’å›³ã‚‹ã“ã¨ã§ã€
                        ã‚ˆã‚Šçµ±åˆã•ã‚ŒãŸäººæ ¼ã¸ã¨æˆé•·ã§ãã¾ã™ã€‚ç‰¹ã«${this.getWeakestOS(tripleOSResults)}ã®
                        ç™ºé”ã«æ„è­˜ã‚’å‘ã‘ã‚‹ã“ã¨ã§ã€å…¨ä½“çš„ãªãƒãƒ©ãƒ³ã‚¹ãŒå‘ä¸Šã—ã¾ã™ã€‚
                    `,
                    optimizationStrategies: `
                        ã‚·ã‚¹ãƒ†ãƒ å”èª¿åº¦${balance.coordination}%ã‹ã‚‰ã€ç›¸äº’ä½œç”¨ã®æ”¹å–„ä½™åœ°ãŒã‚ã‚Šã¾ã™ã€‚
                        æ—¥å¸¸ç”Ÿæ´»ã§æ„è­˜çš„ã«ç•°ãªã‚‹OSã‚’ä½¿ã„åˆ†ã‘ã‚‹ç·´ç¿’ã‚’ã™ã‚‹ã“ã¨ã§ã€
                        ã‚ˆã‚ŠåŠ¹æœçš„ãªå•é¡Œè§£æ±ºã¨äººé–“é–¢ä¿‚ã®æ§‹ç¯‰ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
                    `,
                    stressManagement: `
                        ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§${balance.resilience}%ã‚’åŸºã«ã€Safe Mode OSã®${this.getStressManagementAdvice(safeModeOS)}
                        ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€å›°é›£ãªçŠ¶æ³ã§ã‚‚å®‰å®šã—ãŸå¯¾å¿œãŒå¯èƒ½ã§ã™ã€‚
                        äºˆé˜²çš„ãªã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†ã¨ã—ã¦ã€å®šæœŸçš„ãªè‡ªå·±ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè·µã—ã¦ãã ã•ã„ã€‚
                    `,
                    comparativeAnalysis: `
                        ä¸€èˆ¬çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã¨æ¯”è¼ƒã—ã¦ã€ã‚ãªãŸã®ç‰¹å¾´ã¯${this.getComparativeInsights(tripleOSResults)}ã§ã™ã€‚
                        ã“ã®ç‹¬è‡ªæ€§ã‚’å¼·ã¿ã¨ã—ã¦æ´»ã‹ã—ã¤ã¤ã€å¿…è¦ã«å¿œã˜ã¦ä»–ã®è¦–ç‚¹ã‚‚å–ã‚Šå…¥ã‚Œã‚‹ã“ã¨ã§ã€
                        ã‚ˆã‚Šå¹…åºƒã„çŠ¶æ³ã«å¯¾å¿œã§ãã‚‹æŸ”è»Ÿæ€§ã‚’ç²å¾—ã§ãã¾ã™ã€‚
                    `
                };
            
            generatePracticalStrategies(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS } = tripleOSResults;
                
                // å®Ÿéš›ã®H384ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å„OSã®ç‰¹æ€§ã‚’å–å¾—
                const engineH384 = H384_DATA.filter(item => item['å¦ç•ªå·'] === engineOS.hexagramId);
                const interfaceH384 = H384_DATA.filter(item => item['å¦ç•ªå·'] === interfaceOS.hexagramId);
                const safeModeH384 = H384_DATA.filter(item => item['å¦ç•ªå·'] === safeModeOS.hexagramId);
                
                // å‹•çš„ã«å®Ÿè·µæˆ¦ç•¥ã‚’ç”Ÿæˆ
                const strategies = [];
                
                // Engine OSæˆ¦ç•¥
                const engineMainYao = engineH384.find(item => item['çˆ»'].includes('äº”')) || engineH384[0];
                if (engineMainYao) {
                    strategies.push({
                        icon: 'âš¡',
                        title: `Engine OSå¼·åŒ–: ${engineMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å‰µé€ æ€§'}ã®æ´»ç”¨`,
                        description: `${engineMainYao['ç¾ä»£è§£é‡ˆã®è¦ç´„'].substring(0, 100)}ã‚’æ—¥å¸¸ç”Ÿæ´»ã«å¿œç”¨ã—ã¾ã™ã€‚`,
                        actions: [
                            `${engineMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[1] || 'åŸºç¤å›ºã‚'}ã®æ—¥ã€…å®Ÿè·µ`,
                            `${engineMainYao['S5_ä¸»ä½“æ€§æ¨å¥¨ã‚¹ã‚¿ãƒ³ã‚¹']}çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã®å•é¡Œè§£æ±º`,
                            `ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«${engineMainYao['S2_ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«']}%ã‚’æ´»ã‹ã—ãŸé•·æœŸè¨ˆç”»`
                        ]
                    });
                
                // Interface OSæˆ¦ç•¥  
                const interfaceMainYao = interfaceH384.find(item => item['çˆ»'].includes('äº”')) || interfaceH384[0];
                if (interfaceMainYao) {
                    strategies.push({
                        icon: 'ğŸ¤',
                        title: `Interface OSæœ€é©åŒ–: ${interfaceMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å”èª¿æ€§'}ã®ç™ºå±•`,
                        description: `${interfaceMainYao['ç¾ä»£è§£é‡ˆã®è¦ç´„'].substring(0, 100)}ã‚’äººé–“é–¢ä¿‚ã§å®Ÿè·µã—ã¾ã™ã€‚`,
                        actions: [
                            `${interfaceMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[1] || 'å¯¾äººé–¢ä¿‚'}ã®æ„è­˜çš„æ”¹å–„`,
                            `ãƒªã‚¹ã‚¯å€¤${Math.abs(interfaceMainYao['S4_ãƒªã‚¹ã‚¯'] || -35)}ã«å¿œã˜ãŸæ…é‡æ€§`,
                            `ç·åˆè©•ä¾¡${interfaceMainYao['S7_ç·åˆè©•ä¾¡ã‚¹ã‚³ã‚¢']}%å‘ä¸Šã‚’ç›®æŒ‡ã—ãŸè¡Œå‹•è¨ˆç”»`
                        ]
                    });
                
                // Safe Mode OSæˆ¦ç•¥
                const safeModeMainYao = safeModeH384.find(item => item['çˆ»'].includes('äº”')) || safeModeH384[0];
                if (safeModeMainYao) {
                    strategies.push({
                        icon: 'ğŸ›¡ï¸',
                        title: `Safe Mode OSé‹ç”¨: ${safeModeMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[0] || 'å®‰å®šæ€§'}ã®ç¢ºç«‹`,
                        description: `${safeModeMainYao['ç¾ä»£è§£é‡ˆã®è¦ç´„'].substring(0, 100)}ã‚’ã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†ã«å¿œç”¨ã—ã¾ã™ã€‚`,
                        actions: [
                            `${safeModeMainYao['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰']?.[1] || 'äºˆé˜²ç­–'}ã®äº‹å‰æº–å‚™`,
                            `å®‰å®šæ€§ã‚¹ã‚³ã‚¢${safeModeMainYao['S3_å®‰å®šæ€§ã‚¹ã‚³ã‚¢']}%ã‚’åŸºæº–ã¨ã—ãŸç’°å¢ƒè¨­è¨ˆ`,
                            `å¤‰å‹•æ€§${safeModeMainYao['S6_å¤‰å‹•æ€§ã‚¹ã‚³ã‚¢']}%ã«åˆã‚ã›ãŸæŸ”è»Ÿãªå¯¾å¿œç­–`
                        ]
                    });
                
                return strategies;
            
            getWeakestOS(tripleOSResults) {
                const strengths = {
                    'Engine OS': this.calculateOSStrength(tripleOSResults.engineOS),
                    'Interface OS': this.calculateOSStrength(tripleOSResults.interfaceOS),
                    'Safe Mode OS': this.calculateOSStrength(tripleOSResults.safeModeOS)
                };
                
                return Object.keys(strengths).reduce((a, b) => 
                    strengths[a] < strengths[b] ? a : b
            
            getStressManagementAdvice(safeModeOS) {
                const strength = this.calculateOSStrength(safeModeOS);
                if (strength > 75) return 'å¼·åŠ›ãªå®‰å®šåŒ–æ©Ÿèƒ½';
                if (strength > 50) return 'é©åº¦ãªé˜²å¾¡ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ';
                return 'æŸ”è»Ÿãªé©å¿œæˆ¦ç•¥';
            
            getComparativeInsights(tripleOSResults) {
                const balance = this.calculateDynamicBalance(tripleOSResults);
                if (balance.coordination > 80) return 'é«˜åº¦ãªçµ±åˆå‹äººæ ¼ç‰¹æ€§';
                if (balance.flexibility > 80) return 'é«˜ã„é©å¿œèƒ½åŠ›ã¨æŸ”è»Ÿæ€§';
                if (balance.resilience > 80) return 'å„ªç§€ãªã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ã¨å®‰å®šæ€§';
                return 'ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸæˆé•·å‹äººæ ¼';
            
            generateTripleOSSummary(tripleOSResults) {
                const { 
                    engineOS, 
                    interfaceOS, 
                    safeModeOS, 
                    consistencyScore,
                    balanceScore,
                    HaQeiIntegration,
                    integration,
                    recommendations 
                } = tripleOSResults;
                
                // çµ±åˆã‚¹ã‚³ã‚¢ã®è¡¨ç¤ºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                const formatScore = (score) => Math.round(score || 0);
                const getScoreColor = (score) => {
                    if (score >= 80) return '#10b981'; // ç·‘
                    if (score >= 65) return '#f59e0b'; // é»„
                    return '#ef4444'; // èµ¤
                };
                
                // HaQeiæº–æ‹ ã®è¡¨ç¾
                const summary = `
                    <div style="margin-bottom: var(--space-md);">
                        <h4 style="color: var(--primary-100); margin-bottom: var(--space-sm);">ğŸ”¯ Triple OS ã‚·ã‚¹ãƒ†ãƒ åˆ†æ</h4>
                        <p style="color: var(--primary-200); line-height: 1.6;">
                            ã“ã®åˆ†æã¯ã€æ˜“çµŒã®64å¦ç†è«–ã«åŸºã¥ã<strong>å‚è€ƒæƒ…å ±</strong>ã¨ã—ã¦æä¾›ã•ã‚Œã¾ã™ã€‚
                            ã‚ãªãŸã®äººæ ¼ã‚’3ã¤ã®å±¤ã§ç†è§£ã™ã‚‹<strong>ä¸€ã¤ã®è¦–ç‚¹</strong>ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #6366f1; margin-bottom: var(--space-xs);">ğŸ¯ Engine OSï¼ˆæ·±å±¤ä¾¡å€¤è¦³ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${engineOS.hexagramName} - ${engineOS.catchphrase || engineOS.description}
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #8b5cf6; margin-bottom: var(--space-xs);">ğŸ’¬ Interface OSï¼ˆç¤¾ä¼šçš„å´é¢ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${interfaceOS.hexagramName} - å¯¾äººé–¢ä¿‚ã§ã®ä¸€é¢
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #10b981; margin-bottom: var(--space-xs);">ğŸ›¡ï¸ SafeMode OSï¼ˆé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${safeModeOS.hexagramName} - å®‰å…¨ã‚’é‡è¦–ã™ã‚‹æ™‚ã®ç‰¹æ€§
                        </p>
                    </div>
                    
                    <div style="background: rgba(99, 102, 241, 0.05); border-radius: var(--radius-md); padding: var(--space-md); margin: var(--space-md) 0;">
                        <h5 style="color: var(--primary-100); margin-bottom: var(--space-sm); text-align: center;">ğŸ“Š Triple OSçµ±åˆè©•ä¾¡</h5>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: var(--space-sm); margin-bottom: var(--space-sm);">
                            <div style="text-align: center; padding: var(--space-xs); background: rgba(255,255,255,0.05); border-radius: var(--radius-sm);">
                                <div style="font-size: var(--font-lg); font-weight: bold; color: ${getScoreColor(consistencyScore)};">
                                    ${formatScore(consistencyScore)}%
                                </div>
                                <div style="font-size: var(--font-xs); color: var(--primary-300);">æ•´åˆæ€§</div>
                            </div>
                            
                            <div style="text-align: center; padding: var(--space-xs); background: rgba(255,255,255,0.05); border-radius: var(--radius-sm);">
                                <div style="font-size: var(--font-lg); font-weight: bold; color: ${getScoreColor(balanceScore)};">
                                    ${formatScore(balanceScore)}%
                                </div>
                                <div style="font-size: var(--font-xs); color: var(--primary-300);">å‹•çš„ãƒãƒ©ãƒ³ã‚¹</div>
                            </div>
                            
                            <div style="text-align: center; padding: var(--space-xs); background: rgba(255,255,255,0.05); border-radius: var(--radius-sm);">
                                <div style="font-size: var(--font-lg); font-weight: bold; color: ${getScoreColor(HaQeiIntegration)};">
                                    ${formatScore(HaQeiIntegration)}%
                                </div>
                                <div style="font-size: var(--font-xs); color: var(--primary-300);">HaQeiçµ±åˆ</div>
                            </div>
                        </div>
                        
                        <p style="color: var(--primary-300); font-size: var(--font-xs); text-align: center; margin-top: var(--space-xs);">
                            â€»ã“ã‚Œã‚‰ã®æ•°å€¤ã¯å‚è€ƒæŒ‡æ¨™ã¨ã—ã¦ã€è‡ªå·±ç†è§£ã®ä¸€åŠ©ã¨ã—ã¦ã”æ´»ç”¨ãã ã•ã„
                        </p>
                    </div>
                    
                    ${recommendations && recommendations.length > 0 ? `
                        <div style="background: rgba(16, 185, 129, 0.05); border-radius: var(--radius-md); padding: var(--space-md); margin: var(--space-md) 0;">
                            <h5 style="color: #10b981; margin-bottom: var(--space-sm);">ğŸ’¡ æˆé•·ã¸ã®æ°—ã¥ã</h5>
                            ${recommendations.slice(0, 2).map(rec => `
                                <div style="margin-bottom: var(--space-sm); padding: var(--space-xs); background: rgba(255,255,255,0.03); border-radius: var(--radius-sm);">
                                    <div style="font-weight: bold; color: var(--primary-200); margin-bottom: var(--space-xs);">
                                        ${rec.title}
                                    </div>
                                    <div style="color: var(--primary-300); font-size: var(--font-sm); line-height: 1.4;">
                                        ${rec.description}
                                    </div>
                                </div>
                            `).join('')}
                            <p style="color: var(--primary-400); font-size: var(--font-xs); text-align: center; margin-top: var(--space-sm);">
                                ã“ã‚Œã‚‰ã®æ°—ã¥ãã‚’ã€æ—¥å¸¸ã®ä¸­ã§å°‘ã—ãšã¤æ„è­˜ã—ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™
                            </p>
                        </div>
                    ` : ''}
                    
                    <div style="background: rgba(99, 102, 241, 0.1); border-radius: var(--radius-md); padding: var(--space-sm); margin-top: var(--space-md);">
                        <p style="color: var(--primary-200); font-size: var(--font-sm); text-align: center; line-height: 1.4;">
                            ğŸŒŸ ã“ã®åˆ†æçµæœã¯æ˜“çµŒã®æ™ºæ…§ã«åŸºã¥ãä¸€ã¤ã®è¦–ç‚¹ã§ã™<br>
                            ã‚ãªãŸè‡ªèº«ã®ç›´æ„Ÿã¨åˆã‚ã›ã¦ã€ã‚ˆã‚Šæ·±ã„è‡ªå·±ç†è§£ã«ãŠå½¹ç«‹ã¦ãã ã•ã„
                        </p>
                    </div>
                `;
                
                document.getElementById('result-summary').innerHTML = summary;
            
            saveResults(tripleOSResults) {
                try {
                    const results = {
                        timestamp: new Date().toISOString(),
                        answers: this.state.answers,
                        tripleOSResults: tripleOSResults,
                        version: '2.0',
                        HaQeiCompliant: true
                    };
                    
                    localStorage.setItem('haqei_emergency_results', JSON.stringify(results));
                    console.log('âœ… Triple OS Results saved to localStorage');
                } catch (error) {
                    console.warn('âš ï¸ Failed to save results:', error);
                }
            }
            
            showError(message) {
                this.showScreen('error-screen');
                document.getElementById('error-message').textContent = message;
                this.announce('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
            
            restart() {
                // çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
                this.state.clearState();
                this.state.currentQuestion = 0;
                this.state.answers = [];
                this.state.tripleOSResults = null;
                this.state.isAnalyzing = false;
                
                // UIåˆæœŸåŒ–
                this.initializeTrigramScores();
                this.showScreen('welcome-screen');
                this.announce('åˆ†æãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸ');
            }
            
            announce(message) {
                const announcements = document.getElementById('announcements');
                announcements.textContent = message;
                
                // ä¸€å®šæ™‚é–“å¾Œã«ã‚¯ãƒªã‚¢
                setTimeout(() => {
                    announcements.textContent = '';
                }, 3000);
            }
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        } // End CriticalCSSAnalyzer class
        
        // 5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log('ğŸ¯ HAQEI Emergency Analyzer initializing...');
                console.log('ğŸ”¯ Authentic I-Ching 64 Hexagrams Engine loaded');
                console.log('â˜° Trigram Mapping System: HaQei philosophy compliant');
                
                // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
                window.criticalCSSAnalyzer = new CriticalCSSAnalyzer();
                window.virtualPersonaEnhancer = new VirtualPersonaEnhancer();
                
                console.log('âœ… Critical CSS Analyzer ready');
                console.log('ğŸ“Š Questions loaded:', QUESTIONS.length);
                console.log('ğŸ­ Triple OS systems:', Object.keys(TRIPLE_OS).length);
                console.log('ğŸ”¯ Authentic Hexagrams loaded:', HEXAGRAMS.length);
                // console.log('ğŸ† Authentic 8D Vectors loaded:', Object.keys(AUTHENTIC_H64_8D_VECTORS).length);
                console.log('ğŸ”¯ I-Ching Orthodoxy validated: Traditional 64 Hexagram matrix');
                
            } catch (error) {
                console.error('âŒ Initialization failed:', error);
                document.body.innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: #ef4444;">
                        <h1>åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</h1>
                        <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>
                        <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #6366f1; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">
                            å†èª­ã¿è¾¼ã¿
                        </button>
                    </div>
                `;
            }
        });
        // 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
        // ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²ï¼ˆå¯èƒ½ãªå ´åˆï¼‰
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/public/haqei-sw.js')
                    .then(registration => {
                        console.log('âœ… Emergency SW registered');
                    })
                    .catch(error => {
                        console.log('âš ï¸ SW registration failed (optional)');
                    });
                } catch (error) {
                    console.error('âŒ Chart.js rendering failed:', error);
                    console.log('ğŸ“Š Chart.js fallback: Using text display instead');
            });
        
        // ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–
        window.addEventListener('beforeunload', () => {
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer = null;
        });
        
        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', (event) => {
            console.error('âŒ Global error:', event.error);
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer.showError('äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('âŒ Unhandled promise rejection:', event.reason);
            event.preventDefault();
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer.showError('å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
        });
        
        console.log('ğŸ“ HAQEI Critical CSS Analyzer script loaded');
        console.log('ğŸ† HaQeiå“²å­¦ Triple OS Engine integrated');
        console.log('âœ¨ Critical CSS optimizations applied');
        
        // ğŸš¨ çµ¶å¯¾è¦ä»¶: ç°¡æ˜“ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ©Ÿèƒ½å®Ÿè£…
        displayQuickAdvice(tripleOSResults) {
            if (!tripleOSResults) return;
            
            console.log('ğŸ’¡ Displaying quick advice');
            
            // ç°¡æ˜“ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
            let quickAdviceContainer = document.getElementById('quick-advice-container');
            if (!quickAdviceContainer) {
                quickAdviceContainer = document.createElement('div');
                quickAdviceContainer.id = 'quick-advice-container';
                quickAdviceContainer.className = 'quick-advice-section';
                
                // çµæœç”»é¢ã®æœ€å¾Œã«è¿½åŠ 
                const resultsScreen = document.getElementById('results-screen');
                if (resultsScreen) {
                    resultsScreen.appendChild(quickAdviceContainer);
                }
            }
            
            const engineOS = tripleOSResults.engineOS?.primary || 'ä¹¾';
            const interfaceOS = tripleOSResults.interfaceOS?.primary || 'å¤';
            const safeModeOS = tripleOSResults.safeModeOS?.primary || 'è‰®';
            
            const quickAdviceMessages = {
                engine: {
                    'ä¹¾': 'å‰µé€ åŠ›ã‚’æ´»ã‹ã—ã¦æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æŒ‘æˆ¦ã™ã‚‹ã“ã¨ã§ã€ã‚ãªãŸã®å¯èƒ½æ€§ãŒé–‹èŠ±ã—ã¾ã™',
                    'éœ‡': 'è¡Œå‹•åŠ›ãŒã‚ãªãŸã®å¼·ã¿ã€‚è¿·ã£ãŸã‚‰ã€ã¾ãšä¸€æ­©ã‚’è¸ã¿å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†',
                    'å': 'æ·±ãè€ƒãˆæŠœãåŠ›ãŒã‚ãªãŸã®æ­¦å™¨ã€‚æƒ…å ±åé›†ã¨åˆ†æã‚’å¤§åˆ‡ã«ã—ã¦ãã ã•ã„',
                    'è‰®': 'å®‰å®šã—ãŸåŸºç›¤ã‚’ç¯‰ãã“ã¨ã§ã€é•·æœŸçš„ãªæˆåŠŸã‚’æ‰‹ã«ã§ãã¾ã™',
                    'å¤': 'å”èª¿æ€§ã‚’æ´»ã‹ã—ã¦ã€äººã¨ã®é–¢ä¿‚ã‚’å¤§åˆ‡ã«ã™ã‚‹ã“ã¨ãŒæˆåŠŸã®éµã§ã™',
                    'å·½': 'æŸ”è»Ÿæ€§ãŒã‚ãªãŸã®ç‰¹å¾´ã€‚å¤‰åŒ–ã«å¯¾å¿œã—ãªãŒã‚‰æˆé•·ã—ã¦ã„ãã¾ã—ã‚‡ã†',
                    'é›¢': 'è¡¨ç¾åŠ›ã‚’ç£¨ãã“ã¨ã§ã€ã‚ãªãŸã®é­…åŠ›ãŒã‚ˆã‚Šè¼ãã¾ã™',
                    'å…Œ': 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›ã‚’æ´»ã‹ã—ã¦ã€äººã¨ã®ç¹‹ãŒã‚Šã‚’æ·±ã‚ã¦ã„ãã¾ã—ã‚‡ã†'
                }
            };
            
            const advice = quickAdviceMessages.engine[engineOS] || 'è‡ªåˆ†ã‚‰ã—ã•ã‚’å¤§åˆ‡ã«ã€ä¸€æ­©ä¸€æ­©å‰é€²ã—ã¦ã„ãã¾ã—ã‚‡ã†';
            
            quickAdviceContainer.innerHTML = `
                <div class="advice-section">
                    <h3>ğŸ’¡ ã‚ãªãŸã¸ã®ç°¡æ˜“ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
                    <div class="advice-content">
                        <p class="main-advice">${advice}</p>
                        <div class="os-summary">
                            <span class="os-tag engine">Engine OS: ${engineOS}</span>
                            <span class="os-tag interface">Interface OS: ${interfaceOS}</span>
                            <span class="os-tag safe">Safe Mode: ${safeModeOS}</span>
                        </div>
                    </div>
                    <div class="premium-banner">
                        <p>ğŸŒŸ <strong>Strategic Cockpit</strong>ã§è©³ç´°æˆ¦ç•¥ã‚’å…¥æ‰‹</p>
                        <button class="premium-button">Â¥2,980/æœˆã§æˆ¦ç•¥çš„æ´»ç”¨æ³•ã‚’å­¦ã¶ â†’</button>
                    </div>
                </div>
            `;
        }
        
        // ğŸš¨ çµ¶å¯¾è¦ä»¶: ç†è«–çš„ç‰¹æ€§åˆ†æå®Ÿè£…
        showTheoreticalCharacteristics(tripleOSResults) {
            if (!tripleOSResults) return;
            
            console.log('ğŸ“Š Displaying theoretical characteristics');
            
            // ç†è«–çš„ç‰¹æ€§ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
            let characteristicsContainer = document.getElementById('theoretical-characteristics-container');
            if (!characteristicsContainer) {
                characteristicsContainer = document.createElement('div');
                characteristicsContainer.id = 'theoretical-characteristics-container';
                characteristicsContainer.className = 'theoretical-characteristics-section';
                
                // çµæœç”»é¢ã®æœ€å¾Œã«è¿½åŠ 
                const resultsScreen = document.getElementById('results-screen');
                if (resultsScreen) {
                    resultsScreen.appendChild(characteristicsContainer);
                }
            }
            
            const engineOS = tripleOSResults.engineOS?.primary || 'ä¹¾';
            const interfaceOS = tripleOSResults.interfaceOS?.primary || 'å¤';
            const safeModeOS = tripleOSResults.safeModeOS?.primary || 'è‰®';
            
            const theoreticalData = {
                'ä¹¾': { type: 'å‰µé€ å‹', tendency: 'é©æ–°å¿—å‘', approach: 'å…ˆé§†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'éœ‡': { type: 'è¡Œå‹•å‹', tendency: 'å®Ÿè·µå¿—å‘', approach: 'ç©æ¥µçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'å': { type: 'æ¢ç©¶å‹', tendency: 'åˆ†æå¿—å‘', approach: 'æ…é‡ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'è‰®': { type: 'å®‰å®šå‹', tendency: 'ç¶™ç¶šå¿—å‘', approach: 'å …å®Ÿã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'å¤': { type: 'å”èª¿å‹', tendency: 'å”åƒå¿—å‘', approach: 'å”åŠ›ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'å·½': { type: 'é©å¿œå‹', tendency: 'æŸ”è»Ÿå¿—å‘', approach: 'èª¿æ•´ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'é›¢': { type: 'è¡¨ç¾å‹', tendency: 'ç™ºä¿¡å¿—å‘', approach: 'å‰µé€ ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' },
                'å…Œ': { type: 'èª¿å’Œå‹', tendency: 'ãƒãƒ©ãƒ³ã‚¹å¿—å‘', approach: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ' }
            };
            
            const engineData = theoreticalData[engineOS] || theoreticalData['ä¹¾'];
            const interfaceData = theoreticalData[interfaceOS] || theoreticalData['å¤'];
            const safeData = theoreticalData[safeModeOS] || theoreticalData['è‰®'];
            
            characteristicsContainer.innerHTML = `
                <div class="characteristics-section">
                    <h3>ğŸ“Š ç†è«–çš„ç‰¹æ€§åˆ†æ</h3>
                    <div class="characteristics-grid">
                        <div class="characteristic-card engine">
                            <h4>ğŸ¯ Engine OSç‰¹æ€§</h4>
                            <div class="characteristic-details">
                                <p><strong>ã‚¿ã‚¤ãƒ—:</strong> ${engineData.type}</p>
                                <p><strong>å‚¾å‘:</strong> ${engineData.tendency}</p>
                                <p><strong>ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> ${engineData.approach}</p>
                            </div>
                        </div>
                        <div class="characteristic-card interface">
                            <h4>ğŸ’¬ Interface OSç‰¹æ€§</h4>
                            <div class="characteristic-details">
                                <p><strong>ã‚¿ã‚¤ãƒ—:</strong> ${interfaceData.type}</p>
                                <p><strong>å‚¾å‘:</strong> ${interfaceData.tendency}</p>
                                <p><strong>ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> ${interfaceData.approach}</p>
                            </div>
                        </div>
                        <div class="characteristic-card safe">
                            <h4>ğŸ›¡ï¸ Safe Modeç‰¹æ€§</h4>
                            <div class="characteristic-details">
                                <p><strong>ã‚¿ã‚¤ãƒ—:</strong> ${safeData.type}</p>
                                <p><strong>å‚¾å‘:</strong> ${safeData.tendency}</p>
                                <p><strong>ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong> ${safeData.approach}</p>
                            </div>
                        </div>
                    </div>
                    <div class="theoretical-note">
                        <p><small>â€»ã“ã‚Œã‚‰ã®ç‰¹æ€§åˆ†æã¯æ˜“çµŒç†è«–ã«åŸºã¥ãç†è«–çš„åˆ†æã§ã™ã€‚çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</small></p>
                    </div>
                    <div class="premium-banner">
                        <p>ğŸŒŸ <strong>Strategic Cockpit</strong>ã§è©³ç´°ãªç†è«–çš„èƒŒæ™¯ã‚’å­¦ç¿’</p>
                        <button class="premium-button">Â¥2,980/æœˆã§æ·±å±¤åˆ†æã«ã‚¢ã‚¯ã‚»ã‚¹ â†’</button>
                    </div>
                </div>
            `;
        }
        

    
    
    
    
    
    </script>
</body>
</html>