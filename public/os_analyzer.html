<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="HaQei Analyzer - 古代の叡智と現代のテクノロジーが融合した、深い自己洞察体験"
    />
    <title>HaQei Analyzer - 深い自己洞察への入り口</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Shippori+Mincho:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/animations.css" />
    <link rel="stylesheet" href="css/compatibility-details.css" />
    <link rel="stylesheet" href="css/polish.css" />
    <link rel="stylesheet" href="css/personality-os-boot-sequence.css" />
    <link rel="stylesheet" href="css/interactive-ui.css" />
    <link rel="stylesheet" href="css/strategic-dashboard.css" />

    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  </head>
  <body>
    <!-- Global Progress Indicator -->
    <div class="global-progress">
      <div class="progress-bar" style="width: var(--progress, 0%)"></div>
    </div>

    <!-- Main Application Container -->
    <div id="app" class="app-container">
      <!-- Welcome Screen -->
      <section id="welcome-container" class="screen-container">
        <!-- WelcomeScreen component will render here -->
      </section>

      <!-- Questions Flow -->
      <section
        id="questions-container"
        class="screen-container"
        style="display: none"
      >
        <!-- QuestionFlow component will render here -->
      </section>

      <!-- Analysis View -->
      <section
        id="analysis-container"
        class="screen-container"
        style="display: none"
      >
        <!-- AnalysisView component will render here -->
      </section>

      <!-- Results View -->
      <section
        id="results-container"
        class="screen-container"
        style="display: none"
      >
        <!-- ResultsView component will render here -->
      </section>

      <!-- Deep Insights Panel -->
      <section
        id="insights-container"
        class="screen-container"
        style="display: none"
      >
        <!-- InsightPanel component will render here -->
      </section>
    </div>

    <!-- 共通ライブラリ -->
    <script src="./js/shared/core/BaseComponent.js"></script>
    <script src="./js/shared/core/StorageManager.js"></script>
    <script src="./js/shared/core/DataManager.js"></script>
    <script src="./js/shared/core/ErrorHandler.js"></script>
    <script src="./js/shared/utils/validators.js"></script>
    <script src="./js/shared/utils/animations.js"></script>
    <script src="./js/shared/data/questions.js"></script>
    <script src="./js/shared/data/vectors.js"></script>

    <!-- 共通データファイル -->
    <script src="./js/data/data_box.js"></script>
    <script src="./js/data/compatibility_definition.js"></script>
    <script src="./assets/os_manual_database.js"></script>

    <!-- OS Analyzer専用データ -->
    <script src="./js/os-analyzer/data/hexagrams.js"></script>
    <script src="./js/os-analyzer/data/hexagram_details.js"></script>
    <script src="./js/os-analyzer/data/compatibility_matrix.js"></script>
    <script src="./js/os-analyzer/data/action_plans.js"></script>

    <!-- ユーティリティ -->
    <script src="js/utils/hexagram-dynamics-calculator.js"></script>
    <script src="js/utils/hexagram-details-fallback.js"></script>

    <!-- OS Analyzerコアエンジン -->
    <script
      src="js/os-analyzer/core/Calculator.js"
      onerror="console.error('❌ Failed to load Calculator.js')"
    ></script>
    <script
      src="js/os-analyzer/engines/CompatibilityDataLoader.js"
      onerror="console.error('❌ Failed to load CompatibilityDataLoader.js')"
    ></script>
    <script
      src="js/os-analyzer/core/Engine.js"
      onerror="console.error('❌ Failed to load Engine.js')"
    ></script>
    <script
      src="js/os-analyzer/core/TripleOSEngine.js"
      onerror="console.error('❌ Failed to load TripleOSEngine.js')"
    ></script>
    <script
      src="js/os-analyzer/core/PersonalStrategyAI.js"
      onerror="console.error('❌ Failed to load PersonalStrategyAI.js')"
    ></script>
    <script
      src="js/os-analyzer/engines/CompatibilityEngine.js"
      onerror="console.error('❌ Failed to load CompatibilityEngine.js')"
    ></script>
    <script
      src="js/os-analyzer/engines/InsightEngine.js"
      onerror="console.error('❌ Failed to load InsightEngine.js')"
    ></script>

    <script>
      console.log("🔍 [Debug] コアクラス読み込み完了チェック");
      console.log("DataManager:", typeof DataManager);
      console.log("Calculator:", typeof Calculator);
      console.log("TripleOSEngine:", typeof TripleOSEngine);
    </script>

    <!-- OS Analyzerコンポーネント -->
    <script
      src="js/os-analyzer/components/WelcomeScreen.js"
      onerror="console.error('❌ Failed to load WelcomeScreen.js')"
    ></script>
    <script
      src="js/os-analyzer/components/QuestionFlow.js"
      onerror="console.error('❌ Failed to load QuestionFlow.js')"
    ></script>
    <script
      src="js/os-analyzer/components/AnalysisView.js"
      onerror="console.error('❌ Failed to load AnalysisView.js')"
    ></script>
    <script
      src="js/os-analyzer/components/ResultsView.js"
      onerror="console.error('❌ Failed to load ResultsView.js')"
    ></script>
    <script
      src="js/components/TripleOSResultsView.js"
      onerror="console.error('❌ Failed to load TripleOSResultsView.js')"
    ></script>
    <script
      src="js/components/TripleOSStrategicView.js"
      onerror="console.error('❌ Failed to load TripleOSStrategicView.js')"
    ></script>
    <script
      src="js/components/InteractiveConnectionsVisualizer.js"
      onerror="console.error('❌ Failed to load InteractiveConnectionsVisualizer.js')"
    ></script>
    <script
      src="js/components/InsightPanel.js"
      onerror="console.error('❌ Failed to load InsightPanel.js')"
    ></script>

    <script>
      console.log("🔍 [Debug] コンポーネント読み込み完了チェック");
      console.log("WelcomeScreen:", typeof WelcomeScreen);
      console.log("QuestionFlow:", typeof QuestionFlow);
      console.log("TripleOSResultsView:", typeof TripleOSResultsView);
    </script>

    <script>
      console.log(
        "🕵️‍♂️ [TRACE-CHECKPOINT 1] app.js実行直前のクラス定義を検証します。"
      );
      console.log(
        " -> TripleOSResultsViewは存在するか？:",
        typeof TripleOSResultsView
      );
      console.log(
        " -> CompatibilityDataLoaderは存在するか？:",
        typeof CompatibilityDataLoader
      );
    </script>

    <script src="js/app.js"></script>

    <!-- メインアプリケーション -->
  </body>
</html>
