# データ駆動型アプローチへの転換

## 実施日時
2025年1月13日

## 方針転換の内容

### 問題認識
- HAQEIは占いではなく、データ分析システム
- H384データベースに既に384個の爻ごとのキーワードと解釈が存在
- これらを直接活用すべき

### 実装した新アプローチ

#### DataDrivenKeywordAnalyzer.js
データベースのスコアと解釈を直接活用するクラス

1. **キーワード関係性マップの構築**
```javascript
buildKeywordRelationMap() {
    // 各爻のキーワード、解釈、スコアを保存
    this.keywordMap.set(key, {
        keywords: entry['キーワード'],
        interpretation: entry['現代解釈の要約'],
        scores: {
            basic: S1_基本スコア,
            potential: S2_ポテンシャル,
            stability: S3_安定性スコア,
            risk: S4_リスク,
            volatility: S6_変動性スコア,
            total: S7_総合評価スコア
        }
    });
}
```

2. **進爻関係性の生成（データベース基準）**
- スコアの変化から関係性を判断
- 総合評価、安定性、リスクの変化を分析
- 現代解釈の要約を活用した説明生成

3. **変爻転換の生成（データベース基準）**
- 卦の変化による質的転換を表現
- 変動性、ポテンシャルの変化を重視
- 異なる卦の解釈を組み合わせた説明

4. **スコアベースの推薦システム**
```javascript
recommendNextStep(currentHex, currentLine, objective) {
    // 目的別評価
    - stability: 安定性重視
    - growth: 成長重視
    - safety: 安全重視
    - change: 変化重視
}
```

### 占い的要素の排除

#### 削除した要素
- 固定カテゴリ分類（preparation, cooperation等）
- 吉凶判断の主観的解釈
- 意味的カテゴリのハードコーディング

#### 追加したデータ駆動要素
- S1〜S7スコアの直接活用
- 現代解釈の要約の動的利用
- スコア変化に基づく客観的評価

### 活用するデータベースフィールド

1. **キーワード**: 各爻の特徴を表す3つのキーワード
2. **現代解釈の要約**: 現代的文脈での意味
3. **S1_基本スコア**: 基本的な評価（0-100）
4. **S2_ポテンシャル**: 潜在的可能性（0-100）
5. **S3_安定性スコア**: 安定度（0-100）
6. **S4_リスク**: リスク度（-100〜0）
7. **S5_主体性推奨スタンス**: 能動/受動/中立
8. **S6_変動性スコア**: 変化の激しさ（0-100）
9. **S7_総合評価スコア**: 総合的な評価（0-100）

### 実装例

```javascript
// 進爻の関係性生成
if (scoreChange > 20) {
    return `総合評価が${scoreChange}ポイント向上し、
            ${fromData.interpretation}から
            ${toData.interpretation}への自然な成長過程`;
}

// 変爻の転換生成
if (volatilityChange > 20) {
    return `変動性が${volatilityChange}ポイント増加し、
            ${toData.interpretation}という新たな局面への転換`;
}
```

## 結果

- 占い的な主観を排除
- データベースの客観的スコアに基づく分析
- 現代解釈の要約を活用した具体的な説明
- ユーザーの目的に応じた推薦機能

これにより、HAQEIの本来の目的である「データ駆動型の戦略分析」が実現されます。