# HAQEI 30問システム統合分析

## Phase 2: 計画段階 - データ統合方針

### 📋 データソース分析完了

#### 1. haqei-vue/src/data/questions.ts の詳細分析
- **総質問数**: 24問（価値観設問）+ 6問（シナリオ設問予定） = 30問完全版
- **構造**: TypeScript型定義によるデータ構造
- **8次元分類**: 乾/震/坎/艮/坤/巽/離/兌の8次元完全対応
- **スコアリングシステム**: scoring_tags配列による詳細スコアリング
- **選択肢**: 各質問5選択肢（A-E）完全対応

#### 2. 現行os_analyzer.html の状況
- **現在**: 12問システム（既存メモリで復元確認済み）
- **必要**: 24問→30問への完全拡張
- **互換性**: JavaScript形式への変換必要

### 🔧 統合実装計画

#### Phase 3: 実装段階計画

1. **データ変換**（TypeScript → JavaScript）
   - scoring_tags → scoring オブジェクト形式変換
   - koui_level データ統合
   - 8次元分類の正確な対応

2. **QUESTIONS配列拡張**（os_analyzer.html）
   - 行1042-1179: 現在の12問配列置換
   - Q1-Q24: 価値観設問統合
   - Q25-Q30: シナリオ設問統合（SCENARIO_QUESTIONS_EXTENDED参照）

3. **スコアリングシステム更新**
   - 8次元スコアリング完全対応
   - conflicting/complementary タイプ対応
   - koui_level（爻レベル）統合

### 📊 技術的詳細

#### データ構造対応表
```javascript
// TypeScript形式（ソース）
scoring_tags: [
  { key: "乾_創造性", value: 3.0 },
  { key: "離_表現性", value: 1.5, type: "complementary" },
  { key: "艮_安定性", value: -1.0, type: "conflicting" }
]

// JavaScript形式（変換後）
scoring: { 
  "乾_創造性": 3.0, 
  "離_表現性": 1.5, 
  "艮_安定性": -1.0 
}
```

#### 8次元完全対応
- Q1-Q3: 乾_創造性（新しい物事への取り組み方）
- Q4-Q6: 震_行動性（行動への取り組み方）
- Q7-Q9: 坎_探求性（知識・理解への取り組み方）
- Q10-Q12: 艮_安定性（持続性・確実性への価値観）
- Q13-Q15: 坤_受容性（他者との関わり方・受け入れる力）
- Q16-Q18: 巽_適応性（変化・状況への適応力）
- Q19-Q21: 離_表現性（自己表現力・影響力）
- Q22-Q24: 兌_調和性（協調性・調和を重視する力）

### 🎯 次段階実行準備

#### TDD Red-Green-Refactor準備
1. **RED**: 30問フローのテスト失敗確認
2. **GREEN**: データ統合による30問システム実装
3. **REFACTOR**: コード品質向上とエラーハンドリング

#### 品質保証準備
- Playwright自動テスト準備
- ユーザーフロー完全検証
- スクリーンショット証拠収集

### 📝 実装優先度

**最高優先**: Q1-Q24の価値観設問統合（Triple OS 診断精度向上）
**中優先**: Q25-Q30のシナリオ設問統合（Interface/Safe Mode OS特定）
**低優先**: UI改善・進捗バー調整

## 結論

haqei-vue/src/data/questions.tsは完全な30問データソースとして確認。
TypeScriptからJavaScriptへの正確な変換により、12問→30問への完全拡張が可能。