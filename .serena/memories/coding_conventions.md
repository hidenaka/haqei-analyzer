# コーディング規約とスタイルガイド

## 📝 コーディング規約

### TypeScript/JavaScript
- **ES6+**: モダンJavaScript構文使用
- **厳密型定義**: TypeScriptでの型安全性重視
- **関数型アプローチ**: 純粋関数とイミュータブルデータ優先
- **モジュラー設計**: 機能別の明確な分離

### ファイル命名規則
- **Vueコンポーネント**: PascalCase (e.g., `QuestionFlow.vue`)
- **TypeScriptファイル**: camelCase (e.g., `useTripleOS.ts`)
- **CSSファイル**: kebab-case (e.g., `question-flow.css`)
- **テストファイル**: `*.spec.ts`

### 関数仕様コメント（必須）
すべての関数・メソッドに詳細な仕様コメントを記述：

```javascript
/**
 * 現在の設問のみを表示し、他のすべての設問を非表示にする
 *
 * 目的：
 * - 仮想スクロールの一環として、現在アクティブな設問のみを画面に表示
 * - メモリ効率とレンダリングパフォーマンスの最適化
 *
 * 処理内容：
 * 1. activeElements Map内のすべての要素をループ
 * 2. currentQuestionIndexと一致するインデックスの要素のみ表示
 * 3. それ以外の要素は非表示に設定
 *
 * 副作用：
 * - DOM要素のstyle属性を直接変更
 * - CSSクラス（active-question）の追加/削除
 *
 * 前提条件：
 * - activeElements Mapが初期化済み
 * - currentQuestionIndexが有効な範囲内
 */
```

## 🎨 UI/UXガイドライン

### 基本スタンス
- **断定的表現を避ける**: 「あなたは○○です」→「○○という側面があります」
- **ユーザー主権**: 解釈と判断はユーザーに委ねる
- **提案的表現**: 示唆に留めて自己決定を促す

### CSS設計
- **CSS変数システム**: テーマ管理とメンテナンス性
- **モバイルファースト**: レスポンシブデザイン
- **アクセシビリティ**: ARIA対応、キーボードナビゲーション

## 🔒 セキュリティガイドライン

### 基本原則
- **防御的セキュリティ**: 入力値の厳格なバリデーション
- **XSS対策**: ユーザー入力のサニタイズ
- **個人情報保護**: ローカルストレージでの適切な暗号化

### 禁止事項
- プロンプトインジェクション対策コードの削除
- セキュリティ関連機能の弱体化
- ユーザーデータの外部送信

## 🧪 テスト方針

### ユニットテスト
- **カバレッジ目標**: 80%以上
- **テストファースト**: 新機能実装時は必ずテストから開始
- **Mock使用**: 外部依存の適切な分離

### E2Eテスト
- **主要フロー**: ユーザージャーニーの完全テスト
- **ブラウザ互換性**: Chrome、Firefox、Safari対応
- **レスポンシブ**: モバイル・タブレット対応確認

## ⚠️ 特別な注意事項

### 偶数番設問表示問題対策
- **統一処理**: 偶数・奇数で異なる表示処理を実装しない
- **CSS競合回避**: `!important`の使用を避ける
- **JavaScript制御**: 表示制御はJavaScriptで統一

### HaQei哲学統合
- **易経的アプローチ**: 陰陽バランスの考慮
- **Triple OSアーキテクチャ**: 各OSの独立性維持
- **ユーザー主権**: プライバシーファースト設計