# 不要ファイル整理戦略提案書

**作成日**: 2025年8月18日  
**目的**: 未整理ファイルの体系的な処理方針策定

## 🔍 現状分析

### 数値データ
- **js/直下の残存ファイル**: 30個
- **日付付き・テストファイル**: 24個  
- **HTMLから参照**: 9ファイルのみ
- **作成時期**: 主に8月13-14日（開発ラッシュ期）

### 問題の根本原因（5WHY分析）
```
問題: 不要ファイルが大量に存在
Why1: なぜ？ → 整理せずに作り続けた
Why2: なぜ？ → 「動けばOK」の開発文化
Why3: なぜ？ → 短期間での機能追加圧力
Why4: なぜ？ → 体系的な設計の欠如
Why5: なぜ？ → プロジェクト初期の計画不足
```

## 🎯 提案する4段階分類システム

### 1. KEEP（保持）
**定義**: 現在確実に使用中のファイル
```
判定基準:
- HTMLから直接参照されている
- 最近（3日以内）更新されている
- core機能として必須

対象例:
- QuestionManager.js
- ScreenManager.js
- error-handler.js
```

### 2. ARCHIVE（アーカイブ）
**定義**: 現在未使用だが、将来参照の可能性あり
```
判定基準:
- 実装のリファレンスになる
- 特定機能の完全版
- ドキュメント的価値

処理: /archives/2025-08/へ移動
```

### 3. QUARANTINE（隔離）
**定義**: 判断保留、検証が必要
```
判定基準:
- 参照関係が不明
- 動的にロードされる可能性
- 依存関係が複雑

処理: /quarantine/へ一時移動（30日後に削除）
```

### 4. DELETE（削除）
**定義**: 明らかに不要
```
判定基準:
- 明確な重複ファイル
- 日付付きテストファイル（7日以上経過）
- .backup、.old等の拡張子

処理: 即削除（事前にリスト化）
```

## 📋 段階的実行計画

### Phase 1: 準備と分類（即実行）
```bash
# ディレクトリ作成
mkdir -p archives/2025-08
mkdir -p quarantine

# ファイルリスト作成
find public/js -maxdepth 1 -name "*.js" > file-list.txt

# 参照チェックスクリプト作成
```

### Phase 2: 安全な移動（Day 1）
1. **DELETE候補を削除**
   - 20250814_*.js等の日付付きファイル
   - test-*.js（1週間以上経過）
   - *.backup.js、*.old.js

2. **ARCHIVE候補を移動**
   - V2Components*.js
   - 古いバージョンファイル

3. **QUARANTINE候補を隔離**
   - 参照不明のファイル
   - 判断保留のファイル

### Phase 3: 監視期間（Day 2-7）
- エラーログ監視
- ユーザーフィードバック収集
- 動作確認テスト

### Phase 4: 最終処理（Day 8）
- Quarantineファイルの最終判定
- 不要ファイルの完全削除
- ドキュメント更新

## 🛡️ リスク管理

### バックアップ戦略
```bash
# 実行前の完全バックアップ
tar -czf backup-$(date +%Y%m%d-%H%M%S).tar.gz public/

# 削除ファイルリストの保存
echo "削除日時: $(date)" > deleted-files.log
```

### ロールバック計画
- バックアップから即座に復元可能
- Git履歴からの復元も可能

## 📊 期待効果

### 定量的効果
- ファイル数: 30個 → 10個以下（67%削減）
- 管理コスト: 80%削減
- 検索効率: 3倍向上

### 定性的効果
- コードベースの見通し向上
- 新規開発者の理解容易化
- メンテナンス性の大幅改善

## 🔄 再発防止策

### 1. 開発ルールの徹底
- PR時のファイル配置レビュー
- 週次のファイル整理タスク

### 2. 自動化ツール
```javascript
// cleanup-check.js
const checkUnusedFiles = () => {
  // 未使用ファイル検出
  // 日付付きファイル警告
  // 重複ファイル検出
};
```

### 3. CI/CDパイプライン
- ファイル構造チェック
- 未使用ファイル警告
- 自動アーカイブ

## 📝 実行判断チェックリスト

実行前に確認：
- [ ] 完全バックアップ作成済み
- [ ] ユーザーへの事前通知完了
- [ ] テスト環境での検証済み
- [ ] ロールバック手順確認済み
- [ ] 削除対象リスト作成済み

## 💡 推奨事項

### 即時実行推奨
1. **DELETE分類の処理**（リスク低）
   - 日付付きテストファイル
   - 明確な重複

2. **ディレクトリ準備**
   - archives/フォルダ作成
   - quarantine/フォルダ作成

### 段階的実行推奨
1. **QUARANTINE処理**（1週間の観察期間）
2. **ARCHIVE処理**（月次で見直し）

## 結論

**推奨アプローチ**: 段階的整理with観察期間

理由：
1. リスク最小化
2. 影響の可視化
3. ロールバック容易性

この戦略により、安全かつ確実に不要ファイルを整理し、
今後の再発も防止できます。