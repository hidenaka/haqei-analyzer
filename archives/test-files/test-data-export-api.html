<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataExportAPI ãƒ†ã‚¹ãƒˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="./js/core/DataPersistenceManager.js"></script>
    <script src="./js/core/DataExportAPI.js"></script>
</head>
<body class="bg-gray-900 text-white p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center">DataExportAPI ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">1. ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ</h2>
                <button id="testInitBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded mb-2">
                    åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                </button>
                <div id="initResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
            
            <!-- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">2. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ</h2>
                <button id="createTestDataBtn" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded mb-2">
                    ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ
                </button>
                <div id="testDataResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
            
            <!-- JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">3. JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ</h2>
                <button id="testJSONExportBtn" class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded mb-2">
                    JSONå½¢å¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                </button>
                <div id="jsonExportResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
            
            <!-- CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">4. CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ</h2>
                <button id="testCSVExportBtn" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded mb-2">
                    CSVå½¢å¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                </button>
                <div id="csvExportResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
            
            <!-- PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">5. PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ</h2>
                <button id="testPDFExportBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded mb-2">
                    PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
                </button>
                <div id="pdfExportResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
            
            <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-semibold mb-4">6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
                <button id="testPerformanceBtn" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded mb-2">
                    ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
                </button>
                <div id="performanceResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
            </div>
        </div>
        
        <!-- çµ±è¨ˆæƒ…å ± -->
        <div class="bg-gray-800 p-6 rounded-lg mt-6">
            <h2 class="text-xl font-semibold mb-4">ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆ</h2>
            <button id="showStatsBtn" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded mb-2">
                çµ±è¨ˆæƒ…å ±è¡¨ç¤º
            </button>
            <div id="statsResult" class="text-sm bg-gray-700 p-3 rounded min-h-16"></div>
        </div>
    </div>

    <script>
        let dataExportAPI = null;
        let dataPersistence = null;
        
        document.addEventListener('DOMContentLoaded', async () => {
            // ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
            document.getElementById('testInitBtn').addEventListener('click', testInitialization);
            document.getElementById('createTestDataBtn').addEventListener('click', createTestData);
            document.getElementById('testJSONExportBtn').addEventListener('click', testJSONExport);
            document.getElementById('testCSVExportBtn').addEventListener('click', testCSVExport);
            document.getElementById('testPDFExportBtn').addEventListener('click', testPDFExport);
            document.getElementById('testPerformanceBtn').addEventListener('click', testPerformance);
            document.getElementById('showStatsBtn').addEventListener('click', showStatistics);
        });
        
        // 1. åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ
        async function testInitialization() {
            const resultDiv = document.getElementById('initResult');
            resultDiv.innerHTML = 'åˆæœŸåŒ–ä¸­...';
            
            try {
                console.log('ğŸ§ª DataExportAPIåˆæœŸåŒ–ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // DataPersistenceManageråˆæœŸåŒ–
                if (window.DataPersistenceManager) {
                    dataPersistence = new window.DataPersistenceManager();
                    const persistenceResult = await dataPersistence.initialize();
                    console.log('DataPersistenceManageråˆæœŸåŒ–çµæœ:', persistenceResult);
                }
                
                // DataExportAPIåˆæœŸåŒ–
                if (window.DataExportAPI) {
                    dataExportAPI = new window.DataExportAPI();
                    const exportResult = await dataExportAPI.initialize();
                    
                    if (exportResult.success) {
                        resultDiv.innerHTML = `
                            âœ… åˆæœŸåŒ–æˆåŠŸ<br>
                            - åˆæœŸåŒ–æ™‚é–“: ${exportResult.initializationTime.toFixed(2)}ms<br>
                            - DataPersistence: ${exportResult.features.dataPersistence ? 'âœ…' : 'âŒ'}<br>
                            - WebWorker: ${exportResult.features.webWorker ? 'âœ…' : 'âŒ'}<br>
                            - æš—å·åŒ–: ${exportResult.features.encryption ? 'âœ…' : 'âŒ'}
                        `;
                    } else {
                        throw new Error(exportResult.message);
                    }
                } else {
                    throw new Error('DataExportAPIã‚¯ãƒ©ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
                
            } catch (error) {
                console.error('âŒ åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // 2. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ
        async function createTestData() {
            const resultDiv = document.getElementById('testDataResult');
            resultDiv.innerHTML = 'ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆä¸­...';
            
            try {
                if (!dataPersistence) {
                    throw new Error('DataPersistenceManagerãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                console.log('ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆé–‹å§‹');
                
                // ãƒ†ã‚¹ãƒˆç”¨åˆ†æãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
                const testAnalyses = [];
                for (let i = 0; i < 10; i++) {
                    const analysisData = {
                        inputAnalysis: {
                            originalText: `ãƒ†ã‚¹ãƒˆåˆ†æ ${i + 1}`,
                            textLength: 50 + i * 10,
                            complexity: i % 3 === 0 ? 'high' : i % 3 === 1 ? 'medium' : 'low'
                        },
                        finalResult: {
                            hexagram: (i % 64) + 1,
                            line: (i % 6) + 1,
                            confidence: 0.7 + (i * 0.03),
                            reasoning: `ãƒ†ã‚¹ãƒˆæ¨è«– ${i + 1}`,
                            tripleOSIntegration: {
                                engine: 'test-engine',
                                interface: 'test-interface',
                                safeMode: i % 2 === 0
                            }
                        },
                        stageResults: {
                            stage1: { result: `stage1_result_${i}` },
                            stage2: { result: `stage2_result_${i}` },
                            stage3: { result: `stage3_result_${i}` }
                        },
                        qualityMetrics: {
                            overallScore: 0.8 + (i * 0.02),
                            accuracy: 0.75 + (i * 0.025)
                        },
                        systemInfo: {
                            version: '1.0.0-test',
                            timestamp: Date.now() - (i * 60000)
                        }
                    };
                    
                    // ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿
                    const patterns = [
                        {
                            type: `pattern_type_${i}`,
                            patternData: { 
                                content: `Pattern content ${i}`,
                                confidence: 0.8 + (i * 0.01)
                            }
                        }
                    ];
                    
                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
                    const userProfile = {
                        testUser: true,
                        userId: `test_user_${i}`,
                        preferences: {
                            language: 'ja',
                            complexity: analysisData.inputAnalysis.complexity
                        }
                    };
                    
                    // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
                    const saveResult = await dataPersistence.saveAnalysisResult(
                        analysisData, 
                        patterns, 
                        userProfile
                    );
                    
                    if (saveResult.success) {
                        testAnalyses.push({
                            analysisId: saveResult.analysisId,
                            ...analysisData
                        });
                    }
                }
                
                resultDiv.innerHTML = `
                    âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆå®Œäº†<br>
                    - ä½œæˆä»¶æ•°: ${testAnalyses.length}ä»¶<br>
                    - ä¿å­˜æˆåŠŸ: ${testAnalyses.length}ä»¶<br>
                    - æ˜“çµŒåˆ†å¸ƒ: 1-${Math.max(...testAnalyses.map(a => a.finalResult.hexagram))}ç•ª<br>
                    - ä¿¡é ¼åº¦ç¯„å›²: ${Math.min(...testAnalyses.map(a => a.finalResult.confidence)).toFixed(2)}-${Math.max(...testAnalyses.map(a => a.finalResult.confidence)).toFixed(2)}
                `;
                
            } catch (error) {
                console.error('âŒ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // 3. JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ
        async function testJSONExport() {
            const resultDiv = document.getElementById('jsonExportResult');
            resultDiv.innerHTML = 'JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆä¸­...';
            
            try {
                if (!dataExportAPI) {
                    throw new Error('DataExportAPIãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                console.log('ğŸ§ª JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const startTime = performance.now();
                const result = await dataExportAPI.exportCompleteData({
                    format: 'json',
                    includePatterns: true,
                    anonymize: true,
                    compress: false
                });
                const exportTime = performance.now() - startTime;
                
                if (result.success) {
                    const dataSize = JSON.stringify(result.data).length;
                    
                    resultDiv.innerHTML = `
                        âœ… JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæˆåŠŸ<br>
                        - ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: ${result.metadata.recordsCount}ä»¶<br>
                        - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚é–“: ${exportTime.toFixed(2)}ms<br>
                        - ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${formatFileSize(dataSize)}<br>
                        - Gemini APIæº–å‚™: ${result.metadata.geminiApiReady ? 'âœ…' : 'âŒ'}<br>
                        - ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ${result.metadata.version}
                    `;
                    
                    // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
                    console.log('JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆçµæœã‚µãƒ³ãƒ—ãƒ«:', result.data);
                } else {
                    throw new Error(result.error);
                }
                
            } catch (error) {
                console.error('âŒ JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // 4. CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ
        async function testCSVExport() {
            const resultDiv = document.getElementById('csvExportResult');
            resultDiv.innerHTML = 'CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆä¸­...';
            
            try {
                if (!dataExportAPI) {
                    throw new Error('DataExportAPIãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                console.log('ğŸ§ª CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const startTime = performance.now();
                const result = await dataExportAPI.exportToCSV({
                    includeHeaders: true,
                    anonymize: true,
                    delimiter: ','
                });
                const exportTime = performance.now() - startTime;
                
                if (result.success) {
                    const lines = result.data.split('\n');
                    
                    resultDiv.innerHTML = `
                        âœ… CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæˆåŠŸ<br>
                        - ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: ${result.metadata.recordsCount}ä»¶<br>
                        - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚é–“: ${exportTime.toFixed(2)}ms<br>
                        - ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${formatFileSize(result.metadata.dataSize)}<br>
                        - è¡Œæ•°: ${lines.length}è¡Œ<br>
                        - ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°: ${result.metadata.encoding}
                    `;
                    
                    // CSVã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º
                    console.log('CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆçµæœã‚µãƒ³ãƒ—ãƒ«:', lines.slice(0, 5).join('\n'));
                } else {
                    throw new Error(result.error);
                }
                
            } catch (error) {
                console.error('âŒ CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // 5. PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ
        async function testPDFExport() {
            const resultDiv = document.getElementById('pdfExportResult');
            resultDiv.innerHTML = 'PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆä¸­...';
            
            try {
                if (!dataExportAPI) {
                    throw new Error('DataExportAPIãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                console.log('ğŸ§ª PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const startTime = performance.now();
                const result = await dataExportAPI.preparePDFReportData({
                    includeCharts: true,
                    includeStatistics: true,
                    anonymize: true,
                    language: 'ja'
                });
                const exportTime = performance.now() - startTime;
                
                if (result.success) {
                    resultDiv.innerHTML = `
                        âœ… PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ç”ŸæˆæˆåŠŸ<br>
                        - ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: ${result.metadata.recordsCount}ä»¶<br>
                        - ç”Ÿæˆæ™‚é–“: ${exportTime.toFixed(2)}ms<br>
                        - è¨€èª: ${result.metadata.language}<br>
                        - ãƒãƒ£ãƒ¼ãƒˆå«æœ‰: ${result.metadata.chartsIncluded ? 'âœ…' : 'âŒ'}<br>
                        - ãƒ¬ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³: ${Object.keys(result.data).length}å€‹
                    `;
                    
                    // PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º
                    console.log('PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿çµæœã‚µãƒ³ãƒ—ãƒ«:', result.data);
                } else {
                    throw new Error(result.error);
                }
                
            } catch (error) {
                console.error('âŒ PDFæº–å‚™ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
        async function testPerformance() {
            const resultDiv = document.getElementById('performanceResult');
            resultDiv.innerHTML = 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...';
            
            try {
                if (!dataExportAPI) {
                    throw new Error('DataExportAPIãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                console.log('ğŸ§ª ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // è¤‡æ•°å›ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
                const results = [];
                const iterations = 3;
                
                for (let i = 0; i < iterations; i++) {
                    const startTime = performance.now();
                    const result = await dataExportAPI.exportCompleteData({
                        format: 'json',
                        anonymize: true,
                        compress: true
                    });
                    const endTime = performance.now();
                    
                    if (result.success) {
                        results.push({
                            iteration: i + 1,
                            time: endTime - startTime,
                            recordsCount: result.metadata.recordsCount,
                            dataSize: JSON.stringify(result.data).length
                        });
                    }
                }
                
                // çµ±è¨ˆè¨ˆç®—
                const avgTime = results.reduce((sum, r) => sum + r.time, 0) / results.length;
                const maxTime = Math.max(...results.map(r => r.time));
                const minTime = Math.min(...results.map(r => r.time));
                const totalRecords = results[0]?.recordsCount || 0;
                const recordsPerSecond = totalRecords / (avgTime / 1000);
                
                resultDiv.innerHTML = `
                    âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†<br>
                    - ãƒ†ã‚¹ãƒˆå›æ•°: ${iterations}å›<br>
                    - å¹³å‡æ™‚é–“: ${avgTime.toFixed(2)}ms<br>
                    - æœ€çŸ­æ™‚é–“: ${minTime.toFixed(2)}ms<br>
                    - æœ€é•·æ™‚é–“: ${maxTime.toFixed(2)}ms<br>
                    - å‡¦ç†é€Ÿåº¦: ${recordsPerSecond.toFixed(2)}ä»¶/ç§’<br>
                    - æ€§èƒ½ç›®æ¨™: ${avgTime < 5000 ? 'âœ… é”æˆ' : 'âŒ æœªé”æˆ'} (5ç§’ä»¥å†…)
                `;
                
            } catch (error) {
                console.error('âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // çµ±è¨ˆæƒ…å ±è¡¨ç¤º
        async function showStatistics() {
            const resultDiv = document.getElementById('statsResult');
            resultDiv.innerHTML = 'çµ±è¨ˆæƒ…å ±å–å¾—ä¸­...';
            
            try {
                if (!dataExportAPI) {
                    throw new Error('DataExportAPIãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                const stats = dataExportAPI.getPerformanceStatistics();
                
                resultDiv.innerHTML = `
                    ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆæƒ…å ±<br>
                    <strong>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆçµ±è¨ˆ:</strong><br>
                    - ç·ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå›æ•°: ${stats.exports.total}å›<br>
                    - æˆåŠŸç‡: ${stats.exports.successRate.toFixed(1)}%<br>
                    - å¹³å‡ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚é–“: ${stats.performance.averageExportTime.toFixed(2)}ms<br>
                    - ç·ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚µã‚¤ã‚º: ${formatFileSize(stats.performance.totalBytesExported)}<br>
                    <strong>ã‚·ã‚¹ãƒ†ãƒ æ©Ÿèƒ½:</strong><br>
                    - WebWorker: ${stats.system.webWorkerEnabled ? 'âœ…' : 'âŒ'}<br>
                    - åœ§ç¸®: ${stats.system.compressionEnabled ? 'âœ…' : 'âŒ'}<br>
                    - æš—å·åŒ–: ${stats.system.encryptionEnabled ? 'âœ…' : 'âŒ'}
                `;
                
            } catch (error) {
                console.error('âŒ çµ±è¨ˆæƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
    </script>
</body>
</html>