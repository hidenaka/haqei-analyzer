<\!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAQEI ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆçµæœ</title>
    <style>
        body { font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: #2a2a2a; padding: 30px; border-radius: 10px; }
        .section { background: #3a3a3a; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .success { border-left: 4px solid #10b981; }
        .warning { border-left: 4px solid #f59e0b; }
        .error { border-left: 4px solid #ef4444; }
        .test-button { background: #6366f1; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .result { background: #1f1f1f; padding: 15px; border-radius: 5px; font-family: monospace; margin: 10px 0; }
        iframe { width: 100%; height: 600px; border: 2px solid #6366f1; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ HAQEI OS Analyzer ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="section success">
            <h2>âœ… åŸºæœ¬ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³</h2>
            <ul>
                <li>âœ… ã‚µãƒ¼ãƒãƒ¼ç¨¼åƒä¸­: localhost:8000</li>
                <li>âœ… os_analyzer.html ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½</li>
                <li>âœ… ä¸»è¦JavaScriptãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèªæ¸ˆã¿</li>
                <li>âœ… CSSãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿è¨­å®šå®Œäº†</li>
            </ul>
        </div>

        <div class="section">
            <h2>ğŸš€ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ†ã‚¹ãƒˆ</h2>
            <button class="test-button" onclick="runQuickTest()">ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button class="test-button" onclick="checkConsoleErrors()">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ç¢ºèª</button>
            <button class="test-button" onclick="testQuestionFlow()">è³ªå•ãƒ•ãƒ­ãƒ¼ç¢ºèª</button>
            <div id="testResults" class="result">ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>

        <div class="section">
            <h2>ğŸ“± OS Analyzer å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆ</h2>
            <iframe src="http://localhost:8000/public/os_analyzer.html" id="testFrame"></iframe>
        </div>
    </div>

    <script>
        function log(message) {
            const testResults = document.getElementById("testResults");
            const timestamp = new Date().toLocaleTimeString();
            testResults.innerHTML += "[" + timestamp + "] " + message + "<br>";
            testResults.scrollTop = testResults.scrollHeight;
        }
        
        function runQuickTest() {
            log("ğŸ¯ ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆé–‹å§‹");
            
            const iframe = document.getElementById("testFrame");
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            setTimeout(() => {
                log("iframeèª­ã¿è¾¼ã¿å¾…æ©Ÿä¸­...");
                
                setTimeout(() => {
                    const iframeWindow = iframe.contentWindow;
                    
                    // åŸºæœ¬ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç¢ºèª
                    if (iframeWindow.CacheManager) {
                        log("âœ… CacheManager åˆ©ç”¨å¯èƒ½");
                    } else {
                        log("âš ï¸ CacheManager æœªèª­ã¿è¾¼ã¿");
                    }
                    
                    if (iframeWindow.VirtualQuestionFlow) {
                        log("âœ… VirtualQuestionFlow åˆ©ç”¨å¯èƒ½");
                    } else {
                        log("âš ï¸ VirtualQuestionFlow æœªèª­ã¿è¾¼ã¿");
                    }
                    
                    if (iframeWindow.WORLDVIEW_QUESTIONS) {
                        log("âœ… WORLDVIEW_QUESTIONS: " + iframeWindow.WORLDVIEW_QUESTIONS.length + "å•");
                    } else {
                        log("âš ï¸ WORLDVIEW_QUESTIONS æœªèª­ã¿è¾¼ã¿");
                    }
                    
                    if (iframeWindow.SCENARIO_QUESTIONS) {
                        log("âœ… SCENARIO_QUESTIONS: " + iframeWindow.SCENARIO_QUESTIONS.length + "å•");
                    } else {
                        log("âš ï¸ SCENARIO_QUESTIONS æœªèª­ã¿è¾¼ã¿");
                    }
                    
                    if (iframeWindow.app) {
                        log("âœ… app ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–æ¸ˆã¿");
                    } else {
                        log("âš ï¸ app ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæœªåˆæœŸåŒ–");
                    }
                    
                    log("ğŸ ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†");
                }, 3000);
            }, 1000);
        }
        
        function checkConsoleErrors() {
            log("ğŸ›¡ï¸ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ç›£è¦–é–‹å§‹");
            
            const iframe = document.getElementById("testFrame");
            setTimeout(() => {
                const iframeWindow = iframe.contentWindow;
                let errorCount = 0;
                
                // ã‚¨ãƒ©ãƒ¼ç›£è¦–
                const originalError = iframeWindow.console.error;
                iframeWindow.console.error = function(...args) {
                    errorCount++;
                    log("âŒ ã‚¨ãƒ©ãƒ¼æ¤œå‡º: " + args.join(" "));
                    originalError.apply(console, args);
                };
                
                const originalWarn = iframeWindow.console.warn;
                iframeWindow.console.warn = function(...args) {
                    log("âš ï¸ è­¦å‘Š: " + args.join(" "));
                    originalWarn.apply(console, args);
                };
                
                setTimeout(() => {
                    log("ğŸ“Š ç›£è¦–çµæœ - ã‚¨ãƒ©ãƒ¼æ•°: " + errorCount);
                }, 5000);
                
            }, 2000);
        }
        
        function testQuestionFlow() {
            log("ğŸ“ è³ªå•ãƒ•ãƒ­ãƒ¼è©³ç´°ãƒ†ã‚¹ãƒˆé–‹å§‹");
            
            const iframe = document.getElementById("testFrame");
            setTimeout(() => {
                const iframeWindow = iframe.contentWindow;
                
                if (iframeWindow.app && iframeWindow.app.questionFlow) {
                    const qf = iframeWindow.app.questionFlow;
                    log("ğŸ“‹ è³ªå•ãƒ•ãƒ­ãƒ¼ç™ºè¦‹ - ç¾åœ¨ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: " + qf.currentQuestionIndex);
                    
                    if (qf.questions) {
                        log("ğŸ“š ç·è³ªå•æ•°: " + qf.questions.length);
                    }
                    
                    if (qf.answers) {
                        log("ğŸ“ ç¾åœ¨ã®å›ç­”æ•°: " + qf.answers.length);
                    }
                    
                    // å…¨è³ªå•è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
                    if (typeof qf.testAllQuestionsDisplay === "function") {
                        log("ğŸ§ª å…¨è³ªå•è¡¨ç¤ºãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...");
                        qf.testAllQuestionsDisplay().then(results => {
                            log("âœ… è¡¨ç¤ºãƒ†ã‚¹ãƒˆå®Œäº† - æˆåŠŸ: " + results.passed + "/" + results.total);
                            if (results.evenQuestions) {
                                log("ğŸ“Š å¶æ•°ç•ªè¨­å•æˆåŠŸç‡: " + (results.evenQuestions.passed / results.evenQuestions.total * 100).toFixed(1) + "%");
                            }
                        }).catch(error => {
                            log("âŒ è¡¨ç¤ºãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: " + error.message);
                        });
                    }
                } else {
                    log("âŒ è³ªå•ãƒ•ãƒ­ãƒ¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");
                }
            }, 3000);
        }
        
        // åˆæœŸåŒ–
        log("ğŸš€ HAQEI ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«æº–å‚™å®Œäº†");
        
        // iframeèª­ã¿è¾¼ã¿ç›£è¦–
        document.getElementById("testFrame").onload = function() {
            log("âœ… OS Analyzer iframe èª­ã¿è¾¼ã¿å®Œäº†");
        };
    </script>
</body>
</html>
