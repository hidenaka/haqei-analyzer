<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¡¨ç¤ºãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            background: #1a1a2e;
            color: #fff;
            padding: 20px;
            font-family: 'Inter', sans-serif;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        .os-card {
            margin: 10px;
            padding: 15px;
            background: rgba(99, 102, 241, 0.1);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
        }
        .success {
            color: #10b981;
        }
        .error {
            color: #ef4444;
        }
        .warning {
            color: #f59e0b;
        }
        pre {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” HAQEI OS Analyzer - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¡¨ç¤ºãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆ1: HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ç¢ºèª</h2>
            <div id="database-test"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ ãƒ†ã‚¹ãƒˆ2: Triple OSçµæœè¡¨ç¤ºãƒ†ã‚¹ãƒˆ</h2>
            <div id="triple-os-test"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ ãƒ†ã‚¹ãƒˆ3: å®Ÿéš›ã®è¡¨ç¤ºç¢ºèª</h2>
            <div id="display-test"></div>
        </div>
        
        <div class="test-section">
            <h2>âš ï¸ å•é¡Œç‚¹ãƒ¬ãƒãƒ¼ãƒˆ</h2>
            <div id="issues-report"></div>
        </div>
    </div>

    <!-- HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ -->
    <script src="/assets/H384H64database.js"></script>
    
    <script>
        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        async function runTests() {
            const results = {
                database: [],
                tripleOS: [],
                display: [],
                issues: []
            };
            
            // ãƒ†ã‚¹ãƒˆ1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
            const dbTest = document.getElementById('database-test');
            if (typeof HEXAGRAMS !== 'undefined') {
                dbTest.innerHTML = `<p class="success">âœ… HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿æˆåŠŸ: ${HEXAGRAMS.length}å¦</p>`;
                
                // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
                const sample = HEXAGRAMS[0];
                dbTest.innerHTML += `
                    <h4>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆç¬¬1å¦ï¼‰:</h4>
                    <pre>${JSON.stringify(sample, null, 2)}</pre>
                `;
                
                // ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒã‚§ãƒƒã‚¯
                const hasRequiredFields = sample.hasOwnProperty('hexagram_id') &&
                                         sample.hasOwnProperty('name_jp') &&
                                         sample.hasOwnProperty('description') &&
                                         sample.hasOwnProperty('catchphrase');
                
                if (hasRequiredFields) {
                    dbTest.innerHTML += `<p class="success">âœ… å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç¢ºèªOK</p>`;
                } else {
                    dbTest.innerHTML += `<p class="error">âŒ å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä¸è¶³</p>`;
                    results.issues.push('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã«å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸è¶³');
                }
            } else {
                dbTest.innerHTML = `<p class="error">âŒ HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>`;
                results.issues.push('HEXAGRAMSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæœªå®šç¾©');
            }
            
            // ãƒ†ã‚¹ãƒˆ2: Triple OSçµæœã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const tripleTest = document.getElementById('triple-os-test');
            
            // æ¨¡æ“¬çš„ãªTriple OSçµæœ
            const mockTripleOS = {
                engineOS: {
                    hexagramId: 1,
                    hexagramName: null, // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã¹ã
                    description: null, // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã¹ã
                    catchphrase: null, // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã¹ã
                    upperTrigram: "ä¹¾",
                    lowerTrigram: "ä¹¾",
                    type: "Engine OS"
                },
                interfaceOS: {
                    hexagramId: 11,
                    hexagramName: null,
                    description: null,
                    catchphrase: null,
                    upperTrigram: "å¤",
                    lowerTrigram: "ä¹¾",
                    type: "Interface OS"
                },
                safeModeOS: {
                    hexagramId: 2,
                    hexagramName: null,
                    description: null,
                    catchphrase: null,
                    upperTrigram: "å¤",
                    lowerTrigram: "å¤",
                    type: "Safe Mode OS"
                }
            };
            
            // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æƒ…å ±ã‚’è£œå®Œ
            if (typeof HEXAGRAMS !== 'undefined') {
                ['engineOS', 'interfaceOS', 'safeModeOS'].forEach(osType => {
                    const os = mockTripleOS[osType];
                    const hexagram = HEXAGRAMS.find(h => h.hexagram_id === os.hexagramId);
                    
                    if (hexagram) {
                        os.hexagramName = hexagram.name_jp;
                        os.description = hexagram.description;
                        os.catchphrase = hexagram.catchphrase;
                        
                        tripleTest.innerHTML += `
                            <div class="os-card">
                                <h3>${osType}</h3>
                                <p><strong>å¦ID:</strong> ${os.hexagramId}</p>
                                <p><strong>å¦å:</strong> ${os.hexagramName || '<span class="error">æœªè¨­å®š</span>'}</p>
                                <p><strong>ã‚­ãƒ£ãƒƒãƒãƒ•ãƒ¬ãƒ¼ã‚º:</strong> ${os.catchphrase || '<span class="error">æœªè¨­å®š</span>'}</p>
                                <p><strong>èª¬æ˜:</strong> ${os.description || '<span class="error">æœªè¨­å®š</span>'}</p>
                            </div>
                        `;
                        
                        if (!os.hexagramName || !os.description || !os.catchphrase) {
                            results.issues.push(`${osType}ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å€¤ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„`);
                        }
                    } else {
                        tripleTest.innerHTML += `<p class="error">âŒ ${osType}: å¦${os.hexagramId}ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>`;
                        results.issues.push(`${osType}ã®å¦${os.hexagramId}ãŒè¦‹ã¤ã‹ã‚‰ãªã„`);
                    }
                });
            }
            
            // ãƒ†ã‚¹ãƒˆ3: å®Ÿéš›ã®è¡¨ç¤ºé–¢æ•°ãƒ†ã‚¹ãƒˆ
            const displayTest = document.getElementById('display-test');
            
            // createEnhancedOSCardç›¸å½“ã®å‡¦ç†
            const testCard = (osName, osData, color) => {
                const hexagram = HEXAGRAMS ? HEXAGRAMS.find(h => h.hexagram_id === osData.hexagramId) : null;
                
                return `
                    <div class="os-card" style="border-color: ${color};">
                        <h3>${osName}</h3>
                        <p>è¡¨ç¤ºã•ã‚Œã‚‹å¦å: ${osData.hexagramName || hexagram?.name_jp || 'âŒ æœªè¨­å®š'}</p>
                        <p>è¡¨ç¤ºã•ã‚Œã‚‹èª¬æ˜: ${osData.description || hexagram?.description || 'âŒ æœªè¨­å®š'}</p>
                        <p>è¡¨ç¤ºã•ã‚Œã‚‹ã‚­ãƒ£ãƒƒãƒãƒ•ãƒ¬ãƒ¼ã‚º: ${osData.catchphrase || hexagram?.catchphrase || 'âŒ æœªè¨­å®š'}</p>
                        <p class="warning">âš ï¸ osDataç›´æ¥å€¤: hexagramName=${osData.hexagramName}, description=${osData.description}, catchphrase=${osData.catchphrase}</p>
                        <p class="success">âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å€¤: name_jp=${hexagram?.name_jp}, description=${hexagram?.description}, catchphrase=${hexagram?.catchphrase}</p>
                    </div>
                `;
            };
            
            displayTest.innerHTML = testCard('Engine OS', mockTripleOS.engineOS, '#6366f1');
            displayTest.innerHTML += testCard('Interface OS', mockTripleOS.interfaceOS, '#8b5cf6');
            displayTest.innerHTML += testCard('Safe Mode OS', mockTripleOS.safeModeOS, '#10b981');
            
            // å•é¡Œç‚¹ãƒ¬ãƒãƒ¼ãƒˆ
            const issuesReport = document.getElementById('issues-report');
            if (results.issues.length > 0) {
                issuesReport.innerHTML = '<h3 class="error">ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œ:</h3><ul>';
                results.issues.forEach(issue => {
                    issuesReport.innerHTML += `<li class="error">${issue}</li>`;
                });
                issuesReport.innerHTML += '</ul>';
                
                issuesReport.innerHTML += `
                    <h3 class="warning">æ¨å¥¨ã•ã‚Œã‚‹ä¿®æ­£:</h3>
                    <ul>
                        <li>calculateEngineOS, calculateInterfaceOS, calculateSafeModeOSé–¢æ•°ã§ã€hexagramName, description, catchphraseã‚’æ­£ã—ãè¨­å®šã™ã‚‹</li>
                        <li>getHexagramDataé–¢æ•°ã®æˆ»ã‚Šå€¤ã‚’æ­£ã—ãOSãƒ‡ãƒ¼ã‚¿ã«åæ˜ ã™ã‚‹</li>
                        <li>createEnhancedOSCardé–¢æ•°ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å€¤ã‚’å„ªå…ˆçš„ã«ä½¿ç”¨ã™ã‚‹</li>
                    </ul>
                `;
            } else {
                issuesReport.innerHTML = '<p class="success">âœ… å•é¡Œã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ</p>';
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.addEventListener('load', runTests);
    </script>
</body>
</html>