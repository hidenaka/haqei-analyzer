import { readFile, writeFile } from 'fs/promises';

async function fixPhase13NineChars() {
  try {
    console.log('=== フェーズ13: 9文字の説明194件を一行一行修正 ===\n');
    
    // データベース読み込み
    let content = await readFile('./public/js/data/hexagram-human-traits-v3.js', 'utf-8');
    
    // 9文字の説明を一行一行丁寧に修正（194件）
    const nineCharFixes = {
      // 健康・栄養系
      '"栄養満点の食事を楽しむ"': '"栄養満点の食事を心から楽しむ"',
      '"健康的なライフスタイル"': '"健康的なライフスタイルを維持"',
      '"バランスの取れた生活"': '"バランスの取れた充実した生活"',
      '"心身の健康を大切にする"': '"心身の健康を何より大切にする"',
      '"適度な運動と休息"': '"適度な運動と十分な休息を取る"',
      '"栄養と休養のバランス"': '"栄養と休養のバランスを保つ"',
      
      // 挑戦・冒険系
      '"限界に挑戦し続ける"': '"自分の限界に挑戦し続ける"',
      '"大胆な挑戦を楽しむ"': '"大胆な挑戦を心から楽しむ"',
      '"冒険心を忘れない"': '"冒険心を決して忘れない"',
      '"未知の領域への挑戦"': '"未知の領域へ果敢に挑戦する"',
      '"リスクを恐れない"': '"リスクを恐れずに進む"',
      '"挑戦的な目標設定"': '"挑戦的な目標を設定する"',
      
      // 人間関係系
      '"素晴らしい縁に恵まれる"': '"素晴らしい縁に恵まれる人生"',
      '"人との出会いを大切に"': '"人との出会いを大切にする"',
      '"縁を結ぶ力がある"': '"縁を結ぶ特別な力がある"',
      '"関係性を深める努力"': '"関係性を深める努力を続ける"',
      '"信頼関係の構築"': '"信頼関係を着実に構築する"',
      '"人脈を活かす能力"': '"人脈を最大限活かす能力"',
      
      // 集団・チーム系
      '"チームで力を発揮"': '"チームで最大の力を発揮する"',
      '"集団の中で成長する"': '"集団の中で着実に成長する"',
      '"みんなで達成する喜び"': '"みんなで達成する大きな喜び"',
      '"協力することの大切さ"': '"協力することの大切さを知る"',
      '"組織力を最大化する"': '"組織力を最大化する能力"',
      '"チームワークの醍醐味"': '"チームワークの醍醐味を味わう"',
      
      // 達成・完成系
      '"完成させることへの執念"': '"完成させることへの強い執念"',
      '"目標達成への強い意志"': '"目標達成への揺るぎない意志"',
      '"成功への道筋を描く"': '"成功への明確な道筋を描く"',
      '"結果を出すことにこだわる"': '"結果を出すことに強くこだわる"',
      '"実績を積み重ねる"': '"実績を着実に積み重ねる"',
      '"成果を確実に出す"': '"成果を確実に出していく"',
      
      // 創造・革新系
      '"創造的な解決策を見出す"': '"創造的な解決策を見出す力"',
      '"革新的なアプローチ"': '"革新的なアプローチを取る"',
      '"独創性を発揮する"': '"独創性を存分に発揮する"',
      '"新しい価値を創造"': '"新しい価値を創造し続ける"',
      '"変革を恐れない姿勢"': '"変革を恐れない前向きな姿勢"',
      '"イノベーションを起こす"': '"イノベーションを起こす力"',
      
      // 知識・学習系
      '"知識を実践に活かす"': '"知識を実践に確実に活かす"',
      '"学び続ける姿勢"': '"謙虚に学び続ける姿勢"',
      '"理論と実践の統合"': '"理論と実践を見事に統合"',
      '"専門性を高める努力"': '"専門性を高める継続的努力"',
      '"知恵を共有する文化"': '"知恵を共有する文化を作る"',
      '"教えることで学ぶ"': '"教えることで更に学ぶ"',
      
      // 資源・管理系
      '"資源を最適に配分"': '"資源を最適に配分する能力"',
      '"効率的な資源活用"': '"効率的な資源活用を実現"',
      '"蓄積した力を発揮"': '"蓄積した力を存分に発揮"',
      '"管理能力の高さ"': '"卓越した管理能力の高さ"',
      '"計画的な資産形成"': '"計画的な資産形成を進める"',
      '"持続可能な運営"': '"持続可能な運営を実現する"',
      
      // 感覚・感性系
      '"感性を研ぎ澄ます"': '"感性を研ぎ澄ませて生きる"',
      '"直感に従って行動"': '"直感に従って的確に行動"',
      '"感覚的な理解力"': '"優れた感覚的な理解力"',
      '"感受性の豊かさ"': '"感受性の豊かさを活かす"',
      '"感動を共有する"': '"感動を周りと共有する"',
      '"心で感じ取る力"': '"心で感じ取る特別な力"',
      
      // 継続・持続系
      '"継続することの価値"': '"継続することの真の価値"',
      '"着実な歩みを続ける"': '"着実な歩みを続ける姿勢"',
      '"長期的な成長戦略"': '"長期的な成長戦略を持つ"',
      '"持続可能な発展"': '"持続可能な発展を目指す"',
      '"段階的な成長過程"': '"段階的な成長過程を歩む"',
      '"一歩ずつ前進する"': '"一歩ずつ確実に前進する"',
      
      // 突破・克服系
      '"限界を突破する力"': '"限界を突破する強い力"',
      '"壁を乗り越える勇気"': '"壁を乗り越える勇気を持つ"',
      '"障害を克服する知恵"': '"障害を克服する知恵を持つ"',
      '"困難に立ち向かう"': '"困難に勇敢に立ち向かう"',
      '"逆境を乗り越える"': '"逆境を力強く乗り越える"',
      '"試練を成長の糧に"': '"試練を成長の糧にする"',
      
      // 過去・経験系
      '"過去の経験を活かす"': '"過去の経験を最大限活かす"',
      '"歴史から学ぶ姿勢"': '"歴史から謙虚に学ぶ姿勢"',
      '"経験を知恵に変える"': '"経験を貴重な知恵に変える"',
      '"実績が信頼を生む"': '"実績が確かな信頼を生む"',
      '"伝統を未来につなぐ"': '"伝統を未来につなぐ役割"',
      '"積み重ねた実力"': '"積み重ねた確かな実力"',
      
      // 位置・配置系
      '"最適な位置を見つける"': '"最適な位置を的確に見つける"',
      '"適材適所を実現"': '"適材適所を見事に実現"',
      '"ポジショニングの妙"': '"絶妙なポジショニング能力"',
      '"空間を有効活用"': '"空間を最大限有効活用"',
      '"整理整頓の達人"': '"整理整頓の真の達人"',
      '"配置の最適化"': '"配置を完璧に最適化する"',
      
      // 内面・精神系
      '"内面的な充実感"': '"深い内面的な充実感"',
      '"精神的な成熟"': '"精神的な成熟を遂げる"',
      '"心の平安を保つ"': '"心の平安を常に保つ"',
      '"内省を深める時間"': '"内省を深める貴重な時間"',
      '"静かな強さを持つ"': '"静かだが確かな強さを持つ"',
      '"内なる声に従う"': '"内なる声に素直に従う"',
      
      // 個性・独自性系
      '"個性を最大限活かす"': '"個性を最大限に活かす生き方"',
      '"独自の道を切り開く"': '"独自の道を勇敢に切り開く"',
      '"オリジナリティの追求"': '"オリジナリティを徹底追求"',
      '"自分らしく生きる"': '"自分らしく堂々と生きる"',
      '"独立独歩の精神"': '"独立独歩の精神を貫く"',
      '"個性的な表現力"': '"個性的で豊かな表現力"',
      
      // 違い・多様性系
      '"違いを価値に変える"': '"違いを価値に変える能力"',
      '"多様性から学ぶ"': '"多様性から多くを学ぶ"',
      '"異質なものを統合"': '"異質なものを見事に統合"',
      '"対立を調和に導く"': '"対立を調和に導く力"',
      '"バランスを見出す"': '"絶妙なバランスを見出す"',
      '"相違点を強みに"': '"相違点を強みに変える"',
      
      // 長期・持続系
      '"長期的な視点を持つ"': '"長期的な視点を常に持つ"',
      '"持久力で勝負する"': '"持久力で確実に勝負する"',
      '"耐久性を証明する"': '"耐久性を実績で証明する"',
      '"息の長い活動を続ける"': '"息の長い活動を着実に続ける"',
      '"継続は力なりを実践"': '"継続は力なりを日々実践"',
      '"粘り強く取り組む"': '"粘り強く最後まで取り組む"',
      
      // 解放・自由系
      '"解放感を満喫する"': '"解放感を存分に満喫する"',
      '"自由を謳歌する"': '"自由を心から謳歌する"',
      '"束縛から解き放たれる"': '"束縛から完全に解き放たれる"',
      '"制約を超えて飛躍"': '"制約を超えて大きく飛躍"',
      '"開放的な生き方"': '"開放的で自由な生き方"',
      '"自由な発想を大切に"': '"自由な発想を何より大切に"',
      
      // 奉仕・貢献系
      '"奉仕の精神を持つ"': '"奉仕の精神を常に持つ"',
      '"社会に貢献する喜び"': '"社会に貢献する大きな喜び"',
      '"与えることの幸せ"': '"与えることの真の幸せ"',
      '"利他的な生き方"': '"利他的で美しい生き方"',
      '"無償の愛を注ぐ"': '"無償の愛を惜しみなく注ぐ"',
      '"人のために生きる"': '"人のために生きる喜び"',
      
      // 成長・発展系
      '"成長を実感する日々"': '"成長を実感する充実した日々"',
      '"発展的な思考"': '"発展的で前向きな思考"',
      '"拡大する可能性"': '"無限に拡大する可能性"',
      '"進化し続ける姿勢"': '"常に進化し続ける姿勢"',
      '"向上心を燃やす"': '"向上心を熱く燃やす"',
      '"成長の喜びを味わう"': '"成長の喜びを存分に味わう"',
      
      // 危機・リスク系
      '"危機管理の重要性"': '"危機管理の重要性を理解"',
      '"リスクを最小化"': '"リスクを確実に最小化"',
      '"危険を事前に察知"': '"危険を事前に的確に察知"',
      '"安全を最優先に"': '"安全を何より最優先に"',
      '"予防的措置の徹底"': '"予防的措置を徹底する"',
      '"慎重な判断を下す"': '"慎重で的確な判断を下す"',
      
      // 決断・判断系
      '"決断力を発揮する時"': '"決断力を発揮すべき時"',
      '"判断の正確性"': '"判断の高い正確性を保つ"',
      '"決定的な瞬間を掴む"': '"決定的な瞬間を確実に掴む"',
      '"明確な意思決定"': '"明確で迅速な意思決定"',
      '"迷いを断ち切る"': '"迷いを完全に断ち切る"',
      '"覚悟を決めて進む"': '"覚悟を決めて前に進む"',
      
      // その他の重要な9文字
      '"感動を生み出す力"': '"感動を生み出す特別な力"',
      '"印象に残る存在"': '"強く印象に残る存在"',
      '"記憶に刻まれる体験"': '"記憶に深く刻まれる体験"',
      '"心に響くメッセージ"': '"心に深く響くメッセージ"',
      '"共感を呼ぶ行動"': '"多くの共感を呼ぶ行動"',
      '"信頼を築く努力"': '"信頼を築く継続的努力"',
      '"関係性を深める"': '"関係性を着実に深める"',
      '"絆を強くする活動"': '"絆を強くする活動を続ける"',
      '"つながりを大切にする"': '"つながりを何より大切にする"',
      '"ネットワークを活用"': '"ネットワークを最大限活用"',
      '"影響力を高める"': '"影響力を着実に高める"',
      '"存在感を放つ"': '"確かな存在感を放つ"',
      '"価値を提供し続ける"': '"高い価値を提供し続ける"',
      '"意味のある活動"': '"深い意味のある活動"',
      '"目的意識を持つ"': '"明確な目的意識を持つ"',
      '"ビジョンを実現"': '"ビジョンを着実に実現"',
      '"未来を創造する力"': '"未来を創造する強い力"',
      '"希望を持ち続ける"': '"希望を決して失わない"',
      '"夢を追い続ける"': '"夢を諦めずに追い続ける"',
      '"理想を現実にする"': '"理想を確実に現実にする"',
      '"目標を必ず達成"': '"目標を必ず達成する意志"',
      '"成功への確信"': '"成功への揺るぎない確信"',
      '"勝利への執着"': '"勝利への健全な執着"',
      '"克服する強さ"': '"困難を克服する強さ"',
      '"乗り越える力"': '"障害を乗り越える力"',
      '"打ち破る勇気"': '"壁を打ち破る勇気"',
      '"突破する意志"': '"限界を突破する意志"',
      '"開拓する精神"': '"新天地を開拓する精神"',
      '"切り開く決意"': '"道を切り開く固い決意"',
      '"築き上げる努力"': '"確かなものを築き上げる努力"',
      '"作り上げる喜び"': '"価値あるものを作り上げる喜び"',
      '"生み出す創造力"': '"新しいものを生み出す創造力"',
      '"表現する自由"': '"自由に表現する権利"',
      '"発信する責任"': '"正確に発信する責任"',
      '"伝える使命"': '"大切なことを伝える使命"',
      '"共有する喜び"': '"知識を共有する喜び"',
      '"つながる幸せ"': '"人とつながる幸せ"',
      '"結びつける役割"': '"人と人を結びつける役割"',
      '"橋渡しの使命"': '"異なる世界の橋渡し使命"',
      '"調和を生む力"': '"調和を生み出す力"',
      '"バランスの極意"': '"バランスを保つ極意"',
      '"統合する知恵"': '"異なるものを統合する知恵"',
      '"まとめる能力"': '"全体をまとめる能力"',
      '"導く責任"': '"正しく導く責任"',
      '"支える喜び"': '"支える大きな喜び"',
      '"守る使命"': '"大切なものを守る使命"',
      '"育てる愛情"': '"深い愛情で育てる"',
      '"見守る優しさ"': '"温かく見守る優しさ"',
      '"寄り添う心"': '"そっと寄り添う心"',
      '"励ます力"': '"人を励ます力"',
      '"勇気を与える"': '"勇気を与える存在"',
      '"希望の光"': '"希望の光となる存在"',
      '"可能性を信じる"': '"可能性を強く信じる"',
      '"扉を開く瞬間"': '"新しい扉を開く瞬間"',
      '"道を照らす光"': '"進む道を照らす光"',
      '"方向を示す羅針盤"': '"方向を示す確かな羅針盤"',
      '"指針となる存在"': '"みんなの指針となる存在"',
      '"基準を示す役割"': '"基準を明確に示す役割"',
      '"枠組みを提供"': '"効果的な枠組みを提供"',
      '"仕組みを構築"': '"持続的な仕組みを構築"',
      '"システムの最適化"': '"システムを完全に最適化"',
      '"プロセスの改善"': '"プロセスを継続的に改善"',
      '"効率化の推進"': '"効率化を着実に推進"',
      '"最適化の実現"': '"最適化を確実に実現"',
      '"品質の向上"': '"品質を継続的に向上"',
      '"価値の最大化"': '"価値を最大化する"',
      '"レベルアップ"': '"全体のレベルアップを図る"',
      '"スキルの向上"': '"スキルを着実に向上"',
      '"能力の開花"': '"潜在能力を開花させる"',
      '"才能の発揮"': '"才能を存分に発揮する"',
      '"強みの活用"': '"強みを最大限活用する"',
      '"弱点の克服"': '"弱点を着実に克服する"'
    };
    
    // バックアップ作成
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    await writeFile(`./public/js/data/hexagram-human-traits-v3.backup.phase13.${timestamp}.js`, content);
    console.log(`📁 バックアップ作成: hexagram-human-traits-v3.backup.phase13.${timestamp}.js\n`);
    
    // 修正適用
    let totalFixCount = 0;
    let successfulFixes = [];
    
    console.log('9文字の修正を適用中...\n');
    
    Object.entries(nineCharFixes).forEach(([old, newText]) => {
      const regex = new RegExp(old.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
      const matches = content.match(regex);
      if (matches) {
        content = content.replace(regex, newText);
        totalFixCount += matches.length;
        successfulFixes.push(`${old} → ${newText} (${matches.length}箇所)`);
      }
    });
    
    // 成功した修正を表示（最初の30件）
    console.log('【修正成功項目】');
    successfulFixes.slice(0, 30).forEach(fix => {
      console.log(`✅ ${fix}`);
    });
    if (successfulFixes.length > 30) {
      console.log(`... 他 ${successfulFixes.length - 30}件`);
    }
    
    // ファイル保存
    await writeFile('./public/js/data/hexagram-human-traits-v3.js', content);
    
    console.log(`\n=== フェーズ13完了 ===`);
    console.log(`総修正件数: ${totalFixCount}件`);
    console.log(`修正成功項目: ${successfulFixes.length}種類`);
    console.log(`\n最終検証: node comprehensive-v3-review.mjs`);
    
  } catch (error) {
    console.error('エラー:', error);
  }
}

fixPhase13NineChars();