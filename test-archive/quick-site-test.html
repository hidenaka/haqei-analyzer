<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>サイト動作クイックテスト</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .btn {
            background: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .btn:hover {
            background: #45a049;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .info { color: blue; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔍 HaQei OS Analyzer サイト動作クイックテスト</h1>
        
        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="openAnalyzerSite()">
                📱 os_analyzer.htmlを開く
            </button>
            
            <button class="btn" onclick="showAutoTestScript()">
                🤖 自動テストスクリプト表示
            </button>
        </div>
        
        <div id="result" class="result"></div>
        
        <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 5px;">
            <h3>📝 手動テスト手順</h3>
            <ol>
                <li>「os_analyzer.htmlを開く」ボタンをクリック</li>
                <li>サイトが開いたら「診断を始める」をクリック</li>
                <li>36問の質問に回答（全てAやBで統一してもOK）</li>
                <li>結果画面で以下を確認：
                    <ul>
                        <li>Engine OS: 卦が表示されているか</li>
                        <li>Interface OS: 卦が表示されているか</li>
                        <li>Safe Mode OS: 卦が表示されているか</li>
                    </ul>
                </li>
                <li>ブラウザのコンソールでエラーがないか確認</li>
            </ol>
        </div>
    </div>
    
    <script>
        function openAnalyzerSite() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="info">os_analyzer.htmlを新しいタブで開いています...</span>\n\n';
            
            // 新しいタブで開く
            window.open('os_analyzer.html', '_blank');
            
            resultDiv.innerHTML += '<span class="success">✅ サイトを開きました</span>\n\n';
            resultDiv.innerHTML += '手動テスト手順:\n';
            resultDiv.innerHTML += '1. 「診断を始める」をクリック\n';
            resultDiv.innerHTML += '2. 36問全て回答（テスト用に全てA選択でもOK）\n';
            resultDiv.innerHTML += '3. 結果画面を確認\n';
            resultDiv.innerHTML += '4. ブラウザコンソール（F12）でエラー確認\n\n';
            resultDiv.innerHTML += '<span class="warning">⚠️ コンソールに以下が表示されれば正常:</span>\n';
            resultDiv.innerHTML += '📊 質問分離結果: {Engine: "Q1-Q12 (12問)", Interface: "Q13-Q24 (12問)", SafeMode: "Q25-Q36 (12問)"}\n';
        }
        
        function showAutoTestScript() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="info">🤖 ブラウザコンソールで実行できる自動テストスクリプト:</span>\n\n';
            
            const script = `// === コンソールにコピペして実行 ===

// 自動回答関数
function autoAnswer() {
    console.log('🤖 自動回答開始...');
    
    // 全36問に自動回答
    for (let i = 1; i <= 36; i++) {
        const questionElement = document.querySelector(\`[data-question="q\${i}"]\`);
        if (questionElement) {
            // 最初の選択肢（A）をクリック
            const firstOption = questionElement.querySelector('input[type="radio"]');
            if (firstOption) {
                firstOption.click();
                console.log(\`✅ Q\${i} 回答完了\`);
            }
        }
    }
    
    // 次へボタンをクリック（必要に応じて）
    const nextButtons = document.querySelectorAll('button');
    nextButtons.forEach(btn => {
        if (btn.textContent.includes('次へ') || btn.textContent.includes('結果')) {
            btn.click();
        }
    });
    
    console.log('🎯 自動回答完了！');
}

// 結果確認関数
function checkResults() {
    console.log('📊 結果確認中...');
    
    // osAnalyzerオブジェクトの確認
    if (typeof osAnalyzer !== 'undefined') {
        console.log('✅ osAnalyzer オブジェクト存在');
        
        // 最新の分析結果を確認
        const results = osAnalyzer.lastAnalysisResult;
        if (results) {
            console.log('Engine OS:', results.engineOS);
            console.log('Interface OS:', results.interfaceOS);
            console.log('Safe Mode OS:', results.safeModeOS);
        }
    } else {
        console.log('❌ osAnalyzer が見つかりません');
    }
}

// 実行
autoAnswer();
setTimeout(checkResults, 2000);`;
            
            resultDiv.innerHTML += '<div style="background: #2d2d2d; color: #fff; padding: 15px; border-radius: 5px; overflow-x: auto;">';
            resultDiv.innerHTML += script.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br>');
            resultDiv.innerHTML += '</div>';
            
            resultDiv.innerHTML += '\n<span class="success">📋 上記のスクリプトをコピーしてブラウザコンソール(F12)で実行してください</span>';
        }
    </script>
</body>
</html>