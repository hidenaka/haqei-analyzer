<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€çµ‚å‹•ä½œæ¤œè¨¼ - HaQei OS Analyzer</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #58a6ff;
            margin-bottom: 40px;
            font-size: 36px;
        }
        .verification-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .verification-card {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
        }
        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #58a6ff;
            margin-bottom: 15px;
        }
        .test-btn {
            background: #238636;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        .test-btn:hover {
            background: #2ea043;
        }
        .danger-btn {
            background: #da3633;
        }
        .danger-btn:hover {
            background: #f85149;
        }
        .result-area {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .success { color: #3fb950; }
        .error { color: #f85149; }
        .warning { color: #d29922; }
        .info { color: #58a6ff; }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .badge-success { background: #238636; color: white; }
        .badge-error { background: #da3633; color: white; }
        .badge-warning { background: #9e6a03; color: white; }
        .badge-pending { background: #6e7681; color: white; }
        
        .code-block {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .main-test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            display: block;
            margin: 30px auto;
            transition: transform 0.2s;
        }
        .main-test-btn:hover {
            transform: translateY(-2px);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #30363d;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #161b22;
            color: #58a6ff;
        }
        td {
            background: #0d1117;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” HaQei OS Analyzer æœ€çµ‚å‹•ä½œæ¤œè¨¼</h1>
        
        <div class="verification-grid">
            <!-- ã‚³ãƒ¼ãƒ‰å®Ÿè£…ç¢ºèª -->
            <div class="verification-card">
                <div class="card-title">
                    ğŸ“ ã‚³ãƒ¼ãƒ‰å®Ÿè£…ç¢ºèª
                    <span class="status-badge badge-pending" id="code-status">æœªæ¤œè¨¼</span>
                </div>
                <button class="test-btn" onclick="verifyCodeImplementation()">å®Ÿè£…ç¢ºèª</button>
                <div class="result-area" id="code-result">æ¤œè¨¼å¾…æ©Ÿä¸­...</div>
            </div>
            
            <!-- è³ªå•åˆ†é›¢ãƒ­ã‚¸ãƒƒã‚¯ -->
            <div class="verification-card">
                <div class="card-title">
                    ğŸ”€ è³ªå•åˆ†é›¢ãƒ­ã‚¸ãƒƒã‚¯
                    <span class="status-badge badge-pending" id="separation-status">æœªæ¤œè¨¼</span>
                </div>
                <button class="test-btn" onclick="verifySeparation()">åˆ†é›¢ç¢ºèª</button>
                <div class="result-area" id="separation-result">æ¤œè¨¼å¾…æ©Ÿä¸­...</div>
            </div>
            
            <!-- Interface OSå‹•ä½œ -->
            <div class="verification-card">
                <div class="card-title">
                    ğŸ’¬ Interface OSå‹•ä½œ
                    <span class="status-badge badge-pending" id="interface-status">æœªæ¤œè¨¼</span>
                </div>
                <button class="test-btn" onclick="verifyInterfaceOS()">å‹•ä½œç¢ºèª</button>
                <div class="result-area" id="interface-result">æ¤œè¨¼å¾…æ©Ÿä¸­...</div>
            </div>
            
            <!-- Safe Mode OSå‹•ä½œ -->
            <div class="verification-card">
                <div class="card-title">
                    ğŸ›¡ï¸ Safe Mode OSå‹•ä½œ
                    <span class="status-badge badge-pending" id="safemode-status">æœªæ¤œè¨¼</span>
                </div>
                <button class="test-btn" onclick="verifySafeModeOS()">å‹•ä½œç¢ºèª</button>
                <div class="result-area" id="safemode-result">æ¤œè¨¼å¾…æ©Ÿä¸­...</div>
            </div>
        </div>
        
        <!-- çµ±åˆãƒ†ã‚¹ãƒˆ -->
        <div class="verification-card" style="margin-bottom: 20px;">
            <div class="card-title">
                ğŸš€ å®Ÿéš›ã®ã‚µã‚¤ãƒˆå‹•ä½œç¢ºèª
                <span class="status-badge badge-pending" id="site-status">æœªæ¤œè¨¼</span>
            </div>
            <button class="main-test-btn" onclick="verifySiteOperation()">ã‚µã‚¤ãƒˆå‹•ä½œã‚’å®Œå…¨æ¤œè¨¼</button>
            <div class="result-area" id="site-result" style="min-height: 200px;">æ¤œè¨¼å¾…æ©Ÿä¸­...</div>
        </div>
        
        <!-- è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ -->
        <div class="verification-card">
            <div class="card-title">ğŸ“Š æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ</div>
            <div id="report-area"></div>
        </div>
    </div>
    
    <iframe id="analyzer-frame" src="os_analyzer.html" style="display:none;"></iframe>
    
    <script>
        let analyzer = null;
        let verificationResults = {
            code: false,
            separation: false,
            interface: false,
            safemode: false,
            site: false
        };
        
        // iframeèª­ã¿è¾¼ã¿
        document.getElementById('analyzer-frame').onload = function() {
            const iframe = document.getElementById('analyzer-frame');
            const iframeWindow = iframe.contentWindow;
            if (iframeWindow.window.osAnalyzer) {
                analyzer = iframeWindow.window.osAnalyzer;
                console.log('âœ… OS Analyzer loaded');
                updateReport();
            }
        };
        
        function updateStatus(id, status) {
            const badge = document.getElementById(id + '-status');
            badge.className = 'status-badge badge-' + status;
            badge.textContent = status === 'success' ? 'âœ… æ­£å¸¸' : 
                               status === 'error' ? 'âŒ ç•°å¸¸' :
                               status === 'warning' ? 'âš ï¸ è­¦å‘Š' : 'æœªæ¤œè¨¼';
        }
        
        function verifyCodeImplementation() {
            const resultDiv = document.getElementById('code-result');
            let result = '<span class="info">ã‚³ãƒ¼ãƒ‰å®Ÿè£…ãƒã‚§ãƒƒã‚¯é–‹å§‹...</span>\n\n';
            
            try {
                // separateAnswersã®ã‚³ãƒ¼ãƒ‰ç¢ºèª
                const separateCode = analyzer.separateAnswers.toString();
                const hasQ1to12 = separateCode.includes('questionNum >= 1 && questionNum <= 12');
                const hasQ13to24 = separateCode.includes('questionNum >= 13 && questionNum <= 24');
                const hasQ25to36 = separateCode.includes('questionNum >= 25 && questionNum <= 36');
                
                result += '1. separateAnswers ãƒ¡ã‚½ãƒƒãƒ‰:\n';
                result += `   Q1-12åˆ¤å®š: ${hasQ1to12 ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `   Q13-24åˆ¤å®š: ${hasQ13to24 ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `   Q25-36åˆ¤å®š: ${hasQ25to36 ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n\n`;
                
                // analyzeSocialPatternsã®ã‚³ãƒ¼ãƒ‰ç¢ºèª
                const socialCode = analyzer.analyzeSocialPatterns.toString();
                const hasQ13Index = socialCode.includes('Q${13 + index}');
                const hasQ13Pattern = socialCode.includes('Q13_leadership');
                const hasQ24Pattern = socialCode.includes('Q24_adaptation');
                
                result += '2. analyzeSocialPatterns ãƒ¡ã‚½ãƒƒãƒ‰:\n';
                result += `   Q13é–‹å§‹: ${hasQ13Index ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `   Q13ãƒ‘ã‚¿ãƒ¼ãƒ³: ${hasQ13Pattern ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `   Q24ãƒ‘ã‚¿ãƒ¼ãƒ³: ${hasQ24Pattern ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n\n`;
                
                // extractDefensivePatternsã®ã‚³ãƒ¼ãƒ‰ç¢ºèª
                const defenseCode = analyzer.extractDefensivePatterns.toString();
                const hasDefenseAnswers = defenseCode.includes('defenseAnswers');
                const hasQ36Pattern = defenseCode.includes('Q36_resourceStress');
                
                result += '3. extractDefensivePatterns ãƒ¡ã‚½ãƒƒãƒ‰:\n';
                result += `   å¼•æ•°å: ${hasDefenseAnswers ? '<span class="success">âœ… defenseAnswers</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `   Q36ãƒ‘ã‚¿ãƒ¼ãƒ³: ${hasQ36Pattern ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                
                const allCorrect = hasQ1to12 && hasQ13to24 && hasQ25to36 && 
                                  hasQ13Index && hasQ13Pattern && hasQ24Pattern &&
                                  hasDefenseAnswers && hasQ36Pattern;
                
                verificationResults.code = allCorrect;
                updateStatus('code', allCorrect ? 'success' : 'error');
                resultDiv.innerHTML = result;
                updateReport();
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                updateStatus('code', 'error');
            }
        }
        
        function verifySeparation() {
            const resultDiv = document.getElementById('separation-result');
            let result = '<span class="info">è³ªå•åˆ†é›¢ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</span>\n\n';
            
            try {
                // 36å•ã®æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ä½œæˆ
                const mockAnswers = [];
                for (let i = 1; i <= 36; i++) {
                    mockAnswers.push({
                        questionId: `q${i}`,
                        selectedOption: { value: 'A' }
                    });
                }
                
                // åˆ†é›¢å®Ÿè¡Œ
                const separated = analyzer.separateAnswers(mockAnswers);
                
                result += 'è³ªå•åˆ†é›¢çµæœ:\n';
                result += `Engine OS: ${separated.worldviewAnswers.length}å• `;
                result += separated.worldviewAnswers.length === 12 ? '<span class="success">âœ…</span>\n' : '<span class="error">âŒ</span>\n';
                
                result += `Interface OS: ${separated.scenarioAnswers.length}å• `;
                result += separated.scenarioAnswers.length === 12 ? '<span class="success">âœ…</span>\n' : '<span class="error">âŒ</span>\n';
                
                result += `Safe Mode OS: ${separated.defenseAnswers.length}å• `;
                result += separated.defenseAnswers.length === 12 ? '<span class="success">âœ…</span>\n' : '<span class="error">âŒ</span>\n';
                
                result += '\nè³ªå•ç•ªå·ç¯„å›²:\n';
                const engineRange = `${separated.worldviewAnswers[0]?.questionId}-${separated.worldviewAnswers[11]?.questionId}`;
                const interfaceRange = `${separated.scenarioAnswers[0]?.questionId}-${separated.scenarioAnswers[11]?.questionId}`;
                const safemodeRange = `${separated.defenseAnswers[0]?.questionId}-${separated.defenseAnswers[11]?.questionId}`;
                
                result += `Engine: ${engineRange} ${engineRange === 'q1-q12' ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `Interface: ${interfaceRange} ${interfaceRange === 'q13-q24' ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                result += `SafeMode: ${safemodeRange} ${safemodeRange === 'q25-q36' ? '<span class="success">âœ…</span>' : '<span class="error">âŒ</span>'}\n`;
                
                const allCorrect = separated.worldviewAnswers.length === 12 &&
                                  separated.scenarioAnswers.length === 12 &&
                                  separated.defenseAnswers.length === 12 &&
                                  engineRange === 'q1-q12' &&
                                  interfaceRange === 'q13-q24' &&
                                  safemodeRange === 'q25-q36';
                
                verificationResults.separation = allCorrect;
                updateStatus('separation', allCorrect ? 'success' : 'error');
                resultDiv.innerHTML = result;
                updateReport();
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                updateStatus('separation', 'error');
            }
        }
        
        function verifyInterfaceOS() {
            const resultDiv = document.getElementById('interface-result');
            let result = '<span class="info">Interface OSå‹•ä½œãƒ†ã‚¹ãƒˆ...</span>\n\n';
            
            try {
                // Q13-Q24ã®æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿
                const interfaceAnswers = [];
                for (let i = 13; i <= 24; i++) {
                    interfaceAnswers.push({
                        questionId: `q${i}`,
                        selectedOption: { value: 'B' }
                    });
                }
                
                // ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
                const patterns = analyzer.analyzeSocialPatterns(interfaceAnswers);
                
                result += 'ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆçµæœ:\n';
                const expectedPatterns = [
                    'Q13_leadership', 'Q14_interpersonal', 'Q15_family',
                    'Q16_emergency', 'Q17_competition', 'Q18_community',
                    'Q19_social', 'Q20_conflict', 'Q21_trust',
                    'Q22_expression', 'Q23_cooperation', 'Q24_adaptation'
                ];
                
                let allPatternsExist = true;
                expectedPatterns.forEach(pattern => {
                    const exists = patterns[pattern] !== undefined;
                    result += `  ${pattern}: ${exists ? '<span class="success">âœ…</span>' : '<span class="error">âŒ æœªå®šç¾©</span>'}\n`;
                    if (!exists) allPatternsExist = false;
                });
                
                // ãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰
                result += '\nãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰:\n';
                const vector = analyzer.buildInterfaceVector(patterns);
                let allVectorValid = true;
                Object.entries(vector).forEach(([key, value]) => {
                    const isValid = !isNaN(value) && value !== undefined;
                    if (!isValid) allVectorValid = false;
                    result += `  ${key}: ${isValid ? '<span class="success">âœ…</span>' : '<span class="error">âŒ NaN</span>'}\n`;
                });
                
                verificationResults.interface = allPatternsExist && allVectorValid;
                updateStatus('interface', verificationResults.interface ? 'success' : 'error');
                resultDiv.innerHTML = result;
                updateReport();
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                updateStatus('interface', 'error');
            }
        }
        
        function verifySafeModeOS() {
            const resultDiv = document.getElementById('safemode-result');
            let result = '<span class="info">Safe Mode OSå‹•ä½œãƒ†ã‚¹ãƒˆ...</span>\n\n';
            
            try {
                // Q25-Q36ã®æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿
                const defenseAnswers = [];
                for (let i = 25; i <= 36; i++) {
                    defenseAnswers.push({
                        questionId: `q${i}`,
                        selectedOption: { value: 'C' },
                        intensity: 0.7,
                        pattern: 'å›é¿'
                    });
                }
                
                // ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
                const patterns = analyzer.extractDefensivePatterns(defenseAnswers);
                
                result += 'ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆçµæœ:\n';
                const expectedPatterns = [
                    'Q25_leadershipStress', 'Q26_interpersonalStress', 'Q27_familyStress',
                    'Q28_emergencyStress', 'Q29_competitionStress', 'Q30_collaborationStress',
                    'Q31_socialStress', 'Q32_failureStress', 'Q33_changeStress',
                    'Q34_isolationStress', 'Q35_performanceStress', 'Q36_resourceStress'
                ];
                
                let allPatternsExist = true;
                expectedPatterns.forEach(pattern => {
                    const exists = patterns[pattern] !== undefined;
                    result += `  ${pattern}: ${exists ? '<span class="success">âœ…</span>' : '<span class="error">âŒ æœªå®šç¾©</span>'}\n`;
                    if (!exists) allPatternsExist = false;
                });
                
                verificationResults.safemode = allPatternsExist;
                updateStatus('safemode', allPatternsExist ? 'success' : 'error');
                resultDiv.innerHTML = result;
                updateReport();
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                updateStatus('safemode', 'error');
            }
        }
        
        async function verifySiteOperation() {
            const resultDiv = document.getElementById('site-result');
            let result = '<span class="info">ğŸš€ å®Ÿéš›ã®ã‚µã‚¤ãƒˆå‹•ä½œã‚’æ¤œè¨¼ä¸­...</span>\n\n';
            
            try {
                // 36å•ã®å®Œå…¨ãªæ¨¡æ“¬å›ç­”
                const fullAnswers = [];
                for (let i = 1; i <= 36; i++) {
                    fullAnswers.push({
                        questionId: `q${i}`,
                        selectedOption: { 
                            value: i <= 12 ? 'A' : i <= 24 ? 'B' : 'C',
                            scoring: {
                                "ä¹¾_å‰µé€ æ€§": Math.random() * 3,
                                "å…Œ_èª¿å’Œæ€§": Math.random() * 3,
                                "é›¢_è¡¨ç¾æ€§": Math.random() * 3,
                                "éœ‡_è¡Œå‹•æ€§": Math.random() * 3,
                                "å·½_é©å¿œæ€§": Math.random() * 3,
                                "å_æ¢æ±‚æ€§": Math.random() * 3,
                                "è‰®_å®‰å®šæ€§": Math.random() * 3,
                                "å¤_å—å®¹æ€§": Math.random() * 3
                            }
                        }
                    });
                }
                
                result += 'ğŸ“ 36å•ã®å›ç­”ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†\n\n';
                
                // Triple OSåˆ†æå®Ÿè¡Œ
                result += 'ğŸ”„ Triple OSåˆ†æã‚’å®Ÿè¡Œä¸­...\n';
                const analysis = await analyzer.analyzeTripleOS(fullAnswers);
                
                result += '\n<span class="success">âœ… åˆ†æå®Œäº†ï¼</span>\n\n';
                result += 'ğŸ“Š åˆ†æçµæœ:\n';
                result += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
                
                // Engine OSçµæœ
                result += '\nğŸ¯ Engine OS (å†…ãªã‚‹ä¾¡å€¤è¦³):\n';
                result += `  å¦ç•ªå·: #${analysis.engineOS.hexagramId || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  å¦å: ${analysis.engineOS.hexagramName || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  ä¸Šå¦: ${analysis.engineOS.upperTrigram || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  ä¸‹å¦: ${analysis.engineOS.lowerTrigram || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  çŠ¶æ…‹: ${analysis.engineOS.hexagramId ? '<span class="success">âœ… æ­£å¸¸</span>' : '<span class="error">âŒ ç•°å¸¸</span>'}\n`;
                
                // Interface OSçµæœ
                result += '\nğŸ’¬ Interface OS (å¯¾äººé–¢ä¿‚):\n';
                result += `  å¦ç•ªå·: #${analysis.interfaceOS.hexagramId || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  å¦å: ${analysis.interfaceOS.hexagramName || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  ä¸Šå¦: ${analysis.interfaceOS.upperTrigram || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  ä¸‹å¦: ${analysis.interfaceOS.lowerTrigram || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  çŠ¶æ…‹: ${analysis.interfaceOS.hexagramId ? '<span class="success">âœ… æ­£å¸¸</span>' : '<span class="error">âŒ ç•°å¸¸</span>'}\n`;
                
                // Safe Mode OSçµæœ
                result += '\nğŸ›¡ï¸ Safe Mode OS (é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ):\n';
                result += `  å¦ç•ªå·: #${analysis.safeModeOS.hexagramId || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  å¦å: ${analysis.safeModeOS.hexagramName || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  é˜²å¾¡ã‚¿ã‚¤ãƒ—: ${analysis.safeModeOS.defensiveType || 'ã‚¨ãƒ©ãƒ¼'}\n`;
                result += `  çŠ¶æ…‹: ${analysis.safeModeOS.hexagramId ? '<span class="success">âœ… æ­£å¸¸</span>' : '<span class="error">âŒ ç•°å¸¸</span>'}\n`;
                
                // çµ±åˆã‚¹ã‚³ã‚¢
                result += '\nğŸ“ˆ çµ±åˆã‚¹ã‚³ã‚¢:\n';
                result += `  ä¸€è²«æ€§: ${analysis.consistencyScore || 0}%\n`;
                result += `  ãƒãƒ©ãƒ³ã‚¹: ${analysis.balanceScore || 0}%\n`;
                result += `  çµ±åˆåº¦: ${analysis.HaQeiIntegration || 0}%\n`;
                
                result += '\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
                
                const allSuccess = analysis.engineOS.hexagramId && 
                                 analysis.interfaceOS.hexagramId && 
                                 analysis.safeModeOS.hexagramId;
                
                if (allSuccess) {
                    result += '<span class="success">ğŸ‰ å…¨ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸å‹•ä½œç¢ºèªï¼</span>\n';
                    result += '<span class="success">ä¿®æ­£ã¯å®Œå…¨ã«æˆåŠŸã—ã¦ã„ã¾ã™ã€‚</span>';
                } else {
                    result += '<span class="error">âš ï¸ ä¸€éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚</span>\n';
                    result += '<span class="error">è¿½åŠ ã®ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚</span>';
                }
                
                verificationResults.site = allSuccess;
                updateStatus('site', allSuccess ? 'success' : 'error');
                resultDiv.innerHTML = result;
                updateReport();
                
            } catch (error) {
                result += `<span class="error">ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: ${error.message}</span>\n`;
                result += `<span class="error">ã‚¹ã‚¿ãƒƒã‚¯: ${error.stack}</span>`;
                resultDiv.innerHTML = result;
                updateStatus('site', 'error');
                verificationResults.site = false;
                updateReport();
            }
        }
        
        function updateReport() {
            const reportArea = document.getElementById('report-area');
            let html = '<table>';
            html += '<tr><th>æ¤œè¨¼é …ç›®</th><th>çŠ¶æ…‹</th><th>è©³ç´°</th></tr>';
            
            html += '<tr>';
            html += '<td>ã‚³ãƒ¼ãƒ‰å®Ÿè£…</td>';
            html += `<td>${verificationResults.code ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸'}</td>`;
            html += '<td>separateAnswers, analyzeSocialPatterns, extractDefensivePatterns</td>';
            html += '</tr>';
            
            html += '<tr>';
            html += '<td>è³ªå•åˆ†é›¢</td>';
            html += `<td>${verificationResults.separation ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸'}</td>`;
            html += '<td>Q1-12(Engine), Q13-24(Interface), Q25-36(SafeMode)</td>';
            html += '</tr>';
            
            html += '<tr>';
            html += '<td>Interface OS</td>';
            html += `<td>${verificationResults.interface ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸'}</td>`;
            html += '<td>Q13-Q24ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆã€ãƒ™ã‚¯ãƒˆãƒ«æ§‹ç¯‰</td>';
            html += '</tr>';
            
            html += '<tr>';
            html += '<td>Safe Mode OS</td>';
            html += `<td>${verificationResults.safemode ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸'}</td>`;
            html += '<td>Q25-Q36ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ</td>';
            html += '</tr>';
            
            html += '<tr>';
            html += '<td>ã‚µã‚¤ãƒˆå‹•ä½œ</td>';
            html += `<td>${verificationResults.site ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸'}</td>`;
            html += '<td>Triple OSçµ±åˆåˆ†æ</td>';
            html += '</tr>';
            
            html += '</table>';
            
            const allSuccess = Object.values(verificationResults).every(v => v === true);
            if (allSuccess) {
                html += '<div style="margin-top: 20px; padding: 15px; background: #238636; border-radius: 6px;">';
                html += '<span style="font-size: 18px; font-weight: bold;">âœ… å…¨æ¤œè¨¼é …ç›®åˆæ ¼ - å®Ÿè£…ã¯å®Œå…¨ã«æ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã™</span>';
                html += '</div>';
            }
            
            reportArea.innerHTML = html;
        }
    </script>
</body>
</html>