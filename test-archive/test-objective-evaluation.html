<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¢è¦³çš„ãƒ­ã‚¸ãƒƒã‚¯è©•ä¾¡ - HaQei OS Analyzer</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #1a1a1a;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #ff6b6b;
            margin-bottom: 40px;
        }
        .critical-issue {
            background: #ff4444;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 18px;
        }
        .warning-issue {
            background: #ff9800;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .ok-status {
            background: #4caf50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .code-block {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .test-button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            background: #1976d2;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #444;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #333;
        }
        .issue-table td.bad {
            background: rgba(255, 68, 68, 0.3);
        }
        .issue-table td.good {
            background: rgba(76, 175, 80, 0.3);
        }
        .issue-table td.warning {
            background: rgba(255, 152, 0, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” å®¢è¦³çš„ãƒ­ã‚¸ãƒƒã‚¯è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ</h1>
        
        <div class="critical-issue">
            <h2>ğŸš¨ è‡´å‘½çš„å•é¡Œç™ºè¦‹ï¼</h2>
            <p><strong>separateAnswers ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¿®æ­£ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼</strong></p>
            <div class="code-block">
// ç¾åœ¨ã®å®Ÿè£…ï¼ˆé–“é•ã„ï¼‰
separateAnswers(allAnswers) {
    if (questionNum >= 1 && questionNum <= 24) {
        worldviewAnswers.push(answer);  // Q1-Q24å…¨ã¦Engine OSã¸
    } else if (questionNum >= 25 && questionNum <= 30) {
        scenarioAnswers.push(answer);   // Q25-Q30ãŒInterface OSã¸ï¼ˆé–“é•ã„ï¼ï¼‰
    } else if (questionNum >= 31 && questionNum <= 36) {
        defenseAnswers.push(answer);    // Q31-Q36ãŒSafe Mode OSã¸
    }
}
            </div>
            <p>âš ï¸ <strong>analyzeSocialPatternsã¯ä¿®æ­£ã—ãŸãŒã€ãã‚‚ãã‚‚æ¸¡ã•ã‚Œã‚‹è³ªå•ãŒé–“é•ã£ã¦ã„ã‚‹ï¼</strong></p>
        </div>

        <h2>ğŸ“Š ä¿®æ­£çŠ¶æ³ã®å®¢è¦³çš„è©•ä¾¡</h2>
        <table class="issue-table">
            <thead>
                <tr>
                    <th>ä¿®æ­£é …ç›®</th>
                    <th>æœŸå¾…ã•ã‚Œã‚‹å®Ÿè£…</th>
                    <th>å®Ÿéš›ã®çŠ¶æ³</th>
                    <th>è©•ä¾¡</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>è³ªå•ã®åˆ†é›¢ï¼ˆseparateAnswersï¼‰</td>
                    <td>Q1-12: Engine<br>Q13-24: Interface<br>Q25-36: SafeMode</td>
                    <td class="bad">Q1-24: Engine<br>Q25-30: Interface<br>Q31-36: SafeMode</td>
                    <td class="bad">âŒ æœªä¿®æ­£</td>
                </tr>
                <tr>
                    <td>analyzeSocialPatterns</td>
                    <td>Q13-Q24ã‚’å‡¦ç†</td>
                    <td class="warning">ãƒ¡ã‚½ãƒƒãƒ‰å†…ã¯Q13-Q24å¯¾å¿œ<br>ã—ã‹ã—é–“é•ã£ãŸè³ªå•ã‚’å—ã‘å–ã‚‹</td>
                    <td class="warning">âš ï¸ éƒ¨åˆ†çš„</td>
                </tr>
                <tr>
                    <td>buildInterfaceVector</td>
                    <td>Q13-Q24ãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ç”¨</td>
                    <td class="warning">ãƒ¡ã‚½ãƒƒãƒ‰å†…ã¯Q13-Q24å¯¾å¿œ<br>ã—ã‹ã—å­˜åœ¨ã—ãªã„ãƒ‡ãƒ¼ã‚¿å‚ç…§</td>
                    <td class="warning">âš ï¸ éƒ¨åˆ†çš„</td>
                </tr>
                <tr>
                    <td>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é‡è¤‡é˜²æ­¢</td>
                    <td>matchedãƒ•ãƒ©ã‚°ã§åˆ¶å¾¡</td>
                    <td class="good">æ­£ã—ãå®Ÿè£…æ¸ˆã¿</td>
                    <td class="good">âœ… OK</td>
                </tr>
                <tr>
                    <td>ä¸‰çˆ»é‡è¤‡å‡¦ç†</td>
                    <td>ç¬¬3ä½ã‚’ä½¿ç”¨</td>
                    <td class="good">æ­£ã—ãå®Ÿè£…æ¸ˆã¿</td>
                    <td class="good">âœ… OK</td>
                </tr>
                <tr>
                    <td>64å¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹</td>
                    <td>æ­£çµ±é…åˆ—ä½¿ç”¨</td>
                    <td class="good">æ­£ã—ãå®Ÿè£…æ¸ˆã¿</td>
                    <td class="good">âœ… OK</td>
                </tr>
            </tbody>
        </table>

        <div class="warning-issue">
            <h2>âš ï¸ å®Ÿè£…ã®ä¸æ•´åˆ</h2>
            <p><strong>ç¾åœ¨ã®å‹•ä½œãƒ•ãƒ­ãƒ¼ï¼š</strong></p>
            <ol>
                <li>separateAnswers ãŒ Q25-Q30 ã‚’ Interface OSç”¨ã¨ã—ã¦åˆ†é›¢ï¼ˆé–“é•ã„ï¼‰</li>
                <li>analyzeInterfaceOS ãŒ Q25-Q30 ã®6å•ã‚’å—ã‘å–ã‚‹</li>
                <li>analyzeSocialPatterns ãŒ Q13-Q24ï¼ˆ12å•ï¼‰ã‚’æœŸå¾…ã—ã¦ã„ã‚‹</li>
                <li>é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆã‚ãšã€Q13-Q18ã®ã¿å‡¦ç†ï¼ˆQ19-Q24ã¯ undefinedï¼‰</li>
                <li>buildInterfaceVector ãŒå­˜åœ¨ã—ãªã„ Q19_social, Q20_conflict ç­‰ã‚’å‚ç…§</li>
            </ol>
        </div>

        <h2>ğŸ§ª å‹•ä½œæ¤œè¨¼</h2>
        <button class="test-button" onclick="testDataFlow()">ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testActualExecution()">å®Ÿéš›ã®å®Ÿè¡Œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
        
        <div id="test-results" style="margin-top: 20px;"></div>

        <div class="critical-issue" style="margin-top: 40px;">
            <h2>ğŸ“ å¿…è¦ãªè¿½åŠ ä¿®æ­£</h2>
            <div class="code-block">
// separateAnswers ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
separateAnswers(allAnswers) {
    allAnswers.forEach(answer => {
        const questionNum = parseInt(answer.questionId.replace('q', ''));
        if (questionNum >= 1 && questionNum <= 12) {
            worldviewAnswers.push(answer);  // Engine OS
        } else if (questionNum >= 13 && questionNum <= 24) {
            scenarioAnswers.push(answer);   // Interface OS ï¼ˆä¿®æ­£å¿…è¦ï¼‰
        } else if (questionNum >= 25 && questionNum <= 36) {
            defenseAnswers.push(answer);    // Safe Mode OS ï¼ˆä¿®æ­£å¿…è¦ï¼‰
        }
    });
}
            </div>
        </div>
    </div>

    <script>
        function testDataFlow() {
            const results = document.getElementById('test-results');
            
            let html = '<div class="code-block">';
            html += 'ğŸ“‹ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆçµæœ:\n\n';
            
            // Q25-30ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            html += '1. separateAnswers ãŒ Q25-30 ã‚’ scenarioAnswers ã«æ ¼ç´\n';
            html += '2. analyzeInterfaceOS(scenarioAnswers) å‘¼ã³å‡ºã—\n';
            html += '3. analyzeSocialPatterns å†…ã§:\n';
            html += '   - index 0: Q25 â†’ Q13 ã¨ã—ã¦å‡¦ç†ï¼ˆQ13_leadership ã«æ ¼ç´ï¼‰\n';
            html += '   - index 1: Q26 â†’ Q14 ã¨ã—ã¦å‡¦ç†ï¼ˆQ14_interpersonal ã«æ ¼ç´ï¼‰\n';
            html += '   - index 2: Q27 â†’ Q15 ã¨ã—ã¦å‡¦ç†ï¼ˆQ15_family ã«æ ¼ç´ï¼‰\n';
            html += '   - index 3: Q28 â†’ Q16 ã¨ã—ã¦å‡¦ç†ï¼ˆQ16_emergency ã«æ ¼ç´ï¼‰\n';
            html += '   - index 4: Q29 â†’ Q17 ã¨ã—ã¦å‡¦ç†ï¼ˆQ17_competition ã«æ ¼ç´ï¼‰\n';
            html += '   - index 5: Q30 â†’ Q18 ã¨ã—ã¦å‡¦ç†ï¼ˆQ18_community ã«æ ¼ç´ï¼‰\n';
            html += '   - index 6-11: å­˜åœ¨ã—ãªã„ â†’ Q19-Q24 ã¯ undefined\n\n';
            
            html += '<span style="color: #ff6b6b;">çµæœ: Q25-30ã®å›ç­”ãŒQ13-18ã¨ã—ã¦èª¤ã£ã¦å‡¦ç†ã•ã‚Œã‚‹</span>\n';
            html += '<span style="color: #ff6b6b;">Q19-24ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å¸¸ã«0ï¼ˆundefinedï¼‰ã«ãªã‚‹</span>\n';
            
            html += '</div>';
            results.innerHTML = html;
        }
        
        function testActualExecution() {
            const results = document.getElementById('test-results');
            
            let html = '<div class="code-block">';
            html += 'ğŸ”¬ å®Ÿè¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ:\n\n';
            
            // æ¨¡æ“¬çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
            const patterns = {
                Q13_leadership: 0.8,     // å®Ÿéš›ã¯Q25ã®å€¤
                Q14_interpersonal: 0.7,  // å®Ÿéš›ã¯Q26ã®å€¤
                Q15_family: 0.6,         // å®Ÿéš›ã¯Q27ã®å€¤
                Q16_emergency: 0.9,      // å®Ÿéš›ã¯Q28ã®å€¤
                Q17_competition: 0.5,    // å®Ÿéš›ã¯Q29ã®å€¤
                Q18_community: 0.7,      // å®Ÿéš›ã¯Q30ã®å€¤
                Q19_social: undefined,   // å­˜åœ¨ã—ãªã„
                Q20_conflict: undefined, // å­˜åœ¨ã—ãªã„
                Q21_trust: undefined,    // å­˜åœ¨ã—ãªã„
                Q22_expression: undefined,// å­˜åœ¨ã—ãªã„
                Q23_cooperation: undefined,// å­˜åœ¨ã—ãªã„
                Q24_adaptation: undefined  // å­˜åœ¨ã—ãªã„
            };
            
            html += 'socialPatterns ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:\n';
            for (const [key, value] of Object.entries(patterns)) {
                const color = value === undefined ? '#ff6b6b' : '#4caf50';
                html += `  <span style="color: ${color}">${key}: ${value}</span>\n`;
            }
            
            html += '\nbuildInterfaceVector ã§ã®è¨ˆç®—:\n';
            html += '  å¤–å‘_ä¸»å°æ€§ = (0.8 * 0.8) + (0.9 * 0.5) + (undefined * 0.3)\n';
            html += '  <span style="color: #ff6b6b;">â†’ NaN ã«ãªã‚‹å¯èƒ½æ€§ï¼</span>\n';
            
            html += '</div>';
            results.innerHTML = html;
        }
    </script>
</body>
</html>