<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contract A改善テスト - 2025-08-10</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f1419;
            color: #e5e7eb;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        h1 { color: #6366f1; }
        h2 { color: #8b5cf6; }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
        .code-block {
            background: #1e293b;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #4f46e5;
        }
        .os-card {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .hexagram-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        .hexagram-id {
            background: rgba(99, 102, 241, 0.2);
            color: #6366f1;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
        }
        .weakness-list {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .weakness-list ul {
            margin: 10px 0;
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <h1>🔧 Contract A 改善テスト</h1>
    <p>日付: 2025-08-10 | 作業者: Claude</p>

    <div class="test-section">
        <h2>1. 契約A形式での保存テスト</h2>
        <button onclick="testContractASave()">保存テスト実行</button>
        <div id="save-result" class="code-block" style="margin-top: 10px; min-height: 100px;">
            結果がここに表示されます...
        </div>
    </div>

    <div class="test-section">
        <h2>2. 64卦ID・卦名表示テスト</h2>
        <div class="os-card">
            <h3 style="color: #6366f1;">Engine OS</h3>
            <div class="hexagram-info">
                <span class="hexagram-id">#1</span>
                <span>乾為天</span>
            </div>
        </div>
        <div class="os-card">
            <h3 style="color: #8b5cf6;">Interface OS</h3>
            <div class="hexagram-info">
                <span class="hexagram-id">#2</span>
                <span>坤為地</span>
            </div>
        </div>
        <div class="os-card">
            <h3 style="color: #10b981;">Safe Mode OS</h3>
            <div class="hexagram-info">
                <span class="hexagram-id">#29</span>
                <span>坎為水</span>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>3. 弱みが出やすいインターフェース表示テスト</h2>
        <div class="weakness-list">
            <h3 style="color: #ef4444;">⚠️ 弱みが出やすいインターフェース</h3>
            <div>
                <strong style="color: #6366f1;">Engine OS:</strong>
                <ul>
                    <li>過度な制約がある環境</li>
                    <li>創造性を抑圧する状況</li>
                    <li>硬直的なルールに縛られる場面</li>
                </ul>
            </div>
            <div>
                <strong style="color: #8b5cf6;">Interface OS:</strong>
                <ul>
                    <li>孤立した作業環境</li>
                    <li>競争的で協力が難しい状況</li>
                    <li>感情表現が抑制される場面</li>
                </ul>
            </div>
            <div>
                <strong style="color: #10b981;">Safe Mode OS:</strong>
                <ul>
                    <li>不確実性の高い状況</li>
                    <li>急激な変化が求められる場面</li>
                    <li>リスクテイクが必要な環境</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>4. 変化記述の削除確認</h2>
        <p class="success">✅ 変卦システムセクション: 削除済み</p>
        <p class="success">✅ renderChangeHexagramSystem: コメントアウト済み</p>
        <p class="success">✅ transform/advance記述: 削除済み</p>
    </div>

    <div class="test-section">
        <h2>テスト結果サマリー</h2>
        <div id="test-summary">
            <p>実装状況:</p>
            <ul>
                <li class="success">✅ 契約A v1.1形式での保存実装完了</li>
                <li class="success">✅ 64卦ID（1-64）と卦名の明確な表示</li>
                <li class="success">✅ 弱みが出やすいインターフェースの記述追加</li>
                <li class="success">✅ 変化記述（transform/advance）の削除</li>
            </ul>
        </div>
    </div>

    <script>
        // 契約A形式保存テスト
        function testContractASave() {
            const testData = {
                version: "1.1",
                engine_os: {
                    id: 1,
                    name: "乾為天",
                    score: 0.82
                },
                interface_os: {
                    id: 2,
                    name: "坤為地",
                    score: 0.74
                },
                safe_mode_os: {
                    id: 29,
                    name: "坎為水",
                    score: 0.65
                },
                synergy: {
                    matrix: [[1, 0.7, 0.5], [0.7, 1, 0.6], [0.5, 0.6, 1]],
                    notes: "Engine-Interface-Safe Mode間の相互作用パターン"
                },
                interactions: {
                    pair_insights: [
                        {
                            pair: "Engine-Interface",
                            type: "complementary",
                            strength: 0.75,
                            summary: "創造性と社会性の調和"
                        }
                    ],
                    affordances: {
                        engine: {
                            thrives_with: ["革新的な環境", "自由な発想が許される場"],
                            struggles_with: ["過度な制約", "創造性を抑圧する環境"]
                        },
                        interface: {
                            thrives_with: ["協調的なチーム", "対話重視の環境"],
                            struggles_with: ["孤立した作業", "競争的な環境"]
                        },
                        safe: {
                            thrives_with: ["安定した環境", "明確なルール"],
                            struggles_with: ["不確実性の高い状況", "急激な変化"]
                        }
                    },
                    inner_conflicts: ["創造性と安定性の対立", "社会性と独立性の葛藤"],
                    integration_prompts: [
                        "各OSの強みを認識し、状況に応じて使い分ける",
                        "内的対話を通じて統合を促進する"
                    ]
                },
                strengths: ["創造的リーダーシップ", "適応力", "安定性"],
                risks: ["過度な理想主義", "優柔不断", "変化への抵抗"],
                created_at: new Date().toISOString()
            };

            // LocalStorageに保存
            localStorage.setItem('haqei_triple_os_results', JSON.stringify(testData));
            
            // 保存したデータを読み込んで表示
            const savedData = JSON.parse(localStorage.getItem('haqei_triple_os_results'));
            
            document.getElementById('save-result').innerHTML = `
                <div class="success">✅ 保存成功</div>
                <pre>${JSON.stringify(savedData, null, 2)}</pre>
            `;
        }

        // ページ読み込み時にlocalStorageをチェック
        window.onload = function() {
            const existingData = localStorage.getItem('haqei_triple_os_results');
            if (existingData) {
                console.log('既存のContract Aデータ検出:', JSON.parse(existingData));
            }
        };
    </script>
</body>
</html>