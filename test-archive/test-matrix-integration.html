<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒˆãƒªã‚¯ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 10px;
        }
        .test-result {
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¬ os_analyzer.html ãƒãƒˆãƒªã‚¯ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ</h1>
    
    <div style="text-align: center;">
        <button onclick="runAllTests()">å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <button onclick="clearResults()">çµæœã‚¯ãƒªã‚¢</button>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆ1: ãƒãƒˆãƒªã‚¯ã‚¹å®šç¾©ç¢ºèª -->
    <div class="test-section">
        <div class="test-title">ğŸ“‹ ãƒ†ã‚¹ãƒˆ1: ãƒãƒˆãƒªã‚¯ã‚¹å®šç¾©ç¢ºèª</div>
        <div id="matrix-definition-test" class="test-result info">ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...</div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆ2: å°‚é–€å®¶æ¨å¥¨ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div class="test-section">
        <div class="test-title">âœ… ãƒ†ã‚¹ãƒˆ2: å°‚é–€å®¶æ¨å¥¨ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³</div>
        <div id="assertion-test" class="test-result info">ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...</div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆ3: ç´”å¦ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <div class="test-title">â˜¯ ãƒ†ã‚¹ãƒˆ3: ç´”å¦ï¼ˆ8ã¤ï¼‰ã®ç”Ÿæˆç¢ºèª</div>
        <div id="pure-hexagram-test" class="test-result info">ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...</div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆ4: å¯¾ç§°æ€§ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <div class="test-title">ğŸ”„ ãƒ†ã‚¹ãƒˆ4: å¯¾ç§°æ€§ç¢ºèª</div>
        <div id="symmetry-test" class="test-result info">ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...</div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆ5: å®Ÿéš›ã®è¨ºæ–­ãƒ•ãƒ­ãƒ¼ -->
    <div class="test-section">
        <div class="test-title">âš¡ ãƒ†ã‚¹ãƒˆ5: å®Ÿéš›ã®è¨ºæ–­ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ</div>
        <div id="diagnosis-flow-test" class="test-result info">ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...</div>
    </div>

    <script>
        // ãƒãƒˆãƒªã‚¯ã‚¹å®šç¾©ï¼ˆos_analyzer.htmlã¨åŒã˜ï¼‰
        const authenticHexagramMatrix = [
            // ä¸Šå¦: ä¹¾ï¼ˆå¤©ï¼‰, ä¸‹å¦: ä¹¾,å…Œ,é›¢,éœ‡,å·½,å,è‰®,å¤
            [1,  10, 13, 25, 44,  6, 33, 12],
            // ä¸Šå¦: å…Œï¼ˆæ²¢ï¼‰
            [43, 58, 49, 17, 28, 47, 31, 45],
            // ä¸Šå¦: é›¢ï¼ˆç«ï¼‰
            [14, 38, 30, 21, 50, 64, 56, 35],
            // ä¸Šå¦: éœ‡ï¼ˆé›·ï¼‰
            [34, 54, 55, 51, 32, 40, 62, 16],
            // ä¸Šå¦: å·½ï¼ˆé¢¨ï¼‰
            [9,  61, 37, 42, 57, 59, 53, 20],
            // ä¸Šå¦: åï¼ˆæ°´ï¼‰
            [5,  60, 63,  3, 48, 29, 39,  8],
            // ä¸Šå¦: è‰®ï¼ˆå±±ï¼‰
            [26, 41, 22, 27, 18,  4, 52, 23],
            // ä¸Šå¦: å¤ï¼ˆåœ°ï¼‰
            [11, 19, 36, 24, 46,  7, 15,  2]
        ];

        const BAGUA_ORDER = ["ä¹¾", "å…Œ", "é›¢", "éœ‡", "å·½", "å", "è‰®", "å¤"];
        
        function getHexagramId(upperBagua, lowerBagua) {
            const upperIndex = BAGUA_ORDER.indexOf(upperBagua);
            const lowerIndex = BAGUA_ORDER.indexOf(lowerBagua);
            
            if (upperIndex === -1 || lowerIndex === -1) {
                throw new Error(`Invalid bagua: upper=${upperBagua}, lower=${lowerBagua}`);
            }
            
            return authenticHexagramMatrix[upperIndex][lowerIndex];
        }

        // ãƒ†ã‚¹ãƒˆ1: ãƒãƒˆãƒªã‚¯ã‚¹å®šç¾©ç¢ºèª
        function testMatrixDefinition() {
            const element = document.getElementById('matrix-definition-test');
            let output = "";
            
            try {
                output += "ãƒãƒˆãƒªã‚¯ã‚¹ã‚µã‚¤ã‚º: " + authenticHexagramMatrix.length + "Ã—" + authenticHexagramMatrix[0].length + "\n";
                
                // å…¨è¦ç´ ãŒ1-64ã®ç¯„å›²å†…ã‹ç¢ºèª
                const allValues = new Set();
                for (let i = 0; i < 8; i++) {
                    for (let j = 0; j < 8; j++) {
                        const value = authenticHexagramMatrix[i][j];
                        if (value < 1 || value > 64) {
                            throw new Error(`Invalid value ${value} at [${i}][${j}]`);
                        }
                        allValues.add(value);
                    }
                }
                
                output += "ã‚«ãƒãƒ¼å¦æ•°: " + allValues.size + "/64\n";
                output += "ç¯„å›²ãƒã‚§ãƒƒã‚¯: âœ… å…¨å€¤ãŒ1-64ã®ç¯„å›²å†…\n";
                
                element.className = "test-result success";
                element.textContent = output;
                return true;
            } catch (error) {
                output += "âŒ ã‚¨ãƒ©ãƒ¼: " + error.message;
                element.className = "test-result error";
                element.textContent = output;
                return false;
            }
        }

        // ãƒ†ã‚¹ãƒˆ2: å°‚é–€å®¶æ¨å¥¨ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
        function testAssertions() {
            const element = document.getElementById('assertion-test');
            let output = "";
            
            const assertions = [
                { upper: "ä¹¾", lower: "ä¹¾", expected: 1, name: "ä¹¾ç‚ºå¤©" },
                { upper: "ä¹¾", lower: "å", expected: 6, name: "å¤©æ°´è¨Ÿ" },
                { upper: "å", lower: "ä¹¾", expected: 5, name: "æ°´å¤©éœ€" },
                { upper: "ä¹¾", lower: "é›¢", expected: 13, name: "å¤©ç«åŒäºº" },
                { upper: "é›¢", lower: "ä¹¾", expected: 14, name: "ç«å¤©å¤§æœ‰" }
            ];
            
            let allPassed = true;
            
            assertions.forEach(test => {
                try {
                    const actual = getHexagramId(test.upper, test.lower);
                    const passed = actual === test.expected;
                    
                    if (passed) {
                        output += `âœ… ${test.upper}/${test.lower} = #${actual} (${test.name})\n`;
                    } else {
                        output += `âŒ ${test.upper}/${test.lower} = #${actual}, æœŸå¾…å€¤: #${test.expected} (${test.name})\n`;
                        allPassed = false;
                    }
                } catch (error) {
                    output += `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n`;
                    allPassed = false;
                }
            });
            
            element.className = allPassed ? "test-result success" : "test-result error";
            element.textContent = output;
            return allPassed;
        }

        // ãƒ†ã‚¹ãƒˆ3: ç´”å¦ãƒ†ã‚¹ãƒˆ
        function testPureHexagrams() {
            const element = document.getElementById('pure-hexagram-test');
            let output = "";
            
            const pureTests = [
                { bagua: "ä¹¾", expected: 1, name: "ä¹¾ç‚ºå¤©" },
                { bagua: "å¤", expected: 2, name: "å¤ç‚ºåœ°" },
                { bagua: "å", expected: 29, name: "åç‚ºæ°´" },
                { bagua: "é›¢", expected: 30, name: "é›¢ç‚ºç«" },
                { bagua: "éœ‡", expected: 51, name: "éœ‡ç‚ºé›·" },
                { bagua: "è‰®", expected: 52, name: "è‰®ç‚ºå±±" },
                { bagua: "å·½", expected: 57, name: "å·½ç‚ºé¢¨" },
                { bagua: "å…Œ", expected: 58, name: "å…Œç‚ºæ²¢" }
            ];
            
            let allPassed = true;
            
            pureTests.forEach(test => {
                const actual = getHexagramId(test.bagua, test.bagua);
                const passed = actual === test.expected;
                
                if (passed) {
                    output += `âœ… ${test.bagua}/${test.bagua} = #${actual} ${test.name}\n`;
                } else {
                    output += `âŒ ${test.bagua}/${test.bagua} = #${actual}, æœŸå¾…å€¤: #${test.expected}\n`;
                    allPassed = false;
                }
            });
            
            element.className = allPassed ? "test-result success" : "test-result error";
            element.textContent = output;
            return allPassed;
        }

        // ãƒ†ã‚¹ãƒˆ4: å¯¾ç§°æ€§ãƒ†ã‚¹ãƒˆ
        function testSymmetry() {
            const element = document.getElementById('symmetry-test');
            let output = "";
            
            const pairs = [
                ["ä¹¾", "å"],
                ["ä¹¾", "é›¢"],
                ["å…Œ", "å·½"],
                ["éœ‡", "è‰®"]
            ];
            
            pairs.forEach(([bagua1, bagua2]) => {
                const id1 = getHexagramId(bagua1, bagua2);
                const id2 = getHexagramId(bagua2, bagua1);
                
                output += `${bagua1}/${bagua2} = #${id1}\n`;
                output += `${bagua2}/${bagua1} = #${id2}\n`;
                output += `ç•°ãªã‚‹å¦: ${id1 !== id2 ? "âœ…" : "âŒ"}\n\n`;
            });
            
            element.className = "test-result success";
            element.textContent = output;
            return true;
        }

        // ãƒ†ã‚¹ãƒˆ5: å®Ÿéš›ã®è¨ºæ–­ãƒ•ãƒ­ãƒ¼
        function testDiagnosisFlow() {
            const element = document.getElementById('diagnosis-flow-test');
            let output = "";
            
            try {
                // æ¨¡æ“¬çš„ãªå…«å¦ã‚¨ãƒãƒ«ã‚®ãƒ¼
                const baguaEnergies = {
                    "ä¹¾": 45,
                    "é›¢": 30,
                    "å…Œ": 15,
                    "éœ‡": 10,
                    "å·½": 5,
                    "å": 3,
                    "è‰®": 2,
                    "å¤": 1
                };
                
                // ã‚½ãƒ¼ãƒˆ
                const sorted = Object.entries(baguaEnergies).sort((a, b) => b[1] - a[1]);
                const topBagua1 = sorted[0][0];
                const topBagua2 = sorted[1][0];
                
                output += `Top 2 å…«å¦: ${topBagua1} (${sorted[0][1]}%), ${topBagua2} (${sorted[1][1]}%)\n`;
                
                // ä¸¡æ–¹å‘ã®å¦ã‚’è¨ˆç®—
                const hexagramId1 = getHexagramId(topBagua1, topBagua2);
                const hexagramId2 = getHexagramId(topBagua2, topBagua1);
                
                output += `å€™è£œ1: ${topBagua1}/${topBagua2} = #${hexagramId1}\n`;
                output += `å€™è£œ2: ${topBagua2}/${topBagua1} = #${hexagramId2}\n`;
                
                // ç°¡æ˜“çš„ãªé¸æŠï¼ˆå®Ÿéš›ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é©åˆåº¦ã§åˆ¤æ–­ï¼‰
                output += `\né¸æŠ: #${hexagramId1} (å®Ÿéš›ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é©åˆåº¦ã§æ±ºå®š)\n`;
                
                element.className = "test-result success";
                element.textContent = output;
                return true;
            } catch (error) {
                output += "âŒ ã‚¨ãƒ©ãƒ¼: " + error.message;
                element.className = "test-result error";
                element.textContent = output;
                return false;
            }
        }

        // å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function runAllTests() {
            console.log("=== ãƒãƒˆãƒªã‚¯ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹ ===");
            
            const results = {
                matrixDefinition: testMatrixDefinition(),
                assertions: testAssertions(),
                pureHexagrams: testPureHexagrams(),
                symmetry: testSymmetry(),
                diagnosisFlow: testDiagnosisFlow()
            };
            
            const allPassed = Object.values(results).every(r => r);
            
            console.log("=== ãƒ†ã‚¹ãƒˆçµæœ ===");
            console.log(results);
            console.log(`ç·åˆçµæœ: ${allPassed ? "âœ… å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ" : "âŒ å¤±æ•—ã‚ã‚Š"}`);
            
            if (allPassed) {
                alert("âœ… å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸï¼ãƒãƒˆãƒªã‚¯ã‚¹çµ±åˆã¯æ­£å¸¸ã§ã™ã€‚");
            } else {
                alert("âŒ ãƒ†ã‚¹ãƒˆã«å¤±æ•—ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
            }
        }

        // çµæœã‚¯ãƒªã‚¢
        function clearResults() {
            const elements = document.querySelectorAll('.test-result');
            elements.forEach(el => {
                el.className = 'test-result info';
                el.textContent = 'ãƒ†ã‚¹ãƒˆå¾…æ©Ÿä¸­...';
            });
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
        window.onload = () => {
            setTimeout(runAllTests, 500);
        };
    </script>
</body>
</html>