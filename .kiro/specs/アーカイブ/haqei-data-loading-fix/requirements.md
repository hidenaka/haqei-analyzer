# 3 層人格 OS 診断結果画面 - 機能強化要件書（改訂版）

## はじめに

現在の 3 層人格 OS 診断結果画面を大幅に強化し、ユーザーに**内なるチームの多次元的分析**を提供する包括的なシステムを構築します。単純な結果表示から、インタラクティブで視覚的に魅力的な、**内的統合のための実践的ガイダンス**を含む診断レポートへと進化させます。

## 中核概念：内なるチーム分析

本システムは**他者との相性診断ではなく**、**一人の人間の中で異なる OS（側面）がどのように連携し、あるいは葛藤するかを分析する**ことを目的とします。エンジン OS（動機）、インターフェース OS（行動）、セーフモード OS（防御機制）の 3 つが、あなたの内部でどのようなチームワークを形成しているかを明らかにします。

## 要件

### 要件 1: 多次元相性評価システム

**ユーザーストーリー:** 診断を受けたユーザーとして、自分の 3 つの OS の組み合わせが単純な良し悪しではなく、多面的な観点から評価され、それぞれの価値と課題を理解したい。

#### 受け入れ基準

1. WHEN ユーザーが診断結果を表示する THEN 5 つの評価軸（機能的効率性、成長促進性、ストレス耐性、創造性、統合難易度）による多次元評価が表示される SHALL
2. WHEN ユーザーが相性評価を閲覧する THEN シナジー型、調和型、緊張型、葛藤型、混沌型の 5 段階分類が色分けと共に表示される SHALL
3. WHEN ユーザーが各評価軸を確認する THEN 具体的なスコア（0-1.0）と質的な解釈が提供される SHALL
4. WHEN ユーザーが組み合わせパターンを閲覧する THEN その組み合わせ特有の強み、課題、推奨事項が表示される SHALL

### 要件 2: 内的チーム力学の可視化システム

**ユーザーストーリー:** 診断を受けたユーザーとして、自分の内なる 3 つの OS がどのように相互作用しているかを、視覚的に理解したい。

#### 受け入れ基準

1. WHEN ユーザーが診断結果画面を表示する THEN 5 次元レーダーチャートで多面的評価が可視化される SHALL
2. WHEN ユーザーが相互作用を確認する THEN エネルギーフローが粒子アニメーションで表現される SHALL
   - スムーズな流れ: 調和的な関係
   - 衝突する粒子: 葛藤的な関係
   - ランダムな粒子: 混沌的な関係
3. WHEN ユーザーが統合パスを閲覧する THEN 現在の状態から理想的な統合への道筋が表示される SHALL
4. WHEN ユーザーがクラッシュサイクルを確認する THEN 暴走 → クラッシュ → 再生の循環が視覚化される SHALL

### 要件 3: 相性マトリックス詳細表示システム

**ユーザーストーリー:** 診断を受けたユーザーとして、自分のエンジン OS に対して、なぜ特定のインターフェース OS/セーフモード OS が最適なのか、その設計思想を理解したい。

#### 受け入れ基準

1. WHEN ユーザーがベストマッチを閲覧する THEN 「補完と調和」の観点から詳細な説明が表示される SHALL
2. WHEN ユーザーがセーフモードマッチを閲覧する THEN 「健全なクラッシュと必要なリセット」の観点から説明される SHALL
3. WHEN ユーザーが課題となる組み合わせを閲覧する THEN 具体的な葛藤パターンと内的体験が描写される SHALL
4. WHEN ユーザーが特殊パターンを確認する THEN 逆説的シナジー型、状況依存型、成長段階型などの説明が提供される SHALL

### 要件 4: 動的コンテキスト評価システム

**ユーザーストーリー:** 診断を受けたユーザーとして、自分の現在のライフステージや目標に応じて、組み合わせの評価がどう変わるかを知りたい。

#### 受け入れ基準

1. WHEN ユーザーがライフステージを入力する THEN 年齢・段階に応じた評価調整が行われる SHALL
2. WHEN ユーザーが現在の課題を入力する THEN 課題に対する各 OS の有効性が再評価される SHALL
3. WHEN ユーザーが目標を設定する THEN 目標達成における組み合わせの適性が分析される SHALL
4. WHEN ユーザーが環境要因を入力する THEN 環境との相性を考慮した評価が提供される SHALL

### 要件 5: 統合ガイダンス提供システム

**ユーザーストーリー:** 診断を受けたユーザーとして、自分の内なるチームをより良く統合し、葛藤を創造的に活用する具体的な方法を知りたい。

#### 受け入れ基準

1. WHEN ユーザーが統合アドバイスを閲覧する THEN 組み合わせタイプに応じた具体的な統合手法が提供される SHALL
2. WHEN ユーザーが葛藤解消法を確認する THEN 内的矛盾を創造的エネルギーに変換する方法が提案される SHALL
3. WHEN ユーザーが成長プランを閲覧する THEN 短期・中期・長期の具体的行動計画が表示される SHALL
4. WHEN ユーザーが日常実践を確認する THEN 毎日の生活で意識すべきポイントが提示される SHALL

### 要件 6: 高度な視覚的デザインシステム

**ユーザーストーリー:** 診断を受けたユーザーとして、複雑な内的力学を直感的に理解できる、美しく機能的なビジュアル表現を体験したい。

#### 受け入れ基準

1. WHEN ユーザーが診断結果を閲覧する THEN 相性タイプごとに定義された色（シナジー:緑、調和:青、緊張:橙、葛藤:赤、混沌:紫）が使用される SHALL
2. WHEN ユーザーが OS カードを確認する THEN 八卦記号と 64 卦シンボルが適切に表示される SHALL
3. WHEN ユーザーがアニメーションを体験する THEN 滑らかで意味のある動きで内的力学が表現される SHALL
4. WHEN ユーザーがダークモードを選択する THEN 全体のビジュアルが適切に調整される SHALL

### 要件 7: データ整合性・品質要件

**ユーザーストーリー:** 診断を受けたユーザーとして、表示される多次元評価が論理的に一貫し、信頼できることを期待する。

#### 受け入れ基準

1. WHEN システムが相性評価を計算する THEN 全 64 卦 ×64 卦の組み合わせで一貫した評価ロジックが適用される SHALL
2. WHEN システムが特殊パターンを検出する THEN 定義された条件に基づいて正確に分類される SHALL
3. WHEN システムが動的調整を行う THEN ベース評価との関係が明確に保たれる SHALL
4. WHEN システムが統合アドバイスを生成する THEN 評価結果と論理的に整合したアドバイスが提供される SHALL

## 技術的前提条件

### 多次元評価データベース構造

```javascript
const CompatibilityDatabase = {
  // 64×64の全組み合わせに対する基本評価
  baseEvaluations: {
    "1_15": {
      // 乾為天 × 地山謙
      functionalEfficiency: 0.65,
      growthPotential: 0.9,
      stressResilience: 0.75,
      creativity: 0.7,
      integrationChallenge: 0.85,
      type: "SYNERGY",
      philosophy: "傲慢さを謙虚さで中和",
      detailedAnalysis: {
        /* ... */
      },
    },
    // ... 4096通りの組み合わせ
  },

  // 特殊パターンの定義
  specialPatterns: {
    paradoxicalSynergy: [
      /* ... */
    ],
    contextDependent: [
      /* ... */
    ],
    developmental: [
      /* ... */
    ],
  },
};
```

### 既存システムとの整合性

- TripleOSEngine.js の出力形式を維持しつつ、多次元評価を追加
- 64 卦詳細コンテンツ（Phase 1 で作成）との連携
- 既存の UI コンポーネント構造を拡張

## 実装フェーズ（改訂版）

### Phase 1: 多次元評価基盤の実装（必須）

1. **相性評価データベースの構築**

   - 64×64 組み合わせの基本スコア設定
   - 5 つの評価軸に基づく詳細解説文作成
   - 特殊パターンの定義と分類

2. **評価エンジンの実装**

   - MultidimensionalCompatibility クラスの実装
   - InternalCompatibilityEngine の実装
   - 基本的なテキストベース表示

3. **統合ガイダンス生成**
   - 組み合わせタイプ別アドバイス
   - 葛藤解消メソッドの定義
   - 成長プランテンプレート

### Phase 2: 視覚的表現と体験の向上（推奨）

1. **高度なビジュアライゼーション**

   - 5 次元レーダーチャート実装
   - エネルギーフロー粒子アニメーション
   - 統合パスの可視化

2. **インタラクティブ要素**
   - ドリルダウン機能
   - アニメーション制御
   - ツールチップ詳細情報

### Phase 3: 動的評価システムの導入（拡張）

1. **コンテキスト入力機能**

   - ライフステージ選択 UI
   - 目標・課題入力フォーム
   - 環境要因の設定

2. **動的評価アルゴリズム**

   - コンテキストベース調整ロジック
   - リアルタイム再計算
   - パーソナライズされた洞察

3. **学習サイクル確立**
   - ユーザーフィードバック収集
   - 評価精度の継続的改善
   - 実証データの蓄積

## テスト要件

### 多次元評価の検証

- 全 4096 組み合わせの評価一貫性チェック
- 特殊パターン検出の正確性検証
- 動的調整の論理的整合性テスト

### ユーザビリティテスト

- 多次元評価の理解度測定
- 視覚的表現の直感性評価
- 統合ガイダンスの実用性検証

## 成功指標

1. **理解度向上**: ユーザーが自身の内的力学を深く理解できる
2. **実践的価値**: 提供されるガイダンスが日常生活で活用される
3. **継続的関与**: ユーザーが繰り返し診断結果を参照し、成長を実感する

この改訂版要件書により、「内なるチーム」という革新的な概念を中心に据えた、より深い自己理解と成長を促進するシステムを構築します。
