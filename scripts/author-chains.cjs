'use strict';

const fs = require('fs');
const path = require('path');

function loadJSON(p) { return JSON.parse(fs.readFileSync(p, 'utf8')); }
function saveJSON(p, obj) { fs.writeFileSync(p, JSON.stringify(obj, null, 2), 'utf8'); }

function main() {
  const file = path.resolve(__dirname, '..', 'public', 'data', 'narratives_chain.v1.json');
  const db = loadJSON(file);
  const baseKey = '乾為天 初九 | ';
  const updates = {
    JJJ: {
      chain_long:
        'まず、芽吹いた力を急がせず、静かに深めていきます。体を整え、足場を固めるほどに、呼吸はゆっくりと整い、地面の感触が確かになります。' +
        '続いて、積み重ねた基礎が芯を支え、学びが自信へ変わります。見える景色は大きく変わらなくても、内側では確かな手応えが育っていきます。' +
        '最後に、芽は茎へ、茎は節へと伸び、静かな準備が静かな前進へ転じます。力はまだ飾らず、次の跳躍のために、磨いておきます。' +
        '突破口は、急がず深めることにあります。まずは背筋を伸ばし、丁寧な基本動作を揃えていきましょう。',
      suitability: '長期の基礎作りや技能の鍛錬を優先する場面',
      caution: '早合点や過度な自己主張を避け、謙虚さを保つ'
    },
    JJH: {
      chain_long:
        'まず、土台を整えながら手順を覚え、身体に馴染ませていきます。細部を直し、基準を一つずつ確かにします。' +
        '続いて、もう一段、同じ型を深めて芯を太くします。迷いが減り、動きが自然に繋がりはじめます。' +
        '最後に、視点を少し切り替えます。これまでの型を生かしたまま、関係や配置を見直すと、新しい通り道が開けます。' +
        '突破口は、深めた後の小さな視点転換にあります。まずは意図を共有し、関わる人の目線を揃えてから一歩進めましょう。',
      suitability: '基礎固めののちに軽い方向転換で効果を出したい場面',
      caution: '深めた型を捨てず、言葉と期待値をすり合わせてから切り替える'
    },
    JHJ: {
      chain_long:
        'まず、基礎の呼吸を整えます。手に馴染む重みや間合いを確かめ、無理のない運びを身に付けます。' +
        '次に、観点を一度切り替えます。同じ素材でも、並べ方や距離が変われば、扱い方も自然と変わります。' +
        '最後に、切り替えた視点のまま、もう一度深めます。新しい重心が見つかるほど、動きは滑らかになり、道筋が一本にまとまります。' +
        '突破口は、視点の切替後に再び基本を磨くところにあります。まずは小さく試し、うまくいった型を丁寧に繰り返しましょう。',
      suitability: '仮説転換の後、同一視点で実装精度を高めたい場面',
      caution: '切替直後は負荷がかかるため、変更点を絞って反復する'
    },
    JHH: {
      chain_long:
        'まず、静かな前進で基礎を固めます。焦らず一呼吸おくほど、足元は落ち着きます。' +
        '続いて、連続して視点を切り替えます。組み合わせや順番を入れ替え、固定観念をほどいていきます。' +
        '最後に、さらにもう一度切り替えます。風向きが変わるように、扱い方を軽くし、動ける余白を広げます。' +
        '突破口は、固さをほぐす二度の転換にあります。まずは合意の幅を確認し、段取りを細かく刻んで進めましょう。',
      suitability: '環境の変化が大きく、柔軟な再配置が必要な場面',
      caution: '切替疲れを避けるため、関係者の足並みと節目の説明を丁寧に'
    },
    HJJ: {
      chain_long:
        'まず、観点をそっと切り替えます。同じ素材を、別の光で照らし直すところから始めます。' +
        '続いて、切り替えた視点のもとで深めます。操作は小さく、精度は高く。芯が少しずつ通っていきます。' +
        '最後に、もう一段深めます。動きは簡素になり、余計な力が抜けて、前と後ろが自然に繋がります。' +
        '突破口は、最初の小さな見直しにあります。まずは関係を傷つけない範囲から整え、うまくいった流れを増やしましょう。',
      suitability: '初手の再定義の後、安定化と定着を図りたい場面',
      caution: '初期の切替に抵抗が出やすいので、意図と利点を先に共有する'
    },
    HJH: {
      chain_long:
        'まず、視点を切り替えます。別角度から同じ課題を見ると、扱いは自然に変わります。' +
        '次に、その視点で深めます。新しい重心が決まれば、手順は短く、動きは軽やかになります。' +
        '最後に、もう一度視点を切り替えます。硬直を避け、流れに合わせて、軽快に軌道を微修正します。' +
        '突破口は、固定しすぎない柔らかさにあります。まずは方針・役割・期待の三点を短いサイクルで見直しましょう。',
      suitability: '探索と定着を往復しながら最短経路を探る場面',
      caution: '揺れが大きくならないよう、変更の目的と境界を明確に'
    },
    HHJ: {
      chain_long:
        'まず、視点を替えます。次に、もう一度替えます。二度の切替で、固まっていた思考の節がほぐれ、手が軽くなります。' +
        '最後に、ほぐれた視点のまま深めます。余白のある運びへと整え直し、力の向きが一つにまとまります。' +
        '突破口は、最初の二手にあります。まずは関係者の安心を確かめ、変える範囲を明示してから実行しましょう。',
      suitability: '前提の固定化を解き、再設計へ移る前のほぐしが必要な場面',
      caution: '序盤の混乱を避けるため、変更のスコープと期待値を先に揃える'
    },
    HHH: {
      chain_long:
        'まず、視点を替えます。続いて、もう一度。最後に、さらにもう一度。三度の切替で、風向きは大きく変わります。' +
        '元の型に戻らない覚悟で、関係と配置を編み直すほど、行き止まりは道へと変わります。' +
        '突破口は、再発明にあります。まずは地図を書き換えるつもりで、概念・役割・運用を順に整えましょう。',
      suitability: '抜本的なリフレーミングや再構築が必要な場面',
      caution: '影響範囲が広いため、移行計画・支援線・合意形成を段階的に設計する'
    }
  };

  for (const pat of Object.keys(updates)) {
    const k = baseKey + pat;
    if (!db[k]) continue;
    Object.assign(db[k], updates[pat], { updated_at: new Date().toISOString() });
  }

  // 乾為天 九二
  const baseKey2 = '乾為天 九二 | ';
  const updates2 = {
    JJJ: {
      chain_long:
        'まず、認められ始めた力を急がず深めます。導き手に学び、型の裏側にある筋道を体で覚えます。' +
        '続いて、同じ型をもう一段磨きます。公の場でのふるまいに無理がなくなり、声は自然と届くようになります。' +
        '最後に、静かな自信が芯を支え、次に託す準備が整います。' +
        '突破口は、学びの反復にあります。まずは基本の所作を揃え、節度と礼を崩さずに歩を進めましょう。',
      suitability: '師や協力者から学びつつ発信力を高めたい場面',
      caution: '承認欲求に流されず、公明正大な態度を保つ'
    },
    JJH: {
      chain_long:
        'まず、教えを受け取り、足場を固めます。問いの立て方が洗練され、やるべきことが絞られます。' +
        '続いて、もう一段深めます。場数が増え、声の響き方が変わります。' +
        '最後に、視点を切り替えます。自分が前に出る形から、役割や仕組みへと重心を移すと、輪郭がより澄みます。' +
        '突破口は、深めた後の役割移行にあります。まずは任せ方と基準を共有し、透明に運用していきましょう。',
      suitability: '実務の型を固めたのち、仕組み化へ移行したい場面',
      caution: '人に任せる前に、評価軸と例外対応を明確にする'
    },
    JHJ: {
      chain_long:
        'まず、基礎を磨きます。小さな成功体験が積み重なり、迷いが減っていきます。' +
        '次に、観点を切り替えます。自分の手元から、場全体と関係の流れへとピントをずらします。' +
        '最後に、その視点で再び深めます。関係が整うほど、声は遠くまで届き、仕事は軽くつながります。' +
        '突破口は、視点の切替後の定着にあります。まずは関係者の合図を揃え、短いサイクルで改善を回しましょう。',
      suitability: '周囲を巻き込みつつ自分の型を場の型へ昇華したい場面',
      caution: '視点切替直後は負荷が増すため、段階と期待値を合わせる'
    },
    JHH: {
      chain_long:
        'まず、積み上げを重ねます。場の呼吸がわかるほどに、余計な力が抜けていきます。' +
        '続いて、連続して観点を切り替えます。自身の成功パターンを、関係と仕組みへ移していきます。' +
        '最後に、もう一度切り替えます。前に出る強さから、支える強さへ。流れが整い、滞りが減ります。' +
        '突破口は、二度の軽い転換にあります。まずは役割分担と言葉の定義を揃え、誤解を減らして進めましょう。',
      suitability: '個人の力をチームの仕組みに移し替えたい場面',
      caution: '切替疲れを避けるため、段取りを小さく刻む'
    },
    HJJ: {
      chain_long:
        'まず、観点を切り替えます。自分の成果から、場の成功へと光を当て直します。' +
        '続いて、深めます。場に合った言葉と速度を選ぶほど、摩擦は減っていきます。' +
        '最後に、もう一段深めます。任せ方が整い、関係は軽く強くつながります。' +
        '突破口は、はじめの見直しにあります。まずは目的・基準・権限を一枚絵にして共有しましょう。',
      suitability: '個人ドライブから組織ドライブへ移行したい場面',
      caution: '目的と権限の曖昧さが摩擦の原因になるため、先に可視化する'
    },
    HJH: {
      chain_long:
        'まず、視点を切り替えます。評価の軸を変え、関係が動く余白をつくります。' +
        '次に、その視点で深めます。期待と現実の差が小さくなるほど、動きはなめらかになります。' +
        '最後に、もう一度視点を切り替えます。固まらない柔らかさが、次の成長余地を広げます。' +
        '突破口は、定期的な見直しにあります。まずは合意形成の段取りを軽く早くし、試して学ぶ回数を増やしましょう。',
      suitability: '探索と定着を往復しながら運用精度を上げたい場面',
      caution: '見直しの頻度と判断の基準を先に合意しておく'
    },
    HHJ: {
      chain_long:
        'まず、視点を替えます。次に、もう一度替えます。二度の切替で、勝ち筋の形が変わります。' +
        '最後に、深めます。新しい型を反復し、場の手触りに馴染ませていきます。' +
        '突破口は、初動の二手にあります。まずは守るべき線を決め、変える部分を明確にしてから動きましょう。',
      suitability: 'やり方そのものを更新しつつ、早く新常態に馴染ませたい場面',
      caution: '守る線と変える線が曖昧だと混乱するため、先に線引きする'
    },
    HHH: {
      chain_long:
        'まず、視点を替えます。続いて、もう一度。最後に、さらにもう一度。三度の切替で、働き方の地図が書き換わります。' +
        '人が主役から、関係と仕組みが主役へ。場が回り出すと、個の力は無理なく活きます。' +
        '突破口は、再構成の設計にあります。まずは役割・リズム・可視化の三点を整え、循環を起こしましょう。',
      suitability: '抜本的な運用転換を伴う再構築',
      caution: '影響範囲が広いため、移行の道筋と支援線を先に作図する'
    }
  };

  for (const pat of Object.keys(updates2)) {
    const k = baseKey2 + pat;
    if (!db[k]) continue;
    Object.assign(db[k], updates2[pat], { updated_at: new Date().toISOString() });
  }

  saveJSON(file, db);
  console.log('Authored chains for 乾為天 初九 / 九二 (各8 patterns).');
}

if (require.main === module) main();
