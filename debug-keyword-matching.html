<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°è©³ç´°ãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body { 
            font-family: monospace; 
            padding: 20px; 
            background: #1a1a1a; 
            color: #fff; 
            line-height: 1.6;
        }
        .debug-result { 
            margin: 15px 0; 
            padding: 15px; 
            border: 1px solid #444; 
            border-radius: 8px; 
            background: rgba(0,0,0,0.3);
        }
        .pattern-header { 
            font-weight: bold; 
            color: #22d3ee; 
            margin-bottom: 10px; 
        }
        .keyword-analysis {
            background: rgba(59, 130, 246, 0.1);
            padding: 10px;
            margin: 8px 0;
            border-radius: 4px;
        }
        .conflict-detected { 
            color: #10b981; 
            font-weight: bold; 
        }
        .no-conflict { 
            color: #6b7280; 
        }
        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°è©³ç´°ãƒ‡ãƒãƒƒã‚°</h1>
    <p>ãªãœãƒ‘ã‚¿ãƒ¼ãƒ³27ã ã‘ãŒç‰¹æ®Šè¡¨ç¾ã«ãªã‚Šã€ä»–ãŒgenericã«ãªã‚‹ã‹ã‚’èª¿æŸ»</p>
    
    <button onclick="runKeywordDebug()">ğŸ¯ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°è©³ç´°åˆ†æ</button>
    
    <div id="results"></div>

    <script src="./public/assets/H384H64database.js"></script>
    <script src="./public/js/core/TripleOSInteractionAnalyzer.js"></script>
    <script>
        function runKeywordDebug() {
            const results = document.getElementById('results');
            results.innerHTML = '<div>ğŸ”„ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°åˆ†æä¸­...</div>';
            
            try {
                const analyzer = new TripleOSInteractionAnalyzer();
                
                // å›ºå®šãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ30ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‹ã‚‰ç‰¹ã«æ³¨ç›®ã™ã¹ãã‚‚ã®
                const testPatterns = [
                    [51, 59, 53],  // Pattern 1
                    [56, 9, 59],   // Pattern 2  
                    [45, 62, 53],  // Pattern 28 (ã“ã‚ŒãŒPattern 27ãªã®ã‹ï¼Ÿ)
                    [14, 11, 37],  // Pattern 29
                    [48, 14, 9]    // Pattern 30
                ];
                
                let html = '<h2>ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°è©³ç´°åˆ†æ</h2>';
                
                testPatterns.forEach(([e, iface, s], index) => {
                    try {
                        const engineOS = { hexagramId: e, name: `ç¬¬${e}å¦`, score: 0.5 };
                        const interfaceOS = { hexagramId: iface, name: `ç¬¬${iface}å¦`, score: 0.5 };
                        const safeModeOS = { hexagramId: s, name: `ç¬¬${s}å¦`, score: 0.5 };
                        
                        // å¦ã®ç‰¹å¾´å–å¾—
                        const char1 = analyzer.getHexagramCharacteristics(e);
                        const char2 = analyzer.getHexagramCharacteristics(iface);
                        const char3 = analyzer.getHexagramCharacteristics(s);
                        
                        // Engine-Interfaceé–“ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰çµ„ã¿åˆã‚ã›åˆ†æ
                        const eiCombinations = analyzer.analyzeKeywordCombination(char1, char2);
                        const esCombinations = analyzer.analyzeKeywordCombination(char1, char3);
                        const isCombinations = analyzer.analyzeKeywordCombination(char2, char3);
                        
                        // å®Ÿéš›ã®ãƒšã‚¢åˆ†æçµæœ
                        const eiAnalysis = analyzer.analyzePair('engine-interface', engineOS, interfaceOS);
                        const esAnalysis = analyzer.analyzePair('engine-safe', engineOS, safeModeOS);
                        const isAnalysis = analyzer.analyzePair('interface-safe', interfaceOS, safeModeOS);
                        
                        html += `
                            <div class="debug-result">
                                <div class="pattern-header">
                                    ãƒ‘ã‚¿ãƒ¼ãƒ³ ${index + 1}: Engine(${e}: ${char1.name}) Ã— Interface(${iface}: ${char2.name}) Ã— Safe(${s}: ${char3.name})
                                </div>
                                
                                <div class="keyword-analysis">
                                    <h4>å¦ã®ç‰¹å¾´ãƒ‡ãƒ¼ã‚¿:</h4>
                                    <p><strong>Engine(${e}):</strong> ${char1.keywords?.join(', ') || 'æœªå®šç¾©'}</p>
                                    <p><strong>Interface(${iface}):</strong> ${char2.keywords?.join(', ') || 'æœªå®šç¾©'}</p>
                                    <p><strong>SafeMode(${s}):</strong> ${char3.keywords?.join(', ') || 'æœªå®šç¾©'}</p>
                                </div>
                                
                                <div class="keyword-analysis">
                                    <h4>Engine-Interface ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¡çªæ¤œå‡º:</h4>
                                    <p>Speed conflict: <span class="${eiCombinations.speedConflict ? 'conflict-detected' : 'no-conflict'}">${eiCombinations.speedConflict}</span></p>
                                    <p>Value conflict: <span class="${eiCombinations.valueConflict ? 'conflict-detected' : 'no-conflict'}">${eiCombinations.valueConflict}</span></p>
                                    <p>Time conflict: <span class="${eiCombinations.timeConflict ? 'conflict-detected' : 'no-conflict'}">${eiCombinations.timeConflict}</span></p>
                                    <p>Direction conflict: <span class="${eiCombinations.directionConflict ? 'conflict-detected' : 'no-conflict'}">${eiCombinations.directionConflict}</span></p>
                                    <p><strong>å®Ÿéš›ã®è¡¨ç¾:</strong> ã€Œ${eiAnalysis.summary}ã€</p>
                                </div>
                                
                                <div class="keyword-analysis">
                                    <h4>Engine-Safe ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¡çªæ¤œå‡º:</h4>
                                    <p>Speed conflict: <span class="${esCombinations.speedConflict ? 'conflict-detected' : 'no-conflict'}">${esCombinations.speedConflict}</span></p>
                                    <p>Value conflict: <span class="${esCombinations.valueConflict ? 'conflict-detected' : 'no-conflict'}">${esCombinations.valueConflict}</span></p>
                                    <p>Time conflict: <span class="${esCombinations.timeConflict ? 'conflict-detected' : 'no-conflict'}">${esCombinations.timeConflict}</span></p>
                                    <p>Direction conflict: <span class="${esCombinations.directionConflict ? 'conflict-detected' : 'no-conflict'}">${esCombinations.directionConflict}</span></p>
                                    <p><strong>å®Ÿéš›ã®è¡¨ç¾:</strong> ã€Œ${esAnalysis.summary}ã€</p>
                                </div>
                                
                                <div class="keyword-analysis">
                                    <h4>Interface-Safe ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¡çªæ¤œå‡º:</h4>
                                    <p>Speed conflict: <span class="${isCombinations.speedConflict ? 'conflict-detected' : 'no-conflict'}">${isCombinations.speedConflict}</span></p>
                                    <p>Value conflict: <span class="${isCombinations.valueConflict ? 'conflict-detected' : 'no-conflict'}">${isCombinations.valueConflict}</span></p>
                                    <p>Time conflict: <span class="${isCombinations.timeConflict ? 'conflict-detected' : 'no-conflict'}">${isCombinations.timeConflict}</span></p>
                                    <p>Direction conflict: <span class="${isCombinations.directionConflict ? 'conflict-detected' : 'no-conflict'}">${isCombinations.directionConflict}</span></p>
                                    <p><strong>å®Ÿéš›ã®è¡¨ç¾:</strong> ã€Œ${isAnalysis.summary}ã€</p>
                                </div>
                            </div>
                        `;
                        
                    } catch (error) {
                        html += `
                            <div class="debug-result">
                                <div class="pattern-header">
                                    ãƒ‘ã‚¿ãƒ¼ãƒ³ ${index + 1}: Engine(${e}) Ã— Interface(${iface}) Ã— SafeMode(${s})
                                </div>
                                <div style="color: #ef4444;">
                                    âŒ åˆ†æã‚¨ãƒ©ãƒ¼: ${error.message}
                                </div>
                            </div>
                        `;
                    }
                });
                
                results.innerHTML = html;
                
            } catch (error) {
                results.innerHTML = `
                    <div style="color: #ef4444; padding: 20px;">
                        âŒ ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼: ${error.message}
                    </div>
                `;
                console.error('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æã‚¨ãƒ©ãƒ¼:', error);
            }
        }
    </script>
</body>
</html>