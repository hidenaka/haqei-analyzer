<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H384_DATAçµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: 'Courier New', monospace; padding: 20px; background: #1a1a1a; color: #00ff41; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background: rgba(0, 255, 65, 0.1); border: 1px solid #00ff41; }
        .fail { background: rgba(255, 0, 0, 0.1); border: 1px solid #ff0000; color: #ff4444; }
        .info { background: rgba(255, 255, 0, 0.1); border: 1px solid #ffff00; color: #ffff44; }
        pre { background: rgba(0,0,0,0.3); padding: 10px; border-radius: 3px; font-size: 12px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª H384_DATAçµ±åˆå•é¡Œ TDDãƒ†ã‚¹ãƒˆ</h1>
    <div id="test-results"></div>

    <!-- H384ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ -->
    <script src="./assets/H384H64database.js"></script>
    
    <script>
        /**
         * TDDãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ: H384_DATAçµ±åˆä¿®æ­£å¾Œæ¤œè¨¼
         * 
         * ç›®çš„ï¼š
         * - ä¿®æ­£å¾Œã®å‹•ä½œã‚’åŒ…æ‹¬çš„ã«æ¤œè¨¼
         * - çµ±è¨ˆçš„å“è³ªä¿è¨¼ã®ç¢ºèª
         * - Future Simulatoräº’æ›æ€§ã®ç¢ºèª
         */
        class H384DataIntegrationTest {
            constructor() {
                this.results = [];
                this.runTests();
            }

            /**
             * ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: ä¿®æ­£å¾Œæ¤œè¨¼ï¼ˆGREENæ®µéšï¼‰
             */
            runTests() {
                console.log('ğŸŸ¢ GREENæ®µéš: ä¿®æ­£å¾Œã®å®Œå…¨æ€§æ¤œè¨¼');
                
                this.testH384DataExists();
                this.testWindowH384DataAccess();
                this.testDataIntegrity();
                this.testYoukuuYourikuuEntries();
                this.testLoadH384DataCompatibility();
                this.testAutoValidationFunction();
                this.testTripleOSCompatibility();
                
                this.displayResults();
            }

            /**
             * ãƒ†ã‚¹ãƒˆ1: H384_DATAå¤‰æ•°ã®å­˜åœ¨ç¢ºèª
             */
            testH384DataExists() {
                const testName = 'H384_DATAå¤‰æ•°å­˜åœ¨ç¢ºèª';
                try {
                    const exists = typeof H384_DATA !== 'undefined';
                    this.addResult(testName, exists, 
                        exists ? 'H384_DATAå¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™' : 'H384_DATAå¤‰æ•°ãŒæœªå®šç¾©ã§ã™');
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ2: window.H384_DATAã‚¢ã‚¯ã‚»ã‚¹ç¢ºèªï¼ˆã“ã‚ŒãŒç¾åœ¨ã®å•é¡Œï¼‰
             */
            testWindowH384DataAccess() {
                const testName = 'window.H384_DATAã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª';
                try {
                    const windowAccess = typeof window.H384_DATA !== 'undefined';
                    this.addResult(testName, windowAccess, 
                        windowAccess 
                            ? 'window.H384_DATAã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™' 
                            : 'âŒ window.H384_DATAãŒæœªå®šç¾©ã§ã™ï¼ˆã“ã‚ŒãŒç¾åœ¨ã®å•é¡Œï¼‰');
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ3: ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ€§ç¢ºèªï¼ˆ386çˆ»ï¼‰
             */
            testDataIntegrity() {
                const testName = 'ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ€§ç¢ºèªï¼ˆ386çˆ»ï¼‰';
                try {
                    if (typeof H384_DATA !== 'undefined' && Array.isArray(H384_DATA)) {
                        const length = H384_DATA.length;
                        const isValid = length === 386;
                        this.addResult(testName, isValid, 
                            `ãƒ‡ãƒ¼ã‚¿é•·: ${length}/386 ${isValid ? 'âœ…' : 'âŒ'}`);
                    } else {
                        this.addResult(testName, false, 'H384_DATAãŒé…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“');
                    }
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ4: ç”¨ä¹ãƒ»ç”¨å…­ã‚¨ãƒ³ãƒˆãƒªç¢ºèª
             */
            testYoukuuYourikuuEntries() {
                const testName = 'ç”¨ä¹ãƒ»ç”¨å…­ã‚¨ãƒ³ãƒˆãƒªç¢ºèª';
                try {
                    if (typeof H384_DATA !== 'undefined' && Array.isArray(H384_DATA)) {
                        const youkuu = H384_DATA.find(item => item['é€šã—ç•ªå·'] === 7); // ç”¨ä¹
                        const yourikuu = H384_DATA.find(item => item['é€šã—ç•ªå·'] === 14); // ç”¨å…­
                        
                        const hasYoukuu = youkuu && youkuu['çˆ»'] === 'ç”¨ä¹';
                        const hasYourikuu = yourikuu && yourikuu['çˆ»'] === 'ç”¨å…­';
                        
                        this.addResult(testName, hasYoukuu && hasYourikuu, 
                            `ç”¨ä¹: ${hasYoukuu ? 'âœ…' : 'âŒ'}, ç”¨å…­: ${hasYourikuu ? 'âœ…' : 'âŒ'}`);
                    } else {
                        this.addResult(testName, false, 'H384_DATAãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
                    }
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ5: LoadH384Dataäº’æ›æ€§ç¢ºèª
             */
            testLoadH384DataCompatibility() {
                const testName = 'LoadH384Dataäº’æ›æ€§ç¢ºèª';
                try {
                    // LoadH384Data.jsã§ã®ãƒã‚§ãƒƒã‚¯ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    const localCompatible = typeof H384_DATA !== 'undefined';
                    const windowCompatible = typeof window.H384_DATA !== 'undefined';
                    const isCompatible = localCompatible && windowCompatible;
                    
                    this.addResult(testName, isCompatible, 
                        `ãƒ­ãƒ¼ã‚«ãƒ«: ${localCompatible ? 'âœ…' : 'âŒ'}, ã‚°ãƒ­ãƒ¼ãƒãƒ«: ${windowCompatible ? 'âœ…' : 'âŒ'}`);
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ6: è‡ªå‹•æ¤œè¨¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
             */
            testAutoValidationFunction() {
                const testName = 'è‡ªå‹•æ¤œè¨¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ';
                try {
                    const hasValidationFunction = typeof validateH384DataIntegrity === 'function';
                    if (hasValidationFunction) {
                        const validationResult = validateH384DataIntegrity();
                        const allTestsPassed = validationResult.passed;
                        
                        this.addResult(testName, allTestsPassed, 
                            allTestsPassed 
                                ? 'âœ… è‡ªå‹•æ¤œè¨¼æ©Ÿèƒ½ãŒæ­£å¸¸å‹•ä½œã—ã€å…¨ãƒ†ã‚¹ãƒˆåˆæ ¼' 
                                : `âš ï¸ è‡ªå‹•æ¤œè¨¼ã§å•é¡Œæ¤œå‡º: ${JSON.stringify(validationResult.tests)}`);
                    } else {
                        this.addResult(testName, false, 'âŒ validateH384DataIntegrityé–¢æ•°ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆ7: Triple OSäº’æ›æ€§ç¢ºèª
             */
            testTripleOSCompatibility() {
                const testName = 'Triple OSäº’æ›æ€§ç¢ºèª';
                try {
                    if (typeof window.H384_DATA !== 'undefined' && Array.isArray(window.H384_DATA)) {
                        // Triple OSã‚¹ã‚³ã‚¢ã®å­˜åœ¨ç¢ºèª
                        const sampleEntry = window.H384_DATA[0];
                        const hasEngineScore = 'S1_åŸºæœ¬ã‚¹ã‚³ã‚¢' in sampleEntry;
                        const hasInterfaceScore = 'S5_ä¸»ä½“æ€§æ¨å¥¨ã‚¹ã‚¿ãƒ³ã‚¹' in sampleEntry;
                        const hasSafeModeScore = 'S3_å®‰å®šæ€§ã‚¹ã‚³ã‚¢' in sampleEntry;
                        
                        const isTripleOSCompatible = hasEngineScore && hasInterfaceScore && hasSafeModeScore;
                        
                        this.addResult(testName, isTripleOSCompatible, 
                            `Engine OS: ${hasEngineScore ? 'âœ…' : 'âŒ'}, Interface OS: ${hasInterfaceScore ? 'âœ…' : 'âŒ'}, Safe Mode OS: ${hasSafeModeScore ? 'âœ…' : 'âŒ'}`);
                    } else {
                        this.addResult(testName, false, 'window.H384_DATAãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
                    }
                } catch (error) {
                    this.addResult(testName, false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }

            /**
             * ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²
             */
            addResult(testName, passed, message) {
                this.results.push({
                    name: testName,
                    passed,
                    message,
                    timestamp: new Date().toISOString()
                });
            }

            /**
             * ãƒ†ã‚¹ãƒˆçµæœã‚’è¡¨ç¤º
             */
            displayResults() {
                const container = document.getElementById('test-results');
                const passedTests = this.results.filter(r => r.passed).length;
                const totalTests = this.results.length;
                
                container.innerHTML = `
                    <div class="test-result info">
                        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼</h2>
                        <p>åˆæ ¼: ${passedTests}/${totalTests} (${Math.round(passedTests/totalTests*100)}%)</p>
                        <p>å®Ÿè¡Œæ™‚åˆ»: ${new Date().toLocaleString('ja-JP')}</p>
                    </div>
                `;

                this.results.forEach(result => {
                    const div = document.createElement('div');
                    div.className = `test-result ${result.passed ? 'pass' : 'fail'}`;
                    div.innerHTML = `
                        <h3>${result.passed ? 'âœ…' : 'âŒ'} ${result.name}</h3>
                        <p>${result.message}</p>
                        <small>å®Ÿè¡Œæ™‚åˆ»: ${new Date(result.timestamp).toLocaleString('ja-JP')}</small>
                    `;
                    container.appendChild(div);
                });

                // ç¾åœ¨ã®çŠ¶æ…‹ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚‚å‡ºåŠ›
                console.log('ğŸ” ç¾åœ¨ã®H384_DATAçŠ¶æ…‹:');
                console.log('typeof H384_DATA:', typeof H384_DATA);
                console.log('typeof window.H384_DATA:', typeof window.H384_DATA);
                console.log('H384_DATA length:', typeof H384_DATA !== 'undefined' ? H384_DATA?.length : 'undefined');
                
                if (typeof H384_DATA !== 'undefined') {
                    console.log('Sample entry:', H384_DATA[0]);
                }
            }
        }

        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', () => {
            new H384DataIntegrationTest();
        });
    </script>
</body>
</html>