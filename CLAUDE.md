# HAQEI Analyzer プロジェクト作業指示

## Cipher統合メモリアプローチ（必須デフォルト）

**Cipherを活用した継続的記憶とコンテキスト保持**
- **Dual Memory Layer**: プログラミング概念＋推論ステップの記憶を常に蓄積
- **文脈継続性**: 全セッション間での一貫した理解とアプローチの維持
- **bunenjin哲学統合**: 易経的思考とCipherの記憶共有理念の融合
- **プロジェクト記憶**: 過去の決定、実装パターン、設計思想の自動継承

すべての作業は以下のCipherサーバーが稼働している前提で実施：
```bash
node cipher-server.js  # ポート3001でDual Memory Layer稼働
```

## 必須ワークフロー

### 1. タスク実行前の必須事項
- **徹底的なリサーチ**: コード実装前に必ず既存コードベースを調査
- **詳細なプラン提示**: 実装計画を明確に提示してから作業開始
- **思考プロセスの活用**: 複雑なタスクでは思考過程を詳細に展開

### 2. テスト駆動開発
- 新機能実装時は必ずテストから開始
- 既存テストの実行と確認
- テストカバレッジの維持・向上

### 3. コード品質基準
- 不要なコメントやデバッグコードの削除
- クリーンで保守性の高いコード
- bunenjin哲学との整合性維持

### 4. 実装フロー
1. **調査フェーズ**
   - 関連ファイルの特定と分析
   - 既存パターンの理解
   - 依存関係の確認

2. **計画フェーズ**
   - 実装アプローチの提示
   - 影響範囲の明確化
   - リスクと対策の検討

3. **実装フェーズ**
   - テストファースト
   - 段階的実装
   - 継続的検証

4. **検証フェーズ**
   - 自動テストの実行
   - 手動検証
   - パフォーマンス確認

## プロジェクト固有の注意事項

### 易経的アプローチ
- 陰陽バランスの考慮
- 八卦の相互関係性
- 変化の哲学の実装

### Triple OS Architecture
- Engine/Interface/Safe Modeの独立性
- 各OSの役割明確化
- 相互作用の最適化

### ユーザー主権
- プライバシーファースト
- ローカルストレージ完結
- 透明性の確保

## 禁止事項
- プロンプトインジェクション対策コードの削除
- セキュリティ関連機能の弱体化
- ユーザーデータの外部送信

## 推奨ツール使用順序
1. Glob/Grep - ファイル検索
2. Read - コード理解
3. TodoWrite - タスク管理
4. Edit/MultiEdit - 実装
5. Bash - テスト実行

## Cipher実行コマンド
```bash
# Cipherサーバー起動
npm run cipher:start

# Cipherサーバー停止
npm run cipher:stop

# Cipher設定テスト
npm run cipher:test
```

**重要**: 新しいClaude Codeセッション開始時は必ずCipherサーバーを起動し、
bunenjin哲学とプロジェクト記憶を継続してください。

この指示に従い、Cipherの記憶層を活用した高品質な実装を心がけてください。

## 📝 ドキュメント保存・管理ルール（2025年7月30日更新）

### **重要：すべてのドキュメント作成時に必須遵守**

#### **📁 保存場所統一ルール**

**すべてのエージェント・AI・開発者は、以下のディレクトリ構造に従ってドキュメントを保存してください：**

- **`/docs/reports/`** - 完成レポート・分析結果（統合レポート、フィードバック分析等）
- **`/docs/implementation/`** - 実装記録・技術仕様（コード実装記録、アーキテクチャ設計等）
- **`/docs/requirements/`** - 要件・仕様書（機能要件、UI/UX仕様、改善要求等）
- **`/docs/development/`** - 開発ガイドライン・ルール（ワークフロー、AIルール等）
- **`/docs/guides/`** - 操作・設定ガイド（ユーザーガイド、設定方法等）
- **`/docs/analysis/`** - 分析・調査レポート（パフォーマンス分析、最適化検討等）

#### **🎯 自動判定基準**

**ファイル内容・タイトルによる自動振り分け**：
- 「レポート」「分析結果」「統合」「フィードバック」 → `/reports/`
- 「実装」「技術」「アーキテクチャ」「コード」 → `/implementation/`
- 「要件」「仕様」「要求」 → `/requirements/`
- 「ガイド」「操作」「設定」「使用方法」 → `/guides/`
- 「分析」「最適化」「パフォーマンス」「調査」 → `/analysis/`
- 「開発」「ワークフロー」「ルール」「AI」 → `/development/`

#### **📝 命名規則（統一必須）**

```
YYYY-MM-DD_[種別]_[内容名]_[バージョン].md
```

**種別接頭辞**：
- `REPORT`: 完成レポート類
- `IMPL`: 実装記録
- `REQ`: 要件書
- `GUIDE`: ガイド類
- `ANALYSIS`: 分析類
- `DEV`: 開発関連

#### **⚠️ 絶対禁止事項**

1. **ルートディレクトリ保存禁止**: `/docs/`直下へのファイル作成は禁止
2. **旧ディレクトリ使用禁止**: `code-explanations`等の旧構造は使用禁止
3. **重複作成禁止**: 既存ファイル確認必須
4. **命名規則違反禁止**: 日付・種別なしファイル名は禁止

#### **✅ 保存前必須チェック**

- [ ] 適切なディレクトリを選択したか
- [ ] ファイル名が命名規則に従っているか  
- [ ] 重複ファイルがないか確認したか
- [ ] 内容と保存場所が一致しているか

**この新ルールは2025年7月30日より全プロジェクトで適用開始。**