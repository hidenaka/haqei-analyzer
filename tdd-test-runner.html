<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAQEIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ TDD Test Runner - Tsumikiãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æº–æ‹ </title>
    <style>
        body {
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .status-card {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .test-controls {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            transition: transform 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .results-area {
            background: #f1f3f4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .tsumiki-badge {
            display: inline-block;
            background: #FF6B6B;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin: 5px;
        }
        
        .bunenjin-info {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #e17055;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª HAQEIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ TDD Test Runner</h1>
        <div class="tsumiki-badge">Tsumikiãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æº–æ‹ </div>
        <div class="tsumiki-badge">bunenjinå“²å­¦çµ±åˆ</div>
        <div class="tsumiki-badge">Triple OS Architecture</div>
        
        <div class="bunenjin-info">
            <h3>ğŸ”„ bunenjinæ€æƒ³ã«åŸºã¥ãTDD approach</h3>
            <p>ã“ã®ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã¯ã€HAQEIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ ¸å¿ƒã§ã‚ã‚‹bunenjinå“²å­¦ï¼ˆåˆ†äººæ€æƒ³ï¼‰ã«åŸºã¥ãã€è¤‡æ•°ã®ä»®æƒ³äººæ ¼ï¼ˆã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒï¼‰ã‚’çµ±åˆçš„ã«ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚æ˜“çµŒã®å¤‰åŒ–ã®å“²å­¦ã‚’åæ˜ ã—ãŸç¶™ç¶šçš„æ”¹å–„ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚</p>
        </div>
        
        <div class="status-card">
            <h3>ğŸ“‹ ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ </h3>
            <ul>
                <li><strong>ServerConfigurationDetector.js</strong> (539è¡Œ) - ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒè‡ªå‹•æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ </li>
                <li><strong>ä¸¦è¡Œé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ç®¡ç†</strong> - OS Analyzer (8001) + Future Simulator (8788)</li>
                <li><strong>Triple OS Architectureçµ±åˆ</strong> - Engine/Interface/Safe Mode OSé€£æº</li>
                <li><strong>bunenjinå“²å­¦é©åˆæ€§</strong> - æ˜“çµŒ64å¦ã‚·ã‚¹ãƒ†ãƒ ã¨ã®æ•´åˆæ€§</li>
            </ul>
        </div>
        
        <div class="test-controls">
            <button class="btn" onclick="loadDependencies()">ğŸ“¦ Load Dependencies</button>
            <button class="btn" onclick="runRedPhase()" id="redPhaseBtn" disabled>ğŸ”´ Run RED Phase</button>
            <button class="btn" onclick="showSystemInfo()">â„¹ï¸ System Info</button>
            <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ Clear Results</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <div id="status" class="status-card">
            <h3>ğŸ“Š Test Status</h3>
            <p>Ready to load dependencies and run TDD tests...</p>
        </div>
        
        <div id="results" class="results-area">
            <p>Test results will appear here...</p>
        </div>
    </div>

    <script>
        let testResults = null;
        let dependenciesLoaded = false;

        /**
         * ä¾å­˜é–¢ä¿‚ã®èª­ã¿è¾¼ã¿
         */
        async function loadDependencies() {
            updateStatus('Loading dependencies...', 'â³');
            updateProgress(10);

            try {
                // ServerConfigurationDetector.jsã®èª­ã¿è¾¼ã¿
                await loadScript('js/core/ServerConfigurationDetector.js');
                updateProgress(50);

                // TDDãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®èª­ã¿è¾¼ã¿
                await loadScript('test-server-configuration-detector.js');
                updateProgress(80);

                dependenciesLoaded = true;
                document.getElementById('redPhaseBtn').disabled = false;
                updateStatus('Dependencies loaded successfully! Ready to run RED phase.', 'âœ…');
                updateProgress(100);

                // 2ç§’å¾Œã«é€²è¡ŒçŠ¶æ³ã‚’ãƒªã‚»ãƒƒãƒˆ
                setTimeout(() => updateProgress(0), 2000);

            } catch (error) {
                updateStatus(`Failed to load dependencies: ${error.message}`, 'âŒ');
                logToResults(`Error loading dependencies: ${error.message}`);
                updateProgress(0);
            }
        }

        /**
         * ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‹•çš„èª­ã¿è¾¼ã¿ãƒ˜ãƒ«ãƒ‘ãƒ¼
         */
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = () => reject(new Error(`Failed to load ${src}`));
                document.head.appendChild(script);
            });
        }

        /**
         * RED Phaseå®Ÿè¡Œï¼ˆå¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‹ã‚‰é–‹å§‹ï¼‰
         */
        async function runRedPhase() {
            if (!dependenciesLoaded) {
                alert('Please load dependencies first!');
                return;
            }

            updateStatus('Running RED Phase - Tests are expected to fail initially...', 'ğŸ”´');
            logToResults('ğŸš€ Starting TDD RED Phase execution...\n');
            logToResults('========================================\n');

            try {
                updateProgress(20);
                
                // TDDãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ
                if (typeof window.runTDDTestSuite !== 'function') {
                    throw new Error('TDD Test Suite not loaded properly');
                }

                updateProgress(40);
                logToResults('Executing comprehensive TDD test suite...\n');

                // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                testResults = await window.runTDDTestSuite();
                updateProgress(80);

                // çµæœåˆ†æ
                logToResults('\nğŸ“Š RED Phase Results Analysis:\n');
                logToResults(`Total Tests: ${testResults.summary.total}\n`);
                logToResults(`Passed: ${testResults.summary.passed}\n`);
                logToResults(`Failed: ${testResults.summary.failed}\n`);
                logToResults(`Success Rate: ${testResults.summary.successRate}\n`);
                logToResults(`Tsumiki Compliant: ${testResults.tsumikiCompliant ? 'âœ…' : 'âŒ'}\n`);

                // bunenjinå“²å­¦çš„åˆ†æ
                logToResults('\nğŸ”„ bunenjin Philosophy Analysis:\n');
                if (testResults.tsumikiCompliant) {
                    logToResults('âœ¨ All virtual personalities (server environments) are harmoniously integrated!\n');
                    logToResults('The Triple OS Architecture maintains perfect balance.\n');
                    updateStatus('RED Phase Complete: All tests passed! Ready for GREEN phase.', 'âœ…');
                } else {
                    logToResults('âš¡ Some virtual personalities need alignment - this is expected in RED phase.\n');
                    logToResults('The system is ready for GREEN phase implementation to achieve harmony.\n');
                    updateStatus(`RED Phase Complete: ${testResults.summary.failed} tests failed as expected. Proceed to GREEN phase.`, 'ğŸŸ¡');
                }

                updateProgress(100);

                // æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹
                logToResults('\nğŸ¯ Next Steps (GREEN Phase):\n');
                logToResults('1. Implement missing functionality to make failing tests pass\n');
                logToResults('2. Ensure Triple OS Architecture integrity\n');
                logToResults('3. Validate bunenjin philosophy compliance\n');
                logToResults('4. Achieve 100% Tsumiki quality standards\n');

            } catch (error) {
                updateStatus(`RED Phase Failed: ${error.message}`, 'âŒ');
                logToResults(`\nâŒ RED Phase execution error: ${error.message}\n`);
                updateProgress(0);
            }
        }

        /**
         * ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤º
         */
        function showSystemInfo() {
            const info = {
                userAgent: navigator.userAgent,
                location: window.location.href,
                timestamp: new Date().toISOString(),
                screen: `${screen.width}x${screen.height}`,
                colorDepth: screen.colorDepth,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            };

            logToResults('\nğŸ–¥ï¸ System Information:\n');
            logToResults('=========================\n');
            Object.entries(info).forEach(([key, value]) => {
                logToResults(`${key}: ${value}\n`);
            });
            logToResults('\n');
        }

        /**
         * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
         */
        function updateStatus(message, icon = 'ğŸ“Š') {
            document.getElementById('status').innerHTML = `
                <h3>${icon} Test Status</h3>
                <p>${message}</p>
            `;
        }

        /**
         * é€²è¡ŒçŠ¶æ³æ›´æ–°
         */
        function updateProgress(percentage) {
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        /**
         * çµæœãƒ­ã‚°å‡ºåŠ›
         */
        function logToResults(message) {
            const resultsArea = document.getElementById('results');
            resultsArea.textContent += message;
            resultsArea.scrollTop = resultsArea.scrollHeight;
        }

        /**
         * çµæœã‚¯ãƒªã‚¢
         */
        function clearResults() {
            document.getElementById('results').textContent = 'Test results cleared...\n';
            updateProgress(0);
            updateStatus('Ready to run tests...', 'ğŸ“Š');
        }

        // åˆæœŸåŒ–
        console.log('ğŸš€ TDD Test Runner initialized');
        console.log('Load dependencies first, then run RED phase tests');
    </script>
</body>
</html>