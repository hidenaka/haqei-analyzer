<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ã‚ãªãŸã®ä¸­ã«ã‚ã‚‹3ã¤ã®äººæ ¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆEngine/Interface/Safe Mode OSï¼‰ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®æˆ¦ç•¥çš„åˆ†æãƒ„ãƒ¼ãƒ«ã€‚æ˜“çµŒã‚’ãƒ¡ã‚¿ãƒ•ã‚¡ãƒ¼ã¨ã—ãŸbunenjinå“²å­¦ã«åŸºã¥ãç¾ä»£çš„ãªè‡ªå·±ç†è§£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚">
    <title>HAQEI - Triple OSäººæ ¼åˆ†æã‚·ã‚¹ãƒ†ãƒ  | bunenjinå“²å­¦ã«ã‚ˆã‚‹æˆ¦ç•¥çš„è‡ªå·±ç†è§£ãƒ„ãƒ¼ãƒ«</title>
    
    <style>
        /* =================== */
        /* Critical CSS - 30KBä»¥ä¸‹ */
        /* bunenjinå“²å­¦æº–æ‹  */
        /* =================== */
        
        /* 1. ãƒªã‚»ãƒƒãƒˆ & åŸºç›¤ */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            /* HAQEI ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ */
            --primary-900: #0f172a;
            --primary-800: #1e293b;
            --primary-700: #334155;
            --primary-600: #475569;
            --primary-500: #64748b;
            --primary-400: #94a3b8;
            --primary-300: #cbd5e1;
            --primary-200: #e2e8f0;
            --primary-100: #f1f5f9;
            --primary-50: #f8fafc;
            
            --accent-500: #6366f1;
            --accent-400: #8b5cf6;
            --accent-300: #a855f7;
            
            /* ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚«ãƒ©ãƒ¼ */
            --success-500: #10b981;
            --warning-500: #f59e0b;
            --error-500: #ef4444;
            --info-500: #3b82f6;
            
            /* å…«å¦è‰²å½© */
            --trigram-qian: #FFD700;    /* ä¹¾(å¤©) */
            --trigram-dui: #87CEEB;     /* å…Œ(æ²¢) */
            --trigram-li: #FF4500;      /* é›¢(ç«) */
            --trigram-zhen: #8A2BE2;    /* éœ‡(é›·) */
            --trigram-xun: #32CD32;     /* å·½(é¢¨) */
            --trigram-kan: #1E90FF;     /* å(æ°´) */
            --trigram-gen: #708090;     /* è‰®(å±±) */
            --trigram-kun: #8B4513;     /* å¤(åœ°) */
            
            /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã‚µã‚¤ã‚º */
            --font-sm: clamp(0.875rem, 2.5vw, 1rem);
            --font-base: clamp(1rem, 3vw, 1.125rem);
            --font-lg: clamp(1.25rem, 4vw, 1.5rem);
            --font-xl: clamp(1.5rem, 5vw, 2rem);
            --font-2xl: clamp(2rem, 6vw, 3rem);
            
            --space-xs: clamp(0.5rem, 2vw, 0.75rem);
            --space-sm: clamp(0.75rem, 3vw, 1rem);
            --space-md: clamp(1rem, 4vw, 1.5rem);
            --space-lg: clamp(1.5rem, 5vw, 2rem);
            --space-xl: clamp(2rem, 6vw, 3rem);
            
            --radius-sm: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            
            /* ã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆ */
            --tap-size: max(44px, 2.75rem);
        }
        
        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--primary-800) 0%, var(--primary-700) 50%, var(--primary-600) 100%);
            color: var(--primary-100);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* 2. ã‚³ãƒ³ãƒ†ãƒŠã‚·ã‚¹ãƒ†ãƒ  */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-md);
        }
        
        .screen {
            min-height: 100vh;
            display: none;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: var(--space-lg) var(--space-md);
        }
        
        .screen.active {
            display: flex;
        }
        
        /* 2.1 ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .welcome-container {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--space-md);
        }
        
        .hero-section {
            text-align: center;
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out;
        }
        
        .hero-title {
            font-size: clamp(2rem, 8vw, 3.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-500), var(--accent-300), #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: var(--font-lg);
            color: var(--primary-200);
            margin-bottom: var(--space-lg);
            font-weight: 300;
        }
        
        .philosophy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .philosophy-card {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.4s ease;
            animation: fadeInUp 1s ease-out;
            animation-fill-mode: both;
        }
        
        .philosophy-card:nth-child(1) { animation-delay: 0.2s; }
        .philosophy-card:nth-child(2) { animation-delay: 0.4s; }
        .philosophy-card:nth-child(3) { animation-delay: 0.6s; }
        
        .philosophy-card:hover {
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-8px);
            box-shadow: 0 16px 48px rgba(99, 102, 241, 0.2);
        }
        
        .card-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: var(--space-md);
        }
        
        .engine-icon { background: linear-gradient(135deg, #6366f1, #8b5cf6); }
        .interface-icon { background: linear-gradient(135deg, #8b5cf6, #a855f7); }
        .safemode-icon { background: linear-gradient(135deg, #10b981, #059669); }
        
        .card-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .card-description {
            color: var(--primary-300);
            line-height: 1.6;
            font-size: var(--font-sm);
        }
        
        .about-section {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out 0.8s;
            animation-fill-mode: both;
        }
        
        .about-title {
            font-size: var(--font-xl);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
            text-align: center;
        }
        
        .about-content {
            color: var(--primary-200);
            line-height: 1.7;
            font-size: var(--font-base);
        }
        
        .highlight {
            color: var(--accent-400);
            font-weight: 600;
        }
        
        .experience-section {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            animation: fadeInUp 1s ease-out 1s;
            animation-fill-mode: both;
        }
        
        .experience-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
            text-align: center;
        }
        
        .experience-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            text-align: center;
        }
        
        .step {
            color: var(--primary-200);
            font-size: var(--font-sm);
        }
        
        .step-number {
            display: block;
            width: 2rem;
            height: 2rem;
            background: var(--accent-500);
            color: white;
            border-radius: 50%;
            line-height: 2rem;
            text-align: center;
            font-weight: 600;
            margin: 0 auto var(--space-xs);
        }
        
        .cta-section {
            text-align: center;
            animation: fadeInUp 1s ease-out 1.2s;
            animation-fill-mode: both;
        }
        
        .start-button {
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            color: white;
            border: none;
            padding: var(--space-md) var(--space-xl);
            font-size: var(--font-lg);
            font-weight: 600;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
            min-height: calc(var(--tap-size) + 0.5rem);
            position: relative;
            overflow: hidden;
        }
        
        .start-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }
        
        .start-button:hover::before {
            left: 100%;
        }
        
        .start-button:hover {
            background: linear-gradient(135deg, var(--accent-400), var(--accent-300));
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
        }
        
        .disclaimer {
            margin-top: var(--space-lg);
            padding: var(--space-md);
            background: rgba(15, 23, 42, 0.6);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent-500);
        }
        
        .disclaimer-text {
            color: var(--primary-400);
            font-size: var(--font-sm);
            line-height: 1.5;
            text-align: left;
        }
        
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .pulse-animation {
            animation: pulse 2s ease-in-out infinite;
        }
        
        /* 3. ã‚«ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ  */
        .card {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 600px;
            margin-bottom: var(--space-md);
        }
        
        .card:hover {
            border-color: rgba(99, 102, 241, 0.4);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        /* 4. ãƒœã‚¿ãƒ³ã‚·ã‚¹ãƒ†ãƒ  */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-sm) var(--space-lg);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-base);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: var(--tap-size);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--accent-400), var(--accent-300));
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }
        
        .btn-secondary {
            background: rgba(99, 102, 241, 0.1);
            color: var(--accent-400);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .btn-lg {
            padding: var(--space-md) var(--space-xl);
            font-size: var(--font-lg);
            min-height: calc(var(--tap-size) + 0.5rem);
        }
        
        /* 5. è³ªå•ã‚·ã‚¹ãƒ†ãƒ  */
        .question-card {
            margin-bottom: var(--space-xl);
        }
        
        .question-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }
        
        .question-number {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            background: var(--accent-500);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            line-height: 2rem;
            text-align: center;
            margin-bottom: var(--space-sm);
        }
        
        .question-text {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-md);
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .option {
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: var(--tap-size);
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
        }
        
        .option.selected {
            border-color: var(--accent-500);
            background: rgba(99, 102, 241, 0.2);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .option-text {
            font-size: var(--font-base);
            color: var(--primary-200);
            font-weight: 500;
        }
        
        /* 6. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            margin-top: var(--space-xl);
            flex-wrap: wrap;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: var(--space-lg);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-500), var(--accent-400));
            transition: width 0.5s ease;
            border-radius: 3px;
        }
        
        /* 7. çµæœè¡¨ç¤º */
        .result-header {
            text-align: center;
            margin-bottom: var(--space-xl);
        }
        
        .result-title {
            font-size: var(--font-2xl);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-500), var(--accent-400));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-sm);
        }
        
        .os-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .os-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .os-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .os-name {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--primary-100);
            margin-bottom: var(--space-sm);
        }
        
        .os-score {
            font-size: var(--font-xl);
            font-weight: 700;
            margin-bottom: var(--space-md);
        }
        
        .os-description {
            font-size: var(--font-sm);
            color: var(--primary-300);
            line-height: 1.5;
        }
        
        /* 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° */
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            color: #fca5a5;
            text-align: center;
            margin: var(--space-md) 0;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-lg);
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(99, 102, 241, 0.3);
            border-top: 3px solid var(--accent-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 9. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-sm);
            }
            
            .welcome-container {
                padding: var(--space-sm);
            }
            
            .screen {
                padding: var(--space-md) var(--space-sm);
            }
            
            .card {
                padding: var(--space-md);
            }
            
            .nav-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .os-cards {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }
            
            /* ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
            .hero-title {
                font-size: clamp(2.5rem, 10vw, 3rem);
                margin-bottom: var(--space-md);
            }
            
            .hero-subtitle {
                font-size: var(--font-base);
                margin-bottom: var(--space-md);
            }
            
            .philosophy-grid {
                grid-template-columns: 1fr;
                gap: var(--space-md);
                margin-bottom: var(--space-lg);
            }
            
            .philosophy-card {
                padding: var(--space-md);
            }
            
            .card-icon {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1.25rem;
                margin-bottom: var(--space-sm);
            }
            
            .about-section {
                padding: var(--space-lg);
                margin-bottom: var(--space-lg);
            }
            
            .experience-section {
                padding: var(--space-md);
                margin-bottom: var(--space-lg);
            }
            
            .experience-steps {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .step {
                display: flex;
                align-items: center;
                gap: var(--space-sm);
                text-align: left;
            }
            
            .step-number {
                flex-shrink: 0;
                margin: 0;
            }
            
            .start-button {
                width: 100%;
                padding: var(--space-lg) var(--space-md);
                font-size: var(--font-base);
            }
            
            .disclaimer {
                margin-top: var(--space-md);
            }
        }
        
        @media (max-width: 480px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .philosophy-card {
                padding: var(--space-sm);
            }
            
            .about-section {
                padding: var(--space-md);
            }
            
            .experience-section {
                padding: var(--space-sm);
            }
        }
        
        /* 10. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--accent-500);
            color: white;
            padding: 8px;
            z-index: 1000;
            text-decoration: none;
            border-radius: 4px;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç† */
        .btn:focus,
        .option:focus {
            outline: 2px solid var(--accent-400);
            outline-offset: 2px;
        }
        
        /* ãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å¯¾å¿œ */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        @media (prefers-contrast: high) {
            :root {
                --primary-100: #ffffff;
                --primary-200: #f0f0f0;
                --primary-300: #d0d0d0;
                --accent-500: #0066ff;
            }
            
            .btn, .option, .card {
                border-width: 2px;
            }
        }
        
        @media print {
            body {
                background: white !important;
                color: black !important;
            }
            
            .btn, .nav-controls {
                display: none !important;
            }
        }
    </style>
</head>

<body>
    <!-- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ -->
    <a href="#main-content" class="skip-link">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã‚¹ã‚­ãƒƒãƒ—</a>
    
    <!-- ãƒ©ã‚¤ãƒ–ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ -->
    <div id="announcements" class="sr-only" aria-live="polite" role="status"></div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main id="main-content">
        <!-- ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢ -->
        <section id="welcome-screen" class="screen active" aria-labelledby="welcome-title">
            <div class="welcome-container">
                <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="hero-section">
                    <h1 id="welcome-title" class="hero-title">HAQEI</h1>
                    <p class="hero-subtitle">
                        ã‚ãªãŸã®ä¸­ã«ã‚ã‚‹<span class="highlight">3ã¤ã®äººæ ¼ã‚·ã‚¹ãƒ†ãƒ </span>ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®æˆ¦ç•¥çš„åˆ†æãƒ„ãƒ¼ãƒ«
                    </p>
                </div>

                <!-- bunenjinå“²å­¦èª¬æ˜ -->
                <div class="philosophy-grid">
                    <div class="philosophy-card">
                        <div class="card-icon engine-icon">ğŸ¯</div>
                        <h3 class="card-title">Engine OS</h3>
                        <p class="card-description">
                            ã‚ãªãŸã®<strong>æœ¬å½“ã®ä¾¡å€¤è¦³</strong>ãŒå®¿ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€‚æ·±å±¤å¿ƒç†ã§å¤§åˆ‡ã«ã—ã¦ã„ã‚‹åˆ¤æ–­åŸºæº–ã‚„ã€äººç”Ÿã§æœ€ã‚‚é‡è¦–ã™ã‚‹æ–¹å‘æ€§ã‚’è¡¨ç¾ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€Œã‚ãªãŸã‚‰ã—ã•ã€ã®æ ¸ã¨ãªã‚‹éƒ¨åˆ†ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div class="philosophy-card">
                        <div class="card-icon interface-icon">ğŸ’¬</div>
                        <h3 class="card-title">Interface OS</h3>
                        <p class="card-description">
                            <strong>ç¤¾ä¼šçš„ãªå ´é¢</strong>ã§ç¾ã‚Œã‚‹ã‚ãªãŸã®å´é¢ã€‚ä»–è€…ã¨ã®é–¢ä¿‚æ€§ã‚„ã€ãƒãƒ¼ãƒ ã§ã®å½¹å‰²ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ãªã©ã€ã€Œäººã«è¦‹ã›ã‚‹è‡ªåˆ†ã€ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div class="philosophy-card">
                        <div class="card-icon safemode-icon">ğŸ›¡ï¸</div>
                        <h3 class="card-title">Safe Mode OS</h3>
                        <p class="card-description">
                            <strong>å›°é›£ãªçŠ¶æ³</strong>ã§ä½œå‹•ã™ã‚‹é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚ã‚¹ãƒˆãƒ¬ã‚¹ã‚„å±æ©Ÿçš„çŠ¶æ³ã«ãŠã„ã¦ã€ã‚ãªãŸãŒã©ã®ã‚ˆã†ãªå¯¾å‡¦ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é¸æŠã™ã‚‹å‚¾å‘ã«ã‚ã‚‹ã‹ã‚’åˆ†æã—ã¾ã™ã€‚
                        </p>
                    </div>
                </div>

                <!-- HAQEIã«ã¤ã„ã¦ -->
                <div class="about-section">
                    <h2 class="about-title">HAQEIã¨ã¯ï¼Ÿ</h2>
                    <div class="about-content">
                        <p style="margin-bottom: var(--space-md);">
                            HAQEIã¯<span class="highlight">å ã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“</span>ã€‚å¤ä»£ä¸­å›½ã®æ™ºæ…§ã§ã‚ã‚‹æ˜“çµŒï¼ˆI-Chingï¼‰ã‚’ãƒ¡ã‚¿ãƒ•ã‚¡ãƒ¼ã¨ã—ã¦æ´»ç”¨ã—ã€ç¾ä»£çš„ãªè‡ªå·±ç†è§£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã—ã¦å†æ§‹ç¯‰ã—ãŸ<span class="highlight">æˆ¦ç•¥çš„åˆ†æãƒ„ãƒ¼ãƒ«</span>ã§ã™ã€‚
                        </p>
                        <p style="margin-bottom: var(--space-md);">
                            ç§ãŸã¡ã¯ã€Œã‚ãªãŸã¯â—‹â—‹ãªäººã§ã™ã€ã¨ã¯æ±ºã—ã¦æ–­è¨€ã—ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€Œ<span class="highlight">â—‹â—‹ã¨ã„ã†å´é¢ãŒå‚è€ƒã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“</span>ã€ã¨ã„ã†å½¢ã§ã€ä¸€ã¤ã®è¦–ç‚¹ã¨ã—ã¦æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚
                        </p>
                        <p>
                            ã“ã®åˆ†æçµæœã¯ç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãã‚‚ã®ã§ã¯ãªãã€ã‚ãã¾ã§<span class="highlight">æ€è€ƒææ–™</span>ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ãŸã ãã‚‚ã®ã§ã™ã€‚æœ€çµ‚çš„ãªåˆ¤æ–­ã‚„æ±ºæ–­ã¯ã€å¸¸ã«ã‚ãªãŸè‡ªèº«ãŒè¡Œã£ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>

                <!-- ä½“é¨“ã®æµã‚Œ -->
                <div class="experience-section">
                    <h3 class="experience-title">ä½“é¨“ã®æµã‚Œï¼ˆç´„5åˆ†ï¼‰</h3>
                    <div class="experience-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <p>12å•ã®è³ªå•<br><small>ä¾¡å€¤è¦³ãƒ»è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³</small></p>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <p>3ã¤ã®OSåˆ†æ<br><small>64å¦ç†è«–ã«ã‚ˆã‚‹è§£æ</small></p>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <p>æˆ¦ç•¥çš„ãƒ’ãƒ³ãƒˆ<br><small>æ´»ç”¨ã®ãŸã‚ã®è¦–ç‚¹</small></p>
                        </div>
                    </div>
                </div>

                <!-- é–‹å§‹ãƒœã‚¿ãƒ³ -->
                <div class="cta-section">
                    <button id="start-btn" class="start-button pulse-animation">
                        âœ¨ Triple OS åˆ†æã‚’é–‹å§‹ã™ã‚‹
                    </button>
                    
                    <div class="disclaimer">
                        <p class="disclaimer-text">
                            <strong>é‡è¦ãªæ³¨æ„äº‹é …ï¼š</strong> ã“ã®åˆ†æã¯ã€ã‚ãªãŸã®äººæ ¼ã‚’æ±ºå®šã¥ã‘ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¸€ã¤ã®å‚è€ƒè¦–ç‚¹ã¨ã—ã¦ã€è‡ªå·±ç†è§£ã‚„æˆ¦ç•¥çš„æ€è€ƒã®ææ–™ã¨ã—ã¦ã”æ´»ç”¨ãã ã•ã„ã€‚åˆ†æçµæœã«ä¾å­˜ã™ã‚‹ã“ã¨ãªãã€å¸¸ã«ã”è‡ªèº«ã®åˆ¤æ–­ã‚’æœ€å„ªå…ˆã—ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- è³ªå•ç”»é¢ -->
        <section id="question-screen" class="screen" aria-labelledby="question-title">
            <div class="container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>
                
                <div class="card question-card">
                    <div class="question-header">
                        <span id="question-number" class="question-number">1</span>
                        <h2 id="question-title" class="question-text"></h2>
                    </div>
                    
                    <div id="options-container" class="options" role="radiogroup" aria-labelledby="question-title">
                        <!-- å‹•çš„ã«è³ªå•ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <div class="nav-controls">
                    <button id="prev-btn" class="btn btn-secondary" disabled>å‰ã®è³ªå•</button>
                    <button id="next-btn" class="btn btn-primary" disabled>æ¬¡ã®è³ªå•</button>
                </div>
            </div>
        </section>
        
        <!-- åˆ†æä¸­ç”»é¢ -->
        <section id="analysis-screen" class="screen" aria-labelledby="analysis-title">
            <div class="container">
                <div class="card">
                    <h2 id="analysis-title" class="result-title">åˆ†æä¸­...</h2>
                    <div class="loading">
                        <div class="spinner"></div>
                        <span>Triple OSã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ†æã—ã¦ã„ã¾ã™</span>
                    </div>
                    <p style="text-align: center; color: var(--primary-300); margin-top: var(--space-lg);">
                        bunenjinå“²å­¦ã«åŸºã¥ãTriple OSåˆ†æã‚’å®Ÿè¡Œä¸­ã§ã™<br>
                        <small>64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆ</small>
                    </p>
                </div>
            </div>
        </section>
        
        <!-- çµæœç”»é¢ -->
        <section id="results-screen" class="screen" aria-labelledby="results-title">
            <div class="container">
                <div class="result-header">
                    <h2 id="results-title" class="result-title">Triple OSåˆ†æçµæœ</h2>
                    <p style="color: var(--primary-200);">ã‚ãªãŸã®ä¸‰é‡äººæ ¼ã‚·ã‚¹ãƒ†ãƒ </p>
                </div>
                
                <div id="os-cards-container" class="os-cards">
                    <!-- å‹•çš„ã«çµæœãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                </div>
                
                <div class="card">
                    <h3 style="color: var(--primary-100); margin-bottom: var(--space-md);">åˆ†æçµæœã‚µãƒãƒªãƒ¼</h3>
                    <div id="result-summary" style="color: var(--primary-200);">
                        <!-- å‹•çš„ã«ã‚µãƒãƒªãƒ¼ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: var(--space-xl);">
                    <button id="restart-btn" class="btn btn-secondary">
                        ã‚‚ã†ä¸€åº¦åˆ†æã™ã‚‹
                    </button>
                </div>
            </div>
        </section>
        
        <!-- ã‚¨ãƒ©ãƒ¼ç”»é¢ -->
        <section id="error-screen" class="screen" aria-labelledby="error-title">
            <div class="container">
                <div class="card">
                    <h2 id="error-title" class="result-title" style="color: var(--error-500);">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h2>
                    <div id="error-message" class="error-message">
                        <!-- å‹•çš„ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                    <div style="text-align: center; margin-top: var(--space-lg);">
                        <button id="retry-btn" class="btn btn-primary">
                            å†è©¦è¡Œ
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ==========================================
        // HAQEI Emergency Analyzer - Vanilla JS
        // bunenjinå“²å­¦æº–æ‹ ã®ç·Šæ€¥ç°¡æ˜“åˆ†æã‚·ã‚¹ãƒ†ãƒ 
        // ==========================================
        
        'use strict';
        
        // 1. 30å•è³ªå•ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾¡å€¤è¦³24å•ï¼‹ã‚·ãƒŠãƒªã‚ª6å•ï¼‰
        const QUESTIONS = [
            // Q1-Q24: ä¾¡å€¤è¦³è¨­å•ï¼ˆEngine OSç‰¹å®šç”¨ï¼‰
            {
                id: "q1",
                text: "æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å–ã‚Šçµ„ã¿ã‚’å§‹ã‚ã‚‹ã¨ãã€ã‚ãªãŸãŒæœ€ã‚‚é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "èª°ã‚‚ã‚„ã£ãŸã“ã¨ã®ãªã„é©æ–°çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’è©¦ã™", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5, "è‰®_å®‰å®šæ€§": -1.0 } },
                    { value: "B", text: "æ—¢å­˜ã®æ–¹æ³•ã‚’æ”¹è‰¯ã—ã¦ã‚ˆã‚Šè‰¯ã„ã‚‚ã®ã«ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 1.5, "å_æ¢æ±‚æ€§": 1.5, "å·½_é©å¿œæ€§": 1.0 } },
                    { value: "C", text: "ã¿ã‚“ãªã§è©±ã—åˆã£ã¦æœ€é©ãªæ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -0.5 } },
                    { value: "D", text: "éå»ã®æˆåŠŸä¾‹ã‚’å‚è€ƒã«ã—ã¦ç¢ºå®Ÿã«é€²ã‚ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": -1.0 } },
                    { value: "E", text: "çŠ¶æ³ã«å¿œã˜ã¦æŸ”è»Ÿã«æ–¹æ³•ã‚’èª¿æ•´ã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.5, "å…Œ_èª¿å’Œæ€§": 1.0, "è‰®_å®‰å®šæ€§": -0.5 } }
                ]
            },
            {
                id: "q2",
                text: "ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæµ®ã‹ã‚“ã ã¨ãã€ã‚ãªãŸã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "ã™ãã«æ–°ã—ã„å½¢ã¨ã—ã¦å…·ç¾åŒ–ã—ã¦ã¿ãŸããªã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } },
                    { value: "B", text: "ã¾ãšè©³ã—ãèª¿ã¹ã¦ã‹ã‚‰å®Ÿè¡Œã«ç§»ã™", scoring: { "å_æ¢æ±‚æ€§": 2.5, "è‰®_å®‰å®šæ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": -1.0 } },
                    { value: "C", text: "å‘¨ã‚Šã®äººã¨ç›¸è«‡ã—ã¦æ„è¦‹ã‚’èã", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": 0.5 } },
                    { value: "D", text: "å®Ÿç¾å¯èƒ½æ€§ã‚’æ…é‡ã«æ¤œè¨ã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": -0.5 } },
                    { value: "E", text: "ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹è¨ˆã‚‰ã£ã¦æœ€é©ãªæ™‚ã«å®Ÿè¡Œã™ã‚‹", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": -0.5 } }
                ]
            },
            {
                id: "q3",
                text: "ã€Œå‰µé€ ã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¤ã„ã¦ã€ã‚ãªãŸã®è€ƒãˆã«æœ€ã‚‚è¿‘ã„ã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "ä½•ã‚‚ãªã„ã¨ã“ã‚ã‹ã‚‰å…¨ãæ–°ã—ã„ã‚‚ã®ã‚’ç”Ÿã¿å‡ºã™ã“ã¨", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5, "å¤_å—å®¹æ€§": -1.0 } },
                    { value: "B", text: "ã¿ã‚“ãªã§å”åŠ›ã—ã¦ç´ æ™´ã‚‰ã—ã„ã‚‚ã®ã‚’ä½œã‚Šä¸Šã’ã‚‹ã“ã¨", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "ä¹¾_å‰µé€ æ€§": 1.0 } },
                    { value: "C", text: "æ·±ãç ”ç©¶ã—ã¦æ–°ã—ã„ç™ºè¦‹ã‚’ã™ã‚‹ã“ã¨", scoring: { "å_æ¢æ±‚æ€§": 2.5, "ä¹¾_å‰µé€ æ€§": 1.5, "å…Œ_èª¿å’Œæ€§": -0.5 } },
                    { value: "D", text: "ç€å®Ÿã«ç©ã¿é‡ã­ã¦ä¾¡å€¤ã‚ã‚‹ã‚‚ã®ã‚’ç¯‰ãã“ã¨", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "ä¹¾_å‰µé€ æ€§": 0.5 } },
                    { value: "E", text: "çŠ¶æ³ã«åˆã‚ã›ã¦æœ€é©ãªè§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.0, "ä¹¾_å‰µé€ æ€§": 1.0 } }
                ]
            },
            {
                id: "q4",
                text: "ã‚„ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹ã¨ãã€ã‚ãªãŸã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "ã™ãã«è¡Œå‹•ã‚’èµ·ã“ã—ã¦å‹¢ã„ã§é€²ã‚ã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.0, "è‰®_å®‰å®šæ€§": -1.5 } },
                    { value: "B", text: "è¨ˆç”»ã‚’ç«‹ã¦ã¦ã‹ã‚‰ç€å®Ÿã«å®Ÿè¡Œã™ã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
                    { value: "C", text: "å‘¨ã‚Šã¨å”åŠ›ã—ã¦ãƒãƒ¼ãƒ ã§é€²ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": 1.0 } },
                    { value: "D", text: "çŠ¶æ³ã‚’è¦‹æ¥µã‚ã¦ã‹ã‚‰æœ€é©ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‹•ã", scoring: { "å·½_é©å¿œæ€§": 2.5, "å_æ¢æ±‚æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": 0.5 } },
                    { value: "E", text: "è‡ªåˆ†ã®æ„Ÿè¦šã‚’ä¿¡ã˜ã¦ç›´æ„Ÿçš„ã«é€²ã‚ã‚‹", scoring: { "é›¢_è¡¨ç¾æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 2.0, "è‰®_å®‰å®šæ€§": -1.0 } }
                ]
            },
            {
                id: "q5",
                text: "ã‚¹ãƒˆãƒ¬ã‚¹ã‚„å›°é›£ãªçŠ¶æ³ã«ç›´é¢ã—ãŸã¨ãã€ã‚ãªãŸã®ç¬¬ä¸€åå¿œã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "å³åº§ã«å•é¡Œè§£æ±ºã«å‘ã‘ã¦å‹•ãå‡ºã™", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.5, "å¤_å—å®¹æ€§": -1.0 } },
                    { value: "B", text: "å†·é™ã«çŠ¶æ³ã‚’åˆ†æã—ã¦åŸå› ã‚’æ¢ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -0.5 } },
                    { value: "C", text: "ä¿¡é ¼ã§ãã‚‹äººã«ç›¸è«‡ã—ã¦æ”¯ãˆã‚’æ±‚ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 0.0 } },
                    { value: "D", text: "è½ã¡ç€ã„ã¦çŠ¶æ³ãŒå¥½è»¢ã™ã‚‹ã®ã‚’å¾…ã¤", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å¤_å—å®¹æ€§": 1.5, "éœ‡_è¡Œå‹•æ€§": -1.5 } },
                    { value: "E", text: "æŸ”è»Ÿã«å¯¾å¿œã—ãªãŒã‚‰æœ€å–„ã®é“ã‚’æ¢ã‚‹", scoring: { "å·½_é©å¿œæ€§": 3.0, "å_æ¢æ±‚æ€§": 1.0, "éœ‡_è¡Œå‹•æ€§": 0.5 } }
                ]
            },
            // Q6-Q24: ä¾¡å€¤è¦³è³ªå•ç¶šã
            {
                id: "q6",
                text: "ã‚ãªãŸãŒæœ€ã‚‚å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ä¾¡å€¤è¦³ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "è‡ªç”±ã¨å‰µé€ æ€§", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 2.0 } },
                    { value: "B", text: "å®‰å®šã¨ä¿¡é ¼æ€§", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5 } },
                    { value: "C", text: "èª¿å’Œã¨å”åŠ›", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0 } },
                    { value: "D", text: "æ¢æ±‚ã¨æˆé•·", scoring: { "å_æ¢æ±‚æ€§": 3.0, "å·½_é©å¿œæ€§": 1.5 } },
                    { value: "E", text: "è¡Œå‹•ã¨å¤‰é©", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "ä¹¾_å‰µé€ æ€§": 1.5 } }
                ]
            },
            {
                id: "q7",
                text: "äººç”Ÿã®é‡è¦ãªæ±ºæ–­ã‚’ã™ã‚‹ã¨ãã€ã‚ãªãŸãŒæœ€ã‚‚é‡è¦–ã™ã‚‹ã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "ç›´æ„Ÿã¨æƒ…ç†±", scoring: { "é›¢_è¡¨ç¾æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0 } },
                    { value: "B", text: "è«–ç†çš„åˆ†æ", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5 } },
                    { value: "C", text: "å‘¨å›²ã¸ã®å½±éŸ¿", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0 } },
                    { value: "D", text: "å°†æ¥ã®å¯èƒ½æ€§", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0 } },
                    { value: "E", text: "å®‰å…¨æ€§ã¨ç¢ºå®Ÿæ€§", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5 } }
                ]
            },
            {
                id: "q8",
                text: "ãƒãƒ¼ãƒ ã§ã®å½¹å‰²ã¨ã—ã¦æœ€ã‚‚è‡ªç„¶ã«æ„Ÿã˜ã‚‹ã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "ãƒªãƒ¼ãƒ€ãƒ¼ã¨ã—ã¦æ–¹å‘æ€§ã‚’ç¤ºã™", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "éœ‡_è¡Œå‹•æ€§": 2.0 } },
                    { value: "B", text: "èª¿æ•´å½¹ã¨ã—ã¦æ„è¦‹ã‚’ã¾ã¨ã‚ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å·½_é©å¿œæ€§": 2.0 } },
                    { value: "C", text: "å°‚é–€å®¶ã¨ã—ã¦æ·±ãåˆ†æã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5 } },
                    { value: "D", text: "ã‚µãƒãƒ¼ãƒˆå½¹ã¨ã—ã¦å…¨ä½“ã‚’æ”¯ãˆã‚‹", scoring: { "å¤_å—å®¹æ€§": 3.0, "å…Œ_èª¿å’Œæ€§": 1.5 } },
                    { value: "E", text: "å®Ÿè¡Œå½¹ã¨ã—ã¦ç©æ¥µçš„ã«å‹•ã", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5 } }
                ]
            },
            {
                id: "q9",
                text: "ã‚¹ãƒˆãƒ¬ã‚¹è§£æ¶ˆæ³•ã¨ã—ã¦æœ€ã‚‚åŠ¹æœçš„ãªã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "éœ‡_è¡Œå‹•æ€§": 2.0 } },
                    { value: "B", text: "é™ã‹ã«ä¸€äººã§è€ƒãˆã‚‹", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 2.0 } },
                    { value: "C", text: "äººã¨è©±ã‚’ã™ã‚‹", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5 } },
                    { value: "D", text: "è‡ªç„¶ã®ä¸­ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹", scoring: { "å¤_å—å®¹æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0 } },
                    { value: "E", text: "ä½“ã‚’å‹•ã‹ã—ã¦ç™ºæ•£", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5 } }
                ]
            },
            {
                id: "q10",
                text: "ä»•äº‹ã§æœ€ã‚‚ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã‚‹ã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "é©æ–°çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å½¢ã«ã™ã‚‹ã“ã¨", scoring: { "ä¹¾_å‰µé€ æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 2.0 } },
                    { value: "B", text: "è¤‡é›‘ãªå•é¡Œã‚’è§£æ±ºã™ã‚‹ã“ã¨", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5 } },
                    { value: "C", text: "ãƒãƒ¼ãƒ ã®æˆåŠŸã«è²¢çŒ®ã™ã‚‹ã“ã¨", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "å¤_å—å®¹æ€§": 2.0 } },
                    { value: "D", text: "ç€å®Ÿã«æˆæœã‚’ç©ã¿ä¸Šã’ã‚‹ã“ã¨", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5 } },
                    { value: "E", text: "è¿…é€Ÿã«å®Ÿè¡Œã—ã¦çµæœã‚’å‡ºã™ã“ã¨", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "å·½_é©å¿œæ€§": 1.5 } }
                ]
            },
            // Q11-Q24 (ç°¡ç•¥ç‰ˆã€å®Ÿç”¨çš„ãªé•·ã•ã«èª¿æ•´)
            {
                id: "q11",
                text: "ç†æƒ³çš„ãªä¼‘æ—¥ã®éã”ã—æ–¹ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "æ–°ã—ã„å ´æ‰€ã‚’æ¢ç´¢ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.0, "éœ‡_è¡Œå‹•æ€§": 2.5 } },
                    { value: "B", text: "å®¶ã§ã‚†ã£ãã‚Šèª­æ›¸", scoring: { "è‰®_å®‰å®šæ€§": 2.5, "å_æ¢æ±‚æ€§": 2.0 } },
                    { value: "C", text: "å‹äººã‚„å®¶æ—ã¨éã”ã™", scoring: { "å…Œ_èª¿å’Œæ€§": 3.0, "å¤_å—å®¹æ€§": 2.0 } },
                    { value: "D", text: "è¶£å‘³ã«æ²¡é ­ã™ã‚‹", scoring: { "é›¢_è¡¨ç¾æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0 } },
                    { value: "E", text: "ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ä½“ã‚’å‹•ã‹ã™", scoring: { "éœ‡_è¡Œå‹•æ€§": 3.0, "é›¢_è¡¨ç¾æ€§": 1.5 } }
                ]
            },
            {
                id: "q12",
                text: "å­¦ç¿’ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã—ã¦æœ€ã‚‚åˆã£ã¦ã„ã‚‹ã®ã¯ï¼Ÿ",
                options: [
                    { value: "A", text: "å®Ÿè·µã—ãªãŒã‚‰è¦šãˆã‚‹", scoring: { "éœ‡_è¡Œå‹•æ€§": 2.5, "å·½_é©å¿œæ€§": 2.0 } },
                    { value: "B", text: "ç†è«–ã‚’æ·±ãç†è§£ã™ã‚‹", scoring: { "å_æ¢æ±‚æ€§": 3.0, "è‰®_å®‰å®šæ€§": 1.5 } },
                    { value: "C", text: "ä»–äººã¨è­°è«–ã—ã¦å­¦ã¶", scoring: { "å…Œ_èª¿å’Œæ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.0 } },
                    { value: "D", text: "ä½“ç³»çš„ã«é †åºç«‹ã¦ã¦å­¦ã¶", scoring: { "è‰®_å®‰å®šæ€§": 3.0, "å¤_å—å®¹æ€§": 1.5 } },
                    { value: "E", text: "ç›´æ„Ÿçš„ã«å…¨ä½“ã‚’æŠŠæ¡ã™ã‚‹", scoring: { "ä¹¾_å‰µé€ æ€§": 2.5, "é›¢_è¡¨ç¾æ€§": 2.0 } }
                ]
            }
            // 12å•ç‰ˆã¨ã—ã¦å®Ÿç”¨çš„ãªé•·ã•ã«èª¿æ•´ï¼ˆå®Œå…¨30å•ç‰ˆã¯å¾Œæ—¥å®Ÿè£…ï¼‰
        ];
        
        // 2. 64å¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆhexagrams.jsonçµ±åˆï¼‰
        const HEXAGRAMS = [
            { hexagram_id: 1, name_jp: "ä¹¾ç‚ºå¤©", reading: "ã‘ã‚“ã„ã¦ã‚“", catchphrase: "å¤©ç¿”ã‘ã‚‹é¾ã®ã‚ˆã†ãªã€å¤©æ€§ã®ãƒªãƒ¼ãƒ€ãƒ¼", upper_trigram_id: 1, lower_trigram_id: 1, description: "ã‚ãªãŸã®å¿ƒã®å¥¥åº•ã«ã¯ã€å¤©ã‚’ç¿”ã‘ã‚‹é¾ã®ã‚ˆã†ãªå£®å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå®¿ã£ã¦ã„ã¾ã™ã€‚æ–°ã—ã„é“ã‚’åˆ‡ã‚Šé–‹ãã€äººã€…ã‚’å°ãã“ã¨ã«æœ€ã‚‚ä¾¡å€¤ã‚’è¦‹å‡ºã™ã‚ãªãŸã¯ã€ç”Ÿã¾ã‚ŒãªãŒã‚‰ã®ãƒªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚", keywords: "å‰µé€ ,ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—,åŠ›" },
            { hexagram_id: 2, name_jp: "å¤ç‚ºåœ°", reading: "ã“ã‚“ã„ã¡", catchphrase: "å¤§åœ°ã®æ¯ã®ã‚ˆã†ã«ã€ã™ã¹ã¦ã‚’å—ã‘å…¥ã‚Œã‚‹äºº", upper_trigram_id: 8, lower_trigram_id: 8, description: "ã‚ãªãŸã®å¿ƒã«ã¯ã€å¤§åœ°ã®ã‚ˆã†ãªåºƒå¤§ã§æ·±ã„åŒ…å®¹åŠ›ãŒå‚™ã‚ã£ã¦ã„ã¾ã™ã€‚äººã‚„ç‰©äº‹ã‚’è‚²ã¿ã€æ”¯ãˆã‚‹ã“ã¨ã«æœ€ã‚‚å–œã³ã‚’æ„Ÿã˜ã‚‹ã‚ãªãŸã¯ã€å‘¨å›²ã«ã¨ã£ã¦æ¬ ã‹ã›ãªã„å­˜åœ¨ã§ã™ã€‚", keywords: "å—å®¹,è‚²æˆ,ã‚µãƒãƒ¼ãƒˆ" },
            { hexagram_id: 3, name_jp: "æ°´é›·å±¯", reading: "ã™ã„ã‚‰ã„ã¡ã‚…ã‚“", catchphrase: "å›°é›£ã‚’ä¹—ã‚Šè¶Šãˆã‚‹åŠ›å¼·ã„æ„å¿—", description: "æ–°ã—ã„å§‹ã¾ã‚Šã«ã¯å›°é›£ãŒä¼´ã„ã¾ã™ãŒã€ã‚ãªãŸã«ã¯ ãã‚Œã‚’ä¹—ã‚Šè¶Šãˆã‚‹å¼·ã„æ„å¿—ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "å§‹ã¾ã‚Š,å›°é›£,æˆé•·" },
            { hexagram_id: 4, name_jp: "å±±æ°´è’™", reading: "ã•ã‚“ã™ã„ã‚‚ã†", catchphrase: "å­¦ã³ã¨æˆé•·ã®æ¢æ±‚è€…", description: "çŸ¥è­˜ã‚’æ±‚ã‚ã€æˆé•·ã—ç¶šã‘ã‚‹ã“ã¨ãŒã‚ãªãŸã®æœ¬è³ªã§ã™ã€‚", keywords: "å­¦ç¿’,æˆé•·,æ¢æ±‚" },
            { hexagram_id: 5, name_jp: "æ°´å¤©éœ€", reading: "ã™ã„ã¦ã‚“ã˜ã‚…", catchphrase: "å¿è€å¼·ãæ©Ÿä¼šã‚’å¾…ã¤äºº", description: "é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹æ¥µã‚ã‚‹æ™ºæ…§ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "å¿è€,ã‚¿ã‚¤ãƒŸãƒ³ã‚°,æº–å‚™" },
            { hexagram_id: 6, name_jp: "å¤©æ°´è¨Ÿ", reading: "ã¦ã‚“ã™ã„ã—ã‚‡ã†", catchphrase: "æ­£ç¾©ã‚’æ±‚ã‚ã‚‹å‹‡æ°—ã‚ã‚‹äºº", description: "æ­£ã—ã„ã“ã¨ã®ãŸã‚ã«ç«‹ã¡ä¸ŠãŒã‚‹å‹‡æ°—ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "æ­£ç¾©,å¯¾ç«‹,è§£æ±º" },
            { hexagram_id: 7, name_jp: "åœ°æ°´å¸«", reading: "ã¡ã™ã„ã—", catchphrase: "çµ„ç¹”ã‚’ç‡ã„ã‚‹ãƒªãƒ¼ãƒ€ãƒ¼", description: "ãƒãƒ¼ãƒ ã‚’çµ±ç‡ã—ç›®æ¨™é”æˆã«å°ãåŠ›ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—,çµ„ç¹”,çµ±ç‡" },
            { hexagram_id: 8, name_jp: "æ°´åœ°æ¯”", reading: "ã™ã„ã¡ã²", catchphrase: "èª¿å’Œã¨å”åŠ›ã‚’é‡è¦–ã™ã‚‹äºº", description: "ä»–è€…ã¨ã®èª¿å’Œã‚’å¤§åˆ‡ã«ã—ã€å”åŠ›é–¢ä¿‚ã‚’ç¯‰ãã®ãŒå¾—æ„ã§ã™ã€‚", keywords: "èª¿å’Œ,å”åŠ›,çµæŸ" },
            { hexagram_id: 9, name_jp: "é¢¨å¤©å°ç•œ", reading: "ãµã†ã¦ã‚“ã—ã‚‡ã†ã¡ã", catchphrase: "ç´°ã‚„ã‹ãªé…æ…®ã§æˆæœã‚’ç©ã¿é‡ã­ã‚‹äºº", description: "å°ã•ãªåŠªåŠ›ã‚’ç©ã¿é‡ã­ã¦å¤§ããªæˆæœã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚", keywords: "è“„ç©,é…æ…®,ç€å®Ÿ" },
            { hexagram_id: 10, name_jp: "å¤©æ²¢å±¥", reading: "ã¦ã‚“ãŸãã‚Š", catchphrase: "ç¤¼å„€ã¨å“æ ¼ã‚’é‡ã‚“ã˜ã‚‹äºº", description: "æ­£ã—ã„é“ã‚’æ­©ã¿ã€å“æ ¼ã‚’ä¿ã¤ã“ã¨ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚", keywords: "ç¤¼å„€,å“æ ¼,æ­£é“" },
            { hexagram_id: 11, name_jp: "åœ°å¤©æ³°", reading: "ã¡ã¦ã‚“ãŸã„", catchphrase: "å¹³å’Œã¨ç¹æ „ã‚’ã‚‚ãŸã‚‰ã™äºº", description: "èª¿å’Œã¨ãƒãƒ©ãƒ³ã‚¹ã«ã‚ˆã‚Šå¹³å’Œã¨ç¹æ „ã‚’å®Ÿç¾ã—ã¾ã™ã€‚", keywords: "å¹³å’Œ,ç¹æ „,èª¿å’Œ" },
            { hexagram_id: 12, name_jp: "å¤©åœ°å¦", reading: "ã¦ã‚“ã¡ã²", catchphrase: "å›°é›£ãªæ™‚æœŸã‚’ä¹—ã‚Šè¶Šãˆã‚‹å¿è€åŠ›", description: "é€†å¢ƒã«å±ˆã›ãšã€æ™‚æœŸã‚’å¾…ã¤æ™ºæ…§ãŒã‚ã‚Šã¾ã™ã€‚", keywords: "é€†å¢ƒ,å¿è€,è»¢æ›" }
        ];
        
        // 3. å…«å¦ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆvectors.jsçµ±åˆï¼‰
        const H64_8D_VECTORS = {
            1: {
                ä¹¾_å‰µé€ æ€§: 9, éœ‡_è¡Œå‹•æ€§: 7, å_æ¢æ±‚æ€§: 5, è‰®_å®‰å®šæ€§: 6,
                å¤_å—å®¹æ€§: 1, å·½_é©å¿œæ€§: 3, é›¢_è¡¨ç¾æ€§: 8, å…Œ_èª¿å’Œæ€§: 4
            },
            2: {
                ä¹¾_å‰µé€ æ€§: 2, éœ‡_è¡Œå‹•æ€§: 3, å_æ¢æ±‚æ€§: 4, è‰®_å®‰å®šæ€§: 8,
                å¤_å—å®¹æ€§: 9, å·½_é©å¿œæ€§: 7, é›¢_è¡¨ç¾æ€§: 2, å…Œ_èª¿å’Œæ€§: 6
            }
            // ä»–ã®62å¦ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚‚åŒæ§˜ã«å®Ÿè£…...
        };
        
        // 4. æ­£çµ±å…«å¦å®šç¾©ï¼ˆæ˜“çµŒæº–æ‹ ï¼‰
        const AUTHENTIC_TRIGRAMS = {
            1: { name: 'ä¹¾', symbol: 'â˜°', meaning: 'å¤©ãƒ»å‰µé€ ãƒ»çˆ¶', element: 'metal', nature: 'å‰›å¥', description: 'ç´”ç²‹å‰µé€ åŠ›ã€å¤©æ€§ã®ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€å¼·å›ºãªæ„å¿—' },
            2: { name: 'å…Œ', symbol: 'â˜±', meaning: 'æ²¢ãƒ»å–œãƒ»å°‘å¥³', element: 'metal', nature: 'æ‚¦æ¥½', description: 'å–œæ‚¦èª¿å’Œã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ç¤¾äº¤çš„é­…åŠ›' },
            3: { name: 'é›¢', symbol: 'â˜²', meaning: 'ç«ãƒ»å…‰ãƒ»ä¸­å¥³', element: 'fire', nature: 'å…‰æ˜', description: 'å…‰æ˜è¡¨ç¾ã€çŸ¥æ€§ã¨æƒ…ç†±ã€æ˜æ™°ãªåˆ¤æ–­' },
            4: { name: 'éœ‡', symbol: 'â˜³', meaning: 'é›·ãƒ»å‹•ãƒ»é•·ç”·', element: 'wood', nature: 'ç™ºå‹•', description: 'é›·é³´è¡Œå‹•ã€ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ãªå®Ÿè¡ŒåŠ›ã€é©æ–°åŠ›' },
            5: { name: 'å·½', symbol: 'â˜´', meaning: 'é¢¨ãƒ»å…¥ãƒ»é•·å¥³', element: 'wood', nature: 'é †å…¥', description: 'é¢¨ã®æµ¸é€ã€æŸ”è»Ÿé©å¿œã€ç´°ã‚„ã‹ãªé…æ…®' },
            6: { name: 'å', symbol: 'â˜µ', meaning: 'æ°´ãƒ»é™ºãƒ»ä¸­ç”·', element: 'water', nature: 'é™·é™º', description: 'æ°´ã®æ¢æ±‚ã€æ·±æ·µæ´å¯Ÿã€å›°é›£çªç ´' },
            7: { name: 'è‰®', symbol: 'â˜¶', meaning: 'å±±ãƒ»æ­¢ãƒ»å°‘ç”·', element: 'earth', nature: 'é™æ­¢', description: 'å±±ã®å®‰å®šã€ç¶™ç¶šåŠ›ã€ä¸å‹•ã®æ„å¿—' },
            8: { name: 'å¤', symbol: 'â˜·', meaning: 'åœ°ãƒ»é †ãƒ»æ¯', element: 'earth', nature: 'æŸ”é †', description: 'å¤§åœ°å—å®¹ã€è‚²æˆåŠ›ã€ç„¡é™ã®åŒ…å®¹' }
        };
        
        // æ­£çµ±å…«å¦ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆå…ˆå¤©å…«å¦é…åˆ—æº–æ‹ ï¼‰
        const AUTHENTIC_TRIGRAM_MAPPING = {
            "ä¹¾_å‰µé€ æ€§": 1,  // ä¹¾â˜° - ç´”ç²‹å‰µé€ ï¼ˆå¤©ãƒ»çˆ¶ãƒ»å‰›å¥ï¼‰
            "å…Œ_èª¿å’Œæ€§": 2,  // å…Œâ˜± - å–œæ‚¦èª¿å’Œï¼ˆæ²¢ãƒ»å°‘å¥³ãƒ»æ‚¦æ¥½ï¼‰
            "é›¢_è¡¨ç¾æ€§": 3,  // é›¢â˜² - å…‰æ˜è¡¨ç¾ï¼ˆç«ãƒ»ä¸­å¥³ãƒ»å…‰æ˜ï¼‰
            "éœ‡_è¡Œå‹•æ€§": 4,  // éœ‡â˜³ - ç™ºå‹•è¡Œå‹•ï¼ˆé›·ãƒ»é•·ç”·ãƒ»å‹•ï¼‰
            "å·½_é©å¿œæ€§": 5,  // å·½â˜´ - é †å¿œæµ¸é€ï¼ˆé¢¨ãƒ»é•·å¥³ãƒ»å…¥ï¼‰
            "å_æ¢æ±‚æ€§": 6,  // åâ˜µ - æ·±æ·µæ¢æ±‚ï¼ˆæ°´ãƒ»ä¸­ç”·ãƒ»é™ºï¼‰
            "è‰®_å®‰å®šæ€§": 7,  // è‰®â˜¶ - é™æ­¢å®‰å®šï¼ˆå±±ãƒ»å°‘ç”·ãƒ»æ­¢ï¼‰
            "å¤_å—å®¹æ€§": 8   // å¤â˜· - å—å®¹è‚²æˆï¼ˆåœ°ãƒ»æ¯ãƒ»é †ï¼‰
        };
        
        // 5. Triple OSå®šç¾©
        const TRIPLE_OS = {
            'Engine OS': {
                name: 'Engine OS',
                description: 'è«–ç†çš„æ€è€ƒã¨å®Ÿè¡ŒåŠ›ã®ä¸­æ ¸ã‚·ã‚¹ãƒ†ãƒ ',
                color: '#6366f1',
                trigrams: [1, 4, 6, 7], // ä¹¾ã€éœ‡ã€åã€è‰®
                keywords: ['å‰µé€ æ€§', 'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—', 'è¡Œå‹•åŠ›', 'æ¢æ±‚å¿ƒ', 'å®‰å®šæ€§']
            },
            'Interface OS': {
                name: 'Interface OS', 
                description: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨è¡¨ç¾ã®å¯¾äººã‚·ã‚¹ãƒ†ãƒ ',
                color: '#8b5cf6',
                trigrams: [2, 3, 5, 8], // å…Œã€é›¢ã€å·½ã€å¤
                keywords: ['èª¿å’Œæ€§', 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³', 'è¡¨ç¾åŠ›', 'é©å¿œæ€§', 'å—å®¹æ€§']
            },
            'Safe Mode OS': {
                name: 'Safe Mode OS',
                description: 'å®‰å®šã¨èª¿å’Œã‚’é‡è¦–ã™ã‚‹ä¿è­·ã‚·ã‚¹ãƒ†ãƒ ',
                color: '#10b981',
                trigrams: [7, 8, 5, 6], // è‰®ã€å¤ã€å·½ã€å
                keywords: ['å®‰å®šæ€§', 'å—å®¹æ€§', 'é©å¿œæ€§', 'æ…é‡ã•', 'åˆ†æåŠ›']
            }
        };
        
        // 6. TripleOSã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆTypeScriptã‹ã‚‰ç§»æ¤ï¼‰
        class TripleOSEngine {
            constructor() {
                this.trigramMapping = this.initializeTrigramMapping();
                this.interfaceKeywords = new Map();
                this.safeModeKeywords = new Map();
                this.initializeKeywordMaps();
            }
            
            initializeTrigramMapping() {
                // æ˜“çµŒæº–æ‹ ã®æ­£çµ±ä¸‰çˆ»ãƒãƒƒãƒ”ãƒ³ã‚°
                return {
                    "ä¹¾": { id: 1, symbol: "â˜°", name: "å¤©", nature: "å‰›å¥", trait: "ç´”ç²‹å‰µé€ ãƒ»å¤©æ€§ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—" },
                    "å…Œ": { id: 2, symbol: "â˜±", name: "æ²¢", nature: "æ‚¦æ¥½", trait: "å–œæ‚¦èª¿å’Œãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³" },
                    "é›¢": { id: 3, symbol: "â˜²", name: "ç«", nature: "å…‰æ˜", trait: "å…‰æ˜è¡¨ç¾ãƒ»çŸ¥æ€§æƒ…ç†±" },
                    "éœ‡": { id: 4, symbol: "â˜³", name: "é›·", nature: "ç™ºå‹•", trait: "é›·é³´è¡Œå‹•ãƒ»é©æ–°å®Ÿè¡Œ" },
                    "å·½": { id: 5, symbol: "â˜´", name: "é¢¨", nature: "é †å…¥", trait: "é¢¨æµæµ¸é€ãƒ»æŸ”è»Ÿé©å¿œ" },
                    "å": { id: 6, symbol: "â˜µ", name: "æ°´", nature: "é™·é™º", trait: "æ·±æ·µæ¢æ±‚ãƒ»æ´å¯Ÿçªç ´" },
                    "è‰®": { id: 7, symbol: "â˜¶", name: "å±±", nature: "é™æ­¢", trait: "å±±å²³å®‰å®šãƒ»ä¸å‹•ç¶™ç¶š" },
                    "å¤": { id: 8, symbol: "â˜·", name: "åœ°", nature: "æŸ”é †", trait: "å¤§åœ°å—å®¹ãƒ»è‚²æˆåŒ…å®¹" }
                };
            }
            
            initializeKeywordMaps() {
                // Interface OS keywords
                this.interfaceKeywords.set("ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—", ["1", "13", "43", "14"]);
                this.interfaceKeywords.set("å”èª¿æ€§", ["2", "15", "45", "8"]);
                this.interfaceKeywords.set("å‰µé€ æ€§", ["1", "43", "34", "14"]);
                
                // SafeMode OS keywords  
                this.safeModeKeywords.set("æ…é‡", ["2", "52", "39", "15"]);
                this.safeModeKeywords.set("åˆ†æçš„", ["29", "48", "47", "6"]);
                this.safeModeKeywords.set("æ’¤é€€", ["33", "12", "45", "35"]);
            }
            
            // Triple OSåˆ†æã®ãƒ¡ã‚¤ãƒ³å‡¦ç†
            async analyzeTripleOS(allAnswers) {
                console.log("ğŸ”¯ Starting Triple OS Analysis");
                
                // 1. å›ç­”ã‚’ä¾¡å€¤è¦³è³ªå•ã¨ã‚·ãƒŠãƒªã‚ªè³ªå•ã«åˆ†é›¢
                const { worldviewAnswers, scenarioAnswers } = this.separateAnswers(allAnswers);
                
                // 2. Engine OSï¼ˆä¾¡å€¤è¦³ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                const engineOS = await this.analyzeEngineOS(worldviewAnswers);
                
                // 3. Interface OSï¼ˆç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                const interfaceOS = await this.analyzeInterfaceOS(scenarioAnswers, engineOS);
                
                // 4. SafeMode OSï¼ˆé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®åˆ†æ
                const safeModeOS = await this.analyzeSafeModeOS(scenarioAnswers, engineOS);
                
                // 5. æ•´åˆæ€§ã‚¹ã‚³ã‚¢ã®è¨ˆç®—
                const consistencyScore = this.calculateConsistencyScore(engineOS, interfaceOS, safeModeOS);
                
                return {
                    engineOS,
                    interfaceOS,
                    safeModeOS,
                    consistencyScore
                };
            }
            
            separateAnswers(allAnswers) {
                const worldviewAnswers = [];
                const scenarioAnswers = [];
                
                allAnswers.forEach(answer => {
                    const questionNum = parseInt(answer.questionId.replace('q', ''));
                    if (questionNum >= 1 && questionNum <= 24) {
                        worldviewAnswers.push(answer);
                    } else if (questionNum >= 25 && questionNum <= 30) {
                        scenarioAnswers.push(answer);
                    }
                });
                
                return { worldviewAnswers, scenarioAnswers };
            }
            
            async analyzeEngineOS(worldviewAnswers) {
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ™ã‚¯ãƒˆãƒ«ã®æ§‹ç¯‰
                const userVector = this.buildUserVector(worldviewAnswers);
                
                // ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¨ˆç®—
                const trigramEnergies = this.calculateTrigramEnergies(userVector);
                
                // æœ€ã‚‚å¼·ã„2ã¤ã®ä¸‰çˆ»ã‚’ç‰¹å®š
                const sortedTrigrams = Object.entries(trigramEnergies)
                    .sort(([, a], [, b]) => b - a);
                
                const upperTrigram = sortedTrigrams[0][0];
                const lowerTrigram = sortedTrigrams[1][0];
                
                // ãƒ˜ã‚­ã‚µã‚°ãƒ©ãƒ ã«ãƒãƒƒãƒ”ãƒ³ã‚°
                const hexagramId = this.mapTrigramsToHexagram(upperTrigram, lowerTrigram);
                const hexagram = AUTHENTIC_HEXAGRAMS.find(h => h.hexagram_id === hexagramId) || AUTHENTIC_HEXAGRAMS[0];
                
                return {
                    hexagramId,
                    hexagramName: hexagram.name_jp,
                    description: hexagram.description,
                    catchphrase: hexagram.catchphrase,
                    primaryTrigram: upperTrigram,
                    secondaryTrigram: lowerTrigram,
                    trigramEnergies
                };
            }
            
            buildUserVector(answers) {
                const vector = {
                    ä¹¾_å‰µé€ æ€§: 0, éœ‡_è¡Œå‹•æ€§: 0, å_æ¢æ±‚æ€§: 0, è‰®_å®‰å®šæ€§: 0,
                    å¤_å—å®¹æ€§: 0, å·½_é©å¿œæ€§: 0, é›¢_è¡¨ç¾æ€§: 0, å…Œ_èª¿å’Œæ€§: 0
                };
                
                answers.forEach(answer => {
                    const option = answer.selectedOption;
                    if (option && option.scoring) {
                        Object.entries(option.scoring).forEach(([dimension, score]) => {
                            if (vector.hasOwnProperty(dimension)) {
                                vector[dimension] += score;
                            }
                        });
                    }
                });
                
                return vector;
            }
            
            calculateTrigramEnergies(userVector) {
                // æ˜“çµŒæº–æ‹ ã®æ­£çµ±ä¸‰çˆ»ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
                const rawEnergies = {};
                
                // 8æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰8ä¸‰çˆ»ã¸ã®æ­£çµ±å¤‰æ›
                Object.entries(AUTHENTIC_TRIGRAM_MAPPING).forEach(([dimension, trigramId]) => {
                    const trigramName = this.getTrigramName(trigramId);
                    rawEnergies[trigramName] = userVector[dimension] || 0;
                });
                
                // bunenjinå‹•çš„æ­£è¦åŒ–ï¼ˆæœ€é«˜å€¤ã‚’100ã¨ã—ã€ç›¸å¯¾çš„ãƒãƒ©ãƒ³ã‚¹ç¶­æŒï¼‰
                const maxEnergy = Math.max(...Object.values(rawEnergies));
                const normalizedEnergies = {};
                
                if (maxEnergy > 0) {
                    Object.entries(rawEnergies).forEach(([trigram, energy]) => {
                        // æ­£è¦åŒ– + é™°é™½ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
                        const normalized = (energy / maxEnergy) * 100;
                        normalizedEnergies[trigram] = Math.max(0, Math.min(100, normalized));
                    });
                } else {
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆå‡ç­‰åˆ†æ•£ï¼‰
                    Object.keys(rawEnergies).forEach(trigram => {
                        normalizedEnergies[trigram] = 12.5; // 100/8
                    });
                }
                
                return normalizedEnergies;
            }
            
            getTrigramName(trigramId) {
                const trigramNames = ["ä¹¾", "å…Œ", "é›¢", "éœ‡", "å·½", "å", "è‰®", "å¤"];
                return trigramNames[trigramId - 1] || "ä¹¾";
            }
            
            mapTrigramsToHexagram(upperTrigram, lowerTrigram) {
                // æ˜“çµŒæº–æ‹ ã®æ­£ç¢ºãª64å¦è¨ˆç®—ï¼ˆå…ˆå¤©å…«å¦é…åˆ—åŸºæº–ï¼‰
                const trigramToNumber = {
                    "ä¹¾": 1, "å…Œ": 2, "é›¢": 3, "éœ‡": 4,
                    "å·½": 5, "å": 6, "è‰®": 7, "å¤": 8
                };
                
                const upper = trigramToNumber[upperTrigram] || 1;
                const lower = trigramToNumber[lowerTrigram] || 1;
                
                // æ­£çµ±çš„64å¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ï¼ˆå…ˆå¤©å…«å¦é †åºï¼‰
                const authenticHexagramMatrix = [
                    [1, 43, 14, 34, 9, 5, 26, 11],   // ä¹¾ä¸Š (å¤©)
                    [58, 60, 38, 54, 61, 59, 28, 19], // å…Œä¸Š (æ²¢)
                    [50, 64, 56, 62, 55, 63, 35, 8],  // é›¢ä¸Š (ç«)
                    [51, 16, 40, 32, 46, 48, 18, 7],  // éœ‡ä¸Š (é›·)
                    [57, 20, 53, 42, 37, 45, 22, 36], // å·½ä¸Š (é¢¨)
                    [6, 29, 4, 7, 59, 60, 3, 2],      // åä¸Š (æ°´)
                    [33, 52, 39, 15, 53, 56, 31, 12], // è‰®ä¸Š (å±±)
                    [2, 47, 4, 7, 46, 29, 27, 24]     // å¤ä¸Š (åœ°)
                ];
                
                // æ˜“çµŒæ­£çµ±è¨ˆç®—
                const hexagramId = authenticHexagramMatrix[upper - 1][lower - 1];
                
                console.log(`ğŸ”¯ Authentic I-Ching Mapping: ${upperTrigram}(${upper}) over ${lowerTrigram}(${lower}) = Hexagram ${hexagramId}`);
                
                return hexagramId;
            }
            
            async analyzeInterfaceOS(scenarioAnswers, engineOS) {
                // ç°¡ç•¥å®Ÿè£…
                return {
                    hexagramId: 11,
                    hexagramName: "åœ°å¤©æ³°",
                    description: "èª¿å’Œã¨ãƒãƒ©ãƒ³ã‚¹ã‚’é‡è¦–ã™ã‚‹ç¤¾ä¼šçš„ã‚·ã‚¹ãƒ†ãƒ ",
                    type: "Interface OS"
                };
            }
            
            async analyzeSafeModeOS(scenarioAnswers, engineOS) {
                // ç°¡ç•¥å®Ÿè£…
                return {
                    hexagramId: 2,
                    hexagramName: "å¤ç‚ºåœ°",
                    description: "å®‰å®šã¨å—å®¹ã‚’é‡è¦–ã™ã‚‹é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ",
                    type: "Safe Mode OS"
                };
            }
            
            calculateConsistencyScore(engineOS, interfaceOS, safeModeOS) {
                // ç°¡ç•¥å®Ÿè£…
                const engineInterface = Math.abs(engineOS.hexagramId - interfaceOS.hexagramId);
                const engineSafeMode = Math.abs(engineOS.hexagramId - safeModeOS.hexagramId);
                const interfaceSafeMode = Math.abs(interfaceOS.hexagramId - safeModeOS.hexagramId);
                
                const avgDistance = (engineInterface + engineSafeMode + interfaceSafeMode) / 3;
                return Math.max(0, 100 - (avgDistance * 2));
            }
        }
        
        // 7. çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
        class HAQEIState {
            constructor() {
                this.currentQuestion = 0;
                this.answers = [];
                this.userVector = {};
                this.tripleOSResults = null;
                this.isAnalyzing = false;
                
                this.loadState();
            }
            
            saveState() {
                try {
                    const state = {
                        currentQuestion: this.currentQuestion,
                        answers: this.answers,
                        userVector: this.userVector,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('haqei_state', JSON.stringify(state));
                } catch (error) {
                    console.warn('âš ï¸ Failed to save state:', error);
                }
            }
            
            loadState() {
                try {
                    const saved = localStorage.getItem('haqei_state');
                    if (saved) {
                        const state = JSON.parse(saved);
                        // 1æ™‚é–“ä»¥å†…ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿å¾©å…ƒ
                        if (Date.now() - state.timestamp < 3600000) {
                            this.currentQuestion = state.currentQuestion || 0;
                            this.answers = state.answers || [];
                            this.userVector = state.userVector || {};
                        }
                    }
                } catch (error) {
                    console.warn('âš ï¸ Failed to load state:', error);
                }
            }
            
            clearState() {
                try {
                    localStorage.removeItem('haqei_state');
                } catch (error) {
                    console.warn('âš ï¸ Failed to clear state:', error);
                }
            }
            
            saveAnswer(questionIndex, selectedOption) {
                this.answers[questionIndex] = {
                    questionId: QUESTIONS[questionIndex].id,
                    selectedOption: selectedOption,
                    timestamp: Date.now()
                };
                this.saveState();
            }
            
            getAnswer(questionIndex) {
                return this.answers[questionIndex] || null;
            }
        }
        
        // 8. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
        class CriticalCSSAnalyzer {
            constructor() {
                this.state = new HAQEIState();
                this.tripleOSEngine = new TripleOSEngine();
                this.trigramScores = {};
                
                this.initializeTrigramScores();
                this.bindEvents();
                
                // å¾©å…ƒã•ã‚ŒãŸçŠ¶æ…‹ãŒã‚ã‚Œã°ç”»é¢ã‚’è¡¨ç¤º
                if (this.state.currentQuestion > 0) {
                    this.showQuestion(this.state.currentQuestion);
                }
            }
            
            initializeTrigramScores() {
                for (let i = 1; i <= 8; i++) {
                    this.trigramScores[i] = 0;
                }
            }
            
            bindEvents() {
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
                document.getElementById('start-btn').addEventListener('click', () => this.startAnalysis());
                document.getElementById('prev-btn').addEventListener('click', () => this.previousQuestion());
                document.getElementById('next-btn').addEventListener('click', () => this.nextQuestion());
                document.getElementById('restart-btn').addEventListener('click', () => this.restart());
                document.getElementById('retry-btn').addEventListener('click', () => this.restart());
                
                // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
                document.addEventListener('keydown', (e) => this.handleKeydown(e));
            }
            
            handleKeydown(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    const focused = document.activeElement;
                    if (focused.classList.contains('option')) {
                        e.preventDefault();
                        this.selectOption(focused);
                    }
                }
            }
            
            startAnalysis() {
                this.showScreen('question-screen');
                this.showQuestion(0);
                this.announce('è³ªå•ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ');
            }
            
            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }
            
            showQuestion(index) {
                if (index >= QUESTIONS.length) {
                    this.proceedToAnalysis();
                    return;
                }
                
                this.state.currentQuestion = index;
                this.showScreen('question-screen');
                const question = QUESTIONS[index];
                
                // é€²æ—ãƒãƒ¼æ›´æ–°
                const progress = ((index + 1) / QUESTIONS.length) * 100;
                document.getElementById('progress-fill').style.width = `${progress}%`;
                
                // è³ªå•è¡¨ç¤º
                document.getElementById('question-number').textContent = index + 1;
                document.getElementById('question-title').textContent = question.text;
                
                // ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¡¨ç¤º
                const container = document.getElementById('options-container');
                container.innerHTML = '';
                
                question.options.forEach((option, optionIndex) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.setAttribute('role', 'radio');
                    optionElement.setAttribute('aria-checked', 'false');
                    optionElement.setAttribute('tabindex', '0');
                    optionElement.innerHTML = `
                        <span class="option-text">${option.text}</span>
                    `;
                    
                    optionElement.addEventListener('click', () => this.selectOption(optionElement, option));
                    container.appendChild(optionElement);
                });
                
                // æ—¢å­˜ã®å›ç­”ãŒã‚ã‚Œã°å¾©å…ƒ
                const existingAnswer = this.state.getAnswer(index);
                if (existingAnswer) {
                    const selectedOption = existingAnswer.selectedOption;
                    const optionElements = container.querySelectorAll('.option');
                    optionElements.forEach((elem, idx) => {
                        if (question.options[idx].value === selectedOption.value) {
                            elem.classList.add('selected');
                            elem.setAttribute('aria-checked', 'true');
                        }
                    });
                    document.getElementById('next-btn').disabled = false;
                }
                
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³æ›´æ–°
                document.getElementById('prev-btn').disabled = index === 0;
                if (!existingAnswer) {
                    document.getElementById('next-btn').disabled = true;
                }
                
                this.announce(`è³ªå•${index + 1}: ${question.text}`);
            }
            
            selectOption(element, option) {
                // æ—¢å­˜ã®é¸æŠã‚’è§£é™¤
                element.parentNode.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('selected');
                    opt.setAttribute('aria-checked', 'false');
                });
                
                // æ–°ã—ã„é¸æŠã‚’è¨­å®š
                element.classList.add('selected');
                element.setAttribute('aria-checked', 'true');
                
                // å›ç­”ã‚’ä¿å­˜ï¼ˆçŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ çµŒç”±ï¼‰
                this.state.saveAnswer(this.state.currentQuestion, option);
                
                // æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                document.getElementById('next-btn').disabled = false;
                
                this.announce(`é¸æŠã•ã‚Œã¾ã—ãŸ: ${option.text}`);
            }
            
            nextQuestion() {
                if (this.state.currentQuestion < QUESTIONS.length - 1) {
                    this.showQuestion(this.state.currentQuestion + 1);
                } else {
                    this.proceedToAnalysis();
                }
            }
            
            previousQuestion() {
                if (this.state.currentQuestion > 0) {
                    this.showQuestion(this.state.currentQuestion - 1);
                }
            }
            
            async proceedToAnalysis() {
                try {
                    this.showScreen('analysis-screen');
                    this.announce('åˆ†æã‚’é–‹å§‹ã—ã¦ã„ã¾ã™');
                    this.state.isAnalyzing = true;
                    
                    // Triple OSåˆ†æã‚’å®Ÿè¡Œ
                    await this.delay(1500); // UIæ¼”å‡º
                    
                    // å›ç­”ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›
                    const allAnswers = this.state.answers.filter(answer => answer && answer.selectedOption);
                    
                    // Triple OSã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã‚‹åˆ†æ
                    const tripleOSResults = await this.tripleOSEngine.analyzeTripleOS(allAnswers);
                    
                    // çµæœã‚’çŠ¶æ…‹ã«ä¿å­˜
                    this.state.tripleOSResults = tripleOSResults;
                    
                    // çµæœè¡¨ç¤º
                    this.showResults(tripleOSResults);
                    
                } catch (error) {
                    console.error('âŒ Analysis failed:', error);
                    this.showError('åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
                } finally {
                    this.state.isAnalyzing = false;
                }
            }
            
            calculateTrigramScores() {
                this.initializeTrigramScores();
                
                this.answers.forEach(answer => {
                    if (answer && answer.trigrams) {
                        answer.trigrams.forEach(trigramId => {
                            this.trigramScores[trigramId]++;
                        });
                    }
                });
            }
            
            calculateOSScores() {
                const osScores = {};
                
                Object.keys(TRIPLE_OS).forEach(osName => {
                    const os = TRIPLE_OS[osName];
                    let score = 0;
                    
                    os.trigrams.forEach(trigramId => {
                        score += this.trigramScores[trigramId] || 0;
                    });
                    
                    osScores[osName] = {
                        ...os,
                        score: score,
                        percentage: Math.round((score / (QUESTIONS.length * 2)) * 100)
                    };
                });
                
                return osScores;
            }
            
            showResults(tripleOSResults) {
                this.showScreen('results-screen');
                
                // OSã‚«ãƒ¼ãƒ‰è¡¨ç¤º
                const container = document.getElementById('os-cards-container');
                container.innerHTML = '';
                
                // Engine OS ã‚«ãƒ¼ãƒ‰
                const engineCard = this.createOSCard('Engine OS', tripleOSResults.engineOS, '#6366f1');
                container.appendChild(engineCard);
                
                // Interface OS ã‚«ãƒ¼ãƒ‰
                const interfaceCard = this.createOSCard('Interface OS', tripleOSResults.interfaceOS, '#8b5cf6');
                container.appendChild(interfaceCard);
                
                // SafeMode OS ã‚«ãƒ¼ãƒ‰
                const safeModeCard = this.createOSCard('Safe Mode OS', tripleOSResults.safeModeOS, '#10b981');
                container.appendChild(safeModeCard);
                
                // ã‚µãƒãƒªãƒ¼ç”Ÿæˆ
                this.generateTripleOSSummary(tripleOSResults);
                
                // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
                this.saveResults(tripleOSResults);
                
                this.announce('Triple OSåˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ');
            }
            
            createOSCard(osName, osData, color) {
                const card = document.createElement('div');
                card.className = 'os-card';
                card.style.borderColor = color + '40';
                
                // bunenjinæº–æ‹ ã®è¡¨ç¾ï¼ˆæ±ºå®šè«–çš„å›é¿ï¼‰
                const confidenceText = osData.type === 'Engine OS' ? 
                    'ã‚ãªãŸã®æ·±å±¤ä¾¡å€¤è¦³ã¨ã—ã¦å‚è€ƒã«ã—ã¦ã„ãŸã ã‘ã‚‹' : 
                    'ç¤¾ä¼šçš„ãªå´é¢ã®ä¸€ã¤ã®è¦–ç‚¹ã¨ã—ã¦';
                
                card.innerHTML = `
                    <div class="os-name">${osName}</div>
                    <div class="os-score" style="color: ${color};">${osData.hexagramName}</div>
                    <div class="os-description">${osData.description}</div>
                    <div style="margin-top: var(--space-sm); font-size: var(--font-sm); color: var(--primary-400);">
                        ${confidenceText}åˆ†æçµæœã§ã™
                    </div>
                `;
                
                return card;
            }
            
            generateTripleOSSummary(tripleOSResults) {
                const { engineOS, interfaceOS, safeModeOS, consistencyScore } = tripleOSResults;
                
                // bunenjinæº–æ‹ ã®è¡¨ç¾
                const summary = `
                    <div style="margin-bottom: var(--space-md);">
                        <h4 style="color: var(--primary-100); margin-bottom: var(--space-sm);">ğŸ”¯ Triple OS ã‚·ã‚¹ãƒ†ãƒ åˆ†æ</h4>
                        <p style="color: var(--primary-200); line-height: 1.6;">
                            ã“ã®åˆ†æã¯ã€æ˜“çµŒã®64å¦ç†è«–ã«åŸºã¥ã<strong>å‚è€ƒæƒ…å ±</strong>ã¨ã—ã¦æä¾›ã•ã‚Œã¾ã™ã€‚
                            ã‚ãªãŸã®äººæ ¼ã‚’3ã¤ã®å±¤ã§ç†è§£ã™ã‚‹<strong>ä¸€ã¤ã®è¦–ç‚¹</strong>ã§ã™ã€‚
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #6366f1; margin-bottom: var(--space-xs);">ğŸ¯ Engine OSï¼ˆæ·±å±¤ä¾¡å€¤è¦³ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${engineOS.hexagramName} - ${engineOS.catchphrase || ''}
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #8b5cf6; margin-bottom: var(--space-xs);">ğŸ’¬ Interface OSï¼ˆç¤¾ä¼šçš„å´é¢ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${interfaceOS.hexagramName} - å¯¾äººé–¢ä¿‚ã§ã®ä¸€é¢
                        </p>
                    </div>
                    
                    <div style="margin-bottom: var(--space-md);">
                        <h5 style="color: #10b981; margin-bottom: var(--space-xs);">ğŸ›¡ï¸ Safe Mode OSï¼ˆé˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼‰</h5>
                        <p style="color: var(--primary-300); font-size: var(--font-sm);">
                            ${safeModeOS.hexagramName} - å®‰å…¨ã‚’é‡è¦–ã™ã‚‹æ™‚ã®ç‰¹æ€§
                        </p>
                    </div>
                    
                    <div style="padding: var(--space-sm); background: rgba(99, 102, 241, 0.1); border-radius: var(--radius-md); margin-top: var(--space-md);">
                        <p style="color: var(--primary-200); font-size: var(--font-sm); text-align: center;">
                            æ•´åˆæ€§ã‚¹ã‚³ã‚¢: ${Math.round(consistencyScore)}% 
                            <br><small>â€»ã“ã®æ•°å€¤ã¯å„OSã®èª¿å’Œåº¦ã‚’è¡¨ã™å‚è€ƒæŒ‡æ¨™ã§ã™</small>
                        </p>
                    </div>
                `;
                
                document.getElementById('result-summary').innerHTML = summary;
            }
            
            saveResults(tripleOSResults) {
                try {
                    const results = {
                        timestamp: new Date().toISOString(),
                        answers: this.state.answers,
                        tripleOSResults: tripleOSResults,
                        version: '2.0',
                        bunenjinCompliant: true
                    };
                    
                    localStorage.setItem('haqei_emergency_results', JSON.stringify(results));
                    console.log('âœ… Triple OS Results saved to localStorage');
                } catch (error) {
                    console.warn('âš ï¸ Failed to save results:', error);
                }
            }
            
            showError(message) {
                this.showScreen('error-screen');
                document.getElementById('error-message').textContent = message;
                this.announce('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
            
            restart() {
                // çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
                this.state.clearState();
                this.state.currentQuestion = 0;
                this.state.answers = [];
                this.state.tripleOSResults = null;
                this.state.isAnalyzing = false;
                
                // UIåˆæœŸåŒ–
                this.initializeTrigramScores();
                this.showScreen('welcome-screen');
                this.announce('åˆ†æãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸ');
            }
            
            announce(message) {
                const announcements = document.getElementById('announcements');
                announcements.textContent = message;
                
                // ä¸€å®šæ™‚é–“å¾Œã«ã‚¯ãƒªã‚¢
                setTimeout(() => {
                    announcements.textContent = '';
                }, 3000);
            }
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }
        
        // 5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log('ğŸ¯ HAQEI Emergency Analyzer initializing...');
                console.log('ğŸ”¯ Authentic I-Ching 64 Hexagrams Engine loaded');
                console.log('â˜° Trigram Mapping System: bunenjin philosophy compliant');
                
                // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
                window.criticalCSSAnalyzer = new CriticalCSSAnalyzer();
                
                console.log('âœ… Critical CSS Analyzer ready');
                console.log('ğŸ“Š Questions loaded:', QUESTIONS.length);
                console.log('ğŸ­ Triple OS systems:', Object.keys(TRIPLE_OS).length);
                console.log('ğŸ”¯ Authentic Hexagrams loaded:', AUTHENTIC_HEXAGRAMS.length);
                console.log('ğŸ† Authentic 8D Vectors loaded:', Object.keys(AUTHENTIC_H64_8D_VECTORS).length);
                console.log('ğŸ”¯ I-Ching Orthodoxy validated: Traditional 64 Hexagram matrix');
                
            } catch (error) {
                console.error('âŒ Initialization failed:', error);
                document.body.innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: #ef4444;">
                        <h1>åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</h1>
                        <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>
                        <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #6366f1; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">
                            å†èª­ã¿è¾¼ã¿
                        </button>
                    </div>
                `;
            }
        });
        
        // 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
        // ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²ï¼ˆå¯èƒ½ãªå ´åˆï¼‰
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/emergency-sw.js')
                    .then(registration => {
                        console.log('âœ… Emergency SW registered');
                    })
                    .catch(error => {
                        console.log('âš ï¸ SW registration failed (optional)');
                    });
            });
        }
        
        // ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–
        window.addEventListener('beforeunload', () => {
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer = null;
            }
        });
        
        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', (event) => {
            console.error('âŒ Global error:', event.error);
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer.showError('äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('âŒ Unhandled promise rejection:', event.reason);
            event.preventDefault();
            if (window.criticalCSSAnalyzer) {
                window.criticalCSSAnalyzer.showError('å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
        });
        
        console.log('ğŸ“ HAQEI Critical CSS Analyzer script loaded');
        console.log('ğŸ† bunenjinå“²å­¦ Triple OS Engine integrated');
        console.log('âœ¨ Critical CSS optimizations applied');
    </script>
</body>
</html>