# テキスト分析易経統合システム要件定義書

作成日: 2025年08月05日  
作成者: HAQEI Requirements Analyst  
プロジェクト: Future Simulator テキスト分析易経統合  
バージョン: 1.0

## 1. プロジェクト概要

### 1.1 背景と問題
現在のfuture_simulator.htmlは以下の問題を抱えている：
- 入力テキストを実際に分析せず、サンプルデータを表示
- テキスト→易経メタファー変換が機能していない
- 8つのシナリオが固定的で動的生成されていない

### 1.2 目的
ユーザーが入力した「生の言葉」から：
1. 仮想状況を的確に把握
2. 易経のメタファーで状況卦を導出
3. 状況卦と爻から8つの未来シナリオを動的生成

### 1.3 期待される成果
- テキスト分析精度: 85%以上
- 易経メタファー適合度: 90%以上
- シナリオ生成品質: A級（HaQei哲学準拠）
- レスポンスタイム: 3秒以内

## 2. 機能要件

### 2.1 テキスト分析機能
#### FR-2.1.1 自然言語処理
- **入力**: ユーザーの生の言葉（100〜2000文字）
- **処理**: 
  - 感情分析（ポジティブ/ネガティブ/中立）
  - キーワード抽出（名詞、動詞、形容詞）
  - 文脈理解（状況、課題、願望の識別）
  - 時間軸分析（現在/過去/未来の言及）
- **出力**: 構造化された状況データ

#### FR-2.1.2 状況パターン認識
- 困難度スコア（0-100）
- 変化の必要性スコア（0-100）
- 内的/外的要因の分類
- 主体性レベルの判定

### 2.2 易経メタファー変換機能
#### FR-2.2.1 状況卦の導出
- **入力**: 構造化された状況データ
- **処理**:
  - 64卦からの最適卦選択アルゴリズム
  - 卦の上卦・下卦の意味マッチング
  - H384_DATAベースとの照合
- **出力**: 本卦（現在の状況卦）

#### FR-2.2.2 変爻の特定
- **処理**:
  - 6爻から最も関連性の高い爻を選択
  - 爻辞との意味的マッチング
  - 動爻/静爻の判定
- **出力**: 特定の爻位置（初爻〜上爻）

### 2.3 8シナリオ生成機能
#### FR-2.3.1 正統易経8変化パターン
1. **正統変化** - 爻辞に従う道
2. **逆行変化** - 爻辞に逆らう道
3. **互卦変化** - 内なる可能性
4. **錯卦変化** - 対極への転換
5. **綜卦変化** - 視点の転換
6. **急速変化** - 革命的変革
7. **漸進変化** - 段階的発展
8. **循環変化** - 序卦伝の流れ

#### FR-2.3.2 シナリオ詳細生成
- 各シナリオの展開予測
- 成功確率の算出
- 推奨行動の提示
- HaQei分人視点の統合

### 2.4 統合表示機能
#### FR-2.4.1 現在地表示
- 本卦と爻の視覚的表現
- 状況の易経的解釈
- HaQei分人間分析

#### FR-2.4.2 選択肢提示
- 二つの主要な道の明確化
- 選択による影響の可視化

#### FR-2.4.3 8シナリオ表示
- グレード評価（S〜H級）
- 詳細な展開説明
- チャート連動表示

## 3. 非機能要件

### 3.1 パフォーマンス要件
- **テキスト分析時間**: 1秒以内
- **易経変換時間**: 0.5秒以内
- **シナリオ生成時間**: 1.5秒以内
- **総処理時間**: 3秒以内

### 3.2 精度要件
- **テキスト理解精度**: 85%以上
- **状況卦適合度**: 90%以上
- **シナリオ妥当性**: 85%以上

### 3.3 ユーザビリティ要件
- 入力から結果表示までシームレス
- プログレッシブレンダリング
- エラー時の適切なフォールバック

### 3.4 技術要件
- **既存資産活用**:
  - H384_DATABASE
  - AuthenticIChingEngine
  - Authentic8ScenariosSystem
  - SituationalContextEngine
  - HexagramMappingEngine

## 4. システム統合要件

### 4.1 データフロー
```
入力テキスト
    ↓
[テキスト分析エンジン]
    ↓
構造化状況データ
    ↓
[易経メタファー変換エンジン]
    ↓
状況卦 + 変爻
    ↓
[8シナリオ生成エンジン]
    ↓
動的生成された8つの未来シナリオ
```

### 4.2 モジュール連携
1. **SituationalContextEngine**: テキスト分析の中核
2. **HexagramMappingEngine**: 易経変換の実行
3. **Authentic8ScenariosSystem**: 8パターン生成
4. **AuthenticIChingEngine**: 全体統括

## 5. 制約事項

### 5.1 技術的制約
- ブラウザ内完結（サーバーサイド処理なし）
- 既存のH384_DATAフォーマット維持
- Chart.js依存の維持

### 5.2 哲学的制約
- HaQei哲学との完全整合
- 易経の正統的解釈の遵守
- 時中概念の適切な実装

## 6. 成功基準

### 6.1 定量的基準
- [ ] テキスト分析精度85%達成
- [ ] 3秒以内のレスポンスタイム
- [ ] 8シナリオすべての動的生成

### 6.2 定性的基準
- [ ] ユーザーの「生の言葉」が易経的に解釈される
- [ ] 生成されたシナリオが現実的かつ示唆的
- [ ] HaQei哲学が自然に統合されている

## 7. リスクと対策

### 7.1 技術的リスク
| リスク | 可能性 | 影響 | 対策 |
|--------|--------|------|------|
| テキスト分析精度不足 | 中 | 高 | 複数分析手法の組み合わせ |
| 処理時間超過 | 低 | 中 | 非同期処理とキャッシュ活用 |
| ブラウザ互換性 | 低 | 低 | ポリフィル使用 |

### 7.2 品質リスク
| リスク | 可能性 | 影響 | 対策 |
|--------|--------|------|------|
| 易経解釈の不適切 | 中 | 高 | 専門家レビュー実施 |
| シナリオの画一化 | 低 | 中 | ランダム要素の導入 |

## 8. プロジェクト範囲

### 8.1 対象範囲
- future_simulator.htmlの完全改修
- テキスト分析→易経変換→シナリオ生成の統合
- 既存コンポーネントの最大活用

### 8.2 対象外
- 新規UIフレームワークの導入
- サーバーサイド処理の追加
- 他ページへの影響

## 9. 承認

本要件定義書は、テキスト分析易経統合システムの開発指針として承認されました。

**次のステップ**: 設計書の作成