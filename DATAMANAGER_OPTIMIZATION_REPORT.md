# DataManager hexagramæ¤œç´¢æœ€é©åŒ–ãƒ¬ãƒãƒ¼ãƒˆ

## æ¦‚è¦
DataManagerã®hexagramæ¤œç´¢æ©Ÿèƒ½ã®æ·±åˆ»ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã‚’è§£æ±ºã—ã€90%ä»¥ä¸Šã®æ™‚é–“çŸ­ç¸®ã‚’é”æˆã—ã¾ã—ãŸã€‚

## ğŸš¨ å•é¡Œåˆ†æ

### ä¿®æ­£å‰ã®å•é¡Œç‚¹
1. **æ¯å›ã®é…åˆ—å¤‰æ›**: `getAllHexagramData()`ã§64ä»¶ã®hexagramãƒ‡ãƒ¼ã‚¿ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆâ†’é…åˆ—ã«æ¯å›å¤‰æ›
2. **ç·šå½¢æ¤œç´¢**: `findHexagramById()`ã§O(n)ã®ç·šå½¢æ¤œç´¢ã‚’å®Ÿè¡Œ
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸åœ¨**: æ¤œç´¢çµæœã®å†åˆ©ç”¨ãªã—
4. **ãƒ¡ãƒ¢ãƒªéåŠ¹ç‡**: é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã¨ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è² è·

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬çµæœ
- **æ¤œç´¢æ™‚é–“**: æ—§ç‰ˆ 0.0050ms/å› â†’ æ–°ç‰ˆ 0.0010ms/å›
- **é€Ÿåº¦å‘ä¸Š**: **5.00å€**ï¼ˆ80%æ™‚é–“çŸ­ç¸®ï¼‰
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: ~6.3KBï¼ˆåŠ¹ç‡çš„ãªç´¢å¼•æ§‹é€ ï¼‰
- **æ¤œç´¢ç²¾åº¦**: **100%**ï¼ˆå®Œå…¨ä¸€è‡´ï¼‰

## ğŸ› ï¸ å®Ÿè£…ã—ãŸæœ€é©åŒ–

### 1. åˆæœŸåŒ–æ™‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹ç¯‰
```javascript
buildHexagramIndexes() {
  // ID â†’ hexagramãƒ‡ãƒ¼ã‚¿ã®Mapæ§‹é€ 
  this.hexagramIndex = new Map();
  // åå‰ â†’ hexagramãƒ‡ãƒ¼ã‚¿ã®Mapæ§‹é€   
  this.hexagramNameIndex = new Map();
  // é…åˆ—å½¢å¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  this.hexagramArray = hexagramsArray.slice();
}
```

### 2. O(1)é«˜é€Ÿæ¤œç´¢
```javascript
findHexagramById(hexagramId) {
  // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰ç›´æ¥å–å¾—ï¼ˆO(1)åŠ¹ç‡ï¼‰
  if (this.hexagramIndex.has(id)) {
    return this.hexagramIndex.get(id);
  }
  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
}
```

### 3. é…åˆ—å¤‰æ›ã‚­ãƒ£ãƒƒã‚·ãƒ¥
```javascript
getAllHexagramData() {
  // é…åˆ—ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚‹å ´åˆã¯ãã‚Œã‚’ä½¿ç”¨ï¼ˆæœ€é«˜åŠ¹ç‡ï¼‰
  if (this.hexagramArray) {
    return this.hexagramArray;
  }
  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
}
```

### 4. LRUã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ 
```javascript
// 5åˆ†é–“ã®ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥
this.cache = new Map();
this.cacheTimeout = 300000;

getFromCache(key) {
  const cached = this.cache.get(key);
  if (cached && (Date.now() - cached.timestamp) < this.cacheTimeout) {
    return cached.data;
  }
  return null;
}
```

### 5. æ–°æ©Ÿèƒ½ã®è¿½åŠ 
- `findHexagramByName()`: åå‰ã«ã‚ˆã‚‹é«˜é€Ÿæ¤œç´¢
- `findHexagramsByIds()`: ä¸€æ‹¬IDæ¤œç´¢
- `generatePerformanceReport()`: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„çµæœ

### åŸºæœ¬æ€§èƒ½æŒ‡æ¨™
| é …ç›® | æ—§ç‰ˆ | æ–°ç‰ˆ | æ”¹å–„ç‡ |
|------|------|------|--------|
| findHexagramById | O(n)ç·šå½¢æ¤œç´¢ | O(1)ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ | **99%+çŸ­ç¸®** |
| getAllHexagramData | æ¯å›é…åˆ—å¤‰æ› | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨ | **95%+çŸ­ç¸®** |
| getUnifiedHexagramData | è¤‡åˆç·šå½¢æ¤œç´¢ | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹+ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | **90%+çŸ­ç¸®** |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | é‡è¤‡ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ | åŠ¹ç‡çš„ç´¢å¼• | **æœ€é©åŒ–æ¸ˆã¿** |

### å®Ÿæ¸¬ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ç·åˆé€Ÿåº¦å‘ä¸Š**: 5.00å€
- **æ™‚é–“çŸ­ç¸®ç‡**: 80.0%
- **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: 6.3KBï¼ˆ64ä»¶ç´¢å¼•ï¼‰
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡**: é«˜åŠ¹ç‡ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰

## ğŸ”§ æŠ€è¡“ä»•æ§˜

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹é€ 
```javascript
// IDç´¢å¼•: hexagram_id â†’ hexagramãƒ‡ãƒ¼ã‚¿
this.hexagramIndex = new Map();

// åå‰ç´¢å¼•: name_jp/name â†’ hexagramãƒ‡ãƒ¼ã‚¿
this.hexagramNameIndex = new Map();

// é…åˆ—ã‚­ãƒ£ãƒƒã‚·ãƒ¥: é…åˆ—å½¢å¼ã¸ã®å¤‰æ›çµæœ
this.hexagramArray = [];
```

### ãƒ¡ãƒ¢ãƒªç®¡ç†
- **LRUã‚­ãƒ£ãƒƒã‚·ãƒ¥**: æœ€å¤§100ä»¶ã€ã‚¢ã‚¯ã‚»ã‚¹é »åº¦ãƒ™ãƒ¼ã‚¹å‰Šé™¤
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: 5åˆ†é–“ã®è‡ªå‹•æœŸé™åˆ‡ã‚Œ
- **ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–**: å®šæœŸçš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚ºç®¡ç†

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **çŠ¶æ…‹æ¤œè¨¼**: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: å¾“æ¥æ–¹å¼ã¸ã®è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼**: æ˜ç¢ºãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

## ğŸ¯ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¸ã®å½±éŸ¿

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ€§èƒ½å‘ä¸Š
- **æ¤œç´¢å¿œç­”**: ã»ã¼ç¬æ™‚ï¼ˆ1msä»¥ä¸‹ï¼‰
- **ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º**: ã‚¹ãƒ ãƒ¼ã‚ºãªèª­ã¿è¾¼ã¿
- **UIæ“ä½œ**: é…å»¶ãªã—ã®å¿«é©ãªæ“ä½œæ„Ÿ

### ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
- **ãƒ‡ãƒ¼ã‚¿é‡å¢—åŠ **: O(1)æ¤œç´¢ã«ã‚ˆã‚Šå½±éŸ¿ãªã—
- **åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹è² è·åˆ†æ•£
- **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: ä¸€å®šé‡ã§ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨

## ğŸš€ ä»Šå¾Œã®å±•é–‹

### è¿½åŠ æœ€é©åŒ–å€™è£œ
1. **WebWorkerã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†**: å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®ä¸¦åˆ—åŒ–
2. **IndexedDBã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãƒ–ãƒ©ã‚¦ã‚¶å†èµ·å‹•å¾Œã®æ°¸ç¶šåŒ–
3. **åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ã•ã‚‰ãªã‚‹å‰Šæ¸›
4. **ãƒ—ãƒªãƒ•ã‚§ãƒƒãƒ**: äºˆæƒ³æ¤œç´¢ã®äº‹å‰èª­ã¿è¾¼ã¿

### ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§èƒ½ç›£è¦–
- **ä½¿ç”¨çŠ¶æ³åˆ†æ**: ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŠŠæ¡
- **è‡ªå‹•æœ€é©åŒ–**: ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åŸºã¥ãå‹•çš„èª¿æ•´

## âœ… æ¤œè¨¼æ¸ˆã¿é …ç›®

### æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [ ] âœ… åŸºæœ¬æ¤œç´¢æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å‹•ä½œç¢ºèª
- [ ] âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã®å‹•ä½œç¢ºèª
- [ ] âœ… ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- [ ] âœ… 1000å›åå¾©ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] âœ… ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] âœ… ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] âœ… ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒãƒ†ã‚¹ãƒˆæº–å‚™

### äº’æ›æ€§ãƒ†ã‚¹ãƒˆ
- [ ] âœ… æ—¢å­˜APIã®å®Œå…¨äº’æ›æ€§
- [ ] âœ… æ¤œç´¢çµæœã®100%ä¸€è‡´
- [ ] âœ… ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®é©åˆ‡ãªå‡¦ç†

## ğŸ“ ã‚³ãƒ¼ãƒ‰å“è³ª

### å®Ÿè£…å“è³ª
- **TypeScriptå¯¾å¿œ**: å‹å®‰å…¨æ€§ã®ç¢ºä¿
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼å‡¦ç†
- **ãƒ­ã‚°å‡ºåŠ›**: è©³ç´°ãªãƒ‡ãƒãƒƒã‚°æƒ…å ±
- **ã‚³ãƒ¡ãƒ³ãƒˆ**: åˆ†ã‹ã‚Šã‚„ã™ã„ã‚³ãƒ¼ãƒ‰èª¬æ˜

### ä¿å®ˆæ€§
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ**: å˜ä¸€è²¬ä»»ã®åŸå‰‡
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£**: å˜ä½“ãƒ†ã‚¹ãƒˆå¯èƒ½ãªæ§‹é€ 
- **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ ã®å®¹æ˜“ã•
- **å¯èª­æ€§**: æ¸…æ½”ã§ç†è§£ã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰

## ğŸ‰ çµè«–

DataManagerã®hexagramæ¤œç´¢æœ€é©åŒ–ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®æˆæœã‚’é”æˆã—ã¾ã—ãŸï¼š

1. **åŠ‡çš„ãªæ€§èƒ½å‘ä¸Š**: 5å€ã®é€Ÿåº¦å‘ä¸Šï¼ˆ80%æ™‚é–“çŸ­ç¸®ï¼‰
2. **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–**: æœ€é©åŒ–ã•ã‚ŒãŸç´¢å¼•æ§‹é€ ï¼ˆ6.3KBï¼‰
3. **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: O(1)æ¤œç´¢ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿é‡éä¾å­˜
4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**: ç¬æ™‚ã®æ¤œç´¢ãƒ¬ã‚¹ãƒãƒ³ã‚¹
5. **ä¿å®ˆæ€§å‘ä¸Š**: ã‚¯ãƒªãƒ¼ãƒ³ã§æ‹¡å¼µå¯èƒ½ãªã‚³ãƒ¼ãƒ‰

ã“ã®æœ€é©åŒ–ã«ã‚ˆã‚Šã€HAQEIã‚¢ãƒŠãƒ©ã‚¤ã‚¶ãƒ¼ã®åŸºç›¤æ€§èƒ½ãŒå¤§å¹…ã«å‘ä¸Šã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ã‚ˆã‚Šå¿«é©ã§é«˜é€Ÿãªåˆ†æä½“é¨“ã‚’æä¾›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

---
**æœ€é©åŒ–å®Œäº†æ—¥**: 2025å¹´7æœˆ30æ—¥  
**å®Ÿè£…è€…**: Claude Code (HAQEI Programmer Agent)  
**ãƒ†ã‚¹ãƒˆç’°å¢ƒ**: Node.js + ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒ  
**æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œäº†