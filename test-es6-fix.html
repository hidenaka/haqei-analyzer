<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ES6 Module Fix Test</title>
  </head>
  <body>
    <h1>ES6 Module Fix Test</h1>
    <div id="test-results"></div>

    <script>
      // Test results container
      const results = document.getElementById("test-results");

      function logResult(message, success = true) {
        const div = document.createElement("div");
        div.style.color = success ? "green" : "red";
        div.textContent = message;
        results.appendChild(div);
      }

      // Test CompatibilityType fallback
      window.CompatibilityType = {
        CONFLICT: "CONFLICT",
        TENSION: "TENSION",
        HARMONY: "HARMONY",
        SYNERGY: "SYNERGY",
        CHAOS: "CHAOS",
      };

      logResult("✅ CompatibilityType fallback defined");
    </script>

    <!-- Load the fixed files -->
    <script src="public/new-analyzer/js/core/CompatibilityDataLoader.js"></script>
    <script src="public/new-analyzer/js/core/RelationshipVisualizationEngine.js"></script>

    <script>
      try {
        // Test CompatibilityDataLoader
        const loader = new CompatibilityDataLoader();
        logResult("✅ CompatibilityDataLoader instantiated successfully");

        // Test RelationshipVisualizationEngine with mock dependency
        const mockEngine = {
          analyzeTripleOSCompatibility: () => ({
            engineInterface: { type: "HARMONY", synergy: 0.8, conflict: 0.2 },
            engineSafeMode: { type: "TENSION", synergy: 0.6, conflict: 0.4 },
            interfaceSafeMode: { type: "SYNERGY", synergy: 0.9, conflict: 0.1 },
            overallSummary: "Test summary",
            overallAdvice: "Test advice",
          }),
        };

        const visualEngine = new RelationshipVisualizationEngine(mockEngine);
        logResult(
          "✅ RelationshipVisualizationEngine instantiated successfully"
        );

        // Test basic functionality
        const result = visualEngine.analyzeRelationships(1, 2, 3);
        if (result && result.interactionData && result.balanceChartData) {
          logResult(
            "✅ RelationshipVisualizationEngine.analyzeRelationships works correctly"
          );
        } else {
          logResult(
            "❌ RelationshipVisualizationEngine.analyzeRelationships failed",
            false
          );
        }
      } catch (error) {
        logResult(`❌ Error: ${error.message}`, false);
        console.error("Test error:", error);
      }
    </script>
  </body>
</html>
