# 🚨 TRAE必読ガイドライン - 作業前必須確認事項

## ⚠️ 重要な注意
**このドキュメントは、TRAEが任意のタスクを開始する前に必ず読み、理解し、遵守しなければならない必須ガイドラインです。**

---

## 🔒 作業開始前の必須チェック

### 1. 📋 このドキュメントの確認
- [ ] このドキュメント全体を読了した
- [ ] 重複作業防止原則を理解した
- [ ] フォルダー構造保護ルールを理解した
- [ ] 必須確認項目をチェックした

### 2. 🔍 既存環境の調査
- [ ] 対象ファイルの現在の状態を確認した
- [ ] 関連するファイルの存在を確認した
- [ ] データ構造の整合性を確認した
- [ ] 依存関係を把握した

### 3. 📝 作業計画の策定
- [ ] 変更範囲を明確に定義した
- [ ] 既存機能への影響を評価した
- [ ] テスト方法を計画した
- [ ] ロールバック方法を準備した

---

## 🚫 絶対禁止事項

### ❌ 重複作業の防止
1. **既存ファイルと同じ機能のファイルを作成しない**
2. **既存のデータ構造と重複するものを作成しない**
3. **既存のAPI/関数と同じ名前のものを作成しない**
4. **既存のCSSクラスと競合するものを作成しない**

### ❌ フォルダー構造の保護
1. **既存のディレクトリ構造を勝手に変更しない**
2. **ファイルの移動は事前確認なしに行わない**
3. **新しいディレクトリの作成は最小限に留める**
4. **既存の命名規則に従う**

### ❌ 無断変更の禁止
1. **既存ファイルの内容確認なしに編集しない**
2. **全体設計に影響する変更を行わない**
3. **他の機能に影響する変更は事前評価する**
4. **設定ファイルの変更は慎重に行う**

---

## ✅ 必須実行手順

### Step 1: 環境調査（必須）
```bash
# 1. 対象ファイルの確認
ls -la [対象パス]

# 2. 関連ファイルの検索
find . -name "*[キーワード]*" -type f

# 3. 既存実装の確認
grep -r "[関数名/クラス名]" ./
```

### Step 2: 重複チェック（必須）
```bash
# 1. 同名ファイルの確認
find . -name "[新規ファイル名]" -type f

# 2. 同名関数の確認
grep -r "function [関数名]" ./

# 3. 同名クラスの確認
grep -r "class [クラス名]" ./
```

### Step 3: 影響範囲評価（必須）
- 変更対象ファイルを使用している箇所を特定
- データフローへの影響を評価
- 既存テストへの影響を確認
- パフォーマンスへの影響を評価

### Step 4: 実装（制約付き）
- **最小限の変更**で目標を達成
- **既存コードスタイル**に合わせる
- **適切なエラーハンドリング**を実装
- **十分なコメント**を追加

### Step 5: 検証（必須）
- 新機能の動作確認
- 既存機能の動作確認
- エラーログの確認
- パフォーマンステスト

---

## 📋 作業報告テンプレート

### 作業開始報告
```
【作業開始】: [タスク名]
【必須確認完了】: ✅ TRAE_MANDATORY_READ.md を確認済み
【環境調査結果】: [既存ファイル/関数/クラスの確認結果]
【重複チェック結果】: [重複なし/重複あり（詳細）]
【影響範囲評価】: [変更による影響範囲]
【実装計画】: [具体的な実装方法]
```

### 作業完了報告
```
【作業完了】: [タスク名]
【変更ファイル】: [変更したファイル一覧]
【実装内容】: [具体的な変更内容]
【テスト結果】: [動作確認結果]
【重複確認】: ✅ 新規作成物に重複なし
【構造保護】: ✅ フォルダー構造変更なし
```

---

## 🔧 自動チェック用コマンド

### 重複チェックスクリプト
```bash
#!/bin/bash
# 新規作成前の重複チェック
echo "=== 重複チェック開始 ==="
echo "ファイル名: $1"
find . -name "$1" -type f
echo "関数名: $2"
grep -r "function $2" ./ || echo "重複なし"
echo "=== チェック完了 ==="
```

### 構造保護チェック
```bash
#!/bin/bash
# フォルダー構造の変更検出
git status --porcelain | grep "^R" && echo "⚠️ ファイル移動検出" || echo "✅ 構造変更なし"
```

---

## 📚 参考ドキュメント

1. **詳細作業指示書**: `docs/20250819_TRAE作業指示書テンプレート.md`
2. **プロジェクト構造**: `docs/architecture/`
3. **API仕様**: `docs/api/`
4. **開発ガイド**: `docs/development/`

---

## ⚠️ 違反時の対応

### 重複作成を検出した場合
1. **即座に作業を停止**
2. **既存の実装を確認**
3. **既存実装の拡張で対応可能か検討**
4. **新規作成が必要な場合は命名を変更**

### 構造変更を検出した場合
1. **変更を元に戻す**
2. **既存構造内での解決方法を検討**
3. **どうしても必要な場合は事前相談**

---

## 🎯 成功のための心得

1. **「既存を活用」を最優先に考える**
2. **「最小限の変更」で最大の効果を目指す**
3. **「破壊より創造」ではなく「調和と拡張」**
4. **「独立より統合」を重視する**
5. **「確認してから実行」を徹底する**

---

**🚨 重要**: このガイドラインに従わない作業は、プロジェクトの整合性を損なう可能性があります。必ず遵守してください。