# 📋 TRAE向けフェーズ2実装指示書 - Triple OS関係性の可視化

## 🎯 フェーズ2の目標

フェーズ1で実装した基本的なOSカード表示に加えて、**3つのOSの関係性とバランスを視覚的に表現**し、より深い自己理解を促進する機能を実装します。

## 📊 実装内容の概要

### Phase 2の3つの主要機能
1. **バランスチャート** - レーダーチャートでOSバランスを可視化
2. **相互作用分析** - OS間のシナジー効果を分析・表示
3. **統合分析サマリー** - 全体的な人格傾向の要約

## 🔧 技術要件

### 必要なライブラリ
```html
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
```

## 📝 詳細実装タスク分解表

### タスク1: DetailedAnalysisTabの基本構造実装

#### 1.1 HTMLテンプレート生成
**ファイル:** `/public/js/components/tabs/DetailedAnalysisTab.js`

```javascript
class DetailedAnalysisTab extends BaseTabView {
    constructor() {
        super('detailed-analysis');
        this.analysisData = null;
        this.chart = null;
    }

    generateContent() {
        return `
            <div class="detailed-analysis-container">
                <!-- ヘッダー -->
                <div class="analysis-header">
                    <h2 class="analysis-title">
                        <span class="title-icon">🔍</span>
                        Triple OS 詳細分析
                    </h2>
                    <p class="analysis-subtitle">
                        あなたの3つのOSのバランスと相互作用を深く理解しましょう
                    </p>
                </div>

                <!-- バランスチャートセクション -->
                <div class="balance-chart-section">
                    <h3 class="section-title">
                        <span class="section-icon">📊</span>
                        OSバランスチャート
                    </h3>
                    <div class="chart-container">
                        <canvas id="balanceChart" width="400" height="400"></canvas>
                    </div>
                    <div class="balance-interpretation" id="balanceInterpretation">
                        <!-- バランス解釈がここに表示される -->
                    </div>
                </div>

                <!-- 相互作用分析セクション -->
                <div class="synergy-analysis-section">
                    <h3 class="section-title">
                        <span class="section-icon">🔄</span>
                        OS間の相互作用
                    </h3>
                    <div class="synergy-cards" id="synergyCards">
                        <!-- シナジーカードがここに表示される -->
                    </div>
                </div>

                <!-- 統合分析サマリーセクション -->
                <div class="integrated-summary-section">
                    <h3 class="section-title">
                        <span class="section-icon">💎</span>
                        統合分析サマリー
                    </h3>
                    <div class="summary-panel" id="summaryPanel">
                        <!-- サマリーパネルがここに表示される -->
                    </div>
                </div>

                <!-- アクションプランセクション -->
                <div class="action-plan-section">
                    <h3 class="section-title">
                        <span class="section-icon">🎯</span>
                        推奨アクションプラン
                    </h3>
                    <div class="action-cards" id="actionCards">
                        <!-- アクションカードがここに表示される -->
                    </div>
                </div>
            </div>
        `;
    }
}
```

### タスク2: レーダーチャート実装

#### 2.1 チャート描画メソッド
```javascript
renderBalanceChart() {
    const canvas = document.getElementById('balanceChart');
    if (!canvas || !this.analysisData) return;

    // 既存のチャートがあれば破棄
    if (this.chart) {
        this.chart.destroy();
    }

    const ctx = canvas.getContext('2d');
    
    // データ準備
    const scores = [
        this.analysisData.engineOS.score,
        this.analysisData.interfaceOS.score,
        this.analysisData.safeModeOS.score
    ];

    // Chart.js設定
    this.chart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: [
                'Engine OS\n(内的動機)',
                'Interface OS\n(社会性)',
                'Safe Mode OS\n(安定性)'
            ],
            datasets: [{
                label: 'あなたのバランス',
                data: scores,
                fill: true,
                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                borderColor: 'rgb(59, 130, 246)',
                pointBackgroundColor: 'rgb(59, 130, 246)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(59, 130, 246)',
                borderWidth: 2
            }, {
                label: '理想的なバランス',
                data: [75, 75, 75],
                fill: true,
                backgroundColor: 'rgba(34, 197, 94, 0.1)',
                borderColor: 'rgba(34, 197, 94, 0.5)',
                pointBackgroundColor: 'rgba(34, 197, 94, 0.5)',
                pointBorderColor: '#fff',
                borderWidth: 1,
                borderDash: [5, 5]
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        font: {
                            size: 12
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.dataset.label + ': ' + context.parsed.r + '点';
                        }
                    }
                }
            },
            scales: {
                r: {
                    angleLines: {
                        display: true,
                        color: 'rgba(0, 0, 0, 0.1)'
                    },
                    suggestedMin: 0,
                    suggestedMax: 100,
                    ticks: {
                        stepSize: 20,
                        font: {
                            size: 10
                        }
                    },
                    pointLabels: {
                        font: {
                            size: 14,
                            weight: 'bold'
                        }
                    }
                }
            }
        }
    });
}
```

### タスク3: バランス解釈の表示

#### 3.1 バランスタイプ判定と表示
```javascript
renderBalanceInterpretation() {
    const container = document.getElementById('balanceInterpretation');
    if (!container || !this.analysisData) return;

    const scores = [
        this.analysisData.engineOS.score,
        this.analysisData.interfaceOS.score,
        this.analysisData.safeModeOS.score
    ];

    const balanceType = this.determineBalanceType(scores);
    
    container.innerHTML = `
        <div class="balance-type-card ${balanceType.className}">
            <div class="balance-type-header">
                <span class="balance-type-icon">${balanceType.icon}</span>
                <h4 class="balance-type-title">${balanceType.title}</h4>
            </div>
            <p class="balance-type-description">${balanceType.description}</p>
            <div class="balance-metrics">
                <div class="metric">
                    <span class="metric-label">バランス度</span>
                    <span class="metric-value">${balanceType.balanceScore}%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">最強OS</span>
                    <span class="metric-value">${balanceType.dominantOS}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">改善余地</span>
                    <span class="metric-value">${balanceType.improvementArea}</span>
                </div>
            </div>
            <div class="balance-advice">
                <p class="advice-label">💡 アドバイス</p>
                <p class="advice-text">${balanceType.advice}</p>
            </div>
        </div>
    `;
}

determineBalanceType(scores) {
    const max = Math.max(...scores);
    const min = Math.min(...scores);
    const diff = max - min;
    const avg = scores.reduce((a, b) => a + b, 0) / 3;
    
    // 最強OSの特定
    const osNames = ['Engine OS', 'Interface OS', 'Safe Mode OS'];
    const maxIndex = scores.indexOf(max);
    const minIndex = scores.indexOf(min);
    
    if (diff < 10) {
        return {
            className: 'balanced',
            icon: '⚖️',
            title: '完全バランス型',
            description: '3つのOSが非常に調和した状態です。状況に応じて柔軟に対応できる理想的なバランスを保っています。',
            balanceScore: 95,
            dominantOS: 'なし（均等）',
            improvementArea: '現状維持',
            advice: 'このバランスを維持しながら、各OSをさらに高めていくことで、より高次元での調和が実現できます。'
        };
    } else if (diff < 20) {
        return {
            className: 'semi-balanced',
            icon: '🎯',
            title: `${osNames[maxIndex]}リード型`,
            description: `${osNames[maxIndex]}がやや優位ながら、全体的にバランスの取れた状態です。`,
            balanceScore: 75,
            dominantOS: osNames[maxIndex],
            improvementArea: osNames[minIndex],
            advice: `${osNames[minIndex]}を意識的に活用する機会を増やすことで、さらなるバランス改善が期待できます。`
        };
    } else {
        return {
            className: 'specialized',
            icon: '🚀',
            title: `${osNames[maxIndex]}特化型`,
            description: `${osNames[maxIndex]}が突出して強い、専門性の高い状態です。`,
            balanceScore: 50,
            dominantOS: osNames[maxIndex],
            improvementArea: osNames[minIndex],
            advice: `${osNames[minIndex]}の強化に注力することで、より安定した人格バランスを構築できます。`
        };
    }
}
```

### タスク4: 相互作用分析の実装

#### 4.1 シナジー効果の分析と表示
```javascript
renderSynergyAnalysis() {
    const container = document.getElementById('synergyCards');
    if (!container || !this.analysisData) return;

    const synergyPairs = [
        {
            pair: 'Engine × Interface',
            os1: this.analysisData.engineOS,
            os2: this.analysisData.interfaceOS,
            icon: '⚡🔄',
            title: '創造的コミュニケーション',
            description: '内的動機と社会性の融合'
        },
        {
            pair: 'Interface × Safe Mode',
            os1: this.analysisData.interfaceOS,
            os2: this.analysisData.safeModeOS,
            icon: '🔄🛡️',
            title: '安定的な関係構築',
            description: '社会性と安定性の調和'
        },
        {
            pair: 'Engine × Safe Mode',
            os1: this.analysisData.engineOS,
            os2: this.analysisData.safeModeOS,
            icon: '⚡🛡️',
            title: '持続可能な成長',
            description: '創造性と安定性のバランス'
        }
    ];

    const synergyHTML = synergyPairs.map(synergy => {
        const synergyScore = this.calculateSynergyScore(synergy.os1.score, synergy.os2.score);
        const synergyLevel = this.getSynergyLevel(synergyScore);
        
        return `
            <div class="synergy-card">
                <div class="synergy-header">
                    <span class="synergy-icon">${synergy.icon}</span>
                    <h4 class="synergy-title">${synergy.title}</h4>
                </div>
                <div class="synergy-pair-info">
                    <span class="pair-label">${synergy.pair}</span>
                    <span class="synergy-score ${synergyLevel.class}">${synergyScore}%</span>
                </div>
                <p class="synergy-description">${synergy.description}</p>
                <div class="synergy-gauge">
                    <div class="gauge-fill" style="width: ${synergyScore}%; background: ${synergyLevel.color}"></div>
                </div>
                <p class="synergy-status">${synergyLevel.message}</p>
                <div class="synergy-advice">
                    <p>${this.getSynergyAdvice(synergy.pair, synergyScore)}</p>
                </div>
            </div>
        `;
    }).join('');

    container.innerHTML = synergyHTML;
}

calculateSynergyScore(score1, score2) {
    // 両方のスコアが高いほどシナジーが強い
    const avg = (score1 + score2) / 2;
    const diff = Math.abs(score1 - score2);
    
    // 差が小さいほどボーナス
    const balanceBonus = Math.max(0, 20 - diff);
    
    return Math.min(100, Math.round(avg + balanceBonus / 2));
}

getSynergyLevel(score) {
    if (score >= 80) {
        return {
            class: 'excellent',
            color: '#10B981',
            message: '✨ 優れたシナジー効果'
        };
    } else if (score >= 65) {
        return {
            class: 'good',
            color: '#3B82F6',
            message: '👍 良好なシナジー'
        };
    } else if (score >= 50) {
        return {
            class: 'moderate',
            color: '#F59E0B',
            message: '📈 成長の余地あり'
        };
    } else {
        return {
            class: 'weak',
            color: '#EF4444',
            message: '⚠️ 強化が必要'
        };
    }
}

getSynergyAdvice(pair, score) {
    const adviceMap = {
        'Engine × Interface': {
            high: 'あなたの創造性と社交性が見事に調和しています。革新的なアイデアを効果的に伝えることができます。',
            medium: 'アイデアを人に伝える練習をすることで、より大きな成果を生み出せます。',
            low: '内なる創造性を表現する方法を探してみましょう。小さなグループから始めることをお勧めします。'
        },
        'Interface × Safe Mode': {
            high: '人間関係において安定感と信頼感を与えることができます。長期的な関係構築が得意です。',
            medium: '人との関わりにおいて、もう少しリスクを取ってみても良いかもしれません。',
            low: '社交の場での安心感を高めるため、準備と練習を重視しましょう。'
        },
        'Engine × Safe Mode': {
            high: '革新性と安定性のバランスが取れており、持続可能な成長が可能です。',
            medium: '時には快適圏から出て新しいチャレンジをすることで、さらなる成長が期待できます。',
            low: '創造的な活動に安全な環境を作ることから始めてみましょう。'
        }
    };

    const level = score >= 70 ? 'high' : score >= 50 ? 'medium' : 'low';
    return adviceMap[pair][level];
}
```

### タスク5: 統合分析サマリーの実装

#### 5.1 総合的な分析結果の表示
```javascript
renderIntegratedSummary() {
    const container = document.getElementById('summaryPanel');
    if (!container || !this.analysisData) return;

    // 各種分析データの収集
    const totalScore = Math.round(
        (this.analysisData.engineOS.score + 
         this.analysisData.interfaceOS.score + 
         this.analysisData.safeModeOS.score) / 3
    );

    const strengths = this.identifyStrengths();
    const challenges = this.identifyChallenges();
    const potential = this.assessPotential();

    container.innerHTML = `
        <div class="integrated-summary-card">
            <!-- 総合スコアセクション -->
            <div class="overall-score-section">
                <div class="score-circle">
                    <svg width="120" height="120">
                        <circle cx="60" cy="60" r="50" fill="none" stroke="#E5E7EB" stroke-width="10"/>
                        <circle cx="60" cy="60" r="50" fill="none" 
                                stroke="${this.getScoreColor(totalScore)}" 
                                stroke-width="10"
                                stroke-dasharray="${totalScore * 3.14} 314"
                                stroke-dashoffset="0"
                                transform="rotate(-90 60 60)"/>
                    </svg>
                    <div class="score-text">
                        <span class="score-value">${totalScore}</span>
                        <span class="score-label">総合力</span>
                    </div>
                </div>
            </div>

            <!-- 強みセクション -->
            <div class="strengths-section">
                <h5 class="section-subtitle">
                    <span class="subtitle-icon">💪</span>
                    あなたの強み
                </h5>
                <ul class="strength-list">
                    ${strengths.map(s => `
                        <li class="strength-item">
                            <span class="strength-icon">${s.icon}</span>
                            <div>
                                <strong>${s.title}</strong>
                                <p>${s.description}</p>
                            </div>
                        </li>
                    `).join('')}
                </ul>
            </div>

            <!-- 課題セクション -->
            <div class="challenges-section">
                <h5 class="section-subtitle">
                    <span class="subtitle-icon">🎯</span>
                    成長の機会
                </h5>
                <ul class="challenge-list">
                    ${challenges.map(c => `
                        <li class="challenge-item">
                            <span class="challenge-icon">${c.icon}</span>
                            <div>
                                <strong>${c.title}</strong>
                                <p>${c.description}</p>
                            </div>
                        </li>
                    `).join('')}
                </ul>
            </div>

            <!-- ポテンシャルセクション -->
            <div class="potential-section">
                <h5 class="section-subtitle">
                    <span class="subtitle-icon">🌟</span>
                    潜在的な可能性
                </h5>
                <div class="potential-message">
                    <p>${potential.message}</p>
                    <div class="potential-badges">
                        ${potential.badges.map(badge => `
                            <span class="potential-badge ${badge.class}">
                                ${badge.icon} ${badge.label}
                            </span>
                        `).join('')}
                    </div>
                </div>
            </div>
        </div>
    `;
}

identifyStrengths() {
    const strengths = [];
    const data = this.analysisData;

    // 各OSのスコアに基づいて強みを特定
    if (data.engineOS.score >= 70) {
        strengths.push({
            icon: '🚀',
            title: '高い創造性',
            description: '独創的なアイデアと内的動機により、革新的な解決策を生み出せます'
        });
    }
    
    if (data.interfaceOS.score >= 70) {
        strengths.push({
            icon: '🤝',
            title: '優れた社交性',
            description: '人との関わりを大切にし、協力的な関係を構築できます'
        });
    }
    
    if (data.safeModeOS.score >= 70) {
        strengths.push({
            icon: '🏰',
            title: '安定した基盤',
            description: '慎重で計画的な行動により、着実な成果を生み出せます'
        });
    }

    // バランスが良い場合の強み
    const scores = [data.engineOS.score, data.interfaceOS.score, data.safeModeOS.score];
    if (Math.max(...scores) - Math.min(...scores) < 15) {
        strengths.push({
            icon: '⚖️',
            title: '優れたバランス感覚',
            description: '状況に応じて適切なOSを活用できる柔軟性があります'
        });
    }

    return strengths.slice(0, 3); // 最大3つまで表示
}

identifyChallenges() {
    const challenges = [];
    const data = this.analysisData;

    // 低スコアのOSを課題として特定
    if (data.engineOS.score < 60) {
        challenges.push({
            icon: '💡',
            title: '創造性の活性化',
            description: '新しいアイデアや独自の視点を育てる機会を増やしましょう'
        });
    }
    
    if (data.interfaceOS.score < 60) {
        challenges.push({
            icon: '👥',
            title: '社交スキルの向上',
            description: '人との繋がりを深め、コミュニケーション力を高めましょう'
        });
    }
    
    if (data.safeModeOS.score < 60) {
        challenges.push({
            icon: '🎯',
            title: '安定性の構築',
            description: '計画性と継続性を意識して、基盤を強化しましょう'
        });
    }

    return challenges.slice(0, 2); // 最大2つまで表示
}

assessPotential() {
    const totalScore = Math.round(
        (this.analysisData.engineOS.score + 
         this.analysisData.interfaceOS.score + 
         this.analysisData.safeModeOS.score) / 3
    );

    const badges = [];
    
    if (totalScore >= 75) {
        badges.push({
            icon: '🏆',
            label: 'ハイパフォーマー',
            class: 'gold'
        });
    }

    const scores = [
        this.analysisData.engineOS.score,
        this.analysisData.interfaceOS.score,
        this.analysisData.safeModeOS.score
    ];

    if (Math.max(...scores) - Math.min(...scores) < 10) {
        badges.push({
            icon: '🎯',
            label: 'バランスマスター',
            class: 'purple'
        });
    }

    if (Math.max(...scores) >= 85) {
        badges.push({
            icon: '⭐',
            label: 'スペシャリスト',
            class: 'blue'
        });
    }

    return {
        message: this.getPotentialMessage(totalScore),
        badges: badges
    };
}

getPotentialMessage(totalScore) {
    if (totalScore >= 80) {
        return 'あなたは非常に高いポテンシャルを持っています。現在の強みを活かしながら、さらなる高みを目指すことができます。リーダーシップを発揮する機会を積極的に求めてください。';
    } else if (totalScore >= 70) {
        return 'バランスの取れた能力を持っています。特定の分野に特化することで、専門性を高めることができるでしょう。自己成長への投資を続けてください。';
    } else if (totalScore >= 60) {
        return '成長の可能性が大いにあります。弱点を改善しながら、強みを伸ばすことで、大きな飛躍が期待できます。小さな成功体験を積み重ねていきましょう。';
    } else {
        return '基礎から着実に力をつけていく段階です。焦らず、一歩ずつ前進することで、必ず成長できます。サポートを求めることも大切です。';
    }
}

getScoreColor(score) {
    if (score >= 80) return '#10B981';
    if (score >= 70) return '#3B82F6';
    if (score >= 60) return '#F59E0B';
    return '#EF4444';
}
```

### タスク6: アクションプランの生成

#### 6.1 具体的な行動提案
```javascript
renderActionPlan() {
    const container = document.getElementById('actionCards');
    if (!container || !this.analysisData) return;

    const actionPlans = this.generateActionPlans();
    
    const actionHTML = actionPlans.map((plan, index) => `
        <div class="action-card priority-${plan.priority}">
            <div class="action-header">
                <span class="action-number">${index + 1}</span>
                <span class="action-priority-badge">${plan.priorityLabel}</span>
            </div>
            <h4 class="action-title">${plan.title}</h4>
            <p class="action-description">${plan.description}</p>
            <div class="action-steps">
                <p class="steps-label">実践ステップ:</p>
                <ol class="steps-list">
                    ${plan.steps.map(step => `<li>${step}</li>`).join('')}
                </ol>
            </div>
            <div class="action-timeline">
                <span class="timeline-icon">📅</span>
                <span class="timeline-text">${plan.timeline}</span>
            </div>
        </div>
    `).join('');

    container.innerHTML = actionHTML;
}

generateActionPlans() {
    const plans = [];
    const data = this.analysisData;
    
    // 最も低いスコアのOSを優先的に改善
    const osData = [
        { name: 'Engine OS', score: data.engineOS.score, type: 'engine' },
        { name: 'Interface OS', score: data.interfaceOS.score, type: 'interface' },
        { name: 'Safe Mode OS', score: data.safeModeOS.score, type: 'safemode' }
    ].sort((a, b) => a.score - b.score);

    // 最も改善が必要なOSのアクションプラン
    const weakestOS = osData[0];
    if (weakestOS.type === 'engine') {
        plans.push({
            priority: 'high',
            priorityLabel: '優先度: 高',
            title: 'Engine OSの活性化',
            description: '創造性と内的動機を高めるための取り組み',
            steps: [
                '毎日15分、自由な発想でアイデアを書き出す',
                '新しい趣味や興味のある分野に挑戦する',
                '定期的に一人の時間を作り、内省する'
            ],
            timeline: '今週から開始・3週間継続'
        });
    } else if (weakestOS.type === 'interface') {
        plans.push({
            priority: 'high',
            priorityLabel: '優先度: 高',
            title: 'Interface OSの強化',
            description: '社交性とコミュニケーション能力の向上',
            steps: [
                '週に1回は新しい人と会話する機会を作る',
                'アクティブリスニングを意識的に実践',
                'グループ活動やコミュニティに参加'
            ],
            timeline: '今週から開始・1ヶ月継続'
        });
    } else {
        plans.push({
            priority: 'high',
            priorityLabel: '優先度: 高',
            title: 'Safe Mode OSの安定化',
            description: '心理的安全性と計画性の確立',
            steps: [
                '毎朝のルーティンを確立する',
                '週次・月次の振り返り時間を設ける',
                'ストレス管理のための瞑想や運動を習慣化'
            ],
            timeline: '明日から開始・2週間で習慣化'
        });
    }

    // バランス改善のアクションプラン
    const scores = [data.engineOS.score, data.interfaceOS.score, data.safeModeOS.score];
    const diff = Math.max(...scores) - Math.min(...scores);
    
    if (diff > 20) {
        plans.push({
            priority: 'medium',
            priorityLabel: '優先度: 中',
            title: 'OSバランスの調整',
            description: '3つのOSの調和を促進する統合的アプローチ',
            steps: [
                '1日の中で各OSを意識的に切り替える練習',
                '異なるOSが求められる場面を記録・分析',
                'バランスを意識した週間スケジュールの作成'
            ],
            timeline: '2週間後から開始'
        });
    }

    // 強みを活かすアクションプラン
    const strongestOS = osData[2];
    plans.push({
        priority: 'low',
        priorityLabel: '優先度: 低',
        title: `${strongestOS.name}の更なる発展`,
        description: '既存の強みを最大限に活用する戦略',
        steps: [
            '強みを活かせる新しいプロジェクトに参加',
            '他者の同じOSの発展をサポート',
            '専門性を深めるための学習機会を探す'
        ],
        timeline: '1ヶ月後から検討'
    });

    return plans.slice(0, 3); // 最大3つのプランを返す
}
```

### タスク7: CSSスタイルの実装

#### 7.1 詳細分析タブ用スタイル
**ファイル:** `/public/css/detailed-analysis.css` (新規作成)

```css
/* 詳細分析コンテナ */
.detailed-analysis-container {
    padding: 32px;
    max-width: 1200px;
    margin: 0 auto;
}

/* セクション共通スタイル */
.balance-chart-section,
.synergy-analysis-section,
.integrated-summary-section,
.action-plan-section {
    margin-bottom: 48px;
    background: white;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

/* チャートコンテナ */
.chart-container {
    position: relative;
    height: 400px;
    max-width: 400px;
    margin: 24px auto;
}

/* バランス解釈カード */
.balance-type-card {
    background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
    border-radius: 12px;
    padding: 20px;
    margin-top: 24px;
    border-left: 4px solid;
}

.balance-type-card.balanced {
    border-left-color: #10B981;
}

.balance-type-card.semi-balanced {
    border-left-color: #3B82F6;
}

.balance-type-card.specialized {
    border-left-color: #F59E0B;
}

/* バランスメトリクス */
.balance-metrics {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin: 20px 0;
}

.metric {
    text-align: center;
    padding: 12px;
    background: white;
    border-radius: 8px;
}

.metric-label {
    display: block;
    font-size: 12px;
    color: #6B7280;
    margin-bottom: 4px;
}

.metric-value {
    display: block;
    font-size: 20px;
    font-weight: 600;
    color: #1E293B;
}

/* シナジーカード */
.synergy-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.synergy-card {
    background: white;
    border: 2px solid #E5E7EB;
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s ease;
}

.synergy-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.synergy-gauge {
    width: 100%;
    height: 8px;
    background: #E5E7EB;
    border-radius: 4px;
    overflow: hidden;
    margin: 12px 0;
}

.gauge-fill {
    height: 100%;
    transition: width 0.6s ease;
    border-radius: 4px;
}

/* 統合サマリーカード */
.integrated-summary-card {
    background: white;
    border-radius: 12px;
    padding: 24px;
}

.overall-score-section {
    text-align: center;
    margin-bottom: 32px;
}

.score-circle {
    position: relative;
    display: inline-block;
}

.score-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.score-value {
    display: block;
    font-size: 32px;
    font-weight: 700;
    color: #1E293B;
}

.score-label {
    display: block;
    font-size: 12px;
    color: #6B7280;
}

/* 強み・課題リスト */
.strength-list,
.challenge-list {
    list-style: none;
    padding: 0;
    margin: 16px 0;
}

.strength-item,
.challenge-item {
    display: flex;
    align-items: start;
    gap: 12px;
    padding: 12px;
    margin-bottom: 12px;
    background: #F9FAFB;
    border-radius: 8px;
}

.strength-icon,
.challenge-icon {
    font-size: 24px;
    flex-shrink: 0;
}

/* ポテンシャルバッジ */
.potential-badges {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 16px;
}

.potential-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    color: white;
}

.potential-badge.gold {
    background: linear-gradient(135deg, #F59E0B, #D97706);
}

.potential-badge.purple {
    background: linear-gradient(135deg, #8B5CF6, #7C3AED);
}

.potential-badge.blue {
    background: linear-gradient(135deg, #3B82F6, #2563EB);
}

/* アクションカード */
.action-cards {
    display: grid;
    gap: 20px;
}

.action-card {
    background: white;
    border: 2px solid #E5E7EB;
    border-radius: 12px;
    padding: 20px;
    position: relative;
    overflow: hidden;
}

.action-card.priority-high {
    border-left: 4px solid #EF4444;
}

.action-card.priority-medium {
    border-left: 4px solid #F59E0B;
}

.action-card.priority-low {
    border-left: 4px solid #10B981;
}

.action-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.action-number {
    width: 32px;
    height: 32px;
    background: #3B82F6;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
}

.action-priority-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
    background: #FEF3C7;
    color: #92400E;
}

.action-steps {
    background: #F9FAFB;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
}

.steps-label {
    font-size: 12px;
    font-weight: 600;
    color: #6B7280;
    margin-bottom: 8px;
}

.steps-list {
    margin: 0;
    padding-left: 20px;
    font-size: 14px;
    line-height: 1.8;
    color: #4B5563;
}

.action-timeline {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #6B7280;
    font-size: 14px;
}

/* レスポンシブ対応 */
@media (max-width: 768px) {
    .detailed-analysis-container {
        padding: 16px;
    }

    .balance-metrics {
        grid-template-columns: 1fr;
    }

    .synergy-cards {
        grid-template-columns: 1fr;
    }

    .chart-container {
        height: 300px;
    }
}
```

### タスク8: results.htmlへの統合

#### 8.1 必要なファイルの読み込み追加
**ファイル:** `/public/results.html` に以下を追加

```html
<!-- Chart.js CDN（<head>セクション内に追加） -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

<!-- 詳細分析用CSS（他のCSSの後に追加） -->
<link rel="stylesheet" href="css/detailed-analysis.css">
```

#### 8.2 DetailedAnalysisTabの初期化修正
```javascript
// 詳細分析タブの初期化（既存のコードを以下で置き換え）
if (typeof DetailedAnalysisTab !== 'undefined') {
    const detailedAnalysisTab = new DetailedAnalysisTab();
    detailedAnalysisTab.setData(analysisResult);
    
    // タブが表示された時にチャートを描画
    detailedAnalysisTab.onActivate = function() {
        BaseTabView.prototype.onActivate.call(this);
        setTimeout(() => {
            this.renderBalanceChart();
            this.renderBalanceInterpretation();
            this.renderSynergyAnalysis();
            this.renderIntegratedSummary();
            this.renderActionPlan();
        }, 100);
    };
    
    tabNavigator.registerTab('detailed', detailedAnalysisTab);
    console.log('✅ DetailedAnalysisTab initialized with Phase 2 features');
}
```

## 🎯 実装の確認ポイント

### 必須確認項目
1. ✅ レーダーチャートが正しく表示される
2. ✅ 3つのOSのバランスが視覚的に分かる
3. ✅ バランスタイプ（完全バランス型、特化型など）が判定される
4. ✅ OS間のシナジー効果が数値とゲージで表示される
5. ✅ 統合分析サマリーに強み・課題・ポテンシャルが表示される
6. ✅ 具体的なアクションプランが3つ提示される
7. ✅ チャートがレスポンシブ対応している

### デバッグ用コンソール出力
```javascript
// DetailedAnalysisTabクラスに追加
debugPhase2() {
    console.log('=== Phase 2 Debug Info ===');
    console.log('Chart Instance:', this.chart);
    console.log('Analysis Data:', this.analysisData);
    console.log('Balance Type:', this.determineBalanceType([75, 82, 68]));
    console.log('Synergy Scores:', {
        'Engine×Interface': this.calculateSynergyScore(75, 82),
        'Interface×SafeMode': this.calculateSynergyScore(82, 68),
        'Engine×SafeMode': this.calculateSynergyScore(75, 68)
    });
}
```

## 📊 期待される成果

### 画面表示
1. **レーダーチャート**: 3つのOSが三角形で表示され、理想的なバランスと比較可能
2. **バランス診断**: 「完全バランス型」「Engine OSリード型」などの診断結果
3. **シナジーカード**: 3つのペア（E×I、I×S、E×S）のシナジー効果が％表示
4. **統合サマリー**: 円形の総合スコアと強み・課題・ポテンシャルのリスト
5. **アクションプラン**: 優先度付きの具体的な行動計画3つ

### ユーザー価値
- 自分のOSバランスが一目で分かる
- 改善すべき点が明確になる
- 具体的な行動指針を得られる
- 成長の方向性が見える

## 🚀 次のステップ（フェーズ3以降）

フェーズ2が完成したら、以下の機能を追加予定:
- 透明化タブ（診断プロセスの可視化）
- 実践ガイドタブ（時間帯別の活用法）
- 相性分析機能（他者との関係性）
- エクスポート機能（PDF出力）

## 確認方法

```bash
# サーバー起動
python3 -m http.server 8012

# ブラウザで確認
http://localhost:8012/public/results.html

# 「詳細分析を見る」タブをクリック
```

レーダーチャートが表示され、各種分析結果が確認できれば成功です！