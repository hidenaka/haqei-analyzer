# 📋 TRAE実装指示書 - データドリブン個別化システム

## 🎯 実装目的

HAQEIの本来コンセプト「**独自ロジックによる科学的分析**」に基づき、占い的な一般論を排除し、ユーザーの実データから導出される個別化された洞察を提供する。

## ⚠️ 重要な方針変更

### 削除する要素
- ❌ 成長のヒント（一般的すぎる助言）
- ❌ 占い的な表現（「〜しましょう」）
- ❌ 固定的なアドバイス

### 追加する要素
- ✅ データに基づく傾向分析
- ✅ 回答パターンからの洞察
- ✅ H384データベースを活用した具体的分析

## 📝 実装タスク一覧

### Phase 1: BasicResultsTabの改修（優先度: 最高）

#### タスク1.1: 成長のヒント機能を削除して傾向分析に置換

**ファイル**: `/public/js/components/tabs/BasicResultsTab.js`

**削除する関数**:
```javascript
// この関数を完全削除
generateGrowthTips(osType, score) { ... }
```

**新規追加する関数**:
```javascript
/**
 * ユーザーの回答パターンから傾向を分析
 * @param {Object} osData - OSのデータ（hexagram, score, traits等）
 * @param {Array} userAnswers - ユーザーの回答データ
 * @returns {Object} 分析された傾向情報
 */
analyzeTendencies(osData, userAnswers) {
    // H384データベースから関連データを取得
    const hexagramData = this.hexagramExtractor?.getHexagramDataByName(osData.hexagram.name);
    
    // 爻ごとのキーワードを収集
    const keywords = new Set();
    if (hexagramData && hexagramData.length > 0) {
        hexagramData.forEach(yao => {
            if (yao['キーワード']) {
                yao['キーワード'].split('・').forEach(kw => keywords.add(kw.trim()));
            }
        });
    }
    
    // スコアに基づく傾向判定
    const tendencyLevel = this.determineTendencyLevel(osData.score);
    
    // 実際の回答パターンから特徴を抽出
    const patterns = this.extractAnswerPatterns(userAnswers, osData.type);
    
    return {
        keywords: Array.from(keywords).slice(0, 5),
        level: tendencyLevel,
        patterns: patterns,
        hexagramMeaning: this.getHexagramCoreMeaning(osData.hexagram.name)
    };
}

/**
 * スコアから傾向レベルを判定
 */
determineTendencyLevel(score) {
    if (score >= 80) {
        return {
            intensity: '非常に強い',
            description: 'この特性があなたの中核を形成しています'
        };
    } else if (score >= 70) {
        return {
            intensity: '明確',
            description: 'はっきりとした傾向として現れています'
        };
    } else if (score >= 60) {
        return {
            intensity: '標準的',
            description: '多くの人と同程度の強さで現れています'
        };
    } else {
        return {
            intensity: '潜在的',
            description: 'まだ表面化していない可能性があります'
        };
    }
}

/**
 * 回答パターンから具体的な特徴を抽出
 */
extractAnswerPatterns(userAnswers, osType) {
    const patterns = [];
    
    // OSタイプごとに関連する質問を分析
    switch(osType) {
        case 'engineOS':
            // Q1-Q8: 価値観・内的動機に関する質問の回答を分析
            const innerValues = this.analyzeInnerValues(userAnswers.slice(0, 8));
            patterns.push(...innerValues);
            break;
            
        case 'interfaceOS':
            // Q9-Q16: 対人関係・社会的側面の回答を分析
            const socialPatterns = this.analyzeSocialPatterns(userAnswers.slice(8, 16));
            patterns.push(...socialPatterns);
            break;
            
        case 'safeModeOS':
            // Q17-Q24: リスク回避・安定性に関する回答を分析
            const safetyPatterns = this.analyzeSafetyPatterns(userAnswers.slice(16, 24));
            patterns.push(...safetyPatterns);
            break;
    }
    
    return patterns.slice(0, 3); // 最も顕著な3つのパターンを返す
}

/**
 * 内的価値観の分析
 */
analyzeInnerValues(answers) {
    const patterns = [];
    const highScoreAnswers = answers.filter(a => a.score >= 4);
    const lowScoreAnswers = answers.filter(a => a.score <= 2);
    
    if (highScoreAnswers.length > 5) {
        patterns.push('強い内的動機に従って行動する');
    }
    if (lowScoreAnswers.length > 3) {
        patterns.push('外部からの影響を受けやすい');
    }
    
    // 具体的な価値観の傾向を分析
    const creativityScore = answers[0].score + answers[2].score; // 創造性関連
    const independenceScore = answers[1].score + answers[3].score; // 独立性関連
    
    if (creativityScore >= 8) {
        patterns.push('創造的な活動で力を発揮');
    }
    if (independenceScore >= 8) {
        patterns.push('自立的な判断を重視');
    }
    
    return patterns;
}

/**
 * 社会的パターンの分析
 */
analyzeSocialPatterns(answers) {
    const patterns = [];
    
    // 協調性スコア
    const cooperationScore = answers[0].score + answers[4].score;
    // リーダーシップスコア
    const leadershipScore = answers[1].score + answers[5].score;
    
    if (cooperationScore >= 8) {
        patterns.push('チームでの協働を好む');
    }
    if (leadershipScore >= 8) {
        patterns.push('リーダーシップを自然に発揮');
    }
    if (cooperationScore <= 4 && leadershipScore <= 4) {
        patterns.push('独立した作業環境を好む');
    }
    
    return patterns;
}

/**
 * 安全性パターンの分析
 */
analyzeSafetyPatterns(answers) {
    const patterns = [];
    
    // リスク回避傾向
    const riskAvoidance = answers.filter(a => a.score >= 4).length;
    // 挑戦志向
    const challengeSeeking = answers.filter(a => a.score <= 2).length;
    
    if (riskAvoidance > 5) {
        patterns.push('慎重な判断を重視');
        patterns.push('安定した環境で力を発揮');
    }
    if (challengeSeeking > 5) {
        patterns.push('新しい挑戦を積極的に受け入れる');
        patterns.push('変化に対して柔軟に対応');
    }
    
    return patterns;
}

/**
 * 易卦の核心的意味を取得（占い的表現を排除）
 */
getHexagramCoreMeaning(hexagramName) {
    const meanings = {
        '乾为天': '強い推進力と決断力',
        '坤为地': '受容性と包容力',
        '水雷屯': '困難を乗り越える粘り強さ',
        '山水蒙': '学習と成長への意欲',
        '水天需': '適切なタイミングを見極める力',
        '天水訟': '論理的思考と公正さ',
        '地水师': '組織力と統率力',
        '水地比': '協調性と親和性',
        '風天小畜': '着実な積み重ね',
        '天泽履': '礼節と社会性',
        '地天泰': '調和とバランス',
        '天地否': '停滞からの転換力',
        '天火同人': '共同体への貢献',
        '火天大有': '豊かさの実現力',
        '地山謙': '謙虚さと学習姿勢',
        '雷地豫': '楽観性と推進力',
        '沢雷随': '柔軟な適応力',
        '山風蠱': '問題解決能力',
        '地沢臨': '積極的な関与',
        '風地観': '観察力と洞察力',
        '火雷噬嗑': '決断と実行力',
        '山火賁': '美的センスと調和',
        '山地剥': '本質を見抜く力',
        '地雷復': '回復力と再生力',
        '天雷無妄': '自然体での行動',
        '山天大畜': '蓄積と準備の力',
        '山雷頤': '自己管理能力',
        '沢風大過': '限界を超える力',
        '坎为水': '深い洞察と適応',
        '離为火': '明晰さと表現力',
        '沢山咸': '感受性と共感力',
        '雷風恒': '持続性と安定性',
        '天山遯': '戦略的撤退の知恵',
        '雷天大壮': '力強い推進力',
        '火地晋': '上昇志向と成長',
        '地火明夷': '内なる光の保持',
        '風火家人': '家族的な温かさ',
        '火沢睽': '相違を理解する力',
        '水山蹇': '困難への対処力',
        '雷水解': '問題解決と解放',
        '山沢損': '必要な犠牲の理解',
        '風雷益': '相互利益の創造',
        '沢天夬': '決断と突破力',
        '天風姤': '出会いと機会',
        '沢地萃': '集合と統合の力',
        '地風升': '着実な上昇',
        '沢水困': '困難からの学び',
        '水風井': '深い知恵の源泉',
        '沢火革': '変革と革新',
        '火風鼎': '新しい創造',
        '震为雷': '行動力と活力',
        '艮为山': '安定性と不動心',
        '風山漸': '段階的な進歩',
        '雷沢帰妹': '関係性の構築',
        '雷火豊': '豊かさの実現',
        '火山旅': '柔軟な適応',
        '巽为風': '浸透力と影響力',
        '兌为泽': '喜びと交流',
        '風水渙': '分散と再編成',
        '水沢節': '節度と制限',
        '風沢中孚': '誠実さと信頼',
        '雷山小過': '細部への注意',
        '水火既済': '完成と達成',
        '火水未済': '継続的な挑戦'
    };
    
    return meanings[hexagramName] || '独自の個性';
}
```

#### タスク1.2: OSカード表示の改修

**createOSCardHTMLメソッドを以下に置換**:
```javascript
/**
 * データドリブンなOSカードHTMLを生成
 */
createOSCardHTML(osInfo, osData) {
    const explanation = this.getOSExplanation(osInfo.key);
    const scoreExplanation = this.getScoreExplanation(osData.score);
    const personality = this.translateHexagramToPersonality(osData.hexagram.name);
    
    // ユーザーの回答データを取得（StorageManagerから）
    const userAnswers = this.storageManager?.getAnswers() || [];
    
    // 傾向分析を実行
    const tendencies = this.analyzeTendencies(osData, userAnswers);
    
    return `
        <div class="os-card ${osInfo.key}">
            <!-- OSタイトル（シンプルに） -->
            <div class="os-card-header">
                <div class="os-title-section">
                    <span class="os-icon">${osInfo.icon}</span>
                    <div class="os-title-info">
                        <h3 class="os-main-title">${explanation.title}</h3>
                        <p class="os-subtitle">${explanation.subtitle}</p>
                    </div>
                </div>
                <div class="os-score-section">
                    <span class="os-score-value">${Math.round(osData.score)}</span>
                    <span class="score-level">${tendencies.level.intensity}</span>
                </div>
            </div>

            <!-- OSの説明（簡潔に） -->
            <div class="os-explanation">
                <p class="explanation-text">${explanation.description}</p>
            </div>

            <!-- スコアの意味（データに基づく） -->
            <div class="score-analysis">
                <div class="score-progress-container">
                    <div class="progress-bar" style="width: ${osData.score}%"></div>
                </div>
                <p class="score-meaning">
                    <strong>${tendencies.level.description}</strong>
                </p>
            </div>

            <!-- 性格特性（易卦の本質） -->
            <div class="personality-section">
                <div class="personality-header">
                    <span class="hexagram-symbol">${osData.hexagram.symbol}</span>
                    <div class="personality-info">
                        <h4 class="personality-type">${personality.personality}</h4>
                        <p class="hexagram-core">${tendencies.hexagramMeaning}</p>
                    </div>
                </div>
                
                <!-- データから抽出されたキーワード -->
                <div class="extracted-keywords">
                    <h5 class="keywords-title">あなたのキーワード</h5>
                    <div class="keyword-tags">
                        ${tendencies.keywords.map(keyword => 
                            `<span class="keyword-tag">${keyword}</span>`
                        ).join('')}
                    </div>
                </div>

                <!-- 回答パターンから見える傾向 -->
                <div class="tendency-analysis">
                    <h5 class="tendency-title">あなたの傾向</h5>
                    <ul class="tendency-list">
                        ${tendencies.patterns.map(pattern => 
                            `<li class="tendency-item">${pattern}</li>`
                        ).join('')}
                    </ul>
                </div>

                <!-- 特性が発揮される場面（データベース） -->
                <div class="strength-scenarios">
                    <h5 class="scenarios-title">この特性が活きる場面</h5>
                    <div class="scenario-examples">
                        ${this.generateStrengthScenarios(osData, tendencies).map(scenario => 
                            `<div class="scenario-item">${scenario}</div>`
                        ).join('')}
                    </div>
                </div>
            </div>
        </div>
    `;
}

/**
 * 強みが発揮される具体的な場面を生成
 */
generateStrengthScenarios(osData, tendencies) {
    const scenarios = [];
    
    // H384データベースから実際のシナリオを抽出
    if (osData.hexagram && osData.hexagram.name) {
        const hexagramData = this.hexagramExtractor?.getHexagramDataByName(osData.hexagram.name);
        if (hexagramData && hexagramData.length > 0) {
            // 高スコアの爻から具体的な状況を抽出
            const topYaos = hexagramData
                .sort((a, b) => (b['スコア'] || 0) - (a['スコア'] || 0))
                .slice(0, 3);
            
            topYaos.forEach(yao => {
                if (yao['解釈']) {
                    // 解釈から具体的な場面を抽出
                    const scenario = this.extractScenarioFromInterpretation(yao['解釈']);
                    if (scenario) {
                        scenarios.push(scenario);
                    }
                }
            });
        }
    }
    
    // データがない場合は汎用的な場面を返す
    if (scenarios.length === 0) {
        switch(osData.type) {
            case 'engineOS':
                scenarios.push('創造的な問題解決が必要な時');
                scenarios.push('新しいアイデアを生み出す時');
                break;
            case 'interfaceOS':
                scenarios.push('チームでの協働作業');
                scenarios.push('人間関係の構築');
                break;
            case 'safeModeOS':
                scenarios.push('リスク管理が重要な場面');
                scenarios.push('長期的な計画立案');
                break;
        }
    }
    
    return scenarios.slice(0, 2);
}

/**
 * 解釈テキストから具体的な場面を抽出
 */
extractScenarioFromInterpretation(interpretation) {
    // 解釈から「〜の時」「〜な場面」などのパターンを抽出
    const patterns = [
        /(.+?)(?:の時|な時)/,
        /(.+?)(?:の場面|な場面)/,
        /(.+?)(?:において|にて)/
    ];
    
    for (const pattern of patterns) {
        const match = interpretation.match(pattern);
        if (match) {
            return match[1];
        }
    }
    
    // パターンにマッチしない場合は最初の20文字を返す
    return interpretation.substring(0, 20) + '...';
}
```

### Phase 2: DetailedAnalysisTabの改修（優先度: 高）

#### タスク2.1: renderSummaryメソッドの改修

**ファイル**: `/public/js/components/tabs/DetailedAnalysisTab.js`

**renderSummaryメソッドを以下に置換**:
```javascript
/**
 * データに基づく統合サマリーを表示
 */
renderSummary() {
    const container = document.getElementById('analysisSummary');
    if (!container || !this.analysisData) return;

    // ユーザーの回答データを取得
    const userAnswers = this.storageManager?.getAnswers() || [];
    
    // 各OSの傾向を分析
    const engineTendency = this.analyzeTendencies(this.analysisData.engineOS, userAnswers);
    const interfaceTendency = this.analyzeTendencies(this.analysisData.interfaceOS, userAnswers);
    const safeModeTendency = this.analyzeTendencies(this.analysisData.safeModeOS, userAnswers);
    
    // 統合的なパターンを分析
    const integratedPattern = this.analyzeIntegratedPattern(
        engineTendency, 
        interfaceTendency, 
        safeModeTendency
    );

    const summaryHTML = `
        <div class="summary-container">
            <h3 class="summary-title">統合分析結果</h3>
            
            <!-- 全体的な傾向 -->
            <div class="overall-pattern">
                <h4>あなたの全体的な傾向</h4>
                <p class="pattern-description">${integratedPattern.description}</p>
            </div>
            
            <!-- 3つのOSの相互作用 -->
            <div class="os-interaction">
                <h4>内面・社会性・安定性のバランス</h4>
                <div class="interaction-chart">
                    ${this.renderInteractionVisualization(integratedPattern)}
                </div>
            </div>
            
            <!-- 具体的な行動パターン -->
            <div class="behavior-patterns">
                <h4>よく見られる行動パターン</h4>
                <ul class="pattern-list">
                    ${integratedPattern.behaviors.map(behavior => 
                        `<li>${behavior}</li>`
                    ).join('')}
                </ul>
            </div>
            
            <!-- データから見える強み -->
            <div class="data-driven-strengths">
                <h4>データが示すあなたの強み</h4>
                <div class="strength-cards">
                    ${integratedPattern.strengths.map(strength => `
                        <div class="strength-card">
                            <span class="strength-icon">${strength.icon}</span>
                            <span class="strength-text">${strength.text}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
        </div>
    `;

    container.innerHTML = summaryHTML;
}

/**
 * 統合的なパターンを分析
 */
analyzeIntegratedPattern(engineTendency, interfaceTendency, safeModeTendency) {
    const pattern = {
        description: '',
        behaviors: [],
        strengths: [],
        balance: {}
    };
    
    // スコアのバランスを分析
    const scores = [
        this.analysisData.engineOS.score,
        this.analysisData.interfaceOS.score,
        this.analysisData.safeModeOS.score
    ];
    
    const maxScore = Math.max(...scores);
    const minScore = Math.min(...scores);
    const diff = maxScore - minScore;
    
    // バランスタイプを判定
    if (diff < 10) {
        pattern.description = '内面・社会性・安定性が均等に発達したバランス型。状況に応じて適切な面を発揮できます。';
        pattern.behaviors.push('状況に応じて柔軟に対応を変える');
        pattern.behaviors.push('多面的な視点から物事を捉える');
    } else if (diff < 20) {
        const dominantIndex = scores.indexOf(maxScore);
        const dominantName = ['内的動機', '社会性', '安定性'][dominantIndex];
        pattern.description = `${dominantName}がやや強く現れる傾向があります。この特性を軸に他の面も活用しています。`;
        pattern.behaviors.push(`${dominantName}を重視した判断をする`);
        pattern.behaviors.push('特定の強みを活かしつつバランスを保つ');
    } else {
        const dominantIndex = scores.indexOf(maxScore);
        const dominantName = ['内的動機', '社会性', '安定性'][dominantIndex];
        pattern.description = `${dominantName}が特に強く、明確な個性として現れています。この特性があなたの行動の中心となっています。`;
        pattern.behaviors.push(`${dominantName}に基づいて一貫した行動をとる`);
        pattern.behaviors.push('自分の強みを明確に認識して活用する');
    }
    
    // キーワードから強みを抽出
    const allKeywords = [
        ...engineTendency.keywords,
        ...interfaceTendency.keywords,
        ...safeModeTendency.keywords
    ];
    
    // 頻出キーワードを強みとして認識
    const keywordFrequency = {};
    allKeywords.forEach(keyword => {
        keywordFrequency[keyword] = (keywordFrequency[keyword] || 0) + 1;
    });
    
    // 上位3つを強みとして抽出
    Object.entries(keywordFrequency)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3)
        .forEach(([keyword, count]) => {
            pattern.strengths.push({
                icon: this.getStrengthIcon(keyword),
                text: keyword
            });
        });
    
    return pattern;
}

/**
 * 強みのアイコンを取得
 */
getStrengthIcon(keyword) {
    const iconMap = {
        '創造': '💡',
        '協調': '🤝',
        '安定': '⚖️',
        '行動': '🚀',
        '分析': '🔍',
        '共感': '❤️',
        '計画': '📅',
        '柔軟': '🌊'
    };
    
    for (const [key, icon] of Object.entries(iconMap)) {
        if (keyword.includes(key)) {
            return icon;
        }
    }
    return '✨';
}
```

### Phase 3: CSSの更新（優先度: 中）

#### タスク3.1: user-friendly.cssの更新
**ファイル**: `/public/css/user-friendly.css`

占い的な表現を削除し、データ分析的な表現に更新：

```css
/* データドリブン分析のスタイル */

/* 削除するクラス */
/* .growth-tips, .tips-title, .tips-list は削除 */

/* 新規追加するクラス */

/* キーワードタグ */
.extracted-keywords {
    margin: 16px 0;
}

.keywords-title {
    font-size: 14px;
    font-weight: 600;
    color: #1E293B;
    margin-bottom: 8px;
}

.keyword-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.keyword-tag {
    padding: 4px 10px;
    background: #F0F9FF;
    color: #0369A1;
    border-radius: 12px;
    font-size: 12px;
    border: 1px solid #BAE6FD;
}

/* 傾向分析 */
.tendency-analysis {
    background: #F8FAFC;
    border-radius: 8px;
    padding: 12px;
    margin: 16px 0;
}

.tendency-title {
    font-size: 14px;
    font-weight: 600;
    color: #334155;
    margin-bottom: 8px;
}

.tendency-list {
    margin: 0;
    padding-left: 20px;
    font-size: 13px;
    line-height: 1.8;
    color: #475569;
}

.tendency-item {
    margin-bottom: 4px;
}

/* 強みのシナリオ */
.strength-scenarios {
    background: #FEF3C7;
    border-radius: 8px;
    padding: 12px;
    margin: 16px 0;
}

.scenarios-title {
    font-size: 14px;
    font-weight: 600;
    color: #92400E;
    margin-bottom: 8px;
}

.scenario-examples {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.scenario-item {
    font-size: 13px;
    color: #78350F;
    padding: 6px 8px;
    background: white;
    border-radius: 4px;
}

/* スコア分析 */
.score-analysis {
    margin: 16px 0;
}

.score-progress-container {
    width: 100%;
    height: 8px;
    background: #E5E7EB;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 8px;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #6366F1 0%, #8B5CF6 100%);
    transition: width 0.3s ease;
}

/* 統合分析 */
.overall-pattern {
    background: #EEF2FF;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
}

.pattern-description {
    font-size: 14px;
    line-height: 1.6;
    color: #4C1D95;
}

/* 行動パターン */
.behavior-patterns {
    margin: 16px 0;
}

.pattern-list {
    margin: 8px 0;
    padding-left: 20px;
}

.pattern-list li {
    font-size: 14px;
    color: #374151;
    margin-bottom: 6px;
}

/* データに基づく強み */
.data-driven-strengths {
    margin-top: 20px;
}

.strength-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin-top: 12px;
}

.strength-card {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px;
    background: white;
    border: 1px solid #E5E7EB;
    border-radius: 8px;
}

.strength-icon {
    font-size: 20px;
}

.strength-text {
    font-size: 13px;
    font-weight: 500;
    color: #1F2937;
}

/* モバイル対応 */
@media (max-width: 768px) {
    .keyword-tags {
        gap: 4px;
    }
    
    .strength-cards {
        grid-template-columns: 1fr;
    }
    
    .scenario-examples {
        font-size: 12px;
    }
}
```

## 📋 実装チェックリスト

### 必須タスク
- [ ] BasicResultsTab.jsからgenerateGrowthTips関数を削除
- [ ] analyzeTendencies関数を追加
- [ ] extractAnswerPatterns関数を追加
- [ ] createOSCardHTMLメソッドを置換
- [ ] DetailedAnalysisTab.jsのrenderSummaryメソッドを改修
- [ ] analyzeIntegratedPattern関数を追加
- [ ] user-friendly.cssを更新（占い的要素を削除）

### 動作確認項目
- [ ] H384データベースからキーワードが正しく抽出される
- [ ] ユーザーの回答パターンが正しく分析される
- [ ] 占い的な「〜しましょう」という表現が一切ない
- [ ] データに基づく具体的な傾向が表示される
- [ ] スコアに応じた適切な分析が行われる
- [ ] エラーなく動作する

## 🎯 期待される効果

### 改善前の問題
- 占い的で一般的すぎるアドバイス
- 個人の状況を考慮しない画一的な助言
- HAQEIの本来コンセプトからの乖離

### 改善後の効果
- **データドリブン**な個別分析
- **科学的根拠**に基づく傾向把握
- **独自ロジック**による洞察提供
- **占いではない**分析ツールとしての位置づけ

## 📝 実装時の注意事項

### 重要な原則
1. **一般的な助言を一切含めない**
2. **「〜しましょう」という表現を使わない**
3. **実データから導出される情報のみを表示**
4. **H384データベースを最大限活用**
5. **ユーザーの回答パターンを重視**

### 技術的注意点
1. **StorageManagerからユーザー回答を確実に取得**
2. **H384データベースへのアクセスエラーをハンドリング**
3. **データがない場合のフォールバック処理**
4. **パフォーマンスを考慮した処理**

## 🔍 テスト方法

### 単体テスト
1. 各関数が正しくデータを返すか確認
2. エラーケースの処理確認
3. 境界値でのテスト

### 統合テスト
1. 実際のユーザーフローでの動作確認
2. 異なる回答パターンでの結果確認
3. H384データベースとの連携確認

### ユーザビリティテスト
1. 占い的表現が完全に排除されているか
2. データに基づく分析として納得感があるか
3. 個別化された内容になっているか

## ✅ 完了条件

- すべての占い的表現が削除されている
- データドリブンな分析が実装されている
- H384データベースが活用されている
- ユーザーの回答パターンが反映されている
- HAQEIの本来コンセプトに合致している

## 🚀 実装順序

1. **Phase 1を最優先で実装**（BasicResultsTab）
2. **Phase 2を次に実装**（DetailedAnalysisTab）
3. **Phase 3でスタイル調整**（CSS）
4. **全体テストと微調整**

TRAEには上記の実装を順番に進めてもらい、**占い的要素を完全に排除した科学的分析ツール**として完成させてください。