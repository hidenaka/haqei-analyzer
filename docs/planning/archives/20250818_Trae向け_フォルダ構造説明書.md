# ğŸ“ Traeå‘ã‘ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ èª¬æ˜æ›¸ - HAQEI Analyzer Project

## ğŸ¯ ã“ã®æ–‡æ›¸ã®ç›®çš„
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã¨å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã‚’æ˜ç¢ºã«ã—ã€æ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

## ğŸš¨ æœ€é‡è¦ï¼šå¤‰æ›´å‰ã®å¿…é ˆç¢ºèªäº‹é …
```bash
# 1. ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒç¢ºèª
git status

# 2. CLAUDEãƒ«ãƒ¼ãƒ«ç¢ºèª
cat CLAUDE.md

# 3. ä½œæ¥­è¨˜éŒ²ç¢ºèª
ls -la .serena/memories/*$(date "+%Y%m%d")*
```

## ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆæ§‹é€ 

```
/Users/hideakimacbookair/Desktop/haqei-analyzer/
â”‚
â”œâ”€â”€ ğŸ“ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè§¦ã‚‰ãªã„ï¼‰
â”‚   â”œâ”€â”€ package.json          # âš ï¸ å‰Šé™¤å³ç¦
â”‚   â”œâ”€â”€ package-lock.json     # âš ï¸ å‰Šé™¤å³ç¦
â”‚   â”œâ”€â”€ wrangler.toml         # Cloudflareè¨­å®š
â”‚   â””â”€â”€ claude-mcp-config.json # MCPè¨­å®š
â”‚
â”œâ”€â”€ ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ CLAUDE.md            # ğŸ”´ å¿…èª­ï¼šé–‹ç™ºãƒ«ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ docs/                # å„ç¨®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â””â”€â”€ .serena/memories/    # ä½œæ¥­è¨˜éŒ²ï¼ˆå¿…é ˆä¿å­˜å…ˆï¼‰
â”‚
â”œâ”€â”€ ğŸŒ å…¬é–‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ¡ã‚¤ãƒ³ä½œæ¥­å ´æ‰€ï¼‰
â”‚   â””â”€â”€ public/              # Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“
â”‚
â”œâ”€â”€ ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
â”‚   â””â”€â”€ data/               # âš ï¸ ç·¨é›†ãƒ»å‰Šé™¤å³ç¦
â”‚
â”œâ”€â”€ ğŸ”§ ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ scripts/            # é–‹ç™ºç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚
â””â”€â”€ ğŸ“¦ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
    â””â”€â”€ archives/           # éå»ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿ç®¡å ´æ‰€
```

## ğŸ¯ OS Analyzer é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°

### 1ï¸âƒ£ HTMLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ/public/ï¼‰
```
public/
â”œâ”€â”€ os_analyzer.html        # âœ… ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæœ¬ç•ªç”¨ï¼‰
â”œâ”€â”€ os_analyzer_clean.html  # ã‚¯ãƒªãƒ¼ãƒ³ç‰ˆ
â”œâ”€â”€ os_analyzer_a11y.html   # ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ç‰ˆ
â””â”€â”€ index.html              # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
```

### 2ï¸âƒ£ JavaScriptãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ï¼ˆ/public/js/ï¼‰
```
public/js/
â”œâ”€â”€ ğŸ® ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
â”‚   â””â”€â”€ os-analyzer-main.js    # ç”»é¢åˆ¶å¾¡ã®ä¸­å¿ƒ
â”‚
â”œâ”€â”€ ğŸ“š core/ ï¼ˆã‚³ã‚¢æ©Ÿèƒ½ï¼‰
â”‚   â”œâ”€â”€ QuestionManager.js     # â­ è³ªå•è¡¨ç¤ºç®¡ç†ï¼ˆæœ€é‡è¦ï¼‰
â”‚   â”œâ”€â”€ ScreenManager.js       # ç”»é¢é·ç§»åˆ¶å¾¡
â”‚   â”œâ”€â”€ DataPersistenceManager.js # ãƒ‡ãƒ¼ã‚¿ä¿å­˜
â”‚   â”œâ”€â”€ TripleOSInteractionAnalyzer.js # Triple OSåˆ†æ
â”‚   â”œâ”€â”€ YongProbabilityMonitor.js # ç¢ºç‡ç›£è¦–
â”‚   â”œâ”€â”€ SeedableRandom.js      # ä¹±æ•°ç”Ÿæˆ
â”‚   â””â”€â”€ ExpressionGenerator.js # è¡¨ç¾ç”Ÿæˆ
â”‚
â”œâ”€â”€ ğŸ§© components/ ï¼ˆUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
â”‚   â”œâ”€â”€ InteractiveSystem.js   # å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ ScoreVisualization.js  # ã‚¹ã‚³ã‚¢è¡¨ç¤º
â”‚   â””â”€â”€ ResultPageController.js # çµæœç”»é¢åˆ¶å¾¡
â”‚
â””â”€â”€ ğŸ“Š assets/js/ ï¼ˆãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼‰
    â”œâ”€â”€ app.js                  # âš ï¸ è³ªå•ãƒ‡ãƒ¼ã‚¿ï¼ˆé‡è¦ï¼‰
    â””â”€â”€ questions-unified-v2.js # çµ±ä¸€è³ªå•ãƒ‡ãƒ¼ã‚¿
```

### 3ï¸âƒ£ CSSãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ/public/css/ï¼‰
```
public/css/
â”œâ”€â”€ os-analyzer.css          # OS Analyzerå°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ«
â””â”€â”€ haqei-unified-design.css # çµ±ä¸€ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé’è‰²åŸºèª¿ï¼‰
```

## ğŸ” é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°èª¬æ˜

### QuestionManager.jsï¼ˆæœ€é‡è¦ï¼‰
**å ´æ‰€**: `/public/js/core/QuestionManager.js`
**å½¹å‰²**: 
- è³ªå•ã®è¡¨ç¤ºç®¡ç†
- ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ç”Ÿæˆ
- é¸æŠè‚¢ã®åˆ¶å¾¡
- å›ç­”ã®è¨˜éŒ²

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```javascript
- displayQuestion(index)     // è³ªå•è¡¨ç¤º
- generateOptionsHTML()       // é¸æŠè‚¢HTMLç”Ÿæˆ
- getSelectedAnswer()        // é¸æŠã•ã‚ŒãŸå›ç­”å–å¾—
- validateAnswer()           // å›ç­”æ¤œè¨¼
```

### os-analyzer-main.js
**å ´æ‰€**: `/public/js/os-analyzer-main.js`
**å½¹å‰²**:
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®åˆ¶å¾¡
- ç”»é¢é·ç§»ã®ç®¡ç†
- å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é€£æº
- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```javascript
- init()                     // åˆæœŸåŒ–
- showQuestion()             // è³ªå•ç”»é¢è¡¨ç¤º
- handleNextButtonClick()    // æ¬¡ã¸ãƒœã‚¿ãƒ³å‡¦ç†
- showResults()              // çµæœè¡¨ç¤º
```

### DataPersistenceManager.js
**å ´æ‰€**: `/public/js/core/DataPersistenceManager.js`
**å½¹å‰²**:
- localStorageã¸ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–

## ğŸš« çµ¶å¯¾ã«è§¦ã£ã¦ã¯ã„ã‘ãªã„ãƒ•ã‚¡ã‚¤ãƒ«

### ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ/data/ï¼‰
```
data/
â”œâ”€â”€ hexagrams.json           # æ˜“çµŒãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ h384.json               # H384ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”œâ”€â”€ enhanced_hexagrams_complete.json
â””â”€â”€ *.json                  # ã™ã¹ã¦ã®JSONãƒ•ã‚¡ã‚¤ãƒ«
```
**ç†ç”±**: ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒå´©ã‚Œã‚‹ã¨ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãŒå‹•ä½œã—ãªããªã‚‹

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- `package.json` - å‰Šé™¤ã—ãŸã‚‰å³ `git restore package.json`
- `wrangler.toml` - Cloudflareè¨­å®š
- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†æ™‚ã®æ³¨æ„äº‹é …

### ç·¨é›†å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
```bash
# 1. ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -la /path/to/file

# 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
cp file.js file.js.backup_$(date "+%Y%m%d_%H%M%S")

# 3. ç¾åœ¨ã®å†…å®¹ç¢ºèª
head -50 file.js
```

### ç·¨é›†å¾Œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
```bash
# 1. Lintãƒã‚§ãƒƒã‚¯
npm run lint

# 2. ã‚¨ãƒ©ãƒ¼ç¢ºèª
npm run dev
# ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ç¢ºèª

# 3. ä½œæ¥­è¨˜éŒ²ä¿å­˜
echo "ä¿®æ­£å†…å®¹..." > .serena/memories/ä½œæ¥­å_$(date "+%Y%m%d").md
```

## ğŸ”„ ãƒ•ã‚¡ã‚¤ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚

```mermaid
graph TD
    A[os_analyzer.html] --> B[os-analyzer-main.js]
    B --> C[QuestionManager.js]
    B --> D[ScreenManager.js]
    B --> E[DataPersistenceManager.js]
    C --> F[app.js - è³ªå•ãƒ‡ãƒ¼ã‚¿]
    E --> G[localStorage]
    B --> H[TripleOSInteractionAnalyzer.js]
```

## ğŸ“Œ ã‚ˆãã‚ã‚‹é–“é•ã„ã¨å¯¾å‡¦æ³•

### 1. é–“é•ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
**ç—‡çŠ¶**: å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„
**å¯¾å‡¦**: 
```bash
# æ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèª
find . -name "QuestionManager.js" -type f
# çµæœ: ./public/js/core/QuestionManager.js
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
**ç—‡çŠ¶**: ã‚·ã‚¹ãƒ†ãƒ ãŒå‹•ä½œã—ãªã„
**å¯¾å‡¦**:
```bash
# Git ã§å¾©å…ƒ
git restore data/*.json
```

### 3. é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
**ç—‡çŠ¶**: ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ä¸æ˜
**å¯¾å‡¦**:
```bash
# HTMLã‹ã‚‰å‚ç…§ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
grep -n "QuestionManager" public/os_analyzer.html
```

## ğŸ¯ ä½œæ¥­æ™‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å°ã•ãªå¤‰æ›´ã‹ã‚‰å§‹ã‚ã‚‹
```javascript
// ã¾ãš console.log ã‚’è¿½åŠ ã—ã¦å‹•ä½œç¢ºèª
console.log('ğŸ” Debug: Function called');
```

### 2. æ®µéšçš„ã«ãƒ†ã‚¹ãƒˆ
```bash
# å„å¤‰æ›´å¾Œã«å‹•ä½œç¢ºèª
npm run dev
# http://localhost:8788/os_analyzer.html
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’æ´»ç”¨
```javascript
try {
    // å‡¦ç†
} catch (error) {
    console.error('âŒ Error in QuestionManager:', error);
    console.trace();
}
```

## ğŸ“Š ãƒ•ã‚©ãƒ«ãƒ€ã‚µã‚¤ã‚ºç›®å®‰

| ãƒ•ã‚©ãƒ«ãƒ€ | ã‚µã‚¤ã‚º | ãƒ•ã‚¡ã‚¤ãƒ«æ•° | é‡è¦åº¦ |
|---------|--------|------------|--------|
| /public/js/core/ | ~500KB | 30+ | â­â­â­â­â­ |
| /public/js/components/ | ~200KB | 15+ | â­â­â­â­ |
| /data/ | ~5MB | 10+ | âš ï¸ èª­å–å°‚ç”¨ |
| /archives/ | ~10MB | 100+ | ğŸ“¦ å‚ç…§ç”¨ |

## ğŸ” ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒãƒ³ãƒ‰é›†

```bash
# ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
find . -name "*Question*" -type f | grep -v node_modules

# ç‰¹å®šã®é–¢æ•°ã‚’æ¤œç´¢
grep -r "displayQuestion" public/js --include="*.js"

# æœ€è¿‘å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
find public/js -type f -mtime -1 -name "*.js"

# ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œæ•°ç¢ºèª
wc -l public/js/core/QuestionManager.js

# Gitå·®åˆ†ç¢ºèª
git diff public/js/core/QuestionManager.js
```

## ğŸ“ æœ€çµ‚ç¢ºèª

ä½œæ¥­å‰ã«å¿…ãšç¢ºèªï¼š
1. âœ… CLAUDE.md ã‚’èª­ã‚“ã 
2. âœ… æ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ãŸ
3. âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆã—ãŸ
4. âœ… ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚’æº–å‚™ã—ãŸ
5. âœ… ä½œæ¥­è¨˜éŒ²ã®ä¿å­˜å…ˆã‚’ç¢ºèªã—ãŸ

---

**æ³¨æ„**: ã“ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã¯2025å¹´1æœˆ18æ—¥æ™‚ç‚¹ã®ã‚‚ã®ã§ã™ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•ã‚„åå‰å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã¯ã€å¿…ãšæœ€æ–°ã®æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

```bash
# æœ€æ–°æ§‹é€ ã®ç¢ºèª
ls -la public/js/core/
ls -la public/js/components/
```