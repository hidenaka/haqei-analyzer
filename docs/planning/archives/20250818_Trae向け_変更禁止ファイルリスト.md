# 🚫 Trae向け変更禁止ファイルリスト - 絶対に編集・削除してはいけないファイル

## ⚠️ 最重要警告
**これらのファイルを変更するとシステムが完全に動作しなくなります**

## 🔴 レベル1: 絶対禁止（触ったら即座にシステム停止）

### 設定ファイル
```
❌ package.json              # NPM設定 - 削除したら即 git restore
❌ package-lock.json         # 依存関係ロック
❌ wrangler.toml            # Cloudflare Workers設定
❌ claude-mcp-config.json   # MCP設定
❌ .env                     # 環境変数（存在する場合）
❌ .gitignore              # Git除外設定
```

### もし誤って削除した場合の復旧コマンド
```bash
# package.json を削除してしまった場合
git restore package.json

# すべての設定ファイルを復旧
git restore package.json package-lock.json wrangler.toml
```

---

## 🟠 レベル2: データファイル（読み取り専用）

### /data/ ディレクトリ内のすべてのファイル
```
❌ /data/hexagrams.json                    # 64卦の基本データ
❌ /data/enhanced_hexagrams_complete.json  # 拡張版易経データ
❌ /data/enhanced_hexagrams_orthodoxy.json # 正統性データ
❌ /data/h384.json                         # H384データベース
❌ /data/bible.json                        # バイブルデータ
❌ /data/ai_themes.json                    # AIテーマデータ
❌ /data/koudo_shishin.json               # 行動指針データ
❌ /data/eight_palaces.v1.json            # 八宮データ
❌ /data/yaoci_31-63.json                 # 爻辞データ
❌ /data/kingwen-canonical.csv            # 京房データ
```

### 理由
- これらは易経の根幹データ
- 1文字でも変更すると占い結果が狂う
- バックアップからの復旧が必要

### 確認方法
```bash
# データファイルの整合性確認
ls -la data/*.json | wc -l
# 期待値: 10以上のファイル

# ファイルサイズ確認（変更されていないか）
ls -lh data/h384.json
# 期待値: 1MB以上
```

---

## 🟡 レベル3: ライブラリファイル（外部依存）

### /public/js/lib/ ディレクトリ
```
⚠️ /public/js/lib/chart.min.js                    # Chart.js
⚠️ /public/js/lib/chartjs-plugin-annotation.min.js # Chart.jsプラグイン
⚠️ /public/js/lib/ml-matrix.min.js                # 機械学習ライブラリ
```

### /node_modules/ ディレクトリ
```
⚠️ /node_modules/*  # すべてのnpmパッケージ
```

### 理由
- 外部ライブラリは手動編集禁止
- 必要な場合はnpmで再インストール

### 復旧方法
```bash
# node_modulesを削除してしまった場合
npm install

# 特定のライブラリを再インストール
npm install chart.js
```

---

## 🟢 レベル4: 自動生成ファイル（触る必要なし）

### ビルド生成物
```
/dist/*                    # ビルド出力
/build/*                   # ビルド結果
/.cache/*                  # キャッシュ
/coverage/*                # テストカバレッジ
*.min.js                   # 圧縮済みファイル
*.map                      # ソースマップ
```

### ログ・一時ファイル
```
/logs/*                    # ログファイル
/tmp/*                     # 一時ファイル
*.log                      # ログファイル
*.tmp                      # テンポラリファイル
.DS_Store                  # Mac OSシステムファイル
Thumbs.db                  # Windowsシステムファイル
```

### 理由
- 自動的に再生成される
- 手動編集しても次回ビルドで上書きされる

---

## 🔵 レベル5: コアシステムファイル（慎重に扱う）

### 質問データ定義
```
⚠️ /public/assets/js/app.js                # メイン質問データ
⚠️ /public/assets/js/questions-unified-v2.js # 統一質問データ
```

### Triple OS システム
```
⚠️ /public/js/core/TripleOSInteractionAnalyzer.js
⚠️ /public/js/core/DataPersistenceManager.js
```

### 理由
- システムの根幹部分
- 変更する場合は完全な理解が必要
- バックアップ必須

### 編集前の確認
```bash
# 必ずバックアップを作成
cp file.js file.js.backup_$(date "+%Y%m%d_%H%M%S")
```

---

## 📋 ファイル変更時のチェックリスト

### 編集前
```bash
# 1. 変更禁止リストを確認
grep "ファイル名" 20250818_Trae向け_変更禁止ファイルリスト.md

# 2. ファイルの役割を確認
head -20 ファイル名  # 最初の20行を読む

# 3. バックアップ作成
cp ファイル名 ファイル名.backup

# 4. Git状態確認
git status
```

### 編集後
```bash
# 1. 差分確認
git diff ファイル名

# 2. 動作確認
npm run dev

# 3. エラーチェック
npm run lint
```

---

## 🆘 間違って変更した場合の対処法

### 1. Gitで管理されているファイル
```bash
# 変更を破棄（まだコミットしていない場合）
git checkout -- ファイル名

# すべての変更を破棄
git checkout -- .

# 特定のコミットの状態に戻す
git checkout コミットID -- ファイル名
```

### 2. package.json を削除した場合
```bash
# 緊急復旧
git restore package.json

# npmエラーが出る場合
rm -rf node_modules package-lock.json
git restore package.json package-lock.json
npm install
```

### 3. データファイルを変更した場合
```bash
# すべてのデータファイルを復旧
git restore data/*.json

# 特定のファイルだけ復旧
git restore data/hexagrams.json
```

---

## 📊 ファイル重要度マトリックス

| カテゴリ | 重要度 | 変更可否 | 影響範囲 | 復旧難易度 |
|---------|--------|----------|---------|------------|
| 設定ファイル | ⭐⭐⭐⭐⭐ | ❌ 絶対禁止 | システム全体 | 簡単（Git） |
| データファイル | ⭐⭐⭐⭐⭐ | ❌ 絶対禁止 | 占い結果 | 簡単（Git） |
| ライブラリ | ⭐⭐⭐⭐ | ❌ 禁止 | 機能一部 | 簡単（npm） |
| 自動生成 | ⭐⭐ | ⭕ 不要 | なし | 自動 |
| コアシステム | ⭐⭐⭐⭐ | ⚠️ 要注意 | 主要機能 | 中程度 |
| UIファイル | ⭐⭐⭐ | ✅ 変更可 | 表示のみ | 簡単 |

---

## 🔍 ファイル種別の見分け方

### 変更禁止ファイルの特徴
- `.json` 拡張子（dataフォルダ内）
- `.min.js` 拡張子（圧縮済み）
- `package` で始まる名前
- `config` を含む名前
- `node_modules` フォルダ内

### 変更可能ファイルの特徴
- `/public/js/` 内の通常の `.js` ファイル
- `/public/css/` 内の `.css` ファイル
- 自分で作成したファイル
- `test-` で始まるファイル

---

## 📝 ゴールデンルール

### やってはいけないこと
1. ❌ 「ちょっとだけ」データファイルを編集
2. ❌ package.json の「不要そうな」項目を削除
3. ❌ 「最適化のため」にライブラリを直接編集
4. ❌ 「テストのため」に設定ファイルを変更
5. ❌ バックアップなしでコアファイルを編集

### やるべきこと
1. ✅ 変更前に必ずこのリストを確認
2. ✅ バックアップを作成してから編集
3. ✅ 小さな変更を段階的に実施
4. ✅ 変更後は必ず動作確認
5. ✅ エラーが出たら即座に復旧

---

## 🚨 最終警告

**データファイル（/data/*.json）は絶対に編集しないでください**

これらのファイルには：
- 64卦の意味
- 384爻の解釈
- 数千年の叡智

が含まれています。1文字でも変更すると、すべての占い結果が狂います。

もし編集が必要な場合は：
1. 必ず専門家に相談
2. 完全なバックアップを作成
3. テスト環境で検証
4. レビューを受ける

---

**覚えておくべきこと**: 
「触らぬファイルに祟りなし」

不明な場合は触らない。これが最も安全な方法です。