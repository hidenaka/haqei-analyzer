# ğŸ“‹ 384çˆ»ã‚·ã‚¹ãƒ†ãƒ  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå‹æ–‡è„ˆç†è§£æ©Ÿèƒ½ è¦ä»¶å®šç¾©æ›¸

**æ–‡æ›¸ç•ªå·**: RD-384-004  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 4.0ï¼ˆçœŸã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆç‰ˆï¼‰  
**ä½œæˆæ—¥**: 2025å¹´8æœˆ28æ—¥  
**ä½œæˆè€…**: HAQEIé–‹ç™ºãƒãƒ¼ãƒ   
**æ‰¿èªè€…**: [æœªæ‰¿èª]  

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 èƒŒæ™¯ã¨ç¾çŠ¶åˆ†æ

#### ç¾çŠ¶ã®æ·±åˆ»ãªå•é¡Œ
ç¾åœ¨ã®384çˆ»ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®è‡´å‘½çš„ãªå•é¡Œã‚’æŠ±ãˆã¦ãŠã‚Šã€çœŸã®æ–‡è„ˆç†è§£ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã¯ç¨‹é ã„çŠ¶æ…‹ã§ã™ï¼š

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸åœ¨ã®å±æ©Ÿçš„çŠ¶æ³**
   - å…¨ãƒ‡ãƒ¼ã‚¿ãŒå˜ä¸€JSONï¼ˆkoudo_shishin.jsonï¼‰ã® `shin`/`hen` 2ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã«ä¾å­˜
   - è±Šå¯Œãªåˆ©ç”¨å¯èƒ½ãƒ‡ãƒ¼ã‚¿ï¼ˆenhanced_hexagrams_complete.jsonç­‰ï¼‰ãŒå®Œå…¨ã«ç„¡è¦–ã•ã‚Œã¦ã„ã‚‹
   - ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–æ©Ÿæ§‹ãŒçš†ç„¡ã§ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è“„ç©ä¸å¯èƒ½

2. **è‡ªç„¶è¨€èªå‡¦ç†æ©Ÿèƒ½ã®å®Œå…¨æ¬ å¦‚**
   - å½¢æ…‹ç´ è§£æè¾æ›¸ï¼šæœªå°å…¥ï¼ˆIPAè¾æ›¸ã€MeCabè¾æ›¸ç­‰ï¼‰
   - é¡ç¾©èªè¾æ›¸ï¼šæœªå°å…¥ï¼ˆWordNetæ—¥æœ¬èªç‰ˆç­‰ï¼‰
   - æ„å‘³ç†è§£ï¼šå˜ç´”ãªæ–‡å­—åˆ—ãƒãƒƒãƒãƒ³ã‚°ã®ã¿

3. **å­¦ç¿’ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿèƒ½ã®ä¸åœ¨**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¿å­˜å…ˆï¼šå­˜åœ¨ã—ãªã„
   - åˆ†é¡ç²¾åº¦æ”¹å–„æ©Ÿæ§‹ï¼šå­˜åœ¨ã—ãªã„
   - éå»ã®åˆ†æå±¥æ­´ï¼šä¿å­˜ã•ã‚Œãªã„

### 1.2 åˆ©ç”¨å¯èƒ½ãƒ‡ãƒ¼ã‚¿ãƒªã‚½ãƒ¼ã‚¹ã®å®Œå…¨æ´»ç”¨æ–¹é‡

#### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿è³‡ç”£ã®ç¾çŠ¶
```
åˆ©ç”¨å¯èƒ½ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ:
â”œâ”€â”€ koudo_shishin.json (386ã‚¨ãƒ³ãƒˆãƒª) - âœ… ç¾åœ¨ä½¿ç”¨ä¸­ï¼ˆshin/henã®ã¿ï¼‰
â”œâ”€â”€ enhanced_hexagrams_complete.json (384å®Œå…¨ãƒ‡ãƒ¼ã‚¿) - âŒ å®Œå…¨æœªä½¿ç”¨
â”œâ”€â”€ yaoci_31-63.json - âŒ å®Œå…¨æœªä½¿ç”¨  
â”œâ”€â”€ h384.json - âŒ å®Œå…¨æœªä½¿ç”¨
â””â”€â”€ ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ç‡: ç´„25%ï¼ˆæ·±åˆ»ãªè³‡æºæµªè²»ï¼‰
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆæˆ¦ç•¥
**ç›®æ¨™**: 75%ã®æœªæ´»ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’åŒ…æ‹¬çš„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã§å®Œå…¨çµ±åˆ

| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | çµ±åˆå…ˆDBMS | ç”¨é€” | çµ±åˆæ–¹æ³• |
|-------------|----------|------|---------|
| enhanced_hexagrams_complete.json | SQLite | çˆ»è¾ãƒ»æ„å‘³ãƒ»æ€§æ ¼ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ | æ­£è¦åŒ–ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ |
| yaoci_31-63.json | SQLite | å°‚é–€çˆ»è¾ãƒ‡ãƒ¼ã‚¿ | enhanced_hexagramsã¨çµåˆ |
| h384.json | SQLite | 384çˆ»åŸºæœ¬æƒ…å ± | ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ« |
| koudo_shishin.json | SQLite | æ—¢å­˜shin/henãƒ‡ãƒ¼ã‚¿ | æ—¢å­˜äº’æ›ãƒ¬ã‚¤ãƒ¤ãƒ¼ç¶­æŒ |
| IPAè¾æ›¸ï¼ˆå¤–éƒ¨èª¿é”ï¼‰ | SQLite | æ—¥æœ¬èªå½¢æ…‹ç´ è§£æ | 50MBè¾æ›¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| WordNet-jpï¼ˆå¤–éƒ¨èª¿é”ï¼‰ | SQLite | é¡ç¾©èªãƒ»æ„å‘³é–¢ä¿‚ | 20MBé¡ç¾©èªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ | MongoDB | å­¦ç¿’ãƒ»æ”¹å–„ãƒ‡ãƒ¼ã‚¿ | å‹•çš„ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ |
| åˆ†æã‚­ãƒ£ãƒƒã‚·ãƒ¥ | Redis | é«˜é€Ÿãƒ¬ã‚¹ãƒãƒ³ã‚¹ | TTLä»˜ãã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚° |

### 1.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›®æ¨™ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸­å¿ƒè¨­è¨ˆï¼‰

**åŸºæœ¬æ–¹é‡**: JSONãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜ã‹ã‚‰è„±å´ã—ã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

#### Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŸºç›¤æ§‹ç¯‰ï¼ˆWeek 1-2ï¼‰
- **SQLiteçµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: 4ã¤ã®JSONãƒ•ã‚¡ã‚¤ãƒ« + å¤–éƒ¨è¾æ›¸ã®å®Œå…¨çµ±åˆ
- **MongoDBå°å…¥**: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã‚·ã‚¹ãƒ†ãƒ 
- **Rediså°å…¥**: åˆ†æçµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- **ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ**: æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–ãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

#### Phase 2: è‡ªç„¶è¨€èªå‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆWeek 3-4ï¼‰
- **MeCab + IPAè¾æ›¸**: æ—¥æœ¬èªå½¢æ…‹ç´ è§£æã‚·ã‚¹ãƒ†ãƒ 
- **WordNet-jpçµ±åˆ**: é¡ç¾©èªãƒ»æ„å‘³é¡ä¼¼æ€§è¨ˆç®—
- **ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°**: è¤‡åˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚‹é«˜ç²¾åº¦åˆ†é¡

#### Phase 3: å­¦ç¿’ãƒ»æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ï¼ˆWeek 5-6ï¼‰
- **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—**: MongoDBåŸºç›¤ã®å‹•çš„é‡ã¿èª¿æ•´
- **æ€§èƒ½æœ€é©åŒ–**: Redisæ´»ç”¨ã®3msä»¥å†…ãƒ¬ã‚¹ãƒãƒ³ã‚¹é”æˆ
- **ç¶™ç¶šå­¦ç¿’**: åˆ†é¡ç²¾åº¦ã®æœˆæ¬¡2%å‘ä¸Šã‚·ã‚¹ãƒ†ãƒ 

---

## 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆè¦ä»¶

### 2.1 SQLiteçµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

#### 2.1.1 çˆ»ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ†ãƒ¼ãƒ–ãƒ«
```sql
-- ãƒ¡ã‚¤ãƒ³çˆ»ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ384çˆ»å®Œå…¨ãƒ‡ãƒ¼ã‚¿ï¼‰
CREATE TABLE lines_384 (
    line_id INTEGER PRIMARY KEY, -- 1-384
    hexagram_id INTEGER NOT NULL, -- 1-64
    line_position INTEGER NOT NULL, -- 1-6 (åˆçˆ»-ä¸Šçˆ»)
    hexagram_name TEXT NOT NULL,
    line_name TEXT NOT NULL,
    
    -- enhanced_hexagrams_complete.json ã‹ã‚‰çµ±åˆ
    yaoci_text TEXT, -- çˆ»è¾
    yaoci_meaning TEXT, -- çˆ»è¾ã®æ„å‘³
    personality_trait TEXT, -- æ€§æ ¼ç‰¹æ€§
    transformation_potential TEXT, -- å¤‰åŒ–ã®å¯èƒ½æ€§
    
    -- yaoci_31-63.json ã‹ã‚‰è£œå®Œ
    extended_yaoci TEXT,
    classical_interpretation TEXT,
    
    -- h384.json ã‹ã‚‰åŸºæœ¬æƒ…å ±
    basic_meaning TEXT,
    keywords TEXT, -- JSON array
    
    -- koudo_shishin.json ã‹ã‚‰æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ï¼ˆäº’æ›æ€§ç¶­æŒï¼‰
    shin_data TEXT,
    hen_data TEXT,
    
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ
CREATE INDEX idx_hexagram_position ON lines_384(hexagram_id, line_position);
CREATE INDEX idx_keywords ON lines_384(keywords);
CREATE UNIQUE INDEX idx_line_id ON lines_384(line_id);
```

#### 2.1.2 å½¢æ…‹ç´ è§£æè¾æ›¸ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆIPAè¾æ›¸çµ±åˆï¼‰
```sql
-- MeCab IPAè¾æ›¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒ–
CREATE TABLE morphology_dict (
    id INTEGER PRIMARY KEY,
    surface TEXT NOT NULL, -- è¡¨å±¤å½¢
    left_context_id INTEGER,
    right_context_id INTEGER,
    cost INTEGER,
    part_of_speech TEXT NOT NULL, -- å“è©
    pos_detail1 TEXT,
    pos_detail2 TEXT,
    pos_detail3 TEXT,
    inflection_type TEXT,
    inflection_form TEXT,
    base_form TEXT, -- åŸºæœ¬å½¢
    reading TEXT, -- èª­ã¿
    pronunciation TEXT, -- ç™ºéŸ³
    
    -- æ˜“çµŒç‰¹åŒ–ã‚«ã‚¹ã‚¿ãƒ åˆ†é¡
    yijing_category TEXT, -- æ˜“çµŒç”¨èªåˆ†é¡ï¼ˆå¦åã€çˆ»è¾ã€æ¦‚å¿µç­‰ï¼‰
    semantic_weight REAL DEFAULT 1.0
);

-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_surface ON morphology_dict(surface);
CREATE INDEX idx_base_form ON morphology_dict(base_form);
CREATE INDEX idx_pos ON morphology_dict(part_of_speech);
CREATE INDEX idx_yijing_category ON morphology_dict(yijing_category);
```

#### 2.1.3 é¡ç¾©èªè¾æ›¸ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆWordNet-jpçµ±åˆï¼‰
```sql
-- WordNetæ—¥æœ¬èªç‰ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒ–
CREATE TABLE synonym_relations (
    id INTEGER PRIMARY KEY,
    word1 TEXT NOT NULL,
    word2 TEXT NOT NULL,
    relation_type TEXT NOT NULL, -- synonym, hypernym, hyponym, meronymç­‰
    similarity_score REAL NOT NULL, -- Wu-Palmeré¡ä¼¼åº¦
    confidence REAL DEFAULT 1.0,
    
    -- æ˜“çµŒãƒ‰ãƒ¡ã‚¤ãƒ³ç‰¹åŒ–é‡ã¿
    yijing_relevance REAL DEFAULT 0.0,
    domain_category TEXT -- general, yijing, psychology, leadershipç­‰
);

CREATE INDEX idx_word1 ON synonym_relations(word1);
CREATE INDEX idx_word2 ON synonym_relations(word2);
CREATE INDEX idx_relation_similarity ON synonym_relations(relation_type, similarity_score DESC);
CREATE INDEX idx_yijing_relevance ON synonym_relations(yijing_relevance DESC);
```

### 2.2 MongoDBå­¦ç¿’ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

#### 2.2.1 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
```javascript
// user_feedback collection schema
{
  _id: ObjectId,
  timestamp: ISODate,
  session_id: String, // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥
  
  // åˆ†æå…¥åŠ›ãƒ‡ãƒ¼ã‚¿
  user_input: {
    text: String, // å…ƒã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›
    text_length: Number,
    language: String // "ja", "en" etc.
  },
  
  // ã‚·ã‚¹ãƒ†ãƒ åˆ†æçµæœ
  system_analysis: {
    predicted_line_id: Number, // 1-384
    confidence_score: Number, // 0-1
    processing_time_ms: Number,
    
    // è©³ç´°ã‚¹ã‚³ã‚¢åˆ†è§£
    component_scores: {
      morphology_score: Number,
      synonym_score: Number,
      yaoci_match_score: Number,
      cache_hit: Boolean
    },
    
    // ä½¿ç”¨ã•ã‚ŒãŸç‰¹å¾´é‡
    extracted_features: {
      morphology_tokens: Array, // å½¢æ…‹ç´ è§£æçµæœ
      keywords: Array, // æŠ½å‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
      synonyms_matched: Array // ãƒãƒƒãƒã—ãŸé¡ç¾©èª
    }
  },
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  user_feedback: {
    correct_line_id: Number, // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ¤æ–­ã—ãŸæ­£è§£
    accuracy_rating: Number, // 1-5è©•ä¾¡
    feedback_text: String, // è‡ªç”±è¨˜è¿°
    feedback_type: String // "correct", "partially_correct", "incorrect"
  },
  
  // å­¦ç¿’ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  learning_metadata: {
    was_used_for_training: Boolean,
    training_weight: Number,
    feedback_quality_score: Number
  }
}
```

#### 2.2.2 å­¦ç¿’çµ±è¨ˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
```javascript
// learning_statistics collection schema
{
  _id: ObjectId,
  date: ISODate,
  
  // æ—¥æ¬¡çµ±è¨ˆ
  daily_metrics: {
    total_queries: Number,
    avg_confidence: Number,
    feedback_count: Number,
    accuracy_improvement: Number // å‰æ—¥æ¯”
  },
  
  // çˆ»åˆ¥æ€§èƒ½çµ±è¨ˆ
  line_performance: {
    line_id: Number,
    prediction_count: Number,
    accuracy_rate: Number,
    avg_confidence: Number,
    improvement_trend: Array // éå»30æ—¥ã®æ¨ç§»
  },
  
  // å‹•çš„é‡ã¿èª¿æ•´ãƒ‡ãƒ¼ã‚¿
  dynamic_weights: {
    morphology_weight: Number,
    synonym_weight: Number,
    yaoci_weight: Number,
    learning_rate: Number
  }
}
```

### 2.3 Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­è¨ˆ

#### 2.3.1 ã‚­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨TTLæˆ¦ç•¥
```
åˆ†æçµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥:
analysis:{text_hash}:result (TTL: 1æ™‚é–“)
â””â”€â”€ å®Œå…¨ãªåˆ†æçµæœã‚’JSONæ ¼ç´

å½¢æ…‹ç´ è§£æã‚­ãƒ£ãƒƒã‚·ãƒ¥:
morphology:{text_hash} (TTL: 24æ™‚é–“)  
â””â”€â”€ MeCabè§£æçµæœã‚’JSONæ ¼ç´

é¡ç¾©èªã‚­ãƒ£ãƒƒã‚·ãƒ¥:
synonyms:{word_hash} (TTL: 12æ™‚é–“)
â””â”€â”€ WordNeté¡ç¾©èªãƒªã‚¹ãƒˆã‚’JSONæ ¼ç´

çµ±è¨ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥:
stats:daily:{date} (TTL: 7æ—¥)
â””â”€â”€ æ—¥æ¬¡çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’JSONæ ¼ç´

session:{session_id} (TTL: 30åˆ†)
â””â”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±
```

---

## 3. æ©Ÿèƒ½è¦ä»¶ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå‹ï¼‰

### 3.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆæ©Ÿèƒ½

#### FR-DB-001: SQLiteãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
**èª¬æ˜**: 4ã¤ã®JSONãƒ•ã‚¡ã‚¤ãƒ« + å¤–éƒ¨è¾æ›¸ã®å®Œå…¨çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

**ãƒ‡ãƒ¼ã‚¿çµ±åˆè¦ä»¶**:
```yaml
çµ±åˆå¯¾è±¡ãƒ‡ãƒ¼ã‚¿:
  - enhanced_hexagrams_complete.json: 64å¦Ã—6çˆ»å®Œå…¨ãƒ‡ãƒ¼ã‚¿
  - yaoci_31-63.json: å°‚é–€çˆ»è¾ãƒ‡ãƒ¼ã‚¿
  - h384.json: 384çˆ»åŸºæœ¬æƒ…å ±
  - koudo_shishin.json: æ—¢å­˜shin/henãƒ‡ãƒ¼ã‚¿
  - MeCab IPAè¾æ›¸: 50MBæ—¥æœ¬èªè¾æ›¸
  - WordNet-jp: 20MBé¡ç¾©èªè¾æ›¸

ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–è¦ä»¶:
  - é‡è¤‡æ’é™¤: 100%é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®çµ±åˆ
  - NULLå€¤å‡¦ç†: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¾ãŸã¯NULLè¨±å¯è¨­å®š
  - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–: æ¤œç´¢æ€§èƒ½å‘ä¸Š
  - å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼
```

**å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹**:
```javascript
class SQLiteIntegratedDatabase {
    constructor() {
        this.db = new SQLite3('./dbs/haqei_master.db');
    }
    
    async initializeDatabase() {
        // 1. ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
        await this.createTables();
        
        // 2. JSONãƒ‡ãƒ¼ã‚¿çµ±åˆ
        await this.importEnhancedHexagrams();
        await this.importYaociData();
        await this.importH384Data();
        await this.importKoudoShishin();
        
        // 3. å¤–éƒ¨è¾æ›¸çµ±åˆ
        await this.importIPADictionary();
        await this.importWordNetJp();
        
        // 4. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–
        await this.optimizeIndexes();
    }
    
    async importEnhancedHexagrams() {
        const data = JSON.parse(fs.readFileSync('./public/data/enhanced_hexagrams_complete.json'));
        
        const insertStmt = this.db.prepare(`
            INSERT INTO lines_384 (
                line_id, hexagram_id, line_position, hexagram_name, line_name,
                yaoci_text, yaoci_meaning, personality_trait, transformation_potential
            ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
        `);
        
        for (const hexagram of data) {
            for (let pos = 0; pos < 6; pos++) {
                const line = hexagram.six_lines[pos];
                const lineId = (hexagram.number - 1) * 6 + (pos + 1);
                
                insertStmt.run([
                    lineId,
                    hexagram.number,
                    pos + 1,
                    hexagram.name,
                    line.name || `${hexagram.name} ${this.getPositionName(pos + 1)}`,
                    line.text,
                    line.meaning,
                    line.personality_trait,
                    line.transformation_potential
                ]);
            }
        }
        
        insertStmt.finalize();
    }
    
    async searchByMorphology(tokens) {
        const query = `
            SELECT DISTINCT l.*, 
                   COUNT(m.surface) as token_match_count,
                   GROUP_CONCAT(m.surface) as matched_tokens
            FROM lines_384 l
            JOIN morphology_dict m ON (
                l.yaoci_text LIKE '%' || m.surface || '%' OR
                l.yaoci_meaning LIKE '%' || m.base_form || '%' OR
                l.keywords LIKE '%' || m.surface || '%'
            )
            WHERE m.surface IN (${tokens.map(() => '?').join(',')})
            GROUP BY l.line_id
            ORDER BY token_match_count DESC, m.semantic_weight DESC
            LIMIT 20
        `;
        
        return this.db.all(query, tokens.map(t => t.surface));
    }
}
```

**å„ªå…ˆåº¦**: å¿…é ˆ

#### FR-DB-002: MongoDBå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ 
**èª¬æ˜**: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å‹•çš„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

**å­¦ç¿’ãƒ‡ãƒ¼ã‚¿è¦ä»¶**:
```yaml
ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†:
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¿å­˜: ãƒ¦ãƒ¼ã‚¶ãƒ¼è©•ä¾¡ã®å³åº§è¨˜éŒ²
  - ãƒãƒƒãƒå‡¦ç†: å¤œé–“çµ±è¨ˆè¨ˆç®—ãƒ»é‡ã¿èª¿æ•´
  - ãƒ‡ãƒ¼ã‚¿å“è³ªç®¡ç†: ä¸æ­£ãƒ»åã£ãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ¤œå‡º

å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :
  - å‹•çš„é‡ã¿èª¿æ•´: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åŸºã¥ãä¿‚æ•°è‡ªå‹•èª¿æ•´
  - æ€§èƒ½è¿½è·¡: ç²¾åº¦æ”¹å–„ãƒˆãƒ¬ãƒ³ãƒ‰ç›£è¦–
  - A/Bãƒ†ã‚¹ãƒˆ: æ–°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ®µéšå°å…¥
```

**å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹**:
```javascript
class MongoLearningSystem {
    constructor() {
        this.client = new MongoClient('mongodb://localhost:27017');
        this.db = this.client.db('haqei_learning');
    }
    
    async saveFeedback(feedback) {
        const feedbackDoc = {
            ...feedback,
            timestamp: new Date(),
            processed: false,
            quality_score: await this.calculateFeedbackQuality(feedback)
        };
        
        const result = await this.db.collection('user_feedback').insertOne(feedbackDoc);
        
        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å­¦ç¿’ãƒˆãƒªã‚¬ãƒ¼
        if (feedbackDoc.quality_score > 0.8) {
            await this.triggerLearning(feedbackDoc);
        }
        
        return result.insertedId;
    }
    
    async triggerLearning(feedback) {
        const { user_input, system_analysis, user_feedback } = feedback;
        
        // äºˆæ¸¬ãŒé–“é•ã£ã¦ã„ãŸå ´åˆã®é‡ã¿èª¿æ•´
        if (system_analysis.predicted_line_id !== user_feedback.correct_line_id) {
            await this.adjustWeights({
                input: user_input,
                correct_line: user_feedback.correct_line_id,
                incorrect_prediction: system_analysis.predicted_line_id,
                component_scores: system_analysis.component_scores
            });
        }
        
        // å­¦ç¿’çµ±è¨ˆã®æ›´æ–°
        await this.updateLearningStatistics(feedback);
    }
    
    async adjustWeights(learningData) {
        const currentWeights = await this.getCurrentWeights();
        
        // ç°¡å˜ãªå‹¾é…èª¿æ•´ï¼ˆå®Ÿéš›ã¯ã‚ˆã‚Šè¤‡é›‘ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
        const adjustments = {
            morphology_weight: learningData.component_scores.morphology_score > 0.7 
                ? currentWeights.morphology_weight * 0.98 
                : currentWeights.morphology_weight * 1.02,
            synonym_weight: learningData.component_scores.synonym_score > 0.7 
                ? currentWeights.synonym_weight * 0.98 
                : currentWeights.synonym_weight * 1.02
        };
        
        await this.db.collection('learning_statistics').updateOne(
            { date: new Date().toISOString().split('T')[0] },
            { $set: { dynamic_weights: adjustments } },
            { upsert: true }
        );
    }
}
```

**å„ªå…ˆåº¦**: å¿…é ˆ

### 3.2 è‡ªç„¶è¨€èªå‡¦ç†æ©Ÿèƒ½ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå‹ï¼‰

#### FR-NLP-001: MeCabå½¢æ…‹ç´ è§£æã‚·ã‚¹ãƒ†ãƒ 
**èª¬æ˜**: SQLiteçµ±åˆIPAè¾æ›¸ã«ã‚ˆã‚‹é«˜ç²¾åº¦æ—¥æœ¬èªè§£æ

**å½¢æ…‹ç´ è§£æè¦ä»¶**:
```yaml
è¾æ›¸ã‚·ã‚¹ãƒ†ãƒ :
  - IPAè¾æ›¸: æ¨™æº–æ—¥æœ¬èªèªå½™ï¼ˆç´„50MBï¼‰
  - æ˜“çµŒå°‚é–€è¾æ›¸: å¦åãƒ»çˆ»è¾ãƒ»å°‚é–€ç”¨èªï¼ˆç´„2MBï¼‰
  - å‹•çš„è¾æ›¸æ›´æ–°: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åŸºã¥ãæ–°èªè¿½åŠ 

è§£æç²¾åº¦ç›®æ¨™:
  - ä¸€èˆ¬æ–‡: 95%ä»¥ä¸Šã®å½¢æ…‹ç´ åˆ†å‰²ç²¾åº¦
  - æ˜“çµŒç”¨èª: 90%ä»¥ä¸Šã®å°‚é–€ç”¨èªèªè­˜ç‡
  - å‡¦ç†é€Ÿåº¦: å¹³å‡2msä»¥å†…
```

**å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹**:
```javascript
class DatabaseIntegratedMeCab {
    constructor(sqliteDB) {
        this.mecab = require('mecab-async');
        this.db = sqliteDB;
        this.customDict = new Map();
    }
    
    async analyze(text) {
        // 1. MeCabåŸºæœ¬è§£æ
        const tokens = await this.mecab.parse(text);
        
        // 2. SQLiteè¾æ›¸ã§è£œå®Œãƒ»ä¿®æ­£
        const enhancedTokens = await this.enhanceWithDatabase(tokens);
        
        // 3. æ˜“çµŒå°‚é–€ç”¨èªã®ç‰¹åˆ¥å‡¦ç†
        const yijingTokens = await this.processYijingTerms(enhancedTokens);
        
        // 4. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º
        const keywords = await this.extractKeywords(yijingTokens);
        
        return {
            tokens: yijingTokens,
            keywords: keywords,
            semantic_categories: await this.categorizeSemantics(keywords),
            processing_time: Date.now() - startTime
        };
    }
    
    async enhanceWithDatabase(tokens) {
        const enhancedTokens = [];
        
        for (const token of tokens) {
            // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰è©³ç´°æƒ…å ±ã‚’å–å¾—
            const dbInfo = await this.db.get(`
                SELECT * FROM morphology_dict 
                WHERE surface = ? OR base_form = ?
            `, [token.surface, token.surface]);
            
            if (dbInfo) {
                enhancedTokens.push({
                    ...token,
                    yijing_category: dbInfo.yijing_category,
                    semantic_weight: dbInfo.semantic_weight,
                    enhanced: true
                });
            } else {
                enhancedTokens.push(token);
            }
        }
        
        return enhancedTokens;
    }
    
    async processYijingTerms(tokens) {
        // æ˜“çµŒå°‚é–€ç”¨èªã®è¤‡åˆèªå‡¦ç†
        const yijingPatterns = [
            /^(ä¹¾|å¤|éœ‡|å·½|å|é›¢|è‰®|å…Œ)(ç‚º|å±±|æ°´|å¤©|åœ°|é›·|é¢¨|ç«|æ¾¤)/,
            /^(åˆ|ä¹|å…­|ä¸Š)(ä¹|å…­)/,
            /^(çˆ»|å¦|å½–|è±¡)(è¾|å‚³)/
        ];
        
        const processed = [];
        let i = 0;
        
        while (i < tokens.length) {
            let combined = false;
            
            // æ˜“çµŒå°‚é–€ç”¨èªã®çµåˆå‡¦ç†
            for (const pattern of yijingPatterns) {
                const text = tokens.slice(i, i + 3).map(t => t.surface).join('');
                if (pattern.test(text)) {
                    processed.push({
                        surface: text,
                        pos: 'åè©',
                        yijing_category: 'hexagram_name',
                        semantic_weight: 2.0,
                        combined_tokens: tokens.slice(i, i + 3)
                    });
                    i += 3;
                    combined = true;
                    break;
                }
            }
            
            if (!combined) {
                processed.push(tokens[i]);
                i++;
            }
        }
        
        return processed;
    }
}
```

**å„ªå…ˆåº¦**: å¿…é ˆ

#### FR-NLP-002: WordNeté¡ç¾©èªã‚·ã‚¹ãƒ†ãƒ 
**èª¬æ˜**: SQLiteçµ±åˆWordNet-jpã«ã‚ˆã‚‹æ„å‘³çš„é¡ä¼¼æ€§è¨ˆç®—

**é¡ç¾©èªã‚·ã‚¹ãƒ†ãƒ è¦ä»¶**:
```yaml
é¡ç¾©èªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹:
  - WordNet-jp: æ—¥æœ¬èªæ¦‚å¿µè¾æ›¸ï¼ˆç´„20MBï¼‰
  - æ˜“çµŒãƒ‰ãƒ¡ã‚¤ãƒ³é¡ç¾©èª: å°‚é–€ç”¨èªé–¢ä¿‚ï¼ˆç´„1MBï¼‰
  - å‹•çš„é¡ç¾©èªå­¦ç¿’: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åŸºã¥ãé–¢ä¿‚å¼·åŒ–

é¡ä¼¼åº¦è¨ˆç®—:
  - Wu-Palmeré¡ä¼¼åº¦: æ¦‚å¿µéšå±¤åŸºã¥ãè¨ˆç®—
  - ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦: ãƒ™ã‚¯ãƒˆãƒ«ç©ºé–“ã§ã®è¨ˆç®—
  - ãƒ‰ãƒ¡ã‚¤ãƒ³é‡ã¿: æ˜“çµŒç‰¹åŒ–ã®é‡ã¿èª¿æ•´
```

**å„ªå…ˆåº¦**: å¿…é ˆ

### 3.3 ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆåˆ†æã‚¨ãƒ³ã‚¸ãƒ³

#### FR-AI-001: çµ±åˆã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 
**èª¬æ˜**: è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆã«ã‚ˆã‚‹é«˜ç²¾åº¦384çˆ»åˆ†é¡

**ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¦ä»¶**:
```yaml
çµ±åˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :
  - å½¢æ…‹ç´ è§£æã‚¹ã‚³ã‚¢: 25%é‡ã¿ï¼ˆSQLiteè¾æ›¸ãƒ™ãƒ¼ã‚¹ï¼‰
  - é¡ç¾©èªãƒãƒƒãƒãƒ³ã‚°: 35%é‡ã¿ï¼ˆWordNet-jpãƒ™ãƒ¼ã‚¹ï¼‰
  - çˆ»è¾ç›´æ¥ãƒãƒƒãƒ: 20%é‡ã¿ï¼ˆçµ±åˆçˆ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰
  - å­¦ç¿’é‡ã¿: 15%é‡ã¿ï¼ˆMongoãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰
  - æ–‡è„ˆã‚¹ã‚³ã‚¢: 5%é‡ã¿ï¼ˆæ–‡å…¨ä½“ã®æ„å‘³ï¼‰

ç²¾åº¦ç›®æ¨™:
  - åˆ†é¡ç²¾åº¦: 85%ä»¥ä¸Š
  - ã‚«ãƒãƒ¼ç‡: 60%ä»¥ä¸Šï¼ˆ384çˆ»ä¸­240çˆ»ä»¥ä¸Šä½¿ç”¨ï¼‰
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: å¹³å‡3msä»¥å†…
```

**å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹**:
```javascript
class IntelligentScoringEngine {
    constructor(sqliteDB, mongoDB, redisClient) {
        this.sqlite = sqliteDB;
        this.mongo = mongoDB;
        this.redis = redisClient;
        this.weights = {
            morphology: 0.25,
            synonym: 0.35,
            yaoci: 0.20,
            learning: 0.15,
            context: 0.05
        };
    }
    
    async analyzeText(inputText) {
        const cacheKey = `analysis:${this.hashText(inputText)}`;
        
        // 1. Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèª
        const cached = await this.redis.get(cacheKey);
        if (cached) {
            return { ...JSON.parse(cached), cache_hit: true };
        }
        
        const startTime = Date.now();
        
        // 2. å½¢æ…‹ç´ è§£æï¼ˆSQLiteè¾æ›¸ä½¿ç”¨ï¼‰
        const morphologyResult = await this.analyzeMorphology(inputText);
        
        // 3. å„çˆ»ã«å¯¾ã™ã‚‹ã‚¹ã‚³ã‚¢è¨ˆç®—
        const lineScores = await this.calculateAllLineScores(morphologyResult);
        
        // 4. æœ€é«˜ã‚¹ã‚³ã‚¢çˆ»ã®æ±ºå®š
        const bestMatch = lineScores.reduce((best, current) => 
            current.total_score > best.total_score ? current : best
        );
        
        // 5. çµæœæ§‹é€ åŒ–
        const result = {
            line_384_id: bestMatch.line_id,
            confidence_score: bestMatch.total_score,
            hexagram_name: bestMatch.hexagram_name,
            line_name: bestMatch.line_name,
            yaoci_text: bestMatch.yaoci_text,
            analysis_breakdown: {
                morphology_score: bestMatch.morphology_score,
                synonym_score: bestMatch.synonym_score,
                yaoci_score: bestMatch.yaoci_score,
                learning_score: bestMatch.learning_score,
                context_score: bestMatch.context_score
            },
            extracted_features: morphologyResult,
            processing_time: Date.now() - startTime,
            cache_hit: false
        };
        
        // 6. Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜ï¼ˆ1æ™‚é–“TTLï¼‰
        await this.redis.setex(cacheKey, 3600, JSON.stringify(result));
        
        return result;
    }
    
    async calculateAllLineScores(morphologyResult) {
        const allLines = await this.sqlite.all(`
            SELECT line_id, hexagram_name, line_name, yaoci_text, yaoci_meaning, keywords
            FROM lines_384
        `);
        
        const lineScores = [];
        
        for (const line of allLines) {
            const scores = await this.calculateLineScore(line, morphologyResult);
            lineScores.push({
                ...line,
                ...scores,
                total_score: 
                    scores.morphology_score * this.weights.morphology +
                    scores.synonym_score * this.weights.synonym +
                    scores.yaoci_score * this.weights.yaoci +
                    scores.learning_score * this.weights.learning +
                    scores.context_score * this.weights.context
            });
        }
        
        return lineScores;
    }
    
    async calculateLineScore(line, morphologyResult) {
        // 1. å½¢æ…‹ç´ è§£æã‚¹ã‚³ã‚¢
        const morphologyScore = await this.calculateMorphologyScore(
            line, morphologyResult.keywords
        );
        
        // 2. é¡ç¾©èªãƒãƒƒãƒãƒ³ã‚°ã‚¹ã‚³ã‚¢
        const synonymScore = await this.calculateSynonymScore(
            line, morphologyResult.keywords
        );
        
        // 3. çˆ»è¾ç›´æ¥ãƒãƒƒãƒã‚¹ã‚³ã‚¢
        const yaociScore = this.calculateYaociScore(
            line, morphologyResult.tokens
        );
        
        // 4. å­¦ç¿’é‡ã¿ã‚¹ã‚³ã‚¢ï¼ˆMongoDBï¼‰
        const learningScore = await this.calculateLearningScore(line.line_id);
        
        // 5. æ–‡è„ˆã‚¹ã‚³ã‚¢
        const contextScore = await this.calculateContextScore(
            line, morphologyResult
        );
        
        return {
            morphology_score: morphologyScore,
            synonym_score: synonymScore,
            yaoci_score: yaociScore,
            learning_score: learningScore,
            context_score: contextScore
        };
    }
}
```

**å„ªå…ˆåº¦**: å¿…é ˆ

---

## 4. éæ©Ÿèƒ½è¦ä»¶ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå‹ï¼‰

### 4.1 æ€§èƒ½è¦ä»¶

#### NFR-001: ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆæ™‚**: 1msä»¥å†…ï¼ˆRedisæ´»ç”¨ï¼‰
- **åˆå›åˆ†ææ™‚**: 3msä»¥å†…ï¼ˆ95%tileï¼‰
- **è¤‡é›‘åˆ†ææ™‚**: 5msä»¥å†…ï¼ˆ99%tileï¼‰
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èµ·å‹•**: 5ç§’ä»¥å†…

#### NFR-002: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ€§èƒ½
- **SQLiteèª­ã¿è¾¼ã¿**: å¹³å‡0.5msï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ï¼‰
- **MongoDBæ›¸ãè¾¼ã¿**: å¹³å‡2msï¼ˆãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç„¡ã—ï¼‰
- **Redisæ“ä½œ**: å¹³å‡0.1msï¼ˆãƒ¡ãƒ¢ãƒªå†…å‡¦ç†ï¼‰
- **åŒæ™‚æ¥ç¶š**: 100ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¾ã§å¯¾å¿œ

#### NFR-003: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ»ãƒ¡ãƒ¢ãƒªè¦ä»¶
- **SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: 100MBä»¥å†…ï¼ˆè¾æ›¸å«ã‚€ï¼‰
- **MongoDBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: å¹´é–“1GBæˆé•·
- **Redisãƒ¡ãƒ¢ãƒª**: 200MBä»¥å†…
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ¢ãƒª**: 500MBä»¥å†…

### 4.2 å“è³ªè¦ä»¶

#### NFR-004: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
- **ACIDæº–æ‹ **: SQLite WALãƒ¢ãƒ¼ãƒ‰ä½¿ç”¨
- **ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: MongoDBå˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
- **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æ—¥æ¬¡è‡ªå‹•SQLiteãƒ€ãƒ³ãƒ—
- **ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼**: èµ·å‹•æ™‚æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯

#### NFR-005: å¯ç”¨æ€§ãƒ»ä¿¡é ¼æ€§
- **ç¨¼åƒç‡**: 99.5%ï¼ˆæœˆé–“3.6æ™‚é–“ä»¥ä¸‹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ï¼‰
- **éšœå®³å¾©æ—§**: æ‰‹å‹•å¾©æ—§ï¼ˆ5åˆ†ä»¥å†…ï¼‰
- **ãƒ‡ãƒ¼ã‚¿ä¿è­·**: æš—å·åŒ–ãªã—ï¼ˆé–‹ç™ºç‰ˆï¼‰
- **ç›£æŸ»ãƒ­ã‚°**: é‡è¦æ“ä½œã®ã¿ãƒ­ã‚°è¨˜éŒ²

---

## 5. å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆç‰ˆï¼‰

### 5.1 Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŸºç›¤æ§‹ç¯‰

#### SQLiteçµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [ ] **ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ**: lines_384, morphology_dict, synonym_relations
- [ ] **ãƒ‡ãƒ¼ã‚¿çµ±åˆ**: 4ã¤ã®JSONãƒ•ã‚¡ã‚¤ãƒ«ã®æ­£è¦åŒ–ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [ ] **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–**: æ¤œç´¢æ€§èƒ½å‘ä¸Šã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
- [ ] **IPAè¾æ›¸å°å…¥**: MeCabè¾æ›¸ã®SQLiteåŒ–ï¼ˆ50MBï¼‰
- [ ] **WordNet-jpå°å…¥**: é¡ç¾©èªè¾æ›¸ã®SQLiteåŒ–ï¼ˆ20MBï¼‰

#### MongoDBå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
- [ ] **ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è¨­è¨ˆ**: user_feedback, learning_statistics
- [ ] **ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼**: MongoDB validatorè¨­å®š
- [ ] **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ**: ã‚¯ã‚¨ãƒªæ€§èƒ½æœ€é©åŒ–
- [ ] **åˆæœŸãƒ‡ãƒ¼ã‚¿**: ç©ºã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ä½œæˆç¢ºèª

#### Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ 
- [ ] **æ¥ç¶šè¨­å®š**: Redis 6.0+ã¸ã®æ¥ç¶šç¢ºèª
- [ ] **TTLæˆ¦ç•¥**: ã‚­ãƒ¼ã”ã¨ã®é©åˆ‡ãªæœ‰åŠ¹æœŸé™è¨­å®š
- [ ] **ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–**: maxmemoryãƒãƒªã‚·ãƒ¼è¨­å®š
- [ ] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**: åŸºæœ¬æ“ä½œã®æ€§èƒ½ç¢ºèª

### 5.2 Phase 2: è‡ªç„¶è¨€èªå‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³

#### MeCabçµ±åˆã‚·ã‚¹ãƒ†ãƒ 
- [ ] **MeCabè¨­å®š**: IPAè¾æ›¸ã¨ã®çµ±åˆç¢ºèª
- [ ] **ã‚«ã‚¹ã‚¿ãƒ è¾æ›¸**: æ˜“çµŒå°‚é–€ç”¨èªè¾æ›¸ã®è¿½åŠ 
- [ ] **æ€§èƒ½ãƒ†ã‚¹ãƒˆ**: å¹³å‡2msä»¥å†…ã®è§£ææ™‚é–“ç¢ºèª
- [ ] **ç²¾åº¦è©•ä¾¡**: å°‚é–€ç”¨èªèªè­˜ç‡90%ä»¥ä¸Š

#### WordNeté¡ç¾©èªã‚·ã‚¹ãƒ†ãƒ 
- [ ] **WordNet-jpå°å…¥**: SQLiteè¾æ›¸ã®æ­£å¸¸å‹•ä½œç¢ºèª
- [ ] **é¡ä¼¼åº¦è¨ˆç®—**: Wu-Palmer ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…
- [ ] **æ€§èƒ½ãƒ†ã‚¹ãƒˆ**: é¡ç¾©èªæ¤œç´¢ã®å¿œç­”æ™‚é–“ç¢ºèª
- [ ] **ç²¾åº¦è©•ä¾¡**: é¡ç¾©èªãƒãƒƒãƒãƒ³ã‚°ç²¾åº¦æ¸¬å®š

### 5.3 Phase 3: å­¦ç¿’ãƒ»æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ 

#### ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å­¦ç¿’
- [ ] **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†**: MongoDBä¿å­˜ã®è‡ªå‹•åŒ–
- [ ] **å‹•çš„é‡ã¿èª¿æ•´**: å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…
- [ ] **æ€§èƒ½å‘ä¸Šç¢ºèª**: æœˆæ¬¡2%æ”¹å–„ã®æ¸¬å®šæº–å‚™
- [ ] **A/Bãƒ†ã‚¹ãƒˆ**: æ–°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ®µéšå°å…¥æ©Ÿèƒ½

---

## 6. æ‰¿èªåŸºæº–

### 6.1 å¿…é ˆåˆæ ¼åŸºæº–

| é …ç›® | åˆæ ¼åŸºæº– | æ¸¬å®šæ–¹æ³• |
|------|---------|---------|
| **ãƒ‡ãƒ¼ã‚¿çµ±åˆ** | 4ã¤ã®JSONãƒ•ã‚¡ã‚¤ãƒ«100%çµ±åˆ | SQLiteã‚¯ã‚¨ãƒªã§ã®ç¢ºèª |
| **åˆ†é¡ç²¾åº¦** | 85%ä»¥ä¸Š | 100ã‚µãƒ³ãƒ—ãƒ«ã®å°‚é–€å®¶è©•ä¾¡ |
| **ã‚«ãƒãƒ¼ç‡** | 60%ä»¥ä¸Š | 500ã‚¯ã‚¨ãƒªã§ã®384çˆ»ä½¿ç”¨ç‡ |
| **ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“** | å¹³å‡3msä»¥å†… | 1000å›å®Ÿè¡Œã®å¹³å‡å€¤ |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ€§èƒ½** | SQLite 0.5ms, MongoDB 2ms, Redis 0.1ms | å„DBå˜ä½“æ€§èƒ½ãƒ†ã‚¹ãƒˆ |

### 6.2 æ®µéšåˆ¥å—ã‘å…¥ã‚ŒåŸºæº–

#### Phase 1å®Œäº†åŸºæº–
- [ ] SQLite: 4JSON + 2è¾æ›¸ã®å®Œå…¨çµ±åˆ
- [ ] MongoDB: åŸºæœ¬ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆãƒ»å‹•ä½œç¢ºèª
- [ ] Redis: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã®åŸºæœ¬å‹•ä½œ

#### Phase 2å®Œäº†åŸºæº–  
- [ ] åˆ†é¡ç²¾åº¦: 70%ä»¥ä¸Šï¼ˆPhase 3ã§85%ç›®æ¨™ï¼‰
- [ ] NLPç²¾åº¦: å½¢æ…‹ç´ è§£æ90%ã€é¡ç¾©èª85%
- [ ] å‡¦ç†æ€§èƒ½: å¹³å‡5msä»¥å†…ï¼ˆPhase 3ã§3msç›®æ¨™ï¼‰

#### Phase 3å®Œäº†åŸºæº–
- [ ] æœ€çµ‚ç²¾åº¦: 85%ä»¥ä¸Šã®åˆ†é¡ç²¾åº¦é”æˆ
- [ ] å­¦ç¿’æ©Ÿèƒ½: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åæ˜ æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- [ ] æ€§èƒ½ç›®æ¨™: å…¨ã¦ã®éæ©Ÿèƒ½è¦ä»¶ã‚¯ãƒªã‚¢

---

## 7. æ‰¿èª

| å½¹å‰² | æ°å | æ‰¿èªæ—¥ | ç½²å |
|------|------|--------|------|
| ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼ | | | |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ | | | |
| è‡ªç„¶è¨€èªå‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ | | | |
| æŠ€è¡“ãƒªãƒ¼ãƒ‰ | | | |

---

**æ–‡æ›¸ç®¡ç†**
- **é‡è¦**: ã“ã®è¦ä»¶å®šç¾©æ›¸ã¯çœŸã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆç‰ˆã¨ã—ã¦è¨­è¨ˆ
- **ãƒ‡ãƒ¼ã‚¿æ´»ç”¨**: 75%ã®æœªæ´»ç”¨ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨çµ±åˆ
- **å®Ÿè£…æ ¹æ‹ **: å…·ä½“çš„ãªDBMSé¸å®šãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãƒ»ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’å«ã‚€
- **æ®µéšçš„å®Ÿè£…**: ç¾å®Ÿçš„ãª6é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã®æ®µéšçš„å°å…¥
- **é…å¸ƒå…ˆ**: é–‹ç™ºãƒãƒ¼ãƒ ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ãƒ ã€QAãƒãƒ¼ãƒ 