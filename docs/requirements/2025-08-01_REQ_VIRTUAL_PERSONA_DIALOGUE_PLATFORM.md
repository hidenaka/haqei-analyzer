# 仮想人格対話型自己理解プラットフォーム - 要件定義書

**作成日**: 2025-08-01  
**バージョン**: 1.0.0  
**対象システム**: HAQEI Analyzer Results Page  
**プロジェクト哲学**: bunenjin × 易経 × AI技術の融合

---

## 1. プロジェクト概要

### 1.1 背景と目的

現在のHAQEI Analyzerは、ユーザーの回答から3つのOS（Engine OS・Interface OS・SafeMode OS）を分析し、結果を表示するシステムとして機能している。しかし、現状のresults.htmlは単なる静的な分析結果表示に留まっており、ユーザーが自己の内面の複雑な相互作用を深く理解する機会を十分に提供できていない。

本プロジェクトは、易経の古代の智慧と現代の分人思想を融合し、ユーザーの内なる3つのOSが複雑に相互作用する様子を可視化・対話化することで、より深い自己理解を促進する革新的なプラットフォームの構築を目的とする。

### 1.2 プロジェクトビジョン

「仮想人格対話型自己理解プラットフォーム」は、以下のビジョンを実現する：

1. **動的な自己理解**: 静的な診断結果から、生きた仮想人格との対話へ
2. **複雑性の可視化**: 3つのOSの相互作用を視覚的・対話的に表現
3. **易経メタファーの活用**: 古代の智慧による深い洞察の提供
4. **実践的ガイダンス**: 理論的理解から実践的行動への橋渡し

### 1.3 対象ユーザー

- **プライマリターゲット**: os_analyzer.htmlで診断を完了したユーザー
- **年齢層**: 20代〜50代の自己理解・成長に関心のある層
- **ユーザー特性**: 
  - 自己の内面に興味がある
  - 複雑な心理的概念を理解する意欲がある
  - 実践的な自己改善のヒントを求めている

---

## 2. ビジネス要件

### 2.1 戦略的目標

1. **ユーザーエンゲージメント向上**
   - 診断完了後の滞在時間を現在の3分から15分以上に延長
   - リピート利用率を20%から50%に向上

2. **差別化要因の確立**
   - 世界初の「仮想人格対話型」自己理解システム
   - 易経×分人思想×AI技術の独自融合

3. **将来的な収益化準備**
   - 有料版への自然な導線設計
   - プレミアム機能への拡張性確保

### 2.2 成功指標（KPI）

- **ユーザー満足度**: 4.5/5.0以上
- **完走率**: 80%以上のユーザーが全機能を体験
- **共有率**: 20%以上のユーザーがSNSで結果を共有
- **再訪問率**: 30日以内の再訪問率30%以上

---

## 3. 機能要件

### 3.1 仮想人格構築・表示機能

#### 3.1.1 段階的構築演出
- **要件ID**: FR-001
- **説明**: PersonalityConstructionViewを活用し、診断結果から仮想人格を段階的に構築する演出を提供
- **詳細**:
  - データ分析フェーズ（2秒）
  - Engine OS構築（3秒）
  - Interface OS構築（3秒）
  - SafeMode OS構築（3秒）
  - OS間関係性構築（2.5秒）
  - 易経メタファー生成（2秒）
  - 統合完了（1.5秒）

#### 3.1.2 3つのOSの視覚的表現
- **要件ID**: FR-002
- **説明**: 各OSを独自のビジュアルアイデンティティで表現
- **詳細**:
  - Engine OS: 青系統、堅固なデザイン、核心的シンボル
  - Interface OS: 緑系統、流動的デザイン、社交的シンボル
  - SafeMode OS: 赤系統、防御的デザイン、盾のシンボル
  - 各OSのスコア、特性、易経卦の表示

### 3.2 OS間相互作用の可視化

#### 3.2.1 関係性グラフ
- **要件ID**: FR-003
- **説明**: OSRelationshipEngineのデータを基にした動的な関係性グラフ
- **詳細**:
  - 三角形配置での3OS表示
  - 関係性の強さを線の太さで表現
  - 葛藤は赤、調和は青、中立は灰色で表示
  - リアルタイムアニメーション

#### 3.2.2 相互作用パターン表示
- **要件ID**: FR-004
- **説明**: 典型的な相互作用パターンの可視化
- **詳細**:
  - 協調パターン
  - 葛藤パターン
  - 主導権交代パターン
  - バランス調整パターン

### 3.3 内部対話システム

#### 3.3.1 対話再生機能
- **要件ID**: FR-005
- **説明**: DialoguePlayerを活用した3つのOS間の対話再生
- **詳細**:
  - シナリオベースの対話（転職、人間関係、人生の方向性等）
  - 各OSの発言をタイピングアニメーションで表示
  - 再生/一時停止/スキップ機能
  - 速度調整機能（0.5x〜2.0x）

#### 3.3.2 インタラクティブ対話
- **要件ID**: FR-006
- **説明**: ユーザーが質問を投げかけられる対話インターフェース
- **詳細**:
  - プリセット質問の選択
  - 自由テキスト入力（将来実装）
  - 3つのOSからの個別回答
  - 統合的な洞察の提供

### 3.4 易経メタファー統合

#### 3.4.1 物語的解説
- **要件ID**: FR-007
- **説明**: IchingMetaphorEngineによる行動パターンの物語的解説
- **詳細**:
  - 各OSの易経卦に基づく性格描写
  - OS間の関係性の易経的解釈
  - 変化の兆しと成長の方向性
  - 古代の智慧と現代心理学の融合表現

#### 3.4.2 64卦マッピング
- **要件ID**: FR-008
- **説明**: ユーザーの仮想人格と64卦の対応関係表示
- **詳細**:
  - 各OSの主要卦表示
  - 変化の可能性を示す変爻
  - 成長の道筋を示す卦の変化

### 3.5 自己理解ガイダンス

#### 3.5.1 実践的アドバイス
- **要件ID**: FR-009
- **説明**: 3つのOSのバランスに基づく具体的な行動指針
- **詳細**:
  - 日常生活での活用方法
  - 強みの活かし方
  - 弱点の補完方法
  - 成長のための実践課題

#### 3.5.2 シミュレーション機能
- **要件ID**: FR-010
- **説明**: 「もし〜だったら」のシナリオシミュレーション
- **詳細**:
  - 様々な状況での3OSの反応予測
  - 意思決定支援
  - リスクと機会の分析

---

## 4. 非機能要件

### 4.1 パフォーマンス要件

- **NFR-001**: 初期読み込み時間は3秒以内
- **NFR-002**: 各インタラクションのレスポンスは500ms以内
- **NFR-003**: アニメーションは60fps以上で動作
- **NFR-004**: メモリ使用量は500MB以内

### 4.2 ユーザビリティ要件

- **NFR-005**: 直感的で学習コストの低いUI
- **NFR-006**: モバイル・タブレット完全対応
- **NFR-007**: キーボードナビゲーション対応
- **NFR-008**: スクリーンリーダー対応

### 4.3 信頼性要件

- **NFR-009**: ブラウザ互換性（Chrome、Firefox、Safari、Edge最新版）
- **NFR-010**: エラー発生率1%以下
- **NFR-011**: データ整合性100%保証

### 4.4 セキュリティ要件

- **NFR-012**: すべてのユーザーデータはローカルストレージに保存
- **NFR-013**: 外部サーバーへのデータ送信なし
- **NFR-014**: XSS、CSRF対策の実装

---

## 5. UI/UX要件

### 5.1 デザイン原則

1. **bunenjin哲学の体現**
   - シンプルでありながら深い
   - 古典と現代の調和
   - ユーザー主権の尊重

2. **視覚的階層**
   - 重要情報の明確な優先順位
   - 段階的な情報開示
   - 認知負荷の最小化

3. **インタラクションデザイン**
   - スムーズなトランジション
   - 直感的なジェスチャー
   - 適切なフィードバック

### 5.2 画面構成

1. **メインビュー**
   - 仮想人格の中央配置
   - 3OSの三角形配置
   - 対話エリア
   - 操作パネル

2. **詳細ビュー**
   - 各OSの詳細情報
   - 関係性分析
   - 易経解説
   - 実践ガイド

### 5.3 カラースキーム

- **プライマリカラー**: 深い紫（#6B46C1）- 神秘性と深遠さ
- **Engine OS**: 青系（#3B82F6）- 理性と価値観
- **Interface OS**: 緑系（#10B981）- 社会性と適応
- **SafeMode OS**: 赤系（#EF4444）- 防御と警戒
- **背景**: ダークテーマ（#1F2937）- 没入感

---

## 6. 技術要件

### 6.1 アーキテクチャ

#### 6.1.1 既存コンポーネントの活用
- VirtualPersonality.js - 仮想人格のコアエンジン
- OSRelationshipEngine.js - OS間関係性分析
- IchingMetaphorEngine.js - 易経メタファー生成
- PersonalityConstructionView.js - 構築演出
- DialoguePlayer.js - 対話再生システム

#### 6.1.2 新規コンポーネント
- VirtualPersonaResultsView.js - メインビューコントローラー
- OSInteractionVisualizer.js - 相互作用可視化
- GuidanceEngine.js - 実践的アドバイス生成
- SimulationEngine.js - シナリオシミュレーション

### 6.2 技術スタック

- **フロントエンド**: Vanilla JavaScript (ES6+)
- **スタイリング**: CSS3 (CSS Variables, Grid, Flexbox)
- **アニメーション**: CSS Animations + JavaScript
- **データ管理**: localStorage
- **ビルド**: なし（直接実行）

### 6.3 開発ガイドライン

1. **コーディング規約**
   - CLAUDE.mdの仕様コメント必須ルールに従う
   - すべての関数に詳細な仕様コメント記載
   - bunenjin哲学に基づくシンプルで美しいコード

2. **品質基準**
   - Tsumiki TDDワークフローの適用
   - 要件網羅率100%
   - テスト成功率100%

---

## 7. 制約事項

1. **技術的制約**
   - 外部APIの使用不可（完全ローカル動作）
   - ファイルサイズ制限（各ファイル1MB以内）
   - ブラウザストレージ制限（5MB）

2. **リソース制約**
   - 開発期間：6日間
   - 既存システムとの互換性維持

3. **ビジネス制約**
   - 無料版として提供
   - 将来の有料化を妨げない設計

---

## 8. 用語定義

- **仮想人格**: ユーザーの診断結果から構築されるデジタル分身
- **Triple OS**: Engine OS（価値観）、Interface OS（社会的側面）、SafeMode OS（防御的側面）の3つ
- **bunenjin哲学**: プロジェクトの根幹となる「分けて分けない」思想
- **易経メタファー**: 64卦を用いた行動パターンの象徴的表現

---

## 9. 今後の拡張可能性

1. **AI統合**（Phase 2）
   - 自然言語での質問応答
   - より高度な対話生成
   - パーソナライズされたアドバイス

2. **コミュニティ機能**（Phase 3）
   - 匿名での仮想人格共有
   - 類似パターンの発見
   - 集合的洞察の提供

3. **長期追跡**（Phase 4）
   - 仮想人格の成長記録
   - 定期的な再診断
   - 成長グラフの可視化

---

**本要件定義書は、仮想人格対話型自己理解プラットフォームの開発指針として、すべての開発作業の基準となる。**