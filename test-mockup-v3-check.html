<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAQEI - 洗練版 結果画面</title>
    <style>
        /* ==========================================================================
           HAQEI 洗練版デザイン - 元のデザインを活かした階層的情報設計
           ========================================================================== */
        
        :root {
            /* カラーパレット */
            --primary-blue: #3b82f6;
            --primary-blue-dark: #2563eb;
            --secondary-blue: #6366f1;
            --light-blue: #dbeafe;
            --very-light-blue: #f0f9ff;
            
            /* Engine OS カラー */
            --engine-color: #f59e0b;
            --engine-light: #fef3c7;
            --engine-dark: #d97706;
            
            /* Interface OS カラー */
            --interface-color: #10b981;
            --interface-light: #d1fae5;
            --interface-dark: #059669;
            
            /* SafeMode OS カラー */
            --safemode-color: #8b5cf6;
            --safemode-light: #e9d5ff;
            --safemode-dark: #7c3aed;
            
            /* グレースケール */
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            /* スペーシング */
            --spacing-xs: 0.5rem;
            --spacing-sm: 0.75rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            
            /* シャドウ */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            line-height: 1.6;
            color: var(--gray-900);
            background: linear-gradient(180deg, var(--very-light-blue) 0%, var(--gray-50) 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        /* ==========================================================================
           レベル1: ヒーローセクション - 一目で分かる結論
           ========================================================================== */
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: white;
            padding: var(--spacing-2xl) var(--spacing-lg);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 60%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
            pointer-events: none;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .hero-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: var(--spacing-md);
            backdrop-filter: blur(10px);
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0 0 var(--spacing-lg) 0;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            opacity: 0.95;
            margin-bottom: var(--spacing-xl);
            max-width: 600px;
        }

        /* 3つの特性カード */
        .hero-traits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .trait-card {
            background: rgba(255, 255, 255, 0.95);
            color: var(--gray-900);
            padding: var(--spacing-lg);
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .trait-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .trait-emoji {
            font-size: 2.5rem;
            margin-bottom: var(--spacing-sm);
        }

        .trait-label {
            font-size: 0.9rem;
            color: var(--gray-600);
            margin-bottom: var(--spacing-xs);
        }

        .trait-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .trait-desc {
            font-size: 0.85rem;
            color: var(--gray-700);
            margin-top: var(--spacing-xs);
        }

        .hero-scroll {
            text-align: center;
            margin-top: var(--spacing-lg);
        }

        .scroll-button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .scroll-button:hover {
            background: white;
            color: var(--primary-blue);
            transform: scale(1.05);
        }

        /* ==========================================================================
           レベル2: エッセンシャル・サマリー
           ========================================================================== */
        
        .summary-section {
            background: white;
            padding: var(--spacing-2xl) var(--spacing-lg);
        }

        .summary-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .summary-header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
        }

        .summary-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--gray-900);
            margin: 0 0 var(--spacing-sm) 0;
        }

        .summary-desc {
            color: var(--gray-600);
            font-size: 1.1rem;
        }

        /* キーポイントカード */
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-2xl);
        }

        .key-point {
            background: var(--white);
            border-radius: 12px;
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-md);
            border-top: 4px solid var(--primary-blue);
            transition: all 0.3s ease;
        }

        .key-point:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .key-point.strength {
            border-top-color: var(--engine-color);
            background: linear-gradient(180deg, var(--engine-light) 0%, white 30%);
        }

        .key-point.caution {
            border-top-color: var(--safemode-color);
            background: linear-gradient(180deg, var(--safemode-light) 0%, white 30%);
        }

        .key-point.growth {
            border-top-color: var(--interface-color);
            background: linear-gradient(180deg, var(--interface-light) 0%, white 30%);
        }

        .key-point-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .key-point-icon {
            font-size: 1.5rem;
        }

        .key-point-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .key-point-content {
            color: var(--gray-700);
            line-height: 1.8;
        }

        .key-point-example {
            margin-top: var(--spacing-sm);
            padding: var(--spacing-sm);
            background: var(--gray-50);
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--gray-600);
            font-style: italic;
        }

        /* 今週のアクション */
        .action-section {
            background: linear-gradient(135deg, var(--very-light-blue) 0%, var(--light-blue) 100%);
            border-radius: 16px;
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-2xl);
        }

        .action-header {
            text-align: center;
            margin-bottom: var(--spacing-lg);
        }

        .action-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue-dark);
            margin: 0 0 var(--spacing-sm) 0;
        }

        .action-card {
            background: white;
            border-radius: 12px;
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-md);
            max-width: 800px;
            margin: 0 auto;
        }

        .action-step {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .action-number {
            background: var(--primary-blue);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .action-text {
            flex: 1;
            color: var(--gray-700);
        }

        .action-expected {
            background: var(--very-light-blue);
            border-left: 4px solid var(--primary-blue);
            padding: var(--spacing-md);
            border-radius: 8px;
            margin-top: var(--spacing-md);
        }

        /* ==========================================================================
           レベル3: 詳細分析（アコーディオン）
           ========================================================================== */
        
        .detail-section {
            background: var(--gray-50);
            padding: var(--spacing-2xl) var(--spacing-lg);
        }

        .detail-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .detail-header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
        }

        .detail-toggle {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 auto;
            display: block;
        }

        .detail-toggle:hover {
            background: var(--primary-blue-dark);
            transform: scale(1.05);
        }

        .detail-content {
            display: none;
            margin-top: var(--spacing-2xl);
        }

        .detail-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* アコーディオン */
        .accordion-item {
            background: white;
            border-radius: 12px;
            margin-bottom: var(--spacing-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .accordion-header {
            padding: var(--spacing-lg);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background 0.3s ease;
            border-top: 4px solid transparent;
        }

        .accordion-item.engine .accordion-header {
            border-top-color: var(--engine-color);
        }

        .accordion-item.interface .accordion-header {
            border-top-color: var(--interface-color);
        }

        .accordion-item.safemode .accordion-header {
            border-top-color: var(--safemode-color);
        }

        .accordion-header:hover {
            background: var(--gray-50);
        }

        .accordion-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .accordion-icon {
            transition: transform 0.3s ease;
        }

        .accordion-item.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .accordion-item.active .accordion-content {
            max-height: 3000px;
        }

        .accordion-inner {
            padding: 0 var(--spacing-lg) var(--spacing-lg) var(--spacing-lg);
        }

        /* データシミュレーター */
        .simulator {
            position: fixed;
            bottom: var(--spacing-lg);
            right: var(--spacing-lg);
            background: white;
            border-radius: 12px;
            padding: var(--spacing-md);
            box-shadow: var(--shadow-xl);
            z-index: 100;
        }

        .simulator-header {
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--gray-700);
        }

        .simulator-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .sim-btn {
            padding: 0.5rem 1rem;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            text-align: left;
        }

        .sim-btn:hover {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .sim-btn.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 1.75rem;
            }
            
            .hero-traits {
                grid-template-columns: 1fr;
            }
            
            .key-points {
                grid-template-columns: 1fr;
            }
            
            .simulator {
                left: var(--spacing-sm);
                right: var(--spacing-sm);
                bottom: var(--spacing-sm);
            }
        }
    </style>
</head>
<body>
    <!-- ==========================================================================
         レベル1: ヒーローセクション
         ========================================================================== -->
    <section class="hero-section">
        <div class="hero-container">
            <div class="hero-badge">診断結果</div>
            <h1 class="hero-title" id="hero-title">
                新しいアイデアで周りを支える<br>
                革新的なサポーター
            </h1>
            <p class="hero-subtitle" id="hero-subtitle">
                常に「もっと良い方法はないか？」を考えながら、
                チームの成長と調和を支える、創造的な支援者タイプです
            </p>
            
            <div class="hero-traits" id="hero-traits">
                <div class="trait-card">
                    <div class="trait-emoji">🚀</div>
                    <div class="trait-label">原動力</div>
                    <div class="trait-value" id="engine-name">革新追求</div>
                    <div class="trait-desc" id="engine-score">スコア: 92</div>
                </div>
                <div class="trait-card">
                    <div class="trait-emoji">💬</div>
                    <div class="trait-label">人との関わり</div>
                    <div class="trait-value" id="interface-name">情熱共有</div>
                    <div class="trait-desc" id="interface-score">スコア: 75</div>
                </div>
                <div class="trait-card">
                    <div class="trait-emoji">🛡️</div>
                    <div class="trait-label">ストレス対処</div>
                    <div class="trait-value" id="safemode-name">衝撃転換</div>
                    <div class="trait-desc" id="safemode-score">スコア: 68</div>
                </div>
            </div>
            
            <div class="hero-scroll">
                <button class="scroll-button" onclick="scrollToSummary()">
                    詳しい分析を見る ↓
                </button>
            </div>
        </div>
    </section>

    <!-- ==========================================================================
         レベル2: エッセンシャル・サマリー
         ========================================================================== -->
    <section class="summary-section" id="summary-section">
        <div class="summary-container">
            <div class="summary-header">
                <h2 class="summary-title">あなたの特性を3つのポイントで</h2>
                <p class="summary-desc">強み・注意点・成長の方向性を簡潔にまとめました</p>
            </div>
            
            <div class="key-points" id="key-points">
                <!-- 動的に生成 -->
            </div>
            
            <div class="action-section">
                <div class="action-header">
                    <h3 class="action-title">📅 今週試してみること</h3>
                </div>
                <div class="action-card" id="action-card">
                    <!-- 動的に生成 -->
                </div>
            </div>
        </div>
    </section>

    <!-- ==========================================================================
         レベル3: 詳細分析
         ========================================================================== -->
    <section class="detail-section">
        <div class="detail-container">
            <div class="detail-header">
                <button class="detail-toggle" onclick="toggleDetailSection()">
                    詳細分析レポートを表示 →
                </button>
            </div>
            
            <div class="detail-content" id="detail-content">
                <!-- 動的に生成 -->
            </div>
        </div>
    </section>

    <!-- データシミュレーター -->
    <div class="simulator">
        <div class="simulator-header">🔧 パターン選択</div>
        <div class="simulator-buttons">
            <button class="sim-btn active" onclick="loadPattern('innovator')">革新型</button>
            <button class="sim-btn" onclick="loadPattern('supporter')">支援型</button>
            <button class="sim-btn" onclick="loadPattern('balanced')">バランス型</button>
            <button class="sim-btn" onclick="loadPattern('revolutionary')">変革型</button>
            <button class="sim-btn" onclick="loadPattern('stabilizer')">安定型</button>
        </div>
    </div>

    <!-- V3データベース読み込み -->
    <script src="public/js/data/hexagram-human-traits-v3.js"></script>
    <script>
        // データパターン
        const dataPatterns = {
            innovator: {
                engineOS: { hexagram: "乾為天", score: 92 },
                interfaceOS: { hexagram: "離為火", score: 75 },
                safeModeOS: { hexagram: "震為雷", score: 68 }
            },
            supporter: {
                engineOS: { hexagram: "坤為地", score: 85 },
                interfaceOS: { hexagram: "山水蒙", score: 88 },
                safeModeOS: { hexagram: "艮為山", score: 72 }
            },
            balanced: {
                engineOS: { hexagram: "水天需", score: 80 },
                interfaceOS: { hexagram: "巽為風", score: 79 },
                safeModeOS: { hexagram: "坎為水", score: 81 }
            },
            revolutionary: {
                engineOS: { hexagram: "澤火革", score: 89 },
                interfaceOS: { hexagram: "火風鼎", score: 86 },
                safeModeOS: { hexagram: "天水訟", score: 73 }
            },
            stabilizer: {
                engineOS: { hexagram: "艮為山", score: 77 },
                interfaceOS: { hexagram: "水火既済", score: 82 },
                safeModeOS: { hexagram: "兌為澤", score: 78 }
            }
        };

        function generateHeroText(data) {
            const engineData = window.HexagramHumanTraitsV3[data.engineOS.hexagram];
            const interfaceData = window.HexagramHumanTraitsV3[data.interfaceOS.hexagram];
            
            // より自然な日本語表現を生成
            let title = "";
            let subtitle = "";
            
            // Engine OSの特徴を活かしたタイトル生成
            const engineDesc = engineData.asEngineOS.profile.description;
            const interfaceDesc = interfaceData.asInterfaceOS.profile.description;
            
            // タイトルを動的に生成（データベースの内容を活用）
            if (data.engineOS.score > 85) {
                // Engine OSが強い場合
                title = `${engineDesc.replace(/[。、]/g, '')}<br>${interfaceData.nickname}タイプ`;
            } else if (data.interfaceOS.score > 85) {
                // Interface OSが強い場合
                title = `${interfaceDesc.replace(/[。、]/g, '')}<br>${engineData.nickname}`;
            } else {
                // バランス型
                title = `${engineData.nickname}と${interfaceData.nickname}の<br>バランス型`;
            }
            
            // サブタイトルを生成（metaphorを活用）
            subtitle = engineData.asEngineOS.profile.metaphor || 
                      `${engineData.asEngineOS.normalState.whatHappens}`;
            
            return { title, subtitle };
        }

        function generateDynamicContent(pattern) {
            const data = dataPatterns[pattern];
            const engineData = window.HexagramHumanTraitsV3[data.engineOS.hexagram];
            const interfaceData = window.HexagramHumanTraitsV3[data.interfaceOS.hexagram];
            const safeData = window.HexagramHumanTraitsV3[data.safeModeOS.hexagram];
            
            // ヒーローセクションの更新
            const heroText = generateHeroText(data);
            document.getElementById('hero-title').innerHTML = heroText.title;
            document.getElementById('hero-subtitle').textContent = heroText.subtitle;
            
            // 3つの特性カード更新
            document.getElementById('engine-name').textContent = 
                engineData.asEngineOS.profile.type.replace('エンジン', '').replace('型', '');
            document.getElementById('engine-score').textContent = `スコア: ${data.engineOS.score}`;
            
            document.getElementById('interface-name').textContent = 
                interfaceData.asInterfaceOS.profile.type.replace('型', '');
            document.getElementById('interface-score').textContent = `スコア: ${data.interfaceOS.score}`;
            
            document.getElementById('safemode-name').textContent = 
                safeData.asSafeModeOS.profile.type.replace('型', '');
            document.getElementById('safemode-score').textContent = `スコア: ${data.safeModeOS.score}`;
            
            // キーポイント生成
            document.getElementById('key-points').innerHTML = `
                <div class="key-point strength">
                    <div class="key-point-header">
                        <span class="key-point-icon">✨</span>
                        <h3 class="key-point-title">あなたの強み</h3>
                    </div>
                    <div class="key-point-content">
                        ${engineData.asEngineOS.profile.description}
                        ${engineData.asEngineOS.normalState.whatHappens}
                    </div>
                    <div class="key-point-example">
                        例: ${engineData.asEngineOS.normalState.example}
                    </div>
                </div>
                
                <div class="key-point caution">
                    <div class="key-point-header">
                        <span class="key-point-icon">⚠️</span>
                        <h3 class="key-point-title">気をつけること</h3>
                    </div>
                    <div class="key-point-content">
                        ${engineData.asEngineOS.maintenance.warning}
                        ${safeData.asSafeModeOS.stressResponse.badPoint}
                    </div>
                    <div class="key-point-example">
                        対処法: ${safeData.asSafeModeOS.stressResponse.whatYouDo}
                    </div>
                </div>
                
                <div class="key-point growth">
                    <div class="key-point-header">
                        <span class="key-point-icon">🌱</span>
                        <h3 class="key-point-title">成長の方向性</h3>
                    </div>
                    <div class="key-point-content">
                        ${interfaceData.asInterfaceOS.relationshipTips.advice}
                    </div>
                    <div class="key-point-example">
                        ヒント: ${engineData.osBalance.tip}
                    </div>
                </div>
            `;
            
            // アクションカード生成
            document.getElementById('action-card').innerHTML = `
                <div class="action-step">
                    <div class="action-number">1</div>
                    <div class="action-text">
                        <strong>${engineData.asEngineOS.maintenance.tip}</strong><br>
                        ${engineData.asEngineOS.maintenance.howToCharge}
                    </div>
                </div>
                <div class="action-step">
                    <div class="action-number">2</div>
                    <div class="action-text">
                        <strong>${interfaceData.asInterfaceOS.relationshipTips.advice}</strong><br>
                        ${interfaceData.asInterfaceOS.howToTalk.example}
                    </div>
                </div>
                <div class="action-expected">
                    <strong>期待される効果:</strong><br>
                    ${engineData.osBalance.whenBalanced}
                </div>
            `;
            
            // 詳細セクション生成（全データを保持）
            document.getElementById('detail-content').innerHTML = `
                <div class="accordion-item engine">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title">
                            ${engineData.emoji} 原動力の詳細：${data.engineOS.hexagram}「${engineData.nickname}」
                        </div>
                        <span class="accordion-icon">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="accordion-inner">
                            ${generateOSDetail(engineData, 'engine', data.engineOS.score)}
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item interface">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title">
                            ${interfaceData.emoji} 人との関わり方：${data.interfaceOS.hexagram}「${interfaceData.nickname}」
                        </div>
                        <span class="accordion-icon">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="accordion-inner">
                            ${generateOSDetail(interfaceData, 'interface', data.interfaceOS.score)}
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item safemode">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title">
                            ${safeData.emoji} ストレス対処法：${data.safeModeOS.hexagram}「${safeData.nickname}」
                        </div>
                        <span class="accordion-icon">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="accordion-inner">
                            ${generateOSDetail(safeData, 'safemode', data.safeModeOS.score)}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateOSDetail(data, type, score) {
            // 既存の全データを表示（省略なし）
            let html = `
                <div style="margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-radius: 8px;">
                    <span>📍 第${data.id}卦</span> | 
                    <span>卦象: ${data.symbol}</span> | 
                    <span>五行: ${data.element}</span> | 
                    <span>スコア: ${score}</span>
                </div>
            `;
            
            if (type === 'engine' && data.asEngineOS) {
                const os = data.asEngineOS;
                html += `
                    <h4>${os.profile.type}</h4>
                    <p>${os.profile.description}</p>
                    <p style="font-style: italic; color: #6b7280;">${os.profile.metaphor}</p>
                    
                    <h4>通常の状態</h4>
                    <p>${os.normalState.whatHappens}</p>
                    <p>例: ${os.normalState.example}</p>
                    <p>エネルギー: ${os.normalState.energyLevel}</p>
                    
                    <h4>スーパーモード</h4>
                    <p>発動条件: ${os.superMode.when}</p>
                    <p>${os.superMode.whatHappens}</p>
                    ${os.superMode.example ? `<p>例: ${os.superMode.example}</p>` : ''}
                    
                    ${os.restMode ? `
                        <h4>休息モード</h4>
                        <p>${os.restMode.whatHappens}</p>
                        <p>休息方法: ${os.restMode.howToRest}</p>
                        ${os.restMode.note ? `<p>注: ${os.restMode.note}</p>` : ''}
                    ` : ''}
                    
                    <h4>セルフケア</h4>
                    <p>必要なもの: ${os.maintenance.whatYouNeed}</p>
                    <p>充電方法: ${os.maintenance.howToCharge}</p>
                    <p>⚠️ ${os.maintenance.warning}</p>
                    <p>💡 ${os.maintenance.tip}</p>
                `;
            } else if (type === 'interface' && data.asInterfaceOS) {
                const os = data.asInterfaceOS;
                html += `
                    <h4>${os.profile.type}</h4>
                    <p>${os.profile.description}</p>
                    ${os.profile.metaphor ? `<p style="font-style: italic; color: #6b7280;">${os.profile.metaphor}</p>` : ''}
                    
                    <h4>コミュニケーションスタイル</h4>
                    <p>話し方: ${os.howToTalk.style}</p>
                    <p>例: ${os.howToTalk.example}</p>
                    <p>得意: ${os.howToTalk.goodAt}</p>
                    ${os.howToTalk.notGoodAt ? `<p>苦手: ${os.howToTalk.notGoodAt}</p>` : ''}
                    
                    ${os.bestEnvironment ? `
                        <h4>最適環境</h4>
                        <p>場所: ${os.bestEnvironment.where}</p>
                        <p>例: ${os.bestEnvironment.example}</p>
                        <p>相性の良い人: ${os.bestEnvironment.withWho}</p>
                        ${os.bestEnvironment.avoid ? `<p>避けるべき環境: ${os.bestEnvironment.avoid}</p>` : ''}
                    ` : ''}
                    
                    ${os.relationshipTips ? `
                        <h4>関係性のコツ</h4>
                        <p>強み: ${os.relationshipTips.strength}</p>
                        <p>弱み: ${os.relationshipTips.weakness}</p>
                        <p>💡 ${os.relationshipTips.advice}</p>
                    ` : ''}
                `;
            } else if (type === 'safemode' && data.asSafeModeOS) {
                const os = data.asSafeModeOS;
                html += `
                    <h4>${os.profile.type}</h4>
                    <p>${os.profile.description}</p>
                    ${os.profile.metaphor ? `<p style="font-style: italic; color: #6b7280;">${os.profile.metaphor}</p>` : ''}
                    
                    <h4>ストレス対処法</h4>
                    <p>対処方法: ${os.stressResponse.whatYouDo}</p>
                    <p>例: ${os.stressResponse.example}</p>
                    <p>良い点: ${os.stressResponse.goodPoint}</p>
                    <p>注意点: ${os.stressResponse.badPoint}</p>
                    
                    ${os.emergencyMode ? `
                        <h4>緊急モード</h4>
                        <p>反応: ${os.emergencyMode.whatHappens}</p>
                        <p>例: ${os.emergencyMode.example}</p>
                        ${os.emergencyMode.recovery ? `<p>回復: ${os.emergencyMode.recovery}</p>` : ''}
                        <p>回復時間: ${os.emergencyMode.timeToRecover}</p>
                    ` : ''}
                    
                    ${os.howToRecover ? `
                        <h4>回復方法</h4>
                        <p>ベストな方法: ${os.howToRecover.bestWay}</p>
                        <p>例: ${os.howToRecover.example}</p>
                        ${os.howToRecover.environment ? `<p>環境: ${os.howToRecover.environment}</p>` : ''}
                        ${os.howToRecover.support ? `<p>サポート: ${os.howToRecover.support}</p>` : ''}
                    ` : ''}
                `;
            }
            
            if (data.osBalance) {
                html += `
                    <h4>バランス</h4>
                    <p>理想: ${data.osBalance.idealBalance}</p>
                    <p>バランス良好時: ${data.osBalance.whenBalanced}</p>
                    <p>バランス崩壊時: ${data.osBalance.whenImbalanced}</p>
                    <p>💡 ${data.osBalance.tip}</p>
                `;
            }
            
            return html;
        }

        // ユーティリティ関数
        function scrollToSummary() {
            document.getElementById('summary-section').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleDetailSection() {
            const content = document.getElementById('detail-content');
            const button = event.target;
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                button.textContent = '詳細分析レポートを表示 →';
            } else {
                content.classList.add('active');
                button.textContent = '詳細分析レポートを閉じる ↑';
            }
        }

        function toggleAccordion(header) {
            const item = header.parentElement;
            item.classList.toggle('active');
        }

        function loadPattern(patternName) {
            // ボタンのアクティブ状態を更新
            document.querySelectorAll('.sim-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // コンテンツを生成
            generateDynamicContent(patternName);
            
            // トップにスクロール
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 初期表示
        window.onload = () => {
            generateDynamicContent('innovator');
        };
    </script>
</body>
</html>