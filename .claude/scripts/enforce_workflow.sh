#!/bin/bash

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å¼·åˆ¶ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# å®Ÿè£…ã‚¿ã‚¹ã‚¯å‰ã«ãƒªã‚µãƒ¼ãƒã¨ãƒ—ãƒ©ãƒ³ã‚’è¦æ±‚

HOOK_DATA=$(cat)
TIMESTAMP=$(TZ=JST-9 date +"%Y%m%d_%H%M%S")
DOCS_DIR="/Users/hideakimacbookair/Desktop/haqei-analyzer/docs"

# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå†…å®¹ã‹ã‚‰å®Ÿè£…ã‚¿ã‚¹ã‚¯ã‹ã©ã†ã‹ã‚’åˆ¤å®š
if echo "$HOOK_DATA" | grep -q -E "(å®Ÿè£…|ä½œæˆ|ä¿®æ­£|è¿½åŠ |å¤‰æ›´)"; then
    
    echo "ðŸš¨ å®Ÿè£…ã‚¿ã‚¹ã‚¯ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚å¿…é ˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é–‹å§‹ã—ã¾ã™ã€‚" >&2
    echo "" >&2
    echo "ðŸ“‹ å¿…é ˆäº‹é …:" >&2
    echo "1. é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã®å¾¹åº•èª¿æŸ»" >&2
    echo "2. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç†è§£" >&2
    echo "3. è©³ç´°å®Ÿè£…ãƒ—ãƒ©ãƒ³ã®æç¤º" >&2
    echo "4. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ" >&2
    echo "" >&2
    echo "ðŸ’¡ CLAUDE.mdã®ä½œæ¥­æŒ‡ç¤ºã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚" >&2
    
    # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç¢ºèªãƒ­ã‚°
    echo "$(TZ=JST-9 date): Workflow enforcement triggered for implementation task" >> "$DOCS_DIR/workflow_enforcement.log"
    
    # å®Ÿè£…å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤ºã‚’è¦æ±‚
    cat >&2 << EOF

ðŸ” å®Ÿè£…å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:
â–¡ é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Glob/Grepã§æ¤œç´¢æ¸ˆã¿
â–¡ æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’Readã§ç†è§£æ¸ˆã¿
â–¡ å®Ÿè£…ãƒ—ãƒ©ãƒ³ã‚’TodoWriteã§æ•´ç†æ¸ˆã¿
â–¡ ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã‚’æ¤œè¨Žæ¸ˆã¿
â–¡ bunenjinå“²å­¦ã¨ã®æ•´åˆæ€§ã‚’ç¢ºèªæ¸ˆã¿

âš ï¸  ã“ã®è¦ä»¶ã‚’æº€ãŸã•ãšã«å®Ÿè£…ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

EOF

fi

exit 0